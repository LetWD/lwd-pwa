(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Cb(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var l=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,l.get?l:{enumerable:!0,get:function(){return e[s]}})}),n}var qh={exports:{}},Wi={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab=Symbol.for("react.transitional.element"),Tb=Symbol.for("react.fragment");function $h(e,t,n){var s=null;if(n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),"key"in t){n={};for(var l in t)l!=="key"&&(n[l]=t[l])}else n=t;return t=n.ref,{$$typeof:Ab,type:e,key:s,ref:t!==void 0?t:null,props:n}}Wi.Fragment=Tb;Wi.jsx=$h;Wi.jsxs=$h;qh.exports=Wi;var r=qh.exports,Vh={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zd=Symbol.for("react.transitional.element"),_b=Symbol.for("react.portal"),jb=Symbol.for("react.fragment"),Rb=Symbol.for("react.strict_mode"),Ib=Symbol.for("react.profiler"),Mb=Symbol.for("react.consumer"),Db=Symbol.for("react.context"),Ob=Symbol.for("react.forward_ref"),kb=Symbol.for("react.suspense"),Lb=Symbol.for("react.memo"),zh=Symbol.for("react.lazy"),px=Symbol.iterator;function Bb(e){return e===null||typeof e!="object"?null:(e=px&&e[px]||e["@@iterator"],typeof e=="function"?e:null)}var Qh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yh=Object.assign,Wh={};function _l(e,t,n){this.props=e,this.context=t,this.refs=Wh,this.updater=n||Qh}_l.prototype.isReactComponent={};_l.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Xh(){}Xh.prototype=_l.prototype;function Jd(e,t,n){this.props=e,this.context=t,this.refs=Wh,this.updater=n||Qh}var e0=Jd.prototype=new Xh;e0.constructor=Jd;Yh(e0,_l.prototype);e0.isPureReactComponent=!0;var gx=Array.isArray,wt={H:null,A:null,T:null,S:null,V:null},Kh=Object.prototype.hasOwnProperty;function t0(e,t,n,s,l,o){return n=o.ref,{$$typeof:Zd,type:e,key:t,ref:n!==void 0?n:null,props:o}}function Ub(e,t){return t0(e.type,t,void 0,void 0,void 0,e.props)}function n0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zd}function Pb(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var yx=/\/+/g;function yc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Pb(""+e.key):t.toString(36)}function bx(){}function Gb(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(bx,bx):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Vr(e,t,n,s,l){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"bigint":case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Zd:case _b:a=!0;break;case zh:return a=e._init,Vr(a(e._payload),t,n,s,l)}}if(a)return l=l(e),a=s===""?"."+yc(e,0):s,gx(l)?(n="",a!=null&&(n=a.replace(yx,"$&/")+"/"),Vr(l,t,n,"",function(c){return c})):l!=null&&(n0(l)&&(l=Ub(l,n+(l.key==null||e&&e.key===l.key?"":(""+l.key).replace(yx,"$&/")+"/")+a)),t.push(l)),1;a=0;var i=s===""?".":s+":";if(gx(e))for(var u=0;u<e.length;u++)s=e[u],o=i+yc(s,u),a+=Vr(s,t,n,o,l);else if(u=Bb(e),typeof u=="function")for(e=u.call(e),u=0;!(s=e.next()).done;)s=s.value,o=i+yc(s,u++),a+=Vr(s,t,n,o,l);else if(o==="object"){if(typeof e.then=="function")return Vr(Gb(e),t,n,s,l);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return a}function ma(e,t,n){if(e==null)return e;var s=[],l=0;return Vr(e,s,"","",function(o){return t.call(n,o,l++)}),s}function Hb(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vx=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Fb(){}Le.Children={map:ma,forEach:function(e,t,n){ma(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ma(e,function(){t++}),t},toArray:function(e){return ma(e,function(t){return t})||[]},only:function(e){if(!n0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Le.Component=_l;Le.Fragment=jb;Le.Profiler=Ib;Le.PureComponent=Jd;Le.StrictMode=Rb;Le.Suspense=kb;Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=wt;Le.__COMPILER_RUNTIME={__proto__:null,c:function(e){return wt.H.useMemoCache(e)}};Le.cache=function(e){return function(){return e.apply(null,arguments)}};Le.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var s=Yh({},e.props),l=e.key,o=void 0;if(t!=null)for(a in t.ref!==void 0&&(o=void 0),t.key!==void 0&&(l=""+t.key),t)!Kh.call(t,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&t.ref===void 0||(s[a]=t[a]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var i=Array(a),u=0;u<a;u++)i[u]=arguments[u+2];s.children=i}return t0(e.type,l,void 0,void 0,o,s)};Le.createContext=function(e){return e={$$typeof:Db,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:Mb,_context:e},e};Le.createElement=function(e,t,n){var s,l={},o=null;if(t!=null)for(s in t.key!==void 0&&(o=""+t.key),t)Kh.call(t,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(l[s]=t[s]);var a=arguments.length-2;if(a===1)l.children=n;else if(1<a){for(var i=Array(a),u=0;u<a;u++)i[u]=arguments[u+2];l.children=i}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)l[s]===void 0&&(l[s]=a[s]);return t0(e,o,void 0,void 0,null,l)};Le.createRef=function(){return{current:null}};Le.forwardRef=function(e){return{$$typeof:Ob,render:e}};Le.isValidElement=n0;Le.lazy=function(e){return{$$typeof:zh,_payload:{_status:-1,_result:e},_init:Hb}};Le.memo=function(e,t){return{$$typeof:Lb,type:e,compare:t===void 0?null:t}};Le.startTransition=function(e){var t=wt.T,n={};wt.T=n;try{var s=e(),l=wt.S;l!==null&&l(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(Fb,vx)}catch(o){vx(o)}finally{wt.T=t}};Le.unstable_useCacheRefresh=function(){return wt.H.useCacheRefresh()};Le.use=function(e){return wt.H.use(e)};Le.useActionState=function(e,t,n){return wt.H.useActionState(e,t,n)};Le.useCallback=function(e,t){return wt.H.useCallback(e,t)};Le.useContext=function(e){return wt.H.useContext(e)};Le.useDebugValue=function(){};Le.useDeferredValue=function(e,t){return wt.H.useDeferredValue(e,t)};Le.useEffect=function(e,t,n){var s=wt.H;if(typeof n=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return s.useEffect(e,t)};Le.useId=function(){return wt.H.useId()};Le.useImperativeHandle=function(e,t,n){return wt.H.useImperativeHandle(e,t,n)};Le.useInsertionEffect=function(e,t){return wt.H.useInsertionEffect(e,t)};Le.useLayoutEffect=function(e,t){return wt.H.useLayoutEffect(e,t)};Le.useMemo=function(e,t){return wt.H.useMemo(e,t)};Le.useOptimistic=function(e,t){return wt.H.useOptimistic(e,t)};Le.useReducer=function(e,t,n){return wt.H.useReducer(e,t,n)};Le.useRef=function(e){return wt.H.useRef(e)};Le.useState=function(e){return wt.H.useState(e)};Le.useSyncExternalStore=function(e,t,n){return wt.H.useSyncExternalStore(e,t,n)};Le.useTransition=function(){return wt.H.useTransition()};Le.version="19.1.0";Vh.exports=Le;var w=Vh.exports;const qb=Fh(w);var Zh={exports:{}},Xi={},Jh={exports:{}},ep={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,k){var H=B.length;B.push(k);e:for(;0<H;){var F=H-1>>>1,Z=B[F];if(0<l(Z,k))B[F]=k,B[H]=Z,H=F;else break e}}function n(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var k=B[0],H=B.pop();if(H!==k){B[0]=H;e:for(var F=0,Z=B.length,z=Z>>>1;F<z;){var q=2*(F+1)-1,Y=B[q],V=q+1,R=B[V];if(0>l(Y,H))V<Z&&0>l(R,Y)?(B[F]=R,B[V]=H,F=V):(B[F]=Y,B[q]=H,F=q);else if(V<Z&&0>l(R,H))B[F]=R,B[V]=H,F=V;else break e}}return k}function l(B,k){var H=B.sortIndex-k.sortIndex;return H!==0?H:B.id-k.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,i=a.now();e.unstable_now=function(){return a.now()-i}}var u=[],c=[],d=1,h=null,f=3,p=!1,v=!1,S=!1,N=!1,E=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function b(B){for(var k=n(c);k!==null;){if(k.callback===null)s(c);else if(k.startTime<=B)s(c),k.sortIndex=k.expirationTime,t(u,k);else break;k=n(c)}}function T(B){if(S=!1,b(B),!v)if(n(u)!==null)v=!0,A||(A=!0,D());else{var k=n(c);k!==null&&$(T,k.startTime-B)}}var A=!1,C=-1,_=5,L=-1;function I(){return N?!0:!(e.unstable_now()-L<_)}function j(){if(N=!1,A){var B=e.unstable_now();L=B;var k=!0;try{e:{v=!1,S&&(S=!1,g(C),C=-1),p=!0;var H=f;try{t:{for(b(B),h=n(u);h!==null&&!(h.expirationTime>B&&I());){var F=h.callback;if(typeof F=="function"){h.callback=null,f=h.priorityLevel;var Z=F(h.expirationTime<=B);if(B=e.unstable_now(),typeof Z=="function"){h.callback=Z,b(B),k=!0;break t}h===n(u)&&s(u),b(B)}else s(u);h=n(u)}if(h!==null)k=!0;else{var z=n(c);z!==null&&$(T,z.startTime-B),k=!1}}break e}finally{h=null,f=H,p=!1}k=void 0}}finally{k?D():A=!1}}}var D;if(typeof y=="function")D=function(){y(j)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,U=M.port2;M.port1.onmessage=j,D=function(){U.postMessage(null)}}else D=function(){E(j,0)};function $(B,k){C=E(function(){B(e.unstable_now())},k)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(B){switch(f){case 1:case 2:case 3:var k=3;break;default:k=f}var H=f;f=k;try{return B()}finally{f=H}},e.unstable_requestPaint=function(){N=!0},e.unstable_runWithPriority=function(B,k){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var H=f;f=B;try{return k()}finally{f=H}},e.unstable_scheduleCallback=function(B,k,H){var F=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?F+H:F):H=F,B){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=H+Z,B={id:d++,callback:k,priorityLevel:B,startTime:H,expirationTime:Z,sortIndex:-1},H>F?(B.sortIndex=H,t(c,B),n(u)===null&&B===n(c)&&(S?(g(C),C=-1):S=!0,$(T,H-F))):(B.sortIndex=Z,t(u,B),v||p||(v=!0,A||(A=!0,D()))),B},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(B){var k=f;return function(){var H=f;f=k;try{return B.apply(this,arguments)}finally{f=H}}}})(ep);Jh.exports=ep;var $b=Jh.exports,tp={exports:{}},Tn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb=w;function np(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Hs(){}var An={d:{f:Hs,r:function(){throw Error(np(522))},D:Hs,C:Hs,L:Hs,m:Hs,X:Hs,S:Hs,M:Hs},p:0,findDOMNode:null},zb=Symbol.for("react.portal");function Qb(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zb,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}var co=Vb.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Ki(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=An;Tn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(np(299));return Qb(e,t,null,n)};Tn.flushSync=function(e){var t=co.T,n=An.p;try{if(co.T=null,An.p=2,e)return e()}finally{co.T=t,An.p=n,An.d.f()}};Tn.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,An.d.C(e,t))};Tn.prefetchDNS=function(e){typeof e=="string"&&An.d.D(e)};Tn.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,s=Ki(n,t.crossOrigin),l=typeof t.integrity=="string"?t.integrity:void 0,o=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?An.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:s,integrity:l,fetchPriority:o}):n==="script"&&An.d.X(e,{crossOrigin:s,integrity:l,fetchPriority:o,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};Tn.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=Ki(t.as,t.crossOrigin);An.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&An.d.M(e)};Tn.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,s=Ki(n,t.crossOrigin);An.d.L(e,n,{crossOrigin:s,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};Tn.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=Ki(t.as,t.crossOrigin);An.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else An.d.m(e)};Tn.requestFormReset=function(e){An.d.r(e)};Tn.unstable_batchedUpdates=function(e,t){return e(t)};Tn.useFormState=function(e,t,n){return co.H.useFormState(e,t,n)};Tn.useFormStatus=function(){return co.H.useHostTransitionStatus()};Tn.version="19.1.0";function sp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sp)}catch(e){console.error(e)}}sp(),tp.exports=Tn;var Yb=tp.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vt=$b,rp=w,Wb=Yb;function oe(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function lp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wo(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function op(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ex(e){if(Wo(e)!==e)throw Error(oe(188))}function Xb(e){var t=e.alternate;if(!t){if(t=Wo(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var n=e,s=t;;){var l=n.return;if(l===null)break;var o=l.alternate;if(o===null){if(s=l.return,s!==null){n=s;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===n)return Ex(l),e;if(o===s)return Ex(l),t;o=o.sibling}throw Error(oe(188))}if(n.return!==s.return)n=l,s=o;else{for(var a=!1,i=l.child;i;){if(i===n){a=!0,n=l,s=o;break}if(i===s){a=!0,s=l,n=o;break}i=i.sibling}if(!a){for(i=o.child;i;){if(i===n){a=!0,n=o,s=l;break}if(i===s){a=!0,s=o,n=l;break}i=i.sibling}if(!a)throw Error(oe(189))}}if(n.alternate!==s)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?e:t}function ap(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=ap(e),t!==null)return t;e=e.sibling}return null}var Nt=Object.assign,Kb=Symbol.for("react.element"),fa=Symbol.for("react.transitional.element"),ro=Symbol.for("react.portal"),Wr=Symbol.for("react.fragment"),ip=Symbol.for("react.strict_mode"),Yu=Symbol.for("react.profiler"),Zb=Symbol.for("react.provider"),cp=Symbol.for("react.consumer"),Cs=Symbol.for("react.context"),s0=Symbol.for("react.forward_ref"),Wu=Symbol.for("react.suspense"),Xu=Symbol.for("react.suspense_list"),r0=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),Ku=Symbol.for("react.activity"),Jb=Symbol.for("react.memo_cache_sentinel"),Nx=Symbol.iterator;function Ul(e){return e===null||typeof e!="object"?null:(e=Nx&&e[Nx]||e["@@iterator"],typeof e=="function"?e:null)}var ev=Symbol.for("react.client.reference");function Zu(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ev?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wr:return"Fragment";case Yu:return"Profiler";case ip:return"StrictMode";case Wu:return"Suspense";case Xu:return"SuspenseList";case Ku:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case ro:return"Portal";case Cs:return(e.displayName||"Context")+".Provider";case cp:return(e._context.displayName||"Context")+".Consumer";case s0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case r0:return t=e.displayName||null,t!==null?t:Zu(e.type)||"Memo";case Ys:t=e._payload,e=e._init;try{return Zu(e(t))}catch{}}return null}var lo=Array.isArray,Te=rp.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,lt=Wb.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Cr={pending:!1,data:null,method:null,action:null},Ju=[],Xr=-1;function gs(e){return{current:e}}function on(e){0>Xr||(e.current=Ju[Xr],Ju[Xr]=null,Xr--)}function Ct(e,t){Xr++,Ju[Xr]=e.current,e.current=t}var fs=gs(null),_o=gs(null),rr=gs(null),fi=gs(null);function hi(e,t){switch(Ct(rr,t),Ct(_o,e),Ct(fs,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Tm(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Tm(t),e=Ay(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}on(fs),Ct(fs,e)}function gl(){on(fs),on(_o),on(rr)}function ed(e){e.memoizedState!==null&&Ct(fi,e);var t=fs.current,n=Ay(t,e.type);t!==n&&(Ct(_o,e),Ct(fs,n))}function pi(e){_o.current===e&&(on(fs),on(_o)),fi.current===e&&(on(fi),Uo._currentValue=Cr)}var td=Object.prototype.hasOwnProperty,l0=Vt.unstable_scheduleCallback,bc=Vt.unstable_cancelCallback,tv=Vt.unstable_shouldYield,nv=Vt.unstable_requestPaint,hs=Vt.unstable_now,sv=Vt.unstable_getCurrentPriorityLevel,up=Vt.unstable_ImmediatePriority,dp=Vt.unstable_UserBlockingPriority,gi=Vt.unstable_NormalPriority,rv=Vt.unstable_LowPriority,xp=Vt.unstable_IdlePriority,lv=Vt.log,ov=Vt.unstable_setDisableYieldValue,Xo=null,qn=null;function er(e){if(typeof lv=="function"&&ov(e),qn&&typeof qn.setStrictMode=="function")try{qn.setStrictMode(Xo,e)}catch{}}var $n=Math.clz32?Math.clz32:cv,av=Math.log,iv=Math.LN2;function cv(e){return e>>>=0,e===0?32:31-(av(e)/iv|0)|0}var ha=256,pa=4194304;function Nr(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Zi(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var l=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var i=s&134217727;return i!==0?(s=i&~o,s!==0?l=Nr(s):(a&=i,a!==0?l=Nr(a):n||(n=i&~e,n!==0&&(l=Nr(n))))):(i=s&~o,i!==0?l=Nr(i):a!==0?l=Nr(a):n||(n=s&~e,n!==0&&(l=Nr(n)))),l===0?0:t!==0&&t!==l&&!(t&o)&&(o=l&-l,n=t&-t,o>=n||o===32&&(n&4194048)!==0)?t:l}function Ko(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function uv(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mp(){var e=ha;return ha<<=1,!(ha&4194048)&&(ha=256),e}function fp(){var e=pa;return pa<<=1,!(pa&62914560)&&(pa=4194304),e}function vc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zo(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function dv(e,t,n,s,l,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var i=e.entanglements,u=e.expirationTimes,c=e.hiddenUpdates;for(n=a&~n;0<n;){var d=31-$n(n),h=1<<d;i[d]=0,u[d]=-1;var f=c[d];if(f!==null)for(c[d]=null,d=0;d<f.length;d++){var p=f[d];p!==null&&(p.lane&=-536870913)}n&=~h}s!==0&&hp(e,s,0),o!==0&&l===0&&e.tag!==0&&(e.suspendedLanes|=o&~(a&~t))}function hp(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-$n(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function pp(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-$n(n),l=1<<s;l&t|e[s]&t&&(e[s]|=t),n&=~l}}function o0(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function a0(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function gp(){var e=lt.p;return e!==0?e:(e=window.event,e===void 0?32:Ly(e.type))}function xv(e,t){var n=lt.p;try{return lt.p=e,t()}finally{lt.p=n}}var hr=Math.random().toString(36).slice(2),bn="__reactFiber$"+hr,On="__reactProps$"+hr,jl="__reactContainer$"+hr,nd="__reactEvents$"+hr,mv="__reactListeners$"+hr,fv="__reactHandles$"+hr,Sx="__reactResources$"+hr,Jo="__reactMarker$"+hr;function i0(e){delete e[bn],delete e[On],delete e[nd],delete e[mv],delete e[fv]}function Kr(e){var t=e[bn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[jl]||n[bn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Rm(e);e!==null;){if(n=e[bn])return n;e=Rm(e)}return t}e=n,n=e.parentNode}return null}function Rl(e){if(e=e[bn]||e[jl]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function oo(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(oe(33))}function il(e){var t=e[Sx];return t||(t=e[Sx]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function sn(e){e[Jo]=!0}var yp=new Set,bp={};function Br(e,t){yl(e,t),yl(e+"Capture",t)}function yl(e,t){for(bp[e]=t,e=0;e<t.length;e++)yp.add(t[e])}var hv=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wx={},Cx={};function pv(e){return td.call(Cx,e)?!0:td.call(wx,e)?!1:hv.test(e)?Cx[e]=!0:(wx[e]=!0,!1)}function Xa(e,t,n){if(pv(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ga(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function vs(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var Ec,Ax;function zr(e){if(Ec===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ec=t&&t[1]||"",Ax=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ec+e+Ax}var Nc=!1;function Sc(e,t){if(!e||Nc)return"";Nc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(p){var f=p}Reflect.construct(e,[],h)}else{try{h.call()}catch(p){f=p}e.call(h.prototype)}}else{try{throw Error()}catch(p){f=p}(h=e())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(p){if(p&&f&&typeof p.stack=="string")return[p.stack,f.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var l=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");l&&l.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=s.DetermineComponentFrameRoot(),a=o[0],i=o[1];if(a&&i){var u=a.split(`
`),c=i.split(`
`);for(l=s=0;s<u.length&&!u[s].includes("DetermineComponentFrameRoot");)s++;for(;l<c.length&&!c[l].includes("DetermineComponentFrameRoot");)l++;if(s===u.length||l===c.length)for(s=u.length-1,l=c.length-1;1<=s&&0<=l&&u[s]!==c[l];)l--;for(;1<=s&&0<=l;s--,l--)if(u[s]!==c[l]){if(s!==1||l!==1)do if(s--,l--,0>l||u[s]!==c[l]){var d=`
`+u[s].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=s&&0<=l);break}}}finally{Nc=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?zr(n):""}function gv(e){switch(e.tag){case 26:case 27:case 5:return zr(e.type);case 16:return zr("Lazy");case 13:return zr("Suspense");case 19:return zr("SuspenseList");case 0:case 15:return Sc(e.type,!1);case 11:return Sc(e.type.render,!1);case 1:return Sc(e.type,!0);case 31:return zr("Activity");default:return""}}function Tx(e){try{var t="";do t+=gv(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Xn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yv(e){var t=vp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(a){s=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yi(e){e._valueTracker||(e._valueTracker=yv(e))}function Ep(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=vp(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function bi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var bv=/[\n"\\]/g;function Jn(e){return e.replace(bv,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function sd(e,t,n,s,l,o,a,i){e.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.type=a:e.removeAttribute("type"),t!=null?a==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Xn(t)):e.value!==""+Xn(t)&&(e.value=""+Xn(t)):a!=="submit"&&a!=="reset"||e.removeAttribute("value"),t!=null?rd(e,a,Xn(t)):n!=null?rd(e,a,Xn(n)):s!=null&&e.removeAttribute("value"),l==null&&o!=null&&(e.defaultChecked=!!o),l!=null&&(e.checked=l&&typeof l!="function"&&typeof l!="symbol"),i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"?e.name=""+Xn(i):e.removeAttribute("name")}function Np(e,t,n,s,l,o,a,i){if(o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.type=o),t!=null||n!=null){if(!(o!=="submit"&&o!=="reset"||t!=null))return;n=n!=null?""+Xn(n):"",t=t!=null?""+Xn(t):n,i||t===e.value||(e.value=t),e.defaultValue=t}s=s??l,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=i?e.checked:!!s,e.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(e.name=a)}function rd(e,t,n){t==="number"&&bi(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function cl(e,t,n,s){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Xn(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,s&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Sp(e,t,n){if(t!=null&&(t=""+Xn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Xn(n):""}function wp(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(oe(92));if(lo(s)){if(1<s.length)throw Error(oe(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=Xn(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function bl(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var vv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _x(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||vv.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Cp(e,t,n){if(t!=null&&typeof t!="object")throw Error(oe(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var l in t)s=t[l],t.hasOwnProperty(l)&&n[l]!==s&&_x(e,l,s)}else for(var o in t)t.hasOwnProperty(o)&&_x(e,o,t[o])}function c0(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ev=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ka(e){return Nv.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var ld=null;function u0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zr=null,ul=null;function jx(e){var t=Rl(e);if(t&&(e=t.stateNode)){var n=e[On]||null;e:switch(e=t.stateNode,t.type){case"input":if(sd(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Jn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var l=s[On]||null;if(!l)throw Error(oe(90));sd(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&Ep(s)}break e;case"textarea":Sp(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&cl(e,!!n.multiple,t,!1)}}}var wc=!1;function Ap(e,t,n){if(wc)return e(t,n);wc=!0;try{var s=e(t);return s}finally{if(wc=!1,(Zr!==null||ul!==null)&&(ic(),Zr&&(t=Zr,e=ul,ul=Zr=null,jx(t),e)))for(t=0;t<e.length;t++)jx(e[t])}}function jo(e,t){var n=e.stateNode;if(n===null)return null;var s=n[On]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(oe(231,t,typeof n));return n}var Ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),od=!1;if(Ds)try{var Pl={};Object.defineProperty(Pl,"passive",{get:function(){od=!0}}),window.addEventListener("test",Pl,Pl),window.removeEventListener("test",Pl,Pl)}catch{od=!1}var tr=null,d0=null,Za=null;function Tp(){if(Za)return Za;var e,t=d0,n=t.length,s,l="value"in tr?tr.value:tr.textContent,o=l.length;for(e=0;e<n&&t[e]===l[e];e++);var a=n-e;for(s=1;s<=a&&t[n-s]===l[o-s];s++);return Za=l.slice(e,1<s?1-s:void 0)}function Ja(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ya(){return!0}function Rx(){return!1}function kn(e){function t(n,s,l,o,a){this._reactName=n,this._targetInst=l,this.type=s,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(o):o[i]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ya:Rx,this.isPropagationStopped=Rx,this}return Nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ya)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ya)},persist:function(){},isPersistent:ya}),t}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ji=kn(Ur),ea=Nt({},Ur,{view:0,detail:0}),Sv=kn(ea),Cc,Ac,Gl,ec=Nt({},ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:x0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gl&&(Gl&&e.type==="mousemove"?(Cc=e.screenX-Gl.screenX,Ac=e.screenY-Gl.screenY):Ac=Cc=0,Gl=e),Cc)},movementY:function(e){return"movementY"in e?e.movementY:Ac}}),Ix=kn(ec),wv=Nt({},ec,{dataTransfer:0}),Cv=kn(wv),Av=Nt({},ea,{relatedTarget:0}),Tc=kn(Av),Tv=Nt({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),_v=kn(Tv),jv=Nt({},Ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rv=kn(jv),Iv=Nt({},Ur,{data:0}),Mx=kn(Iv),Mv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ov={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ov[e])?!!t[e]:!1}function x0(){return kv}var Lv=Nt({},ea,{key:function(e){if(e.key){var t=Mv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ja(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Dv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:x0,charCode:function(e){return e.type==="keypress"?Ja(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ja(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bv=kn(Lv),Uv=Nt({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dx=kn(Uv),Pv=Nt({},ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:x0}),Gv=kn(Pv),Hv=Nt({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fv=kn(Hv),qv=Nt({},ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$v=kn(qv),Vv=Nt({},Ur,{newState:0,oldState:0}),zv=kn(Vv),Qv=[9,13,27,32],m0=Ds&&"CompositionEvent"in window,uo=null;Ds&&"documentMode"in document&&(uo=document.documentMode);var Yv=Ds&&"TextEvent"in window&&!uo,_p=Ds&&(!m0||uo&&8<uo&&11>=uo),Ox=" ",kx=!1;function jp(e,t){switch(e){case"keyup":return Qv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Jr=!1;function Wv(e,t){switch(e){case"compositionend":return Rp(t);case"keypress":return t.which!==32?null:(kx=!0,Ox);case"textInput":return e=t.data,e===Ox&&kx?null:e;default:return null}}function Xv(e,t){if(Jr)return e==="compositionend"||!m0&&jp(e,t)?(e=Tp(),Za=d0=tr=null,Jr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _p&&t.locale!=="ko"?null:t.data;default:return null}}var Kv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Kv[e.type]:t==="textarea"}function Ip(e,t,n,s){Zr?ul?ul.push(s):ul=[s]:Zr=s,t=Bi(t,"onChange"),0<t.length&&(n=new Ji("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var xo=null,Ro=null;function Zv(e){Sy(e,0)}function tc(e){var t=oo(e);if(Ep(t))return e}function Bx(e,t){if(e==="change")return t}var Mp=!1;if(Ds){var _c;if(Ds){var jc="oninput"in document;if(!jc){var Ux=document.createElement("div");Ux.setAttribute("oninput","return;"),jc=typeof Ux.oninput=="function"}_c=jc}else _c=!1;Mp=_c&&(!document.documentMode||9<document.documentMode)}function Px(){xo&&(xo.detachEvent("onpropertychange",Dp),Ro=xo=null)}function Dp(e){if(e.propertyName==="value"&&tc(Ro)){var t=[];Ip(t,Ro,e,u0(e)),Ap(Zv,t)}}function Jv(e,t,n){e==="focusin"?(Px(),xo=t,Ro=n,xo.attachEvent("onpropertychange",Dp)):e==="focusout"&&Px()}function e1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return tc(Ro)}function t1(e,t){if(e==="click")return tc(t)}function n1(e,t){if(e==="input"||e==="change")return tc(t)}function s1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qn=typeof Object.is=="function"?Object.is:s1;function Io(e,t){if(Qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var l=n[s];if(!td.call(t,l)||!Qn(e[l],t[l]))return!1}return!0}function Gx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hx(e,t){var n=Gx(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gx(n)}}function Op(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Op(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function kp(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=bi(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=bi(e.document)}return t}function f0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var r1=Ds&&"documentMode"in document&&11>=document.documentMode,el=null,ad=null,mo=null,id=!1;function Fx(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;id||el==null||el!==bi(s)||(s=el,"selectionStart"in s&&f0(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),mo&&Io(mo,s)||(mo=s,s=Bi(ad,"onSelect"),0<s.length&&(t=new Ji("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=el)))}function Er(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tl={animationend:Er("Animation","AnimationEnd"),animationiteration:Er("Animation","AnimationIteration"),animationstart:Er("Animation","AnimationStart"),transitionrun:Er("Transition","TransitionRun"),transitionstart:Er("Transition","TransitionStart"),transitioncancel:Er("Transition","TransitionCancel"),transitionend:Er("Transition","TransitionEnd")},Rc={},Lp={};Ds&&(Lp=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);function Pr(e){if(Rc[e])return Rc[e];if(!tl[e])return e;var t=tl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Lp)return Rc[e]=t[n];return e}var Bp=Pr("animationend"),Up=Pr("animationiteration"),Pp=Pr("animationstart"),l1=Pr("transitionrun"),o1=Pr("transitionstart"),a1=Pr("transitioncancel"),Gp=Pr("transitionend"),Hp=new Map,cd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cd.push("scrollEnd");function cs(e,t){Hp.set(e,t),Br(t,[e])}var qx=new WeakMap;function es(e,t){if(typeof e=="object"&&e!==null){var n=qx.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Tx(t)},qx.set(e,t),t)}return{value:e,source:t,stack:Tx(t)}}var Wn=[],nl=0,h0=0;function nc(){for(var e=nl,t=h0=nl=0;t<e;){var n=Wn[t];Wn[t++]=null;var s=Wn[t];Wn[t++]=null;var l=Wn[t];Wn[t++]=null;var o=Wn[t];if(Wn[t++]=null,s!==null&&l!==null){var a=s.pending;a===null?l.next=l:(l.next=a.next,a.next=l),s.pending=l}o!==0&&Fp(n,l,o)}}function sc(e,t,n,s){Wn[nl++]=e,Wn[nl++]=t,Wn[nl++]=n,Wn[nl++]=s,h0|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function p0(e,t,n,s){return sc(e,t,n,s),vi(e)}function Il(e,t){return sc(e,null,null,t),vi(e)}function Fp(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var l=!1,o=e.return;o!==null;)o.childLanes|=n,s=o.alternate,s!==null&&(s.childLanes|=n),o.tag===22&&(e=o.stateNode,e===null||e._visibility&1||(l=!0)),e=o,o=o.return;return e.tag===3?(o=e.stateNode,l&&t!==null&&(l=31-$n(n),e=o.hiddenUpdates,s=e[l],s===null?e[l]=[t]:s.push(t),t.lane=n|536870912),o):null}function vi(e){if(50<So)throw So=0,Rd=null,Error(oe(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var sl={};function i1(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(e,t,n,s){return new i1(e,t,n,s)}function g0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Is(e,t){var n=e.alternate;return n===null?(n=Hn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function qp(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ei(e,t,n,s,l,o){var a=0;if(s=e,typeof e=="function")g0(e)&&(a=1);else if(typeof e=="string")a=uE(e,n,fs.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Ku:return e=Hn(31,n,t,l),e.elementType=Ku,e.lanes=o,e;case Wr:return Ar(n.children,l,o,t);case ip:a=8,l|=24;break;case Yu:return e=Hn(12,n,t,l|2),e.elementType=Yu,e.lanes=o,e;case Wu:return e=Hn(13,n,t,l),e.elementType=Wu,e.lanes=o,e;case Xu:return e=Hn(19,n,t,l),e.elementType=Xu,e.lanes=o,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zb:case Cs:a=10;break e;case cp:a=9;break e;case s0:a=11;break e;case r0:a=14;break e;case Ys:a=16,s=null;break e}a=29,n=Error(oe(130,e===null?"null":typeof e,"")),s=null}return t=Hn(a,n,t,l),t.elementType=e,t.type=s,t.lanes=o,t}function Ar(e,t,n,s){return e=Hn(7,e,s,t),e.lanes=n,e}function Ic(e,t,n){return e=Hn(6,e,null,t),e.lanes=n,e}function Mc(e,t,n){return t=Hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var rl=[],ll=0,Ei=null,Ni=0,Kn=[],Zn=0,Tr=null,As=1,Ts="";function Sr(e,t){rl[ll++]=Ni,rl[ll++]=Ei,Ei=e,Ni=t}function $p(e,t,n){Kn[Zn++]=As,Kn[Zn++]=Ts,Kn[Zn++]=Tr,Tr=e;var s=As;e=Ts;var l=32-$n(s)-1;s&=~(1<<l),n+=1;var o=32-$n(t)+l;if(30<o){var a=l-l%5;o=(s&(1<<a)-1).toString(32),s>>=a,l-=a,As=1<<32-$n(t)+l|n<<l|s,Ts=o+e}else As=1<<o|n<<l|s,Ts=e}function y0(e){e.return!==null&&(Sr(e,1),$p(e,1,0))}function b0(e){for(;e===Ei;)Ei=rl[--ll],rl[ll]=null,Ni=rl[--ll],rl[ll]=null;for(;e===Tr;)Tr=Kn[--Zn],Kn[Zn]=null,Ts=Kn[--Zn],Kn[Zn]=null,As=Kn[--Zn],Kn[Zn]=null}var Cn=null,Rt=null,rt=!1,_r=null,xs=!1,ud=Error(oe(519));function Mr(e){var t=Error(oe(418,""));throw Mo(es(t,e)),ud}function $x(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[bn]=e,t[On]=s,n){case"dialog":Fe("cancel",t),Fe("close",t);break;case"iframe":case"object":case"embed":Fe("load",t);break;case"video":case"audio":for(n=0;n<ko.length;n++)Fe(ko[n],t);break;case"source":Fe("error",t);break;case"img":case"image":case"link":Fe("error",t),Fe("load",t);break;case"details":Fe("toggle",t);break;case"input":Fe("invalid",t),Np(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),yi(t);break;case"select":Fe("invalid",t);break;case"textarea":Fe("invalid",t),wp(t,s.value,s.defaultValue,s.children),yi(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||Cy(t.textContent,n)?(s.popover!=null&&(Fe("beforetoggle",t),Fe("toggle",t)),s.onScroll!=null&&Fe("scroll",t),s.onScrollEnd!=null&&Fe("scrollend",t),s.onClick!=null&&(t.onclick=dc),t=!0):t=!1,t||Mr(e)}function Vx(e){for(Cn=e.return;Cn;)switch(Cn.tag){case 5:case 13:xs=!1;return;case 27:case 3:xs=!0;return;default:Cn=Cn.return}}function Hl(e){if(e!==Cn)return!1;if(!rt)return Vx(e),rt=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Ld(e.type,e.memoizedProps)),n=!n),n&&Rt&&Mr(e),Vx(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Rt=is(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Rt=null}}else t===27?(t=Rt,pr(e.type)?(e=Pd,Pd=null,Rt=e):Rt=t):Rt=Cn?is(e.stateNode.nextSibling):null;return!0}function ta(){Rt=Cn=null,rt=!1}function zx(){var e=_r;return e!==null&&(In===null?In=e:In.push.apply(In,e),_r=null),e}function Mo(e){_r===null?_r=[e]:_r.push(e)}var dd=gs(null),Gr=null,_s=null;function Xs(e,t,n){Ct(dd,t._currentValue),t._currentValue=n}function Ms(e){e._currentValue=dd.current,on(dd)}function xd(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function md(e,t,n,s){var l=e.child;for(l!==null&&(l.return=e);l!==null;){var o=l.dependencies;if(o!==null){var a=l.child;o=o.firstContext;e:for(;o!==null;){var i=o;o=l;for(var u=0;u<t.length;u++)if(i.context===t[u]){o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),xd(o.return,n,e),s||(a=null);break e}o=i.next}}else if(l.tag===18){if(a=l.return,a===null)throw Error(oe(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),xd(a,n,e),a=null}else a=l.child;if(a!==null)a.return=l;else for(a=l;a!==null;){if(a===e){a=null;break}if(l=a.sibling,l!==null){l.return=a.return,a=l;break}a=a.return}l=a}}function na(e,t,n,s){e=null;for(var l=t,o=!1;l!==null;){if(!o){if(l.flags&524288)o=!0;else if(l.flags&262144)break}if(l.tag===10){var a=l.alternate;if(a===null)throw Error(oe(387));if(a=a.memoizedProps,a!==null){var i=l.type;Qn(l.pendingProps.value,a.value)||(e!==null?e.push(i):e=[i])}}else if(l===fi.current){if(a=l.alternate,a===null)throw Error(oe(387));a.memoizedState.memoizedState!==l.memoizedState.memoizedState&&(e!==null?e.push(Uo):e=[Uo])}l=l.return}e!==null&&md(t,e,n,s),t.flags|=262144}function Si(e){for(e=e.firstContext;e!==null;){if(!Qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Dr(e){Gr=e,_s=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vn(e){return Vp(Gr,e)}function ba(e,t){return Gr===null&&Dr(e),Vp(e,t)}function Vp(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},_s===null){if(e===null)throw Error(oe(308));_s=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else _s=_s.next=t;return n}var c1=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},u1=Vt.unstable_scheduleCallback,d1=Vt.unstable_NormalPriority,qt={$$typeof:Cs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function v0(){return{controller:new c1,data:new Map,refCount:0}}function sa(e){e.refCount--,e.refCount===0&&u1(d1,function(){e.controller.abort()})}var fo=null,fd=0,vl=0,dl=null;function x1(e,t){if(fo===null){var n=fo=[];fd=0,vl=q0(),dl={status:"pending",value:void 0,then:function(s){n.push(s)}}}return fd++,t.then(Qx,Qx),t}function Qx(){if(--fd===0&&fo!==null){dl!==null&&(dl.status="fulfilled");var e=fo;fo=null,vl=0,dl=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function m1(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(l){n.push(l)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var l=0;l<n.length;l++)(0,n[l])(t)},function(l){for(s.status="rejected",s.reason=l,l=0;l<n.length;l++)(0,n[l])(void 0)}),s}var Yx=Te.S;Te.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&x1(e,t),Yx!==null&&Yx(e,t)};var jr=gs(null);function E0(){var e=jr.current;return e!==null?e:bt.pooledCache}function ti(e,t){t===null?Ct(jr,jr.current):Ct(jr,t.pool)}function zp(){var e=E0();return e===null?null:{parent:qt._currentValue,pool:e}}var ra=Error(oe(460)),Qp=Error(oe(474)),rc=Error(oe(542)),hd={then:function(){}};function Wx(e){return e=e.status,e==="fulfilled"||e==="rejected"}function va(){}function Yp(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(va,va),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Kx(e),e;default:if(typeof t.status=="string")t.then(va,va);else{if(e=bt,e!==null&&100<e.shellSuspendCounter)throw Error(oe(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var l=t;l.status="fulfilled",l.value=s}},function(s){if(t.status==="pending"){var l=t;l.status="rejected",l.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Kx(e),e}throw ho=t,ra}}var ho=null;function Xx(){if(ho===null)throw Error(oe(459));var e=ho;return ho=null,e}function Kx(e){if(e===ra||e===rc)throw Error(oe(483))}var Ws=!1;function N0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function lr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function or(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,ut&2){var l=s.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t,t=vi(e),Fp(e,null,n),t}return sc(e,s,t,n),vi(e)}function po(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,pp(e,n)}}function Dc(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var l=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};o===null?l=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?l=o=t:o=o.next=t}else l=o=t;n={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:o,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var gd=!1;function go(){if(gd){var e=dl;if(e!==null)throw e}}function yo(e,t,n,s){gd=!1;var l=e.updateQueue;Ws=!1;var o=l.firstBaseUpdate,a=l.lastBaseUpdate,i=l.shared.pending;if(i!==null){l.shared.pending=null;var u=i,c=u.next;u.next=null,a===null?o=c:a.next=c,a=u;var d=e.alternate;d!==null&&(d=d.updateQueue,i=d.lastBaseUpdate,i!==a&&(i===null?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=u))}if(o!==null){var h=l.baseState;a=0,d=c=u=null,i=o;do{var f=i.lane&-536870913,p=f!==i.lane;if(p?(Ze&f)===f:(s&f)===f){f!==0&&f===vl&&(gd=!0),d!==null&&(d=d.next={lane:0,tag:i.tag,payload:i.payload,callback:null,next:null});e:{var v=e,S=i;f=t;var N=n;switch(S.tag){case 1:if(v=S.payload,typeof v=="function"){h=v.call(N,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=S.payload,f=typeof v=="function"?v.call(N,h,f):v,f==null)break e;h=Nt({},h,f);break e;case 2:Ws=!0}}f=i.callback,f!==null&&(e.flags|=64,p&&(e.flags|=8192),p=l.callbacks,p===null?l.callbacks=[f]:p.push(f))}else p={lane:f,tag:i.tag,payload:i.payload,callback:i.callback,next:null},d===null?(c=d=p,u=h):d=d.next=p,a|=f;if(i=i.next,i===null){if(i=l.shared.pending,i===null)break;p=i,i=p.next,p.next=null,l.lastBaseUpdate=p,l.shared.pending=null}}while(!0);d===null&&(u=h),l.baseState=u,l.firstBaseUpdate=c,l.lastBaseUpdate=d,o===null&&(l.shared.lanes=0),fr|=a,e.lanes=a,e.memoizedState=h}}function Wp(e,t){if(typeof e!="function")throw Error(oe(191,e));e.call(t)}function Xp(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Wp(n[e],t)}var El=gs(null),wi=gs(0);function Zx(e,t){e=Ls,Ct(wi,e),Ct(El,t),Ls=e|t.baseLanes}function yd(){Ct(wi,Ls),Ct(El,El.current)}function S0(){Ls=wi.current,on(El),on(wi)}var xr=0,Pe=null,xt=null,Lt=null,Ci=!1,xl=!1,Or=!1,Ai=0,Do=0,ml=null,f1=0;function Dt(){throw Error(oe(321))}function w0(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qn(e[n],t[n]))return!1;return!0}function C0(e,t,n,s,l,o){return xr=o,Pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Te.H=e===null||e.memoizedState===null?Tg:_g,Or=!1,o=n(s,l),Or=!1,xl&&(o=Zp(t,n,s,l)),Kp(e),o}function Kp(e){Te.H=Ti;var t=xt!==null&&xt.next!==null;if(xr=0,Lt=xt=Pe=null,Ci=!1,Do=0,ml=null,t)throw Error(oe(300));e===null||ln||(e=e.dependencies,e!==null&&Si(e)&&(ln=!0))}function Zp(e,t,n,s){Pe=e;var l=0;do{if(xl&&(ml=null),Do=0,xl=!1,25<=l)throw Error(oe(301));if(l+=1,Lt=xt=null,e.updateQueue!=null){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}Te.H=E1,o=t(n,s)}while(xl);return o}function h1(){var e=Te.H,t=e.useState()[0];return t=typeof t.then=="function"?la(t):t,e=e.useState()[0],(xt!==null?xt.memoizedState:null)!==e&&(Pe.flags|=1024),t}function A0(){var e=Ai!==0;return Ai=0,e}function T0(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function _0(e){if(Ci){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ci=!1}xr=0,Lt=xt=Pe=null,xl=!1,Do=Ai=0,ml=null}function jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?Pe.memoizedState=Lt=e:Lt=Lt.next=e,Lt}function Bt(){if(xt===null){var e=Pe.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=Lt===null?Pe.memoizedState:Lt.next;if(t!==null)Lt=t,xt=e;else{if(e===null)throw Pe.alternate===null?Error(oe(467)):Error(oe(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Lt===null?Pe.memoizedState=Lt=e:Lt=Lt.next=e}return Lt}function j0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function la(e){var t=Do;return Do+=1,ml===null&&(ml=[]),e=Yp(ml,e,t),t=Pe,(Lt===null?t.memoizedState:Lt.next)===null&&(t=t.alternate,Te.H=t===null||t.memoizedState===null?Tg:_g),e}function lc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return la(e);if(e.$$typeof===Cs)return vn(e)}throw Error(oe(438,String(e)))}function R0(e){var t=null,n=Pe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=Pe.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(l){return l.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=j0(),Pe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=Jb;return t.index++,n}function Os(e,t){return typeof t=="function"?t(e):t}function ni(e){var t=Bt();return I0(t,xt,e)}function I0(e,t,n){var s=e.queue;if(s===null)throw Error(oe(311));s.lastRenderedReducer=n;var l=e.baseQueue,o=s.pending;if(o!==null){if(l!==null){var a=l.next;l.next=o.next,o.next=a}t.baseQueue=l=o,s.pending=null}if(o=e.baseState,l===null)e.memoizedState=o;else{t=l.next;var i=a=null,u=null,c=t,d=!1;do{var h=c.lane&-536870913;if(h!==c.lane?(Ze&h)===h:(xr&h)===h){var f=c.revertLane;if(f===0)u!==null&&(u=u.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===vl&&(d=!0);else if((xr&f)===f){c=c.next,f===vl&&(d=!0);continue}else h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(i=u=h,a=o):u=u.next=h,Pe.lanes|=f,fr|=f;h=c.action,Or&&n(o,h),o=c.hasEagerState?c.eagerState:n(o,h)}else f={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},u===null?(i=u=f,a=o):u=u.next=f,Pe.lanes|=h,fr|=h;c=c.next}while(c!==null&&c!==t);if(u===null?a=o:u.next=i,!Qn(o,e.memoizedState)&&(ln=!0,d&&(n=dl,n!==null)))throw n;e.memoizedState=o,e.baseState=a,e.baseQueue=u,s.lastRenderedState=o}return l===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Oc(e){var t=Bt(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var s=n.dispatch,l=n.pending,o=t.memoizedState;if(l!==null){n.pending=null;var a=l=l.next;do o=e(o,a.action),a=a.next;while(a!==l);Qn(o,t.memoizedState)||(ln=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,s]}function Jp(e,t,n){var s=Pe,l=Bt(),o=rt;if(o){if(n===void 0)throw Error(oe(407));n=n()}else n=t();var a=!Qn((xt||l).memoizedState,n);a&&(l.memoizedState=n,ln=!0),l=l.queue;var i=ng.bind(null,s,l,e);if(oa(2048,8,i,[e]),l.getSnapshot!==t||a||Lt!==null&&Lt.memoizedState.tag&1){if(s.flags|=2048,Nl(9,oc(),tg.bind(null,s,l,n,t),null),bt===null)throw Error(oe(349));o||xr&124||eg(s,t,n)}return n}function eg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Pe.updateQueue,t===null?(t=j0(),Pe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function tg(e,t,n,s){t.value=n,t.getSnapshot=s,sg(t)&&rg(e)}function ng(e,t,n){return n(function(){sg(t)&&rg(e)})}function sg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qn(e,n)}catch{return!0}}function rg(e){var t=Il(e,2);t!==null&&zn(t,e,2)}function bd(e){var t=jn();if(typeof e=="function"){var n=e;if(e=n(),Or){er(!0);try{n()}finally{er(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:e},t}function lg(e,t,n,s){return e.baseState=n,I0(e,xt,typeof s=="function"?s:Os)}function p1(e,t,n,s,l){if(ac(e))throw Error(oe(485));if(e=t.action,e!==null){var o={payload:l,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){o.listeners.push(a)}};Te.T!==null?n(!0):o.isTransition=!1,s(o),n=t.pending,n===null?(o.next=t.pending=o,og(t,o)):(o.next=n.next,t.pending=n.next=o)}}function og(e,t){var n=t.action,s=t.payload,l=e.state;if(t.isTransition){var o=Te.T,a={};Te.T=a;try{var i=n(l,s),u=Te.S;u!==null&&u(a,i),Jx(e,t,i)}catch(c){vd(e,t,c)}finally{Te.T=o}}else try{o=n(l,s),Jx(e,t,o)}catch(c){vd(e,t,c)}}function Jx(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){em(e,t,s)},function(s){return vd(e,t,s)}):em(e,t,n)}function em(e,t,n){t.status="fulfilled",t.value=n,ag(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,og(e,n)))}function vd(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,ag(t),t=t.next;while(t!==s)}e.action=null}function ag(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ig(e,t){return t}function tm(e,t){if(rt){var n=bt.formState;if(n!==null){e:{var s=Pe;if(rt){if(Rt){t:{for(var l=Rt,o=xs;l.nodeType!==8;){if(!o){l=null;break t}if(l=is(l.nextSibling),l===null){l=null;break t}}o=l.data,l=o==="F!"||o==="F"?l:null}if(l){Rt=is(l.nextSibling),s=l.data==="F!";break e}}Mr(s)}s=!1}s&&(t=n[0])}}return n=jn(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ig,lastRenderedState:t},n.queue=s,n=wg.bind(null,Pe,s),s.dispatch=n,s=bd(!1),o=k0.bind(null,Pe,!1,s.queue),s=jn(),l={state:t,dispatch:null,action:e,pending:null},s.queue=l,n=p1.bind(null,Pe,l,o,n),l.dispatch=n,s.memoizedState=e,[t,n,!1]}function nm(e){var t=Bt();return cg(t,xt,e)}function cg(e,t,n){if(t=I0(e,t,ig)[0],e=ni(Os)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=la(t)}catch(a){throw a===ra?rc:a}else s=t;t=Bt();var l=t.queue,o=l.dispatch;return n!==t.memoizedState&&(Pe.flags|=2048,Nl(9,oc(),g1.bind(null,l,n),null)),[s,o,e]}function g1(e,t){e.action=t}function sm(e){var t=Bt(),n=xt;if(n!==null)return cg(t,n,e);Bt(),t=t.memoizedState,n=Bt();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function Nl(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=Pe.updateQueue,t===null&&(t=j0(),Pe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function oc(){return{destroy:void 0,resource:void 0}}function ug(){return Bt().memoizedState}function si(e,t,n,s){var l=jn();s=s===void 0?null:s,Pe.flags|=e,l.memoizedState=Nl(1|t,oc(),n,s)}function oa(e,t,n,s){var l=Bt();s=s===void 0?null:s;var o=l.memoizedState.inst;xt!==null&&s!==null&&w0(s,xt.memoizedState.deps)?l.memoizedState=Nl(t,o,n,s):(Pe.flags|=e,l.memoizedState=Nl(1|t,o,n,s))}function rm(e,t){si(8390656,8,e,t)}function dg(e,t){oa(2048,8,e,t)}function xg(e,t){return oa(4,2,e,t)}function mg(e,t){return oa(4,4,e,t)}function fg(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hg(e,t,n){n=n!=null?n.concat([e]):null,oa(4,4,fg.bind(null,t,e),n)}function M0(){}function pg(e,t){var n=Bt();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&w0(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function gg(e,t){var n=Bt();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&w0(t,s[1]))return s[0];if(s=e(),Or){er(!0);try{e()}finally{er(!1)}}return n.memoizedState=[s,t],s}function D0(e,t,n){return n===void 0||xr&1073741824?e.memoizedState=t:(e.memoizedState=n,e=ay(),Pe.lanes|=e,fr|=e,n)}function yg(e,t,n,s){return Qn(n,t)?n:El.current!==null?(e=D0(e,n,s),Qn(e,t)||(ln=!0),e):xr&42?(e=ay(),Pe.lanes|=e,fr|=e,t):(ln=!0,e.memoizedState=n)}function bg(e,t,n,s,l){var o=lt.p;lt.p=o!==0&&8>o?o:8;var a=Te.T,i={};Te.T=i,k0(e,!1,t,n);try{var u=l(),c=Te.S;if(c!==null&&c(i,u),u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=m1(u,s);bo(e,t,d,Vn(e))}else bo(e,t,s,Vn(e))}catch(h){bo(e,t,{then:function(){},status:"rejected",reason:h},Vn())}finally{lt.p=o,Te.T=a}}function y1(){}function Ed(e,t,n,s){if(e.tag!==5)throw Error(oe(476));var l=vg(e).queue;bg(e,l,t,Cr,n===null?y1:function(){return Eg(e),n(s)})}function vg(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Cr,baseState:Cr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:Cr},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Eg(e){var t=vg(e).next.queue;bo(e,t,{},Vn())}function O0(){return vn(Uo)}function Ng(){return Bt().memoizedState}function Sg(){return Bt().memoizedState}function b1(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Vn();e=lr(n);var s=or(t,e,n);s!==null&&(zn(s,t,n),po(s,t,n)),t={cache:v0()},e.payload=t;return}t=t.return}}function v1(e,t,n){var s=Vn();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},ac(e)?Cg(t,n):(n=p0(e,t,n,s),n!==null&&(zn(n,e,s),Ag(n,t,s)))}function wg(e,t,n){var s=Vn();bo(e,t,n,s)}function bo(e,t,n,s){var l={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(ac(e))Cg(t,l);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,i=o(a,n);if(l.hasEagerState=!0,l.eagerState=i,Qn(i,a))return sc(e,t,l,0),bt===null&&nc(),!1}catch{}finally{}if(n=p0(e,t,l,s),n!==null)return zn(n,e,s),Ag(n,t,s),!0}return!1}function k0(e,t,n,s){if(s={lane:2,revertLane:q0(),action:s,hasEagerState:!1,eagerState:null,next:null},ac(e)){if(t)throw Error(oe(479))}else t=p0(e,n,s,2),t!==null&&zn(t,e,2)}function ac(e){var t=e.alternate;return e===Pe||t!==null&&t===Pe}function Cg(e,t){xl=Ci=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ag(e,t,n){if(n&4194048){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,pp(e,n)}}var Ti={readContext:vn,use:lc,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt},Tg={readContext:vn,use:lc,useCallback:function(e,t){return jn().memoizedState=[e,t===void 0?null:t],e},useContext:vn,useEffect:rm,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,si(4194308,4,fg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return si(4194308,4,e,t)},useInsertionEffect:function(e,t){si(4,2,e,t)},useMemo:function(e,t){var n=jn();t=t===void 0?null:t;var s=e();if(Or){er(!0);try{e()}finally{er(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=jn();if(n!==void 0){var l=n(t);if(Or){er(!0);try{n(t)}finally{er(!1)}}}else l=t;return s.memoizedState=s.baseState=l,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:l},s.queue=e,e=e.dispatch=v1.bind(null,Pe,e),[s.memoizedState,e]},useRef:function(e){var t=jn();return e={current:e},t.memoizedState=e},useState:function(e){e=bd(e);var t=e.queue,n=wg.bind(null,Pe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:M0,useDeferredValue:function(e,t){var n=jn();return D0(n,e,t)},useTransition:function(){var e=bd(!1);return e=bg.bind(null,Pe,e.queue,!0,!1),jn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=Pe,l=jn();if(rt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=t(),bt===null)throw Error(oe(349));Ze&124||eg(s,t,n)}l.memoizedState=n;var o={value:n,getSnapshot:t};return l.queue=o,rm(ng.bind(null,s,o,e),[e]),s.flags|=2048,Nl(9,oc(),tg.bind(null,s,o,n,t),null),n},useId:function(){var e=jn(),t=bt.identifierPrefix;if(rt){var n=Ts,s=As;n=(s&~(1<<32-$n(s)-1)).toString(32)+n,t=""+t+"R"+n,n=Ai++,0<n&&(t+="H"+n.toString(32)),t+=""}else n=f1++,t=""+t+"r"+n.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:O0,useFormState:tm,useActionState:tm,useOptimistic:function(e){var t=jn();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=k0.bind(null,Pe,!0,n),n.dispatch=t,[e,t]},useMemoCache:R0,useCacheRefresh:function(){return jn().memoizedState=b1.bind(null,Pe)}},_g={readContext:vn,use:lc,useCallback:pg,useContext:vn,useEffect:dg,useImperativeHandle:hg,useInsertionEffect:xg,useLayoutEffect:mg,useMemo:gg,useReducer:ni,useRef:ug,useState:function(){return ni(Os)},useDebugValue:M0,useDeferredValue:function(e,t){var n=Bt();return yg(n,xt.memoizedState,e,t)},useTransition:function(){var e=ni(Os)[0],t=Bt().memoizedState;return[typeof e=="boolean"?e:la(e),t]},useSyncExternalStore:Jp,useId:Ng,useHostTransitionStatus:O0,useFormState:nm,useActionState:nm,useOptimistic:function(e,t){var n=Bt();return lg(n,xt,e,t)},useMemoCache:R0,useCacheRefresh:Sg},E1={readContext:vn,use:lc,useCallback:pg,useContext:vn,useEffect:dg,useImperativeHandle:hg,useInsertionEffect:xg,useLayoutEffect:mg,useMemo:gg,useReducer:Oc,useRef:ug,useState:function(){return Oc(Os)},useDebugValue:M0,useDeferredValue:function(e,t){var n=Bt();return xt===null?D0(n,e,t):yg(n,xt.memoizedState,e,t)},useTransition:function(){var e=Oc(Os)[0],t=Bt().memoizedState;return[typeof e=="boolean"?e:la(e),t]},useSyncExternalStore:Jp,useId:Ng,useHostTransitionStatus:O0,useFormState:sm,useActionState:sm,useOptimistic:function(e,t){var n=Bt();return xt!==null?lg(n,xt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:R0,useCacheRefresh:Sg},fl=null,Oo=0;function Ea(e){var t=Oo;return Oo+=1,fl===null&&(fl=[]),Yp(fl,e,t)}function Fl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Na(e,t){throw t.$$typeof===Kb?Error(oe(525)):(e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function lm(e){var t=e._init;return t(e._payload)}function jg(e){function t(E,g){if(e){var y=E.deletions;y===null?(E.deletions=[g],E.flags|=16):y.push(g)}}function n(E,g){if(!e)return null;for(;g!==null;)t(E,g),g=g.sibling;return null}function s(E){for(var g=new Map;E!==null;)E.key!==null?g.set(E.key,E):g.set(E.index,E),E=E.sibling;return g}function l(E,g){return E=Is(E,g),E.index=0,E.sibling=null,E}function o(E,g,y){return E.index=y,e?(y=E.alternate,y!==null?(y=y.index,y<g?(E.flags|=67108866,g):y):(E.flags|=67108866,g)):(E.flags|=1048576,g)}function a(E){return e&&E.alternate===null&&(E.flags|=67108866),E}function i(E,g,y,b){return g===null||g.tag!==6?(g=Ic(y,E.mode,b),g.return=E,g):(g=l(g,y),g.return=E,g)}function u(E,g,y,b){var T=y.type;return T===Wr?d(E,g,y.props.children,b,y.key):g!==null&&(g.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ys&&lm(T)===g.type)?(g=l(g,y.props),Fl(g,y),g.return=E,g):(g=ei(y.type,y.key,y.props,null,E.mode,b),Fl(g,y),g.return=E,g)}function c(E,g,y,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Mc(y,E.mode,b),g.return=E,g):(g=l(g,y.children||[]),g.return=E,g)}function d(E,g,y,b,T){return g===null||g.tag!==7?(g=Ar(y,E.mode,b,T),g.return=E,g):(g=l(g,y),g.return=E,g)}function h(E,g,y){if(typeof g=="string"&&g!==""||typeof g=="number"||typeof g=="bigint")return g=Ic(""+g,E.mode,y),g.return=E,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case fa:return y=ei(g.type,g.key,g.props,null,E.mode,y),Fl(y,g),y.return=E,y;case ro:return g=Mc(g,E.mode,y),g.return=E,g;case Ys:var b=g._init;return g=b(g._payload),h(E,g,y)}if(lo(g)||Ul(g))return g=Ar(g,E.mode,y,null),g.return=E,g;if(typeof g.then=="function")return h(E,Ea(g),y);if(g.$$typeof===Cs)return h(E,ba(E,g),y);Na(E,g)}return null}function f(E,g,y,b){var T=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return T!==null?null:i(E,g,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case fa:return y.key===T?u(E,g,y,b):null;case ro:return y.key===T?c(E,g,y,b):null;case Ys:return T=y._init,y=T(y._payload),f(E,g,y,b)}if(lo(y)||Ul(y))return T!==null?null:d(E,g,y,b,null);if(typeof y.then=="function")return f(E,g,Ea(y),b);if(y.$$typeof===Cs)return f(E,g,ba(E,y),b);Na(E,y)}return null}function p(E,g,y,b,T){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return E=E.get(y)||null,i(g,E,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case fa:return E=E.get(b.key===null?y:b.key)||null,u(g,E,b,T);case ro:return E=E.get(b.key===null?y:b.key)||null,c(g,E,b,T);case Ys:var A=b._init;return b=A(b._payload),p(E,g,y,b,T)}if(lo(b)||Ul(b))return E=E.get(y)||null,d(g,E,b,T,null);if(typeof b.then=="function")return p(E,g,y,Ea(b),T);if(b.$$typeof===Cs)return p(E,g,y,ba(g,b),T);Na(g,b)}return null}function v(E,g,y,b){for(var T=null,A=null,C=g,_=g=0,L=null;C!==null&&_<y.length;_++){C.index>_?(L=C,C=null):L=C.sibling;var I=f(E,C,y[_],b);if(I===null){C===null&&(C=L);break}e&&C&&I.alternate===null&&t(E,C),g=o(I,g,_),A===null?T=I:A.sibling=I,A=I,C=L}if(_===y.length)return n(E,C),rt&&Sr(E,_),T;if(C===null){for(;_<y.length;_++)C=h(E,y[_],b),C!==null&&(g=o(C,g,_),A===null?T=C:A.sibling=C,A=C);return rt&&Sr(E,_),T}for(C=s(C);_<y.length;_++)L=p(C,E,_,y[_],b),L!==null&&(e&&L.alternate!==null&&C.delete(L.key===null?_:L.key),g=o(L,g,_),A===null?T=L:A.sibling=L,A=L);return e&&C.forEach(function(j){return t(E,j)}),rt&&Sr(E,_),T}function S(E,g,y,b){if(y==null)throw Error(oe(151));for(var T=null,A=null,C=g,_=g=0,L=null,I=y.next();C!==null&&!I.done;_++,I=y.next()){C.index>_?(L=C,C=null):L=C.sibling;var j=f(E,C,I.value,b);if(j===null){C===null&&(C=L);break}e&&C&&j.alternate===null&&t(E,C),g=o(j,g,_),A===null?T=j:A.sibling=j,A=j,C=L}if(I.done)return n(E,C),rt&&Sr(E,_),T;if(C===null){for(;!I.done;_++,I=y.next())I=h(E,I.value,b),I!==null&&(g=o(I,g,_),A===null?T=I:A.sibling=I,A=I);return rt&&Sr(E,_),T}for(C=s(C);!I.done;_++,I=y.next())I=p(C,E,_,I.value,b),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?_:I.key),g=o(I,g,_),A===null?T=I:A.sibling=I,A=I);return e&&C.forEach(function(D){return t(E,D)}),rt&&Sr(E,_),T}function N(E,g,y,b){if(typeof y=="object"&&y!==null&&y.type===Wr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case fa:e:{for(var T=y.key;g!==null;){if(g.key===T){if(T=y.type,T===Wr){if(g.tag===7){n(E,g.sibling),b=l(g,y.props.children),b.return=E,E=b;break e}}else if(g.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ys&&lm(T)===g.type){n(E,g.sibling),b=l(g,y.props),Fl(b,y),b.return=E,E=b;break e}n(E,g);break}else t(E,g);g=g.sibling}y.type===Wr?(b=Ar(y.props.children,E.mode,b,y.key),b.return=E,E=b):(b=ei(y.type,y.key,y.props,null,E.mode,b),Fl(b,y),b.return=E,E=b)}return a(E);case ro:e:{for(T=y.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(E,g.sibling),b=l(g,y.children||[]),b.return=E,E=b;break e}else{n(E,g);break}else t(E,g);g=g.sibling}b=Mc(y,E.mode,b),b.return=E,E=b}return a(E);case Ys:return T=y._init,y=T(y._payload),N(E,g,y,b)}if(lo(y))return v(E,g,y,b);if(Ul(y)){if(T=Ul(y),typeof T!="function")throw Error(oe(150));return y=T.call(y),S(E,g,y,b)}if(typeof y.then=="function")return N(E,g,Ea(y),b);if(y.$$typeof===Cs)return N(E,g,ba(E,y),b);Na(E,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,g!==null&&g.tag===6?(n(E,g.sibling),b=l(g,y),b.return=E,E=b):(n(E,g),b=Ic(y,E.mode,b),b.return=E,E=b),a(E)):n(E,g)}return function(E,g,y,b){try{Oo=0;var T=N(E,g,y,b);return fl=null,T}catch(C){if(C===ra||C===rc)throw C;var A=Hn(29,C,null,E.mode);return A.lanes=b,A.return=E,A}finally{}}}var Sl=jg(!0),Rg=jg(!1),ss=gs(null),ps=null;function Ks(e){var t=e.alternate;Ct($t,$t.current&1),Ct(ss,e),ps===null&&(t===null||El.current!==null||t.memoizedState!==null)&&(ps=e)}function Ig(e){if(e.tag===22){if(Ct($t,$t.current),Ct(ss,e),ps===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(ps=e)}}else Zs()}function Zs(){Ct($t,$t.current),Ct(ss,ss.current)}function js(e){on(ss),ps===e&&(ps=null),on($t)}var $t=gs(0);function _i(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Ud(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function kc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Nt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Nd={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Vn(),l=lr(s);l.payload=t,n!=null&&(l.callback=n),t=or(e,l,s),t!==null&&(zn(t,e,s),po(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Vn(),l=lr(s);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=or(e,l,s),t!==null&&(zn(t,e,s),po(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Vn(),s=lr(n);s.tag=2,t!=null&&(s.callback=t),t=or(e,s,n),t!==null&&(zn(t,e,n),po(t,e,n))}};function om(e,t,n,s,l,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,o,a):t.prototype&&t.prototype.isPureReactComponent?!Io(n,s)||!Io(l,o):!0}function am(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Nd.enqueueReplaceState(t,t.state,null)}function kr(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=Nt({},n));for(var l in e)n[l]===void 0&&(n[l]=e[l])}return n}var ji=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Mg(e){ji(e)}function Dg(e){console.error(e)}function Og(e){ji(e)}function Ri(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function im(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(l){setTimeout(function(){throw l})}}function Sd(e,t,n){return n=lr(n),n.tag=3,n.payload={element:null},n.callback=function(){Ri(e,t)},n}function kg(e){return e=lr(e),e.tag=3,e}function Lg(e,t,n,s){var l=n.type.getDerivedStateFromError;if(typeof l=="function"){var o=s.value;e.payload=function(){return l(o)},e.callback=function(){im(t,n,s)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(e.callback=function(){im(t,n,s),typeof l!="function"&&(ar===null?ar=new Set([this]):ar.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})})}function N1(e,t,n,s,l){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&na(t,n,l,!0),n=ss.current,n!==null){switch(n.tag){case 13:return ps===null?Id():n.alternate===null&&It===0&&(It=3),n.flags&=-257,n.flags|=65536,n.lanes=l,s===hd?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),zc(e,s,l)),!1;case 22:return n.flags|=65536,s===hd?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),zc(e,s,l)),!1}throw Error(oe(435,n.tag))}return zc(e,s,l),Id(),!1}if(rt)return t=ss.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=l,s!==ud&&(e=Error(oe(422),{cause:s}),Mo(es(e,n)))):(s!==ud&&(t=Error(oe(423),{cause:s}),Mo(es(t,n))),e=e.current.alternate,e.flags|=65536,l&=-l,e.lanes|=l,s=es(s,n),l=Sd(e.stateNode,s,l),Dc(e,l),It!==4&&(It=2)),!1;var o=Error(oe(520),{cause:s});if(o=es(o,n),No===null?No=[o]:No.push(o),It!==4&&(It=2),t===null)return!0;s=es(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=l&-l,n.lanes|=e,e=Sd(n.stateNode,s,e),Dc(n,e),!1;case 1:if(t=n.type,o=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||o!==null&&typeof o.componentDidCatch=="function"&&(ar===null||!ar.has(o))))return n.flags|=65536,l&=-l,n.lanes|=l,l=kg(l),Lg(l,e,n,s),Dc(n,l),!1}n=n.return}while(n!==null);return!1}var Bg=Error(oe(461)),ln=!1;function mn(e,t,n,s){t.child=e===null?Rg(t,null,n,s):Sl(t,e.child,n,s)}function cm(e,t,n,s,l){n=n.render;var o=t.ref;if("ref"in s){var a={};for(var i in s)i!=="ref"&&(a[i]=s[i])}else a=s;return Dr(t),s=C0(e,t,n,a,o,l),i=A0(),e!==null&&!ln?(T0(e,t,l),ks(e,t,l)):(rt&&i&&y0(t),t.flags|=1,mn(e,t,s,l),t.child)}function um(e,t,n,s,l){if(e===null){var o=n.type;return typeof o=="function"&&!g0(o)&&o.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=o,Ug(e,t,o,s,l)):(e=ei(n.type,null,s,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!L0(e,l)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Io,n(a,s)&&e.ref===t.ref)return ks(e,t,l)}return t.flags|=1,e=Is(o,s),e.ref=t.ref,e.return=t,t.child=e}function Ug(e,t,n,s,l){if(e!==null){var o=e.memoizedProps;if(Io(o,s)&&e.ref===t.ref)if(ln=!1,t.pendingProps=s=o,L0(e,l))e.flags&131072&&(ln=!0);else return t.lanes=e.lanes,ks(e,t,l)}return wd(e,t,n,s,l)}function Pg(e,t,n){var s=t.pendingProps,l=s.children,o=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if(t.flags&128){if(s=o!==null?o.baseLanes|n:n,e!==null){for(l=t.child=e.child,o=0;l!==null;)o=o|l.lanes|l.childLanes,l=l.sibling;t.childLanes=o&~s}else t.childLanes=0,t.child=null;return dm(e,t,s,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ti(t,o!==null?o.cachePool:null),o!==null?Zx(t,o):yd(),Ig(t);else return t.lanes=t.childLanes=536870912,dm(e,t,o!==null?o.baseLanes|n:n,n)}else o!==null?(ti(t,o.cachePool),Zx(t,o),Zs(),t.memoizedState=null):(e!==null&&ti(t,null),yd(),Zs());return mn(e,t,l,n),t.child}function dm(e,t,n,s){var l=E0();return l=l===null?null:{parent:qt._currentValue,pool:l},t.memoizedState={baseLanes:n,cachePool:l},e!==null&&ti(t,null),yd(),Ig(t),e!==null&&na(e,t,s,!0),null}function ri(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(oe(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function wd(e,t,n,s,l){return Dr(t),n=C0(e,t,n,s,void 0,l),s=A0(),e!==null&&!ln?(T0(e,t,l),ks(e,t,l)):(rt&&s&&y0(t),t.flags|=1,mn(e,t,n,l),t.child)}function xm(e,t,n,s,l,o){return Dr(t),t.updateQueue=null,n=Zp(t,s,n,l),Kp(e),s=A0(),e!==null&&!ln?(T0(e,t,o),ks(e,t,o)):(rt&&s&&y0(t),t.flags|=1,mn(e,t,n,o),t.child)}function mm(e,t,n,s,l){if(Dr(t),t.stateNode===null){var o=sl,a=n.contextType;typeof a=="object"&&a!==null&&(o=vn(a)),o=new n(s,o),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Nd,t.stateNode=o,o._reactInternals=t,o=t.stateNode,o.props=s,o.state=t.memoizedState,o.refs={},N0(t),a=n.contextType,o.context=typeof a=="object"&&a!==null?vn(a):sl,o.state=t.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(kc(t,n,a,s),o.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(a=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),a!==o.state&&Nd.enqueueReplaceState(o,o.state,null),yo(t,s,o,l),go(),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){o=t.stateNode;var i=t.memoizedProps,u=kr(n,i);o.props=u;var c=o.context,d=n.contextType;a=sl,typeof d=="object"&&d!==null&&(a=vn(d));var h=n.getDerivedStateFromProps;d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function",i=t.pendingProps!==i,d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i||c!==a)&&am(t,o,s,a),Ws=!1;var f=t.memoizedState;o.state=f,yo(t,s,o,l),go(),c=t.memoizedState,i||f!==c||Ws?(typeof h=="function"&&(kc(t,n,h,s),c=t.memoizedState),(u=Ws||om(t,n,u,s,f,c,a))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),o.props=s,o.state=c,o.context=a,s=u):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,pd(e,t),a=t.memoizedProps,d=kr(n,a),o.props=d,h=t.pendingProps,f=o.context,c=n.contextType,u=sl,typeof c=="object"&&c!==null&&(u=vn(c)),i=n.getDerivedStateFromProps,(c=typeof i=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==u)&&am(t,o,s,u),Ws=!1,f=t.memoizedState,o.state=f,yo(t,s,o,l),go();var p=t.memoizedState;a!==h||f!==p||Ws||e!==null&&e.dependencies!==null&&Si(e.dependencies)?(typeof i=="function"&&(kc(t,n,i,s),p=t.memoizedState),(d=Ws||om(t,n,d,s,f,p,u)||e!==null&&e.dependencies!==null&&Si(e.dependencies))?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),o.props=s,o.state=p,o.context=u,s=d):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),s=!1)}return o=s,ri(e,t),s=(t.flags&128)!==0,o||s?(o=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:o.render(),t.flags|=1,e!==null&&s?(t.child=Sl(t,e.child,null,l),t.child=Sl(t,null,n,l)):mn(e,t,n,l),t.memoizedState=o.state,e=t.child):e=ks(e,t,l),e}function fm(e,t,n,s){return ta(),t.flags|=256,mn(e,t,n,s),t.child}var Lc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bc(e){return{baseLanes:e,cachePool:zp()}}function Uc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=ts),e}function Gg(e,t,n){var s=t.pendingProps,l=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:($t.current&2)!==0),a&&(l=!0,t.flags&=-129),a=(t.flags&32)!==0,t.flags&=-33,e===null){if(rt){if(l?Ks(t):Zs(),rt){var i=Rt,u;if(u=i){e:{for(u=i,i=xs;u.nodeType!==8;){if(!i){i=null;break e}if(u=is(u.nextSibling),u===null){i=null;break e}}i=u}i!==null?(t.memoizedState={dehydrated:i,treeContext:Tr!==null?{id:As,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},u=Hn(18,null,null,0),u.stateNode=i,u.return=t,t.child=u,Cn=t,Rt=null,u=!0):u=!1}u||Mr(t)}if(i=t.memoizedState,i!==null&&(i=i.dehydrated,i!==null))return Ud(i)?t.lanes=32:t.lanes=536870912,null;js(t)}return i=s.children,s=s.fallback,l?(Zs(),l=t.mode,i=Ii({mode:"hidden",children:i},l),s=Ar(s,l,n,null),i.return=t,s.return=t,i.sibling=s,t.child=i,l=t.child,l.memoizedState=Bc(n),l.childLanes=Uc(e,a,n),t.memoizedState=Lc,s):(Ks(t),Cd(t,i))}if(u=e.memoizedState,u!==null&&(i=u.dehydrated,i!==null)){if(o)t.flags&256?(Ks(t),t.flags&=-257,t=Pc(e,t,n)):t.memoizedState!==null?(Zs(),t.child=e.child,t.flags|=128,t=null):(Zs(),l=s.fallback,i=t.mode,s=Ii({mode:"visible",children:s.children},i),l=Ar(l,i,n,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,Sl(t,e.child,null,n),s=t.child,s.memoizedState=Bc(n),s.childLanes=Uc(e,a,n),t.memoizedState=Lc,t=l);else if(Ks(t),Ud(i)){if(a=i.nextSibling&&i.nextSibling.dataset,a)var c=a.dgst;a=c,s=Error(oe(419)),s.stack="",s.digest=a,Mo({value:s,source:null,stack:null}),t=Pc(e,t,n)}else if(ln||na(e,t,n,!1),a=(n&e.childLanes)!==0,ln||a){if(a=bt,a!==null&&(s=n&-n,s=s&42?1:o0(s),s=s&(a.suspendedLanes|n)?0:s,s!==0&&s!==u.retryLane))throw u.retryLane=s,Il(e,s),zn(a,e,s),Bg;i.data==="$?"||Id(),t=Pc(e,t,n)}else i.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=u.treeContext,Rt=is(i.nextSibling),Cn=t,rt=!0,_r=null,xs=!1,e!==null&&(Kn[Zn++]=As,Kn[Zn++]=Ts,Kn[Zn++]=Tr,As=e.id,Ts=e.overflow,Tr=t),t=Cd(t,s.children),t.flags|=4096);return t}return l?(Zs(),l=s.fallback,i=t.mode,u=e.child,c=u.sibling,s=Is(u,{mode:"hidden",children:s.children}),s.subtreeFlags=u.subtreeFlags&65011712,c!==null?l=Is(c,l):(l=Ar(l,i,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,i=e.child.memoizedState,i===null?i=Bc(n):(u=i.cachePool,u!==null?(c=qt._currentValue,u=u.parent!==c?{parent:c,pool:c}:u):u=zp(),i={baseLanes:i.baseLanes|n,cachePool:u}),l.memoizedState=i,l.childLanes=Uc(e,a,n),t.memoizedState=Lc,s):(Ks(t),n=e.child,e=n.sibling,n=Is(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(a=t.deletions,a===null?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function Cd(e,t){return t=Ii({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Ii(e,t){return e=Hn(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Pc(e,t,n){return Sl(t,e.child,null,n),e=Cd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hm(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),xd(e.return,t,n)}function Gc(e,t,n,s,l){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:l}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=l)}function Hg(e,t,n){var s=t.pendingProps,l=s.revealOrder,o=s.tail;if(mn(e,t,s.children,n),s=$t.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hm(e,n,t);else if(e.tag===19)hm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(Ct($t,s),l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&_i(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Gc(t,!1,l,n,o);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&_i(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Gc(t,!0,n,null,o);break;case"together":Gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ks(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),fr|=t.lanes,!(n&t.childLanes))if(e!==null){if(na(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,n=Is(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Is(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function L0(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Si(e)))}function S1(e,t,n){switch(t.tag){case 3:hi(t,t.stateNode.containerInfo),Xs(t,qt,e.memoizedState.cache),ta();break;case 27:case 5:ed(t);break;case 4:hi(t,t.stateNode.containerInfo);break;case 10:Xs(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Ks(t),t.flags|=128,null):n&t.child.childLanes?Gg(e,t,n):(Ks(t),e=ks(e,t,n),e!==null?e.sibling:null);Ks(t);break;case 19:var l=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(na(e,t,n,!1),s=(n&t.childLanes)!==0),l){if(s)return Hg(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Ct($t,$t.current),s)break;return null;case 22:case 23:return t.lanes=0,Pg(e,t,n);case 24:Xs(t,qt,e.memoizedState.cache)}return ks(e,t,n)}function Fg(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)ln=!0;else{if(!L0(e,n)&&!(t.flags&128))return ln=!1,S1(e,t,n);ln=!!(e.flags&131072)}else ln=!1,rt&&t.flags&1048576&&$p(t,Ni,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,l=s._init;if(s=l(s._payload),t.type=s,typeof s=="function")g0(s)?(e=kr(s,e),t.tag=1,t=mm(null,t,s,e,n)):(t.tag=0,t=wd(null,t,s,e,n));else{if(s!=null){if(l=s.$$typeof,l===s0){t.tag=11,t=cm(null,t,s,e,n);break e}else if(l===r0){t.tag=14,t=um(null,t,s,e,n);break e}}throw t=Zu(s)||s,Error(oe(306,t,""))}}return t;case 0:return wd(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,l=kr(s,t.pendingProps),mm(e,t,s,l,n);case 3:e:{if(hi(t,t.stateNode.containerInfo),e===null)throw Error(oe(387));s=t.pendingProps;var o=t.memoizedState;l=o.element,pd(e,t),yo(t,s,null,n);var a=t.memoizedState;if(s=a.cache,Xs(t,qt,s),s!==o.cache&&md(t,[qt],n,!0),go(),s=a.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){t=fm(e,t,s,n);break e}else if(s!==l){l=es(Error(oe(424)),t),Mo(l),t=fm(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Rt=is(e.firstChild),Cn=t,rt=!0,_r=null,xs=!0,n=Rg(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ta(),s===l){t=ks(e,t,n);break e}mn(e,t,s,n)}t=t.child}return t;case 26:return ri(e,t),e===null?(n=Mm(t.type,null,t.pendingProps,null))?t.memoizedState=n:rt||(n=t.type,e=t.pendingProps,s=Ui(rr.current).createElement(n),s[bn]=t,s[On]=e,hn(s,n,e),sn(s),t.stateNode=s):t.memoizedState=Mm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ed(t),e===null&&rt&&(s=t.stateNode=_y(t.type,t.pendingProps,rr.current),Cn=t,xs=!0,l=Rt,pr(t.type)?(Pd=l,Rt=is(s.firstChild)):Rt=l),mn(e,t,t.pendingProps.children,n),ri(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&rt&&((l=s=Rt)&&(s=K1(s,t.type,t.pendingProps,xs),s!==null?(t.stateNode=s,Cn=t,Rt=is(s.firstChild),xs=!1,l=!0):l=!1),l||Mr(t)),ed(t),l=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,s=o.children,Ld(l,o)?s=null:a!==null&&Ld(l,a)&&(t.flags|=32),t.memoizedState!==null&&(l=C0(e,t,h1,null,null,n),Uo._currentValue=l),ri(e,t),mn(e,t,s,n),t.child;case 6:return e===null&&rt&&((e=n=Rt)&&(n=Z1(n,t.pendingProps,xs),n!==null?(t.stateNode=n,Cn=t,Rt=null,e=!0):e=!1),e||Mr(t)),null;case 13:return Gg(e,t,n);case 4:return hi(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Sl(t,null,s,n):mn(e,t,s,n),t.child;case 11:return cm(e,t,t.type,t.pendingProps,n);case 7:return mn(e,t,t.pendingProps,n),t.child;case 8:return mn(e,t,t.pendingProps.children,n),t.child;case 12:return mn(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,Xs(t,t.type,s.value),mn(e,t,s.children,n),t.child;case 9:return l=t.type._context,s=t.pendingProps.children,Dr(t),l=vn(l),s=s(l),t.flags|=1,mn(e,t,s,n),t.child;case 14:return um(e,t,t.type,t.pendingProps,n);case 15:return Ug(e,t,t.type,t.pendingProps,n);case 19:return Hg(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Ii(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=Is(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Pg(e,t,n);case 24:return Dr(t),s=vn(qt),e===null?(l=E0(),l===null&&(l=bt,o=v0(),l.pooledCache=o,o.refCount++,o!==null&&(l.pooledCacheLanes|=n),l=o),t.memoizedState={parent:s,cache:l},N0(t),Xs(t,qt,l)):(e.lanes&n&&(pd(e,t),yo(t,null,null,n),go()),l=e.memoizedState,o=t.memoizedState,l.parent!==s?(l={parent:s,cache:s},t.memoizedState=l,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=l),Xs(t,qt,s)):(s=o.cache,Xs(t,qt,s),s!==l.cache&&md(t,[qt],n,!0))),mn(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(oe(156,t.tag))}function Es(e){e.flags|=4}function pm(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!Iy(t)){if(t=ss.current,t!==null&&((Ze&4194048)===Ze?ps!==null:(Ze&62914560)!==Ze&&!(Ze&536870912)||t!==ps))throw ho=hd,Qp;e.flags|=8192}}function Sa(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?fp():536870912,e.lanes|=t,wl|=t)}function ql(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags&65011712,s|=l.flags&65011712,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function w1(e,t,n){var s=t.pendingProps;switch(b0(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(t),null;case 1:return Tt(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Ms(qt),gl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Hl(t)?Es(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zx())),Tt(t),null;case 26:return n=t.memoizedState,e===null?(Es(t),n!==null?(Tt(t),pm(t,n)):(Tt(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Es(t),Tt(t),pm(t,n)):(Tt(t),t.flags&=-16777217):(e.memoizedProps!==s&&Es(t),Tt(t),t.flags&=-16777217),null;case 27:pi(t),n=rr.current;var l=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Es(t);else{if(!s){if(t.stateNode===null)throw Error(oe(166));return Tt(t),null}e=fs.current,Hl(t)?$x(t):(e=_y(l,s,n),t.stateNode=e,Es(t))}return Tt(t),null;case 5:if(pi(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Es(t);else{if(!s){if(t.stateNode===null)throw Error(oe(166));return Tt(t),null}if(e=fs.current,Hl(t))$x(t);else{switch(l=Ui(rr.current),e){case 1:e=l.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=l.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=l.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=l.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?l.createElement("select",{is:s.is}):l.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?l.createElement(n,{is:s.is}):l.createElement(n)}}e[bn]=t,e[On]=s;e:for(l=t.child;l!==null;){if(l.tag===5||l.tag===6)e.appendChild(l.stateNode);else if(l.tag!==4&&l.tag!==27&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===t)break e;for(;l.sibling===null;){if(l.return===null||l.return===t)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}t.stateNode=e;e:switch(hn(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Es(t)}}return Tt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Es(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(oe(166));if(e=rr.current,Hl(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,l=Cn,l!==null)switch(l.tag){case 27:case 5:s=l.memoizedProps}e[bn]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||Cy(e.nodeValue,n)),e||Mr(t)}else e=Ui(e).createTextNode(s),e[bn]=t,t.stateNode=e}return Tt(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(l=Hl(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(oe(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(oe(317));l[bn]=t}else ta(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tt(t),l=!1}else l=zx(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),l=!0;if(!l)return t.flags&256?(js(t),t):(js(t),null)}if(js(t),t.flags&128)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,l=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(l=s.alternate.memoizedState.cachePool.pool);var o=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),o!==l&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Sa(t,t.updateQueue),Tt(t),null;case 4:return gl(),e===null&&$0(t.stateNode.containerInfo),Tt(t),null;case 10:return Ms(t.type),Tt(t),null;case 19:if(on($t),l=t.memoizedState,l===null)return Tt(t),null;if(s=(t.flags&128)!==0,o=l.rendering,o===null)if(s)ql(l,!1);else{if(It!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=_i(e),o!==null){for(t.flags|=128,ql(l,!1),e=o.updateQueue,t.updateQueue=e,Sa(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)qp(n,e),n=n.sibling;return Ct($t,$t.current&1|2),t.child}e=e.sibling}l.tail!==null&&hs()>Di&&(t.flags|=128,s=!0,ql(l,!1),t.lanes=4194304)}else{if(!s)if(e=_i(o),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Sa(t,e),ql(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!rt)return Tt(t),null}else 2*hs()-l.renderingStartTime>Di&&n!==536870912&&(t.flags|=128,s=!0,ql(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(e=l.last,e!==null?e.sibling=o:t.child=o,l.last=o)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=hs(),t.sibling=null,e=$t.current,Ct($t,s?e&1|2:e&1),t):(Tt(t),null);case 22:case 23:return js(t),S0(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?n&536870912&&!(t.flags&128)&&(Tt(t),t.subtreeFlags&6&&(t.flags|=8192)):Tt(t),n=t.updateQueue,n!==null&&Sa(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&on(jr),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ms(qt),Tt(t),null;case 25:return null;case 30:return null}throw Error(oe(156,t.tag))}function C1(e,t){switch(b0(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ms(qt),gl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return pi(t),null;case 13:if(js(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));ta()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return on($t),null;case 4:return gl(),null;case 10:return Ms(t.type),null;case 22:case 23:return js(t),S0(),e!==null&&on(jr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ms(qt),null;case 25:return null;default:return null}}function qg(e,t){switch(b0(t),t.tag){case 3:Ms(qt),gl();break;case 26:case 27:case 5:pi(t);break;case 4:gl();break;case 13:js(t);break;case 19:on($t);break;case 10:Ms(t.type);break;case 22:case 23:js(t),S0(),e!==null&&on(jr);break;case 24:Ms(qt)}}function aa(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var l=s.next;n=l;do{if((n.tag&e)===e){s=void 0;var o=n.create,a=n.inst;s=o(),a.destroy=s}n=n.next}while(n!==l)}}catch(i){ht(t,t.return,i)}}function mr(e,t,n){try{var s=t.updateQueue,l=s!==null?s.lastEffect:null;if(l!==null){var o=l.next;s=o;do{if((s.tag&e)===e){var a=s.inst,i=a.destroy;if(i!==void 0){a.destroy=void 0,l=t;var u=n,c=i;try{c()}catch(d){ht(l,u,d)}}}s=s.next}while(s!==o)}}catch(d){ht(t,t.return,d)}}function $g(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Xp(t,n)}catch(s){ht(e,e.return,s)}}}function Vg(e,t,n){n.props=kr(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){ht(e,t,s)}}function vo(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(l){ht(e,t,l)}}function ms(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(l){ht(e,t,l)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(l){ht(e,t,l)}else n.current=null}function zg(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(l){ht(e,e.return,l)}}function Hc(e,t,n){try{var s=e.stateNode;z1(s,e.type,n,t),s[On]=t}catch(l){ht(e,e.return,l)}}function Qg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&pr(e.type)||e.tag===4}function Fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&pr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ad(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=dc));else if(s!==4&&(s===27&&pr(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Ad(e,t,n),e=e.sibling;e!==null;)Ad(e,t,n),e=e.sibling}function Mi(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&pr(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Mi(e,t,n),e=e.sibling;e!==null;)Mi(e,t,n),e=e.sibling}function Yg(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,l=t.attributes;l.length;)t.removeAttributeNode(l[0]);hn(t,s,n),t[bn]=e,t[On]=n}catch(o){ht(e,e.return,o)}}var ws=!1,Ot=!1,qc=!1,gm=typeof WeakSet=="function"?WeakSet:Set,nn=null;function A1(e,t){if(e=e.containerInfo,Od=Fi,e=kp(e),f0(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var l=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,i=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||l!==0&&h.nodeType!==3||(i=a+l),h!==o||s!==0&&h.nodeType!==3||(u=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===l&&(i=a),f===o&&++d===s&&(u=a),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=i===-1||u===-1?null:{start:i,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(kd={focusedElem:e,selectionRange:n},Fi=!1,nn=t;nn!==null;)if(t=nn,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,nn=e;else for(;nn!==null;){switch(t=nn,o=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&o!==null){e=void 0,n=t,l=o.memoizedProps,o=o.memoizedState,s=n.stateNode;try{var v=kr(n.type,l,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(v,o),s.__reactInternalSnapshotBeforeUpdate=e}catch(S){ht(n,n.return,S)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Bd(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Bd(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(oe(163))}if(e=t.sibling,e!==null){e.return=t.return,nn=e;break}nn=t.return}}function Wg(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:Fs(e,n),s&4&&aa(5,n);break;case 1:if(Fs(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(a){ht(n,n.return,a)}else{var l=kr(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(l,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){ht(n,n.return,a)}}s&64&&$g(n),s&512&&vo(n,n.return);break;case 3:if(Fs(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Xp(e,t)}catch(a){ht(n,n.return,a)}}break;case 27:t===null&&s&4&&Yg(n);case 26:case 5:Fs(e,n),t===null&&s&4&&zg(n),s&512&&vo(n,n.return);break;case 12:Fs(e,n);break;case 13:Fs(e,n),s&4&&Zg(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=k1.bind(null,n),J1(e,n))));break;case 22:if(s=n.memoizedState!==null||ws,!s){t=t!==null&&t.memoizedState!==null||Ot,l=ws;var o=Ot;ws=s,(Ot=t)&&!o?zs(e,n,(n.subtreeFlags&8772)!==0):Fs(e,n),ws=l,Ot=o}break;case 30:break;default:Fs(e,n)}}function Xg(e){var t=e.alternate;t!==null&&(e.alternate=null,Xg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&i0(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var St=null,Rn=!1;function Ns(e,t,n){for(n=n.child;n!==null;)Kg(e,t,n),n=n.sibling}function Kg(e,t,n){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount(Xo,n)}catch{}switch(n.tag){case 26:Ot||ms(n,t),Ns(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Ot||ms(n,t);var s=St,l=Rn;pr(n.type)&&(St=n.stateNode,Rn=!1),Ns(e,t,n),wo(n.stateNode),St=s,Rn=l;break;case 5:Ot||ms(n,t);case 6:if(s=St,l=Rn,St=null,Ns(e,t,n),St=s,Rn=l,St!==null)if(Rn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(n.stateNode)}catch(o){ht(n,t,o)}else try{St.removeChild(n.stateNode)}catch(o){ht(n,t,o)}break;case 18:St!==null&&(Rn?(e=St,jm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Ho(e)):jm(St,n.stateNode));break;case 4:s=St,l=Rn,St=n.stateNode.containerInfo,Rn=!0,Ns(e,t,n),St=s,Rn=l;break;case 0:case 11:case 14:case 15:Ot||mr(2,n,t),Ot||mr(4,n,t),Ns(e,t,n);break;case 1:Ot||(ms(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&Vg(n,t,s)),Ns(e,t,n);break;case 21:Ns(e,t,n);break;case 22:Ot=(s=Ot)||n.memoizedState!==null,Ns(e,t,n),Ot=s;break;default:Ns(e,t,n)}}function Zg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ho(e)}catch(n){ht(t,t.return,n)}}function T1(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new gm),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new gm),t;default:throw Error(oe(435,e.tag))}}function $c(e,t){var n=T1(e);t.forEach(function(s){var l=L1.bind(null,e,s);n.has(s)||(n.add(s),s.then(l,l))})}function Un(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var l=n[s],o=e,a=t,i=a;e:for(;i!==null;){switch(i.tag){case 27:if(pr(i.type)){St=i.stateNode,Rn=!1;break e}break;case 5:St=i.stateNode,Rn=!1;break e;case 3:case 4:St=i.stateNode.containerInfo,Rn=!0;break e}i=i.return}if(St===null)throw Error(oe(160));Kg(o,a,l),St=null,Rn=!1,o=l.alternate,o!==null&&(o.return=null),l.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Jg(t,e),t=t.sibling}var as=null;function Jg(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Un(t,e),Pn(e),s&4&&(mr(3,e,e.return),aa(3,e),mr(5,e,e.return));break;case 1:Un(t,e),Pn(e),s&512&&(Ot||n===null||ms(n,n.return)),s&64&&ws&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var l=as;if(Un(t,e),Pn(e),s&512&&(Ot||n===null||ms(n,n.return)),s&4){var o=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,l=l.ownerDocument||l;t:switch(s){case"title":o=l.getElementsByTagName("title")[0],(!o||o[Jo]||o[bn]||o.namespaceURI==="http://www.w3.org/2000/svg"||o.hasAttribute("itemprop"))&&(o=l.createElement(s),l.head.insertBefore(o,l.querySelector("head > title"))),hn(o,s,n),o[bn]=e,sn(o),s=o;break e;case"link":var a=Om("link","href",l).get(s+(n.href||""));if(a){for(var i=0;i<a.length;i++)if(o=a[i],o.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&o.getAttribute("rel")===(n.rel==null?null:n.rel)&&o.getAttribute("title")===(n.title==null?null:n.title)&&o.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(i,1);break t}}o=l.createElement(s),hn(o,s,n),l.head.appendChild(o);break;case"meta":if(a=Om("meta","content",l).get(s+(n.content||""))){for(i=0;i<a.length;i++)if(o=a[i],o.getAttribute("content")===(n.content==null?null:""+n.content)&&o.getAttribute("name")===(n.name==null?null:n.name)&&o.getAttribute("property")===(n.property==null?null:n.property)&&o.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&o.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(i,1);break t}}o=l.createElement(s),hn(o,s,n),l.head.appendChild(o);break;default:throw Error(oe(468,s))}o[bn]=e,sn(o),s=o}e.stateNode=s}else km(l,e.type,e.stateNode);else e.stateNode=Dm(l,s,e.memoizedProps);else o!==s?(o===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):o.count--,s===null?km(l,e.type,e.stateNode):Dm(l,s,e.memoizedProps)):s===null&&e.stateNode!==null&&Hc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Un(t,e),Pn(e),s&512&&(Ot||n===null||ms(n,n.return)),n!==null&&s&4&&Hc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Un(t,e),Pn(e),s&512&&(Ot||n===null||ms(n,n.return)),e.flags&32){l=e.stateNode;try{bl(l,"")}catch(p){ht(e,e.return,p)}}s&4&&e.stateNode!=null&&(l=e.memoizedProps,Hc(e,l,n!==null?n.memoizedProps:l)),s&1024&&(qc=!0);break;case 6:if(Un(t,e),Pn(e),s&4){if(e.stateNode===null)throw Error(oe(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(p){ht(e,e.return,p)}}break;case 3:if(ai=null,l=as,as=Pi(t.containerInfo),Un(t,e),as=l,Pn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ho(t.containerInfo)}catch(p){ht(e,e.return,p)}qc&&(qc=!1,ey(e));break;case 4:s=as,as=Pi(e.stateNode.containerInfo),Un(t,e),Pn(e),as=s;break;case 12:Un(t,e),Pn(e);break;case 13:Un(t,e),Pn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(H0=hs()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,$c(e,s)));break;case 22:l=e.memoizedState!==null;var u=n!==null&&n.memoizedState!==null,c=ws,d=Ot;if(ws=c||l,Ot=d||u,Un(t,e),Ot=d,ws=c,Pn(e),s&8192)e:for(t=e.stateNode,t._visibility=l?t._visibility&-2:t._visibility|1,l&&(n===null||u||ws||Ot||wr(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){u=n=t;try{if(o=u.stateNode,l)a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{i=u.stateNode;var h=u.memoizedProps.style,f=h!=null&&h.hasOwnProperty("display")?h.display:null;i.style.display=f==null||typeof f=="boolean"?"":(""+f).trim()}}catch(p){ht(u,u.return,p)}}}else if(t.tag===6){if(n===null){u=t;try{u.stateNode.nodeValue=l?"":u.memoizedProps}catch(p){ht(u,u.return,p)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,$c(e,n))));break;case 19:Un(t,e),Pn(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,$c(e,s)));break;case 30:break;case 21:break;default:Un(t,e),Pn(e)}}function Pn(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(Qg(s)){n=s;break}s=s.return}if(n==null)throw Error(oe(160));switch(n.tag){case 27:var l=n.stateNode,o=Fc(e);Mi(e,o,l);break;case 5:var a=n.stateNode;n.flags&32&&(bl(a,""),n.flags&=-33);var i=Fc(e);Mi(e,i,a);break;case 3:case 4:var u=n.stateNode.containerInfo,c=Fc(e);Ad(e,c,u);break;default:throw Error(oe(161))}}catch(d){ht(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ey(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;ey(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Fs(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Wg(e,t.alternate,t),t=t.sibling}function wr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:mr(4,t,t.return),wr(t);break;case 1:ms(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Vg(t,t.return,n),wr(t);break;case 27:wo(t.stateNode);case 26:case 5:ms(t,t.return),wr(t);break;case 22:t.memoizedState===null&&wr(t);break;case 30:wr(t);break;default:wr(t)}e=e.sibling}}function zs(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,l=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:zs(l,o,n),aa(4,o);break;case 1:if(zs(l,o,n),s=o,l=s.stateNode,typeof l.componentDidMount=="function")try{l.componentDidMount()}catch(c){ht(s,s.return,c)}if(s=o,l=s.updateQueue,l!==null){var i=s.stateNode;try{var u=l.shared.hiddenCallbacks;if(u!==null)for(l.shared.hiddenCallbacks=null,l=0;l<u.length;l++)Wp(u[l],i)}catch(c){ht(s,s.return,c)}}n&&a&64&&$g(o),vo(o,o.return);break;case 27:Yg(o);case 26:case 5:zs(l,o,n),n&&s===null&&a&4&&zg(o),vo(o,o.return);break;case 12:zs(l,o,n);break;case 13:zs(l,o,n),n&&a&4&&Zg(l,o);break;case 22:o.memoizedState===null&&zs(l,o,n),vo(o,o.return);break;case 30:break;default:zs(l,o,n)}t=t.sibling}}function B0(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&sa(n))}function U0(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&sa(e))}function us(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ty(e,t,n,s),t=t.sibling}function ty(e,t,n,s){var l=t.flags;switch(t.tag){case 0:case 11:case 15:us(e,t,n,s),l&2048&&aa(9,t);break;case 1:us(e,t,n,s);break;case 3:us(e,t,n,s),l&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&sa(e)));break;case 12:if(l&2048){us(e,t,n,s),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,i=o.onPostCommit;typeof i=="function"&&i(a,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(u){ht(t,t.return,u)}}else us(e,t,n,s);break;case 13:us(e,t,n,s);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,t.memoizedState!==null?o._visibility&2?us(e,t,n,s):Eo(e,t):o._visibility&2?us(e,t,n,s):(o._visibility|=2,Qr(e,t,n,s,(t.subtreeFlags&10256)!==0)),l&2048&&B0(a,t);break;case 24:us(e,t,n,s),l&2048&&U0(t.alternate,t);break;default:us(e,t,n,s)}}function Qr(e,t,n,s,l){for(l=l&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var o=e,a=t,i=n,u=s,c=a.flags;switch(a.tag){case 0:case 11:case 15:Qr(o,a,i,u,l),aa(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Qr(o,a,i,u,l):Eo(o,a):(d._visibility|=2,Qr(o,a,i,u,l)),l&&c&2048&&B0(a.alternate,a);break;case 24:Qr(o,a,i,u,l),l&&c&2048&&U0(a.alternate,a);break;default:Qr(o,a,i,u,l)}t=t.sibling}}function Eo(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,l=s.flags;switch(s.tag){case 22:Eo(n,s),l&2048&&B0(s.alternate,s);break;case 24:Eo(n,s),l&2048&&U0(s.alternate,s);break;default:Eo(n,s)}t=t.sibling}}var ao=8192;function qr(e){if(e.subtreeFlags&ao)for(e=e.child;e!==null;)ny(e),e=e.sibling}function ny(e){switch(e.tag){case 26:qr(e),e.flags&ao&&e.memoizedState!==null&&xE(as,e.memoizedState,e.memoizedProps);break;case 5:qr(e);break;case 3:case 4:var t=as;as=Pi(e.stateNode.containerInfo),qr(e),as=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=ao,ao=16777216,qr(e),ao=t):qr(e));break;default:qr(e)}}function sy(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function $l(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];nn=s,ly(s,e)}sy(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ry(e),e=e.sibling}function ry(e){switch(e.tag){case 0:case 11:case 15:$l(e),e.flags&2048&&mr(9,e,e.return);break;case 3:$l(e);break;case 12:$l(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,li(e)):$l(e);break;default:$l(e)}}function li(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];nn=s,ly(s,e)}sy(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:mr(8,t,t.return),li(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,li(t));break;default:li(t)}e=e.sibling}}function ly(e,t){for(;nn!==null;){var n=nn;switch(n.tag){case 0:case 11:case 15:mr(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:sa(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,nn=s;else e:for(n=e;nn!==null;){s=nn;var l=s.sibling,o=s.return;if(Xg(s),s===n){nn=null;break e}if(l!==null){l.return=o,nn=l;break e}nn=o}}}var _1={getCacheForType:function(e){var t=vn(qt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},j1=typeof WeakMap=="function"?WeakMap:Map,ut=0,bt=null,qe=null,Ze=0,ct=0,Gn=null,nr=!1,Ml=!1,P0=!1,Ls=0,It=0,fr=0,Rr=0,G0=0,ts=0,wl=0,No=null,In=null,Td=!1,H0=0,Di=1/0,Oi=null,ar=null,fn=0,ir=null,Cl=null,hl=0,_d=0,jd=null,oy=null,So=0,Rd=null;function Vn(){if(ut&2&&Ze!==0)return Ze&-Ze;if(Te.T!==null){var e=vl;return e!==0?e:q0()}return gp()}function ay(){ts===0&&(ts=!(Ze&536870912)||rt?mp():536870912);var e=ss.current;return e!==null&&(e.flags|=32),ts}function zn(e,t,n){(e===bt&&(ct===2||ct===9)||e.cancelPendingCommit!==null)&&(Al(e,0),sr(e,Ze,ts,!1)),Zo(e,n),(!(ut&2)||e!==bt)&&(e===bt&&(!(ut&2)&&(Rr|=n),It===4&&sr(e,Ze,ts,!1)),ys(e))}function iy(e,t,n){if(ut&6)throw Error(oe(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Ko(e,t),l=s?M1(e,t):Vc(e,t,!0),o=s;do{if(l===0){Ml&&!s&&sr(e,t,0,!1);break}else{if(n=e.current.alternate,o&&!R1(n)){l=Vc(e,t,!1),o=!1;continue}if(l===2){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=e.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){t=a;e:{var i=e;l=No;var u=i.current.memoizedState.isDehydrated;if(u&&(Al(i,a).flags|=256),a=Vc(i,a,!1),a!==2){if(P0&&!u){i.errorRecoveryDisabledLanes|=o,Rr|=o,l=4;break e}o=In,In=l,o!==null&&(In===null?In=o:In.push.apply(In,o))}l=a}if(o=!1,l!==2)continue}}if(l===1){Al(e,0),sr(e,t,0,!0);break}e:{switch(s=e,o=l,o){case 0:case 1:throw Error(oe(345));case 4:if((t&4194048)!==t)break;case 6:sr(s,t,ts,!nr);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(oe(329))}if((t&62914560)===t&&(l=H0+300-hs(),10<l)){if(sr(s,t,ts,!nr),Zi(s,0,!0)!==0)break e;s.timeoutHandle=Ty(ym.bind(null,s,n,In,Oi,Td,t,ts,Rr,wl,nr,o,2,-0,0),l);break e}ym(s,n,In,Oi,Td,t,ts,Rr,wl,nr,o,0,-0,0)}}break}while(!0);ys(e)}function ym(e,t,n,s,l,o,a,i,u,c,d,h,f,p){if(e.timeoutHandle=-1,h=t.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(Bo={stylesheets:null,count:0,unsuspend:dE},ny(t),h=mE(),h!==null)){e.cancelPendingCommit=h(vm.bind(null,e,t,o,n,s,l,a,i,u,d,1,f,p)),sr(e,o,a,!c);return}vm(e,t,o,n,s,l,a,i,u)}function R1(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var l=n[s],o=l.getSnapshot;l=l.value;try{if(!Qn(o(),l))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sr(e,t,n,s){t&=~G0,t&=~Rr,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var l=t;0<l;){var o=31-$n(l),a=1<<o;s[o]=-1,l&=~a}n!==0&&hp(e,n,t)}function ic(){return ut&6?!0:(ia(0),!1)}function F0(){if(qe!==null){if(ct===0)var e=qe.return;else e=qe,_s=Gr=null,_0(e),fl=null,Oo=0,e=qe;for(;e!==null;)qg(e.alternate,e),e=e.return;qe=null}}function Al(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Y1(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),F0(),bt=e,qe=n=Is(e.current,null),Ze=t,ct=0,Gn=null,nr=!1,Ml=Ko(e,t),P0=!1,wl=ts=G0=Rr=fr=It=0,In=No=null,Td=!1,t&8&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var l=31-$n(s),o=1<<l;t|=e[l],s&=~o}return Ls=t,nc(),n}function cy(e,t){Pe=null,Te.H=Ti,t===ra||t===rc?(t=Xx(),ct=3):t===Qp?(t=Xx(),ct=4):ct=t===Bg?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Gn=t,qe===null&&(It=1,Ri(e,es(t,e.current)))}function uy(){var e=Te.H;return Te.H=Ti,e===null?Ti:e}function dy(){var e=Te.A;return Te.A=_1,e}function Id(){It=4,nr||(Ze&4194048)!==Ze&&ss.current!==null||(Ml=!0),!(fr&134217727)&&!(Rr&134217727)||bt===null||sr(bt,Ze,ts,!1)}function Vc(e,t,n){var s=ut;ut|=2;var l=uy(),o=dy();(bt!==e||Ze!==t)&&(Oi=null,Al(e,t)),t=!1;var a=It;e:do try{if(ct!==0&&qe!==null){var i=qe,u=Gn;switch(ct){case 8:F0(),a=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(t=!0);var c=ct;if(ct=0,Gn=null,ol(e,i,u,c),n&&Ml){a=0;break e}break;default:c=ct,ct=0,Gn=null,ol(e,i,u,c)}}I1(),a=It;break}catch(d){cy(e,d)}while(!0);return t&&e.shellSuspendCounter++,_s=Gr=null,ut=s,Te.H=l,Te.A=o,qe===null&&(bt=null,Ze=0,nc()),a}function I1(){for(;qe!==null;)xy(qe)}function M1(e,t){var n=ut;ut|=2;var s=uy(),l=dy();bt!==e||Ze!==t?(Oi=null,Di=hs()+500,Al(e,t)):Ml=Ko(e,t);e:do try{if(ct!==0&&qe!==null){t=qe;var o=Gn;t:switch(ct){case 1:ct=0,Gn=null,ol(e,t,o,1);break;case 2:case 9:if(Wx(o)){ct=0,Gn=null,bm(t);break}t=function(){ct!==2&&ct!==9||bt!==e||(ct=7),ys(e)},o.then(t,t);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:Wx(o)?(ct=0,Gn=null,bm(t)):(ct=0,Gn=null,ol(e,t,o,7));break;case 5:var a=null;switch(qe.tag){case 26:a=qe.memoizedState;case 5:case 27:var i=qe;if(!a||Iy(a)){ct=0,Gn=null;var u=i.sibling;if(u!==null)qe=u;else{var c=i.return;c!==null?(qe=c,cc(c)):qe=null}break t}}ct=0,Gn=null,ol(e,t,o,5);break;case 6:ct=0,Gn=null,ol(e,t,o,6);break;case 8:F0(),It=6;break e;default:throw Error(oe(462))}}D1();break}catch(d){cy(e,d)}while(!0);return _s=Gr=null,Te.H=s,Te.A=l,ut=n,qe!==null?0:(bt=null,Ze=0,nc(),It)}function D1(){for(;qe!==null&&!tv();)xy(qe)}function xy(e){var t=Fg(e.alternate,e,Ls);e.memoizedProps=e.pendingProps,t===null?cc(e):qe=t}function bm(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=xm(n,t,t.pendingProps,t.type,void 0,Ze);break;case 11:t=xm(n,t,t.pendingProps,t.type.render,t.ref,Ze);break;case 5:_0(t);default:qg(n,t),t=qe=qp(t,Ls),t=Fg(n,t,Ls)}e.memoizedProps=e.pendingProps,t===null?cc(e):qe=t}function ol(e,t,n,s){_s=Gr=null,_0(t),fl=null,Oo=0;var l=t.return;try{if(N1(e,l,t,n,Ze)){It=1,Ri(e,es(n,e.current)),qe=null;return}}catch(o){if(l!==null)throw qe=l,o;It=1,Ri(e,es(n,e.current)),qe=null;return}t.flags&32768?(rt||s===1?e=!0:Ml||Ze&536870912?e=!1:(nr=e=!0,(s===2||s===9||s===3||s===6)&&(s=ss.current,s!==null&&s.tag===13&&(s.flags|=16384))),my(t,e)):cc(t)}function cc(e){var t=e;do{if(t.flags&32768){my(t,nr);return}e=t.return;var n=w1(t.alternate,t,Ls);if(n!==null){qe=n;return}if(t=t.sibling,t!==null){qe=t;return}qe=t=e}while(t!==null);It===0&&(It=5)}function my(e,t){do{var n=C1(e.alternate,e);if(n!==null){n.flags&=32767,qe=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){qe=e;return}qe=e=n}while(e!==null);It=6,qe=null}function vm(e,t,n,s,l,o,a,i,u){e.cancelPendingCommit=null;do uc();while(fn!==0);if(ut&6)throw Error(oe(327));if(t!==null){if(t===e.current)throw Error(oe(177));if(o=t.lanes|t.childLanes,o|=h0,dv(e,n,o,a,i,u),e===bt&&(qe=bt=null,Ze=0),Cl=t,ir=e,hl=n,_d=o,jd=l,oy=s,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,B1(gi,function(){return yy(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,t.subtreeFlags&13878||s){s=Te.T,Te.T=null,l=lt.p,lt.p=2,a=ut,ut|=4;try{A1(e,t,n)}finally{ut=a,lt.p=l,Te.T=s}}fn=1,fy(),hy(),py()}}function fy(){if(fn===1){fn=0;var e=ir,t=Cl,n=(t.flags&13878)!==0;if(t.subtreeFlags&13878||n){n=Te.T,Te.T=null;var s=lt.p;lt.p=2;var l=ut;ut|=4;try{Jg(t,e);var o=kd,a=kp(e.containerInfo),i=o.focusedElem,u=o.selectionRange;if(a!==i&&i&&i.ownerDocument&&Op(i.ownerDocument.documentElement,i)){if(u!==null&&f0(i)){var c=u.start,d=u.end;if(d===void 0&&(d=c),"selectionStart"in i)i.selectionStart=c,i.selectionEnd=Math.min(d,i.value.length);else{var h=i.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var p=f.getSelection(),v=i.textContent.length,S=Math.min(u.start,v),N=u.end===void 0?S:Math.min(u.end,v);!p.extend&&S>N&&(a=N,N=S,S=a);var E=Hx(i,S),g=Hx(i,N);if(E&&g&&(p.rangeCount!==1||p.anchorNode!==E.node||p.anchorOffset!==E.offset||p.focusNode!==g.node||p.focusOffset!==g.offset)){var y=h.createRange();y.setStart(E.node,E.offset),p.removeAllRanges(),S>N?(p.addRange(y),p.extend(g.node,g.offset)):(y.setEnd(g.node,g.offset),p.addRange(y))}}}}for(h=[],p=i;p=p.parentNode;)p.nodeType===1&&h.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<h.length;i++){var b=h[i];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}Fi=!!Od,kd=Od=null}finally{ut=l,lt.p=s,Te.T=n}}e.current=t,fn=2}}function hy(){if(fn===2){fn=0;var e=ir,t=Cl,n=(t.flags&8772)!==0;if(t.subtreeFlags&8772||n){n=Te.T,Te.T=null;var s=lt.p;lt.p=2;var l=ut;ut|=4;try{Wg(e,t.alternate,t)}finally{ut=l,lt.p=s,Te.T=n}}fn=3}}function py(){if(fn===4||fn===3){fn=0,nv();var e=ir,t=Cl,n=hl,s=oy;t.subtreeFlags&10256||t.flags&10256?fn=5:(fn=0,Cl=ir=null,gy(e,e.pendingLanes));var l=e.pendingLanes;if(l===0&&(ar=null),a0(n),t=t.stateNode,qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot(Xo,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=Te.T,l=lt.p,lt.p=2,Te.T=null;try{for(var o=e.onRecoverableError,a=0;a<s.length;a++){var i=s[a];o(i.value,{componentStack:i.stack})}}finally{Te.T=t,lt.p=l}}hl&3&&uc(),ys(e),l=e.pendingLanes,n&4194090&&l&42?e===Rd?So++:(So=0,Rd=e):So=0,ia(0)}}function gy(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,sa(t)))}function uc(e){return fy(),hy(),py(),yy()}function yy(){if(fn!==5)return!1;var e=ir,t=_d;_d=0;var n=a0(hl),s=Te.T,l=lt.p;try{lt.p=32>n?32:n,Te.T=null,n=jd,jd=null;var o=ir,a=hl;if(fn=0,Cl=ir=null,hl=0,ut&6)throw Error(oe(331));var i=ut;if(ut|=4,ry(o.current),ty(o,o.current,a,n),ut=i,ia(0,!1),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot(Xo,o)}catch{}return!0}finally{lt.p=l,Te.T=s,gy(e,t)}}function Em(e,t,n){t=es(n,t),t=Sd(e.stateNode,t,2),e=or(e,t,2),e!==null&&(Zo(e,2),ys(e))}function ht(e,t,n){if(e.tag===3)Em(e,e,n);else for(;t!==null;){if(t.tag===3){Em(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ar===null||!ar.has(s))){e=es(n,e),n=kg(2),s=or(t,n,2),s!==null&&(Lg(n,s,t,e),Zo(s,2),ys(s));break}}t=t.return}}function zc(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new j1;var l=new Set;s.set(t,l)}else l=s.get(t),l===void 0&&(l=new Set,s.set(t,l));l.has(n)||(P0=!0,l.add(n),e=O1.bind(null,e,t,n),t.then(e,e))}function O1(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,bt===e&&(Ze&n)===n&&(It===4||It===3&&(Ze&62914560)===Ze&&300>hs()-H0?!(ut&2)&&Al(e,0):G0|=n,wl===Ze&&(wl=0)),ys(e)}function by(e,t){t===0&&(t=fp()),e=Il(e,t),e!==null&&(Zo(e,t),ys(e))}function k1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),by(e,n)}function L1(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(oe(314))}s!==null&&s.delete(t),by(e,n)}function B1(e,t){return l0(e,t)}var ki=null,Yr=null,Md=!1,Li=!1,Qc=!1,Ir=0;function ys(e){e!==Yr&&e.next===null&&(Yr===null?ki=Yr=e:Yr=Yr.next=e),Li=!0,Md||(Md=!0,P1())}function ia(e,t){if(!Qc&&Li){Qc=!0;do for(var n=!1,s=ki;s!==null;){if(e!==0){var l=s.pendingLanes;if(l===0)var o=0;else{var a=s.suspendedLanes,i=s.pingedLanes;o=(1<<31-$n(42|e)+1)-1,o&=l&~(a&~i),o=o&201326741?o&201326741|1:o?o|2:0}o!==0&&(n=!0,Nm(s,o))}else o=Ze,o=Zi(s,s===bt?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(o&3)||Ko(s,o)||(n=!0,Nm(s,o));s=s.next}while(n);Qc=!1}}function U1(){vy()}function vy(){Li=Md=!1;var e=0;Ir!==0&&(Q1()&&(e=Ir),Ir=0);for(var t=hs(),n=null,s=ki;s!==null;){var l=s.next,o=Ey(s,t);o===0?(s.next=null,n===null?ki=l:n.next=l,l===null&&(Yr=n)):(n=s,(e!==0||o&3)&&(Li=!0)),s=l}ia(e)}function Ey(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,l=e.expirationTimes,o=e.pendingLanes&-62914561;0<o;){var a=31-$n(o),i=1<<a,u=l[a];u===-1?(!(i&n)||i&s)&&(l[a]=uv(i,t)):u<=t&&(e.expiredLanes|=i),o&=~i}if(t=bt,n=Ze,n=Zi(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(ct===2||ct===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||Ko(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&bc(s),a0(n)){case 2:case 8:n=dp;break;case 32:n=gi;break;case 268435456:n=xp;break;default:n=gi}return s=Ny.bind(null,e),n=l0(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&bc(s),e.callbackPriority=2,e.callbackNode=null,2}function Ny(e,t){if(fn!==0&&fn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(uc()&&e.callbackNode!==n)return null;var s=Ze;return s=Zi(e,e===bt?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(iy(e,s,t),Ey(e,hs()),e.callbackNode!=null&&e.callbackNode===n?Ny.bind(null,e):null)}function Nm(e,t){if(uc())return null;iy(e,t,!0)}function P1(){W1(function(){ut&6?l0(up,U1):vy()})}function q0(){return Ir===0&&(Ir=mp()),Ir}function Sm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ka(""+e)}function wm(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function G1(e,t,n,s,l){if(t==="submit"&&n&&n.stateNode===l){var o=Sm((l[On]||null).action),a=s.submitter;a&&(t=(t=a[On]||null)?Sm(t.formAction):a.getAttribute("formAction"),t!==null&&(o=t,a=null));var i=new Ji("action","action",null,s,l);e.push({event:i,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(Ir!==0){var u=a?wm(l,a):new FormData(l);Ed(n,{pending:!0,data:u,method:l.method,action:o},null,u)}}else typeof o=="function"&&(i.preventDefault(),u=a?wm(l,a):new FormData(l),Ed(n,{pending:!0,data:u,method:l.method,action:o},o,u))},currentTarget:l}]})}}for(var Yc=0;Yc<cd.length;Yc++){var Wc=cd[Yc],H1=Wc.toLowerCase(),F1=Wc[0].toUpperCase()+Wc.slice(1);cs(H1,"on"+F1)}cs(Bp,"onAnimationEnd");cs(Up,"onAnimationIteration");cs(Pp,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(l1,"onTransitionRun");cs(o1,"onTransitionStart");cs(a1,"onTransitionCancel");cs(Gp,"onTransitionEnd");yl("onMouseEnter",["mouseout","mouseover"]);yl("onMouseLeave",["mouseout","mouseover"]);yl("onPointerEnter",["pointerout","pointerover"]);yl("onPointerLeave",["pointerout","pointerover"]);Br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Br("onBeforeInput",["compositionend","keypress","textInput","paste"]);Br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ko));function Sy(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],l=s.event;s=s.listeners;e:{var o=void 0;if(t)for(var a=s.length-1;0<=a;a--){var i=s[a],u=i.instance,c=i.currentTarget;if(i=i.listener,u!==o&&l.isPropagationStopped())break e;o=i,l.currentTarget=c;try{o(l)}catch(d){ji(d)}l.currentTarget=null,o=u}else for(a=0;a<s.length;a++){if(i=s[a],u=i.instance,c=i.currentTarget,i=i.listener,u!==o&&l.isPropagationStopped())break e;o=i,l.currentTarget=c;try{o(l)}catch(d){ji(d)}l.currentTarget=null,o=u}}}}function Fe(e,t){var n=t[nd];n===void 0&&(n=t[nd]=new Set);var s=e+"__bubble";n.has(s)||(wy(t,e,2,!1),n.add(s))}function Xc(e,t,n){var s=0;t&&(s|=4),wy(n,e,s,t)}var wa="_reactListening"+Math.random().toString(36).slice(2);function $0(e){if(!e[wa]){e[wa]=!0,yp.forEach(function(n){n!=="selectionchange"&&(q1.has(n)||Xc(n,!1,e),Xc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[wa]||(t[wa]=!0,Xc("selectionchange",!1,t))}}function wy(e,t,n,s){switch(Ly(t)){case 2:var l=pE;break;case 8:l=gE;break;default:l=Y0}n=l.bind(null,t,n,e),l=void 0,!od||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),s?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function Kc(e,t,n,s,l){var o=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var i=s.stateNode.containerInfo;if(i===l)break;if(a===4)for(a=s.return;a!==null;){var u=a.tag;if((u===3||u===4)&&a.stateNode.containerInfo===l)return;a=a.return}for(;i!==null;){if(a=Kr(i),a===null)return;if(u=a.tag,u===5||u===6||u===26||u===27){s=o=a;continue e}i=i.parentNode}}s=s.return}Ap(function(){var c=o,d=u0(n),h=[];e:{var f=Hp.get(e);if(f!==void 0){var p=Ji,v=e;switch(e){case"keypress":if(Ja(n)===0)break e;case"keydown":case"keyup":p=Bv;break;case"focusin":v="focus",p=Tc;break;case"focusout":v="blur",p=Tc;break;case"beforeblur":case"afterblur":p=Tc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Ix;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Cv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Gv;break;case Bp:case Up:case Pp:p=_v;break;case Gp:p=Fv;break;case"scroll":case"scrollend":p=Sv;break;case"wheel":p=$v;break;case"copy":case"cut":case"paste":p=Rv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Dx;break;case"toggle":case"beforetoggle":p=zv}var S=(t&4)!==0,N=!S&&(e==="scroll"||e==="scrollend"),E=S?f!==null?f+"Capture":null:f;S=[];for(var g=c,y;g!==null;){var b=g;if(y=b.stateNode,b=b.tag,b!==5&&b!==26&&b!==27||y===null||E===null||(b=jo(g,E),b!=null&&S.push(Lo(g,b,y))),N)break;g=g.return}0<S.length&&(f=new p(f,v,null,n,d),h.push({event:f,listeners:S}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&n!==ld&&(v=n.relatedTarget||n.fromElement)&&(Kr(v)||v[jl]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=c,v=v?Kr(v):null,v!==null&&(N=Wo(v),S=v.tag,v!==N||S!==5&&S!==27&&S!==6)&&(v=null)):(p=null,v=c),p!==v)){if(S=Ix,b="onMouseLeave",E="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(S=Dx,b="onPointerLeave",E="onPointerEnter",g="pointer"),N=p==null?f:oo(p),y=v==null?f:oo(v),f=new S(b,g+"leave",p,n,d),f.target=N,f.relatedTarget=y,b=null,Kr(d)===c&&(S=new S(E,g+"enter",v,n,d),S.target=y,S.relatedTarget=N,b=S),N=b,p&&v)t:{for(S=p,E=v,g=0,y=S;y;y=$r(y))g++;for(y=0,b=E;b;b=$r(b))y++;for(;0<g-y;)S=$r(S),g--;for(;0<y-g;)E=$r(E),y--;for(;g--;){if(S===E||E!==null&&S===E.alternate)break t;S=$r(S),E=$r(E)}S=null}else S=null;p!==null&&Cm(h,f,p,S,!1),v!==null&&N!==null&&Cm(h,N,v,S,!0)}}e:{if(f=c?oo(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var T=Bx;else if(Lx(f))if(Mp)T=n1;else{T=e1;var A=Jv}else p=f.nodeName,!p||p.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?c&&c0(c.elementType)&&(T=Bx):T=t1;if(T&&(T=T(e,c))){Ip(h,T,n,d);break e}A&&A(e,f,c),e==="focusout"&&c&&f.type==="number"&&c.memoizedProps.value!=null&&rd(f,"number",f.value)}switch(A=c?oo(c):window,e){case"focusin":(Lx(A)||A.contentEditable==="true")&&(el=A,ad=c,mo=null);break;case"focusout":mo=ad=el=null;break;case"mousedown":id=!0;break;case"contextmenu":case"mouseup":case"dragend":id=!1,Fx(h,n,d);break;case"selectionchange":if(r1)break;case"keydown":case"keyup":Fx(h,n,d)}var C;if(m0)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Jr?jp(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(_p&&n.locale!=="ko"&&(Jr||_!=="onCompositionStart"?_==="onCompositionEnd"&&Jr&&(C=Tp()):(tr=d,d0="value"in tr?tr.value:tr.textContent,Jr=!0)),A=Bi(c,_),0<A.length&&(_=new Mx(_,e,null,n,d),h.push({event:_,listeners:A}),C?_.data=C:(C=Rp(n),C!==null&&(_.data=C)))),(C=Yv?Wv(e,n):Xv(e,n))&&(_=Bi(c,"onBeforeInput"),0<_.length&&(A=new Mx("onBeforeInput","beforeinput",null,n,d),h.push({event:A,listeners:_}),A.data=C)),G1(h,e,c,n,d)}Sy(h,t)})}function Lo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Bi(e,t){for(var n=t+"Capture",s=[];e!==null;){var l=e,o=l.stateNode;if(l=l.tag,l!==5&&l!==26&&l!==27||o===null||(l=jo(e,n),l!=null&&s.unshift(Lo(e,l,o)),l=jo(e,t),l!=null&&s.push(Lo(e,l,o))),e.tag===3)return s;e=e.return}return[]}function $r(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Cm(e,t,n,s,l){for(var o=t._reactName,a=[];n!==null&&n!==s;){var i=n,u=i.alternate,c=i.stateNode;if(i=i.tag,u!==null&&u===s)break;i!==5&&i!==26&&i!==27||c===null||(u=c,l?(c=jo(n,o),c!=null&&a.unshift(Lo(n,c,u))):l||(c=jo(n,o),c!=null&&a.push(Lo(n,c,u)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var $1=/\r\n?/g,V1=/\u0000|\uFFFD/g;function Am(e){return(typeof e=="string"?e:""+e).replace($1,`
`).replace(V1,"")}function Cy(e,t){return t=Am(t),Am(e)===t}function dc(){}function dt(e,t,n,s,l,o){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||bl(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&bl(e,""+s);break;case"className":ga(e,"class",s);break;case"tabIndex":ga(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(e,n,s);break;case"style":Cp(e,s,o);break;case"data":if(t!=="object"){ga(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ka(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof o=="function"&&(n==="formAction"?(t!=="input"&&dt(e,t,"name",l.name,l,null),dt(e,t,"formEncType",l.formEncType,l,null),dt(e,t,"formMethod",l.formMethod,l,null),dt(e,t,"formTarget",l.formTarget,l,null)):(dt(e,t,"encType",l.encType,l,null),dt(e,t,"method",l.method,l,null),dt(e,t,"target",l.target,l,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ka(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=dc);break;case"onScroll":s!=null&&Fe("scroll",e);break;case"onScrollEnd":s!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(oe(61));if(n=s.__html,n!=null){if(l.children!=null)throw Error(oe(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=Ka(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),Xa(e,"popover",s);break;case"xlinkActuate":vs(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":vs(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":vs(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":vs(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":vs(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":vs(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":vs(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":vs(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":vs(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":Xa(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ev.get(n)||n,Xa(e,n,s))}}function Dd(e,t,n,s,l,o){switch(n){case"style":Cp(e,s,o);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(oe(61));if(n=s.__html,n!=null){if(l.children!=null)throw Error(oe(60));e.innerHTML=n}}break;case"children":typeof s=="string"?bl(e,s):(typeof s=="number"||typeof s=="bigint")&&bl(e,""+s);break;case"onScroll":s!=null&&Fe("scroll",e);break;case"onScrollEnd":s!=null&&Fe("scrollend",e);break;case"onClick":s!=null&&(e.onclick=dc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bp.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(l=n.endsWith("Capture"),t=n.slice(2,l?n.length-7:void 0),o=e[On]||null,o=o!=null?o[n]:null,typeof o=="function"&&e.removeEventListener(t,o,l),typeof s=="function")){typeof o!="function"&&o!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,l);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):Xa(e,n,s)}}}function hn(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var s=!1,l=!1,o;for(o in n)if(n.hasOwnProperty(o)){var a=n[o];if(a!=null)switch(o){case"src":s=!0;break;case"srcSet":l=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(oe(137,t));default:dt(e,t,o,a,n,null)}}l&&dt(e,t,"srcSet",n.srcSet,n,null),s&&dt(e,t,"src",n.src,n,null);return;case"input":Fe("invalid",e);var i=o=a=l=null,u=null,c=null;for(s in n)if(n.hasOwnProperty(s)){var d=n[s];if(d!=null)switch(s){case"name":l=d;break;case"type":a=d;break;case"checked":u=d;break;case"defaultChecked":c=d;break;case"value":o=d;break;case"defaultValue":i=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(oe(137,t));break;default:dt(e,t,s,d,n,null)}}Np(e,o,i,u,c,a,l,!1),yi(e);return;case"select":Fe("invalid",e),s=a=o=null;for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"value":o=i;break;case"defaultValue":a=i;break;case"multiple":s=i;default:dt(e,t,l,i,n,null)}t=o,n=a,e.multiple=!!s,t!=null?cl(e,!!s,t,!1):n!=null&&cl(e,!!s,n,!0);return;case"textarea":Fe("invalid",e),o=l=s=null;for(a in n)if(n.hasOwnProperty(a)&&(i=n[a],i!=null))switch(a){case"value":s=i;break;case"defaultValue":l=i;break;case"children":o=i;break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(oe(91));break;default:dt(e,t,a,i,n,null)}wp(e,s,l,o),yi(e);return;case"option":for(u in n)if(n.hasOwnProperty(u)&&(s=n[u],s!=null))switch(u){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:dt(e,t,u,s,n,null)}return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(s=0;s<ko.length;s++)Fe(ko[s],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(s=n[c],s!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(oe(137,t));default:dt(e,t,c,s,n,null)}return;default:if(c0(t)){for(d in n)n.hasOwnProperty(d)&&(s=n[d],s!==void 0&&Dd(e,t,d,s,n,void 0));return}}for(i in n)n.hasOwnProperty(i)&&(s=n[i],s!=null&&dt(e,t,i,s,n,null))}function z1(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var l=null,o=null,a=null,i=null,u=null,c=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&h!=null)switch(p){case"checked":break;case"value":break;case"defaultValue":u=h;default:s.hasOwnProperty(p)||dt(e,t,p,null,s,h)}}for(var f in s){var p=s[f];if(h=n[f],s.hasOwnProperty(f)&&(p!=null||h!=null))switch(f){case"type":o=p;break;case"name":l=p;break;case"checked":c=p;break;case"defaultChecked":d=p;break;case"value":a=p;break;case"defaultValue":i=p;break;case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(oe(137,t));break;default:p!==h&&dt(e,t,f,p,s,h)}}sd(e,a,i,u,c,d,o,l);return;case"select":p=a=i=f=null;for(o in n)if(u=n[o],n.hasOwnProperty(o)&&u!=null)switch(o){case"value":break;case"multiple":p=u;default:s.hasOwnProperty(o)||dt(e,t,o,null,s,u)}for(l in s)if(o=s[l],u=n[l],s.hasOwnProperty(l)&&(o!=null||u!=null))switch(l){case"value":f=o;break;case"defaultValue":i=o;break;case"multiple":a=o;default:o!==u&&dt(e,t,l,o,s,u)}t=i,n=a,s=p,f!=null?cl(e,!!n,f,!1):!!s!=!!n&&(t!=null?cl(e,!!n,t,!0):cl(e,!!n,n?[]:"",!1));return;case"textarea":p=f=null;for(i in n)if(l=n[i],n.hasOwnProperty(i)&&l!=null&&!s.hasOwnProperty(i))switch(i){case"value":break;case"children":break;default:dt(e,t,i,null,s,l)}for(a in s)if(l=s[a],o=n[a],s.hasOwnProperty(a)&&(l!=null||o!=null))switch(a){case"value":f=l;break;case"defaultValue":p=l;break;case"children":break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(oe(91));break;default:l!==o&&dt(e,t,a,l,s,o)}Sp(e,f,p);return;case"option":for(var v in n)if(f=n[v],n.hasOwnProperty(v)&&f!=null&&!s.hasOwnProperty(v))switch(v){case"selected":e.selected=!1;break;default:dt(e,t,v,null,s,f)}for(u in s)if(f=s[u],p=n[u],s.hasOwnProperty(u)&&f!==p&&(f!=null||p!=null))switch(u){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:dt(e,t,u,f,s,p)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var S in n)f=n[S],n.hasOwnProperty(S)&&f!=null&&!s.hasOwnProperty(S)&&dt(e,t,S,null,s,f);for(c in s)if(f=s[c],p=n[c],s.hasOwnProperty(c)&&f!==p&&(f!=null||p!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(oe(137,t));break;default:dt(e,t,c,f,s,p)}return;default:if(c0(t)){for(var N in n)f=n[N],n.hasOwnProperty(N)&&f!==void 0&&!s.hasOwnProperty(N)&&Dd(e,t,N,void 0,s,f);for(d in s)f=s[d],p=n[d],!s.hasOwnProperty(d)||f===p||f===void 0&&p===void 0||Dd(e,t,d,f,s,p);return}}for(var E in n)f=n[E],n.hasOwnProperty(E)&&f!=null&&!s.hasOwnProperty(E)&&dt(e,t,E,null,s,f);for(h in s)f=s[h],p=n[h],!s.hasOwnProperty(h)||f===p||f==null&&p==null||dt(e,t,h,f,s,p)}var Od=null,kd=null;function Ui(e){return e.nodeType===9?e:e.ownerDocument}function Tm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ay(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Ld(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zc=null;function Q1(){var e=window.event;return e&&e.type==="popstate"?e===Zc?!1:(Zc=e,!0):(Zc=null,!1)}var Ty=typeof setTimeout=="function"?setTimeout:void 0,Y1=typeof clearTimeout=="function"?clearTimeout:void 0,_m=typeof Promise=="function"?Promise:void 0,W1=typeof queueMicrotask=="function"?queueMicrotask:typeof _m<"u"?function(e){return _m.resolve(null).then(e).catch(X1)}:Ty;function X1(e){setTimeout(function(){throw e})}function pr(e){return e==="head"}function jm(e,t){var n=t,s=0,l=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(0<s&&8>s){n=s;var a=e.ownerDocument;if(n&1&&wo(a.documentElement),n&2&&wo(a.body),n&4)for(n=a.head,wo(n),a=n.firstChild;a;){var i=a.nextSibling,u=a.nodeName;a[Jo]||u==="SCRIPT"||u==="STYLE"||u==="LINK"&&a.rel.toLowerCase()==="stylesheet"||n.removeChild(a),a=i}}if(l===0){e.removeChild(o),Ho(t);return}l--}else n==="$"||n==="$?"||n==="$!"?l++:s=n.charCodeAt(0)-48;else s=0;n=o}while(n);Ho(t)}function Bd(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Bd(n),i0(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function K1(e,t,n,s){for(;e.nodeType===1;){var l=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[Jo])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(o=e.getAttribute("rel"),o==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(o!==l.rel||e.getAttribute("href")!==(l.href==null||l.href===""?null:l.href)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin)||e.getAttribute("title")!==(l.title==null?null:l.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(o=e.getAttribute("src"),(o!==(l.src==null?null:l.src)||e.getAttribute("type")!==(l.type==null?null:l.type)||e.getAttribute("crossorigin")!==(l.crossOrigin==null?null:l.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var o=l.name==null?null:""+l.name;if(l.type==="hidden"&&e.getAttribute("name")===o)return e}else return e;if(e=is(e.nextSibling),e===null)break}return null}function Z1(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=is(e.nextSibling),e===null))return null;return e}function Ud(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function J1(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function is(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Pd=null;function Rm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function _y(e,t,n){switch(t=Ui(n),e){case"html":if(e=t.documentElement,!e)throw Error(oe(452));return e;case"head":if(e=t.head,!e)throw Error(oe(453));return e;case"body":if(e=t.body,!e)throw Error(oe(454));return e;default:throw Error(oe(451))}}function wo(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);i0(e)}var rs=new Map,Im=new Set;function Pi(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Us=lt.d;lt.d={f:eE,r:tE,D:nE,C:sE,L:rE,m:lE,X:aE,S:oE,M:iE};function eE(){var e=Us.f(),t=ic();return e||t}function tE(e){var t=Rl(e);t!==null&&t.tag===5&&t.type==="form"?Eg(t):Us.r(e)}var Dl=typeof document>"u"?null:document;function jy(e,t,n){var s=Dl;if(s&&typeof t=="string"&&t){var l=Jn(t);l='link[rel="'+e+'"][href="'+l+'"]',typeof n=="string"&&(l+='[crossorigin="'+n+'"]'),Im.has(l)||(Im.add(l),e={rel:e,crossOrigin:n,href:t},s.querySelector(l)===null&&(t=s.createElement("link"),hn(t,"link",e),sn(t),s.head.appendChild(t)))}}function nE(e){Us.D(e),jy("dns-prefetch",e,null)}function sE(e,t){Us.C(e,t),jy("preconnect",e,t)}function rE(e,t,n){Us.L(e,t,n);var s=Dl;if(s&&e&&t){var l='link[rel="preload"][as="'+Jn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(l+='[imagesrcset="'+Jn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(l+='[imagesizes="'+Jn(n.imageSizes)+'"]')):l+='[href="'+Jn(e)+'"]';var o=l;switch(t){case"style":o=Tl(e);break;case"script":o=Ol(e)}rs.has(o)||(e=Nt({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),rs.set(o,e),s.querySelector(l)!==null||t==="style"&&s.querySelector(ca(o))||t==="script"&&s.querySelector(ua(o))||(t=s.createElement("link"),hn(t,"link",e),sn(t),s.head.appendChild(t)))}}function lE(e,t){Us.m(e,t);var n=Dl;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",l='link[rel="modulepreload"][as="'+Jn(s)+'"][href="'+Jn(e)+'"]',o=l;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Ol(e)}if(!rs.has(o)&&(e=Nt({rel:"modulepreload",href:e},t),rs.set(o,e),n.querySelector(l)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ua(o)))return}s=n.createElement("link"),hn(s,"link",e),sn(s),n.head.appendChild(s)}}}function oE(e,t,n){Us.S(e,t,n);var s=Dl;if(s&&e){var l=il(s).hoistableStyles,o=Tl(e);t=t||"default";var a=l.get(o);if(!a){var i={loading:0,preload:null};if(a=s.querySelector(ca(o)))i.loading=5;else{e=Nt({rel:"stylesheet",href:e,"data-precedence":t},n),(n=rs.get(o))&&V0(e,n);var u=a=s.createElement("link");sn(u),hn(u,"link",e),u._p=new Promise(function(c,d){u.onload=c,u.onerror=d}),u.addEventListener("load",function(){i.loading|=1}),u.addEventListener("error",function(){i.loading|=2}),i.loading|=4,oi(a,t,s)}a={type:"stylesheet",instance:a,count:1,state:i},l.set(o,a)}}}function aE(e,t){Us.X(e,t);var n=Dl;if(n&&e){var s=il(n).hoistableScripts,l=Ol(e),o=s.get(l);o||(o=n.querySelector(ua(l)),o||(e=Nt({src:e,async:!0},t),(t=rs.get(l))&&z0(e,t),o=n.createElement("script"),sn(o),hn(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},s.set(l,o))}}function iE(e,t){Us.M(e,t);var n=Dl;if(n&&e){var s=il(n).hoistableScripts,l=Ol(e),o=s.get(l);o||(o=n.querySelector(ua(l)),o||(e=Nt({src:e,async:!0,type:"module"},t),(t=rs.get(l))&&z0(e,t),o=n.createElement("script"),sn(o),hn(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},s.set(l,o))}}function Mm(e,t,n,s){var l=(l=rr.current)?Pi(l):null;if(!l)throw Error(oe(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Tl(n.href),n=il(l).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Tl(n.href);var o=il(l).hoistableStyles,a=o.get(e);if(a||(l=l.ownerDocument||l,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},o.set(e,a),(o=l.querySelector(ca(e)))&&!o._p&&(a.instance=o,a.state.loading=5),rs.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},rs.set(e,n),o||cE(l,e,n,a.state))),t&&s===null)throw Error(oe(528,""));return a}if(t&&s!==null)throw Error(oe(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ol(n),n=il(l).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(oe(444,e))}}function Tl(e){return'href="'+Jn(e)+'"'}function ca(e){return'link[rel="stylesheet"]['+e+"]"}function Ry(e){return Nt({},e,{"data-precedence":e.precedence,precedence:null})}function cE(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),hn(t,"link",n),sn(t),e.head.appendChild(t))}function Ol(e){return'[src="'+Jn(e)+'"]'}function ua(e){return"script[async]"+e}function Dm(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+Jn(n.href)+'"]');if(s)return t.instance=s,sn(s),s;var l=Nt({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),sn(s),hn(s,"style",l),oi(s,n.precedence,e),t.instance=s;case"stylesheet":l=Tl(n.href);var o=e.querySelector(ca(l));if(o)return t.state.loading|=4,t.instance=o,sn(o),o;s=Ry(n),(l=rs.get(l))&&V0(s,l),o=(e.ownerDocument||e).createElement("link"),sn(o);var a=o;return a._p=new Promise(function(i,u){a.onload=i,a.onerror=u}),hn(o,"link",s),t.state.loading|=4,oi(o,n.precedence,e),t.instance=o;case"script":return o=Ol(n.src),(l=e.querySelector(ua(o)))?(t.instance=l,sn(l),l):(s=n,(l=rs.get(o))&&(s=Nt({},n),z0(s,l)),e=e.ownerDocument||e,l=e.createElement("script"),sn(l),hn(l,"link",s),e.head.appendChild(l),t.instance=l);case"void":return null;default:throw Error(oe(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(s=t.instance,t.state.loading|=4,oi(s,n.precedence,e));return t.instance}function oi(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),l=s.length?s[s.length-1]:null,o=l,a=0;a<s.length;a++){var i=s[a];if(i.dataset.precedence===t)o=i;else if(o!==l)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function V0(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function z0(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var ai=null;function Om(e,t,n){if(ai===null){var s=new Map,l=ai=new Map;l.set(n,s)}else l=ai,s=l.get(n),s||(s=new Map,l.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),l=0;l<n.length;l++){var o=n[l];if(!(o[Jo]||o[bn]||e==="link"&&o.getAttribute("rel")==="stylesheet")&&o.namespaceURI!=="http://www.w3.org/2000/svg"){var a=o.getAttribute(t)||"";a=e+a;var i=s.get(a);i?i.push(o):s.set(a,[o])}}return s}function km(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function uE(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Iy(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Bo=null;function dE(){}function xE(e,t,n){if(Bo===null)throw Error(oe(475));var s=Bo;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var l=Tl(n.href),o=e.querySelector(ca(l));if(o){e=o._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=Gi.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=o,sn(o);return}o=e.ownerDocument||e,n=Ry(n),(l=rs.get(l))&&V0(n,l),o=o.createElement("link"),sn(o);var a=o;a._p=new Promise(function(i,u){a.onload=i,a.onerror=u}),hn(o,"link",n),t.instance=o}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(s.count++,t=Gi.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function mE(){if(Bo===null)throw Error(oe(475));var e=Bo;return e.stylesheets&&e.count===0&&Gd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Gd(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Gi(){if(this.count--,this.count===0){if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Hi=null;function Gd(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Hi=new Map,t.forEach(fE,e),Hi=null,Gi.call(e))}function fE(e,t){if(!(t.state.loading&4)){var n=Hi.get(e);if(n)var s=n.get(null);else{n=new Map,Hi.set(e,n);for(var l=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<l.length;o++){var a=l[o];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),s=a)}s&&n.set(null,s)}l=t.instance,a=l.getAttribute("data-precedence"),o=n.get(a)||s,o===s&&n.set(null,l),n.set(a,l),this.count++,s=Gi.bind(this),l.addEventListener("load",s),l.addEventListener("error",s),o?o.parentNode.insertBefore(l,o.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(l,e.firstChild)),t.state.loading|=4}}var Uo={$$typeof:Cs,Provider:null,Consumer:null,_currentValue:Cr,_currentValue2:Cr,_threadCount:0};function hE(e,t,n,s,l,o,a,i){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vc(0),this.hiddenUpdates=vc(null),this.identifierPrefix=s,this.onUncaughtError=l,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=i,this.incompleteTransitions=new Map}function My(e,t,n,s,l,o,a,i,u,c,d,h){return e=new hE(e,t,n,a,i,u,c,h),t=1,o===!0&&(t|=24),o=Hn(3,null,null,t),e.current=o,o.stateNode=e,t=v0(),t.refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:s,isDehydrated:n,cache:t},N0(o),e}function Dy(e){return e?(e=sl,e):sl}function Oy(e,t,n,s,l,o){l=Dy(l),s.context===null?s.context=l:s.pendingContext=l,s=lr(t),s.payload={element:n},o=o===void 0?null:o,o!==null&&(s.callback=o),n=or(e,s,t),n!==null&&(zn(n,e,t),po(n,e,t))}function Lm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Q0(e,t){Lm(e,t),(e=e.alternate)&&Lm(e,t)}function ky(e){if(e.tag===13){var t=Il(e,67108864);t!==null&&zn(t,e,67108864),Q0(e,67108864)}}var Fi=!0;function pE(e,t,n,s){var l=Te.T;Te.T=null;var o=lt.p;try{lt.p=2,Y0(e,t,n,s)}finally{lt.p=o,Te.T=l}}function gE(e,t,n,s){var l=Te.T;Te.T=null;var o=lt.p;try{lt.p=8,Y0(e,t,n,s)}finally{lt.p=o,Te.T=l}}function Y0(e,t,n,s){if(Fi){var l=Hd(s);if(l===null)Kc(e,t,s,qi,n),Bm(e,s);else if(bE(l,e,t,n,s))s.stopPropagation();else if(Bm(e,s),t&4&&-1<yE.indexOf(e)){for(;l!==null;){var o=Rl(l);if(o!==null)switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var a=Nr(o.pendingLanes);if(a!==0){var i=o;for(i.pendingLanes|=2,i.entangledLanes|=2;a;){var u=1<<31-$n(a);i.entanglements[1]|=u,a&=~u}ys(o),!(ut&6)&&(Di=hs()+500,ia(0))}}break;case 13:i=Il(o,2),i!==null&&zn(i,o,2),ic(),Q0(o,2)}if(o=Hd(s),o===null&&Kc(e,t,s,qi,n),o===l)break;l=o}l!==null&&s.stopPropagation()}else Kc(e,t,s,null,n)}}function Hd(e){return e=u0(e),W0(e)}var qi=null;function W0(e){if(qi=null,e=Kr(e),e!==null){var t=Wo(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=op(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return qi=e,null}function Ly(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sv()){case up:return 2;case dp:return 8;case gi:case rv:return 32;case xp:return 268435456;default:return 32}default:return 32}}var Fd=!1,cr=null,ur=null,dr=null,Po=new Map,Go=new Map,Js=[],yE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bm(e,t){switch(e){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":ur=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":Po.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Go.delete(t.pointerId)}}function Vl(e,t,n,s,l,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[l]},t!==null&&(t=Rl(t),t!==null&&ky(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function bE(e,t,n,s,l){switch(t){case"focusin":return cr=Vl(cr,e,t,n,s,l),!0;case"dragenter":return ur=Vl(ur,e,t,n,s,l),!0;case"mouseover":return dr=Vl(dr,e,t,n,s,l),!0;case"pointerover":var o=l.pointerId;return Po.set(o,Vl(Po.get(o)||null,e,t,n,s,l)),!0;case"gotpointercapture":return o=l.pointerId,Go.set(o,Vl(Go.get(o)||null,e,t,n,s,l)),!0}return!1}function By(e){var t=Kr(e.target);if(t!==null){var n=Wo(t);if(n!==null){if(t=n.tag,t===13){if(t=op(n),t!==null){e.blockedOn=t,xv(e.priority,function(){if(n.tag===13){var s=Vn();s=o0(s);var l=Il(n,s);l!==null&&zn(l,n,s),Q0(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ii(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Hd(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);ld=s,n.target.dispatchEvent(s),ld=null}else return t=Rl(n),t!==null&&ky(t),e.blockedOn=n,!1;t.shift()}return!0}function Um(e,t,n){ii(e)&&n.delete(t)}function vE(){Fd=!1,cr!==null&&ii(cr)&&(cr=null),ur!==null&&ii(ur)&&(ur=null),dr!==null&&ii(dr)&&(dr=null),Po.forEach(Um),Go.forEach(Um)}function Ca(e,t){e.blockedOn===t&&(e.blockedOn=null,Fd||(Fd=!0,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,vE)))}var Aa=null;function Pm(e){Aa!==e&&(Aa=e,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,function(){Aa===e&&(Aa=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],l=e[t+2];if(typeof s!="function"){if(W0(s||n)===null)continue;break}var o=Rl(n);o!==null&&(e.splice(t,3),t-=3,Ed(o,{pending:!0,data:l,method:n.method,action:s},s,l))}}))}function Ho(e){function t(u){return Ca(u,e)}cr!==null&&Ca(cr,e),ur!==null&&Ca(ur,e),dr!==null&&Ca(dr,e),Po.forEach(t),Go.forEach(t);for(var n=0;n<Js.length;n++){var s=Js[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Js.length&&(n=Js[0],n.blockedOn===null);)By(n),n.blockedOn===null&&Js.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var l=n[s],o=n[s+1],a=l[On]||null;if(typeof o=="function")a||Pm(n);else if(a){var i=null;if(o&&o.hasAttribute("formAction")){if(l=o,a=o[On]||null)i=a.formAction;else if(W0(l)!==null)continue}else i=a.action;typeof i=="function"?n[s+1]=i:(n.splice(s,3),s-=3),Pm(n)}}}function X0(e){this._internalRoot=e}xc.prototype.render=X0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));var n=t.current,s=Vn();Oy(n,s,e,t,null,null)};xc.prototype.unmount=X0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Oy(e.current,2,null,e,null,null),ic(),t[jl]=null}};function xc(e){this._internalRoot=e}xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=gp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Js.length&&t!==0&&t<Js[n].priority;n++);Js.splice(n,0,e),n===0&&By(e)}};var Gm=rp.version;if(Gm!=="19.1.0")throw Error(oe(527,Gm,"19.1.0"));lt.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=Xb(t),e=e!==null?ap(e):null,e=e===null?null:e.stateNode,e};var EE={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Te,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ta=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ta.isDisabled&&Ta.supportsFiber)try{Xo=Ta.inject(EE),qn=Ta}catch{}}Xi.createRoot=function(e,t){if(!lp(e))throw Error(oe(299));var n=!1,s="",l=Mg,o=Dg,a=Og,i=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(l=t.onUncaughtError),t.onCaughtError!==void 0&&(o=t.onCaughtError),t.onRecoverableError!==void 0&&(a=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(i=t.unstable_transitionCallbacks)),t=My(e,1,!1,null,null,n,s,l,o,a,i,null),e[jl]=t.current,$0(e),new X0(t)};Xi.hydrateRoot=function(e,t,n){if(!lp(e))throw Error(oe(299));var s=!1,l="",o=Mg,a=Dg,i=Og,u=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(o=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(i=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(u=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=My(e,1,!0,t,n??null,s,l,o,a,i,u,c),t.context=Dy(null),n=t.current,s=Vn(),s=o0(s),l=lr(s),l.callback=null,or(n,l,s),n=s,t.current.lanes=n,Zo(t,n),ys(t),e[jl]=t.current,$0(e),new xc(t)};Xi.version="19.1.0";function Uy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Uy)}catch(e){console.error(e)}}Uy(),Zh.exports=Xi;var NE=Zh.exports,ce=(e=>(e.LOGIN="LOGIN",e.HOME="HOME",e.ONBOARDING_FLOW="ONBOARDING_FLOW",e.PROFILE_SETTINGS="PROFILE_SETTINGS",e.REVIEW_QUIZ="REVIEW_QUIZ",e.MISTAKE_NOTEBOOK="MISTAKE_NOTEBOOK",e.KOREAN_LITERATURE="KOREAN_LITERATURE",e.KOREAN_NON_FICTION="KOREAN_NON_FICTION",e.KOREAN_GRAMMAR="KOREAN_GRAMMAR",e.KOREAN_LITERATURE_WRITING="KOREAN_LITERATURE_WRITING",e.KOREAN_NON_FICTION_WRITING="KOREAN_NON_FICTION_WRITING",e.ENGLISH_READING="ENGLISH_READING",e.ENGLISH_WRITING="ENGLISH_WRITING",e.ENGLISH_GRAMMAR="ENGLISH_GRAMMAR",e.ENGLISH_VOCABULARY="ENGLISH_VOCABULARY",e.ENGLISH_IRREGULAR_VERBS="ENGLISH_IRREGULAR_VERBS",e.MATH_ARITHMETIC="MATH_ARITHMETIC",e.MATH_GRAPHS_EQUATIONS="MATH_GRAPHS_EQUATIONS",e.MATH_GEOMETRY="MATH_GEOMETRY",e.SOCIAL_GENERAL="SOCIAL_GENERAL",e.SOCIAL_HISTORY="SOCIAL_HISTORY",e.SOCIAL_GEOGRAPHY="SOCIAL_GEOGRAPHY",e.SCIENCE_PHYSICS="SCIENCE_PHYSICS",e.SCIENCE_CHEMISTRY="SCIENCE_CHEMISTRY",e.SCIENCE_LIFE_SCIENCE="SCIENCE_LIFE_SCIENCE",e.ASSESSMENT_KOREAN_LEVEL="ASSESSMENT_KOREAN_LEVEL",e.ASSESSMENT_ENGLISH_LEVEL="ASSESSMENT_ENGLISH_LEVEL",e.ASSESSMENT_MATH_LEVEL="ASSESSMENT_MATH_LEVEL",e.ASSESSMENT_SCIENCE_LEVEL="ASSESSMENT_SCIENCE_LEVEL",e.ASSESSMENT_SOCIAL_STUDIES_LEVEL="ASSESSMENT_SOCIAL_STUDIES_LEVEL",e.ASSESSMENT_COMPREHENSIVE="ASSESSMENT_COMPREHENSIVE",e))(ce||{}),me=(e=>(e.ES_1_2="ES 1-2",e.ES_3_4="ES 3-4",e.ES_5_6="ES 5-6",e.MS_1_2="MS 1-2",e.MS_3_HS_1="MS 3 HS 1",e.HS_2_3="HS 2-3",e.UNI_1_2="UNI 1-2",e.UNI_3_4="UNI 3-4",e.GOD="GOD",e))(me||{}),tt=(e=>(e.SELECT_SOURCE="SELECT_SOURCE",e.FETCHING_TEXT="FETCHING_TEXT",e.USER_SUMMARY_INPUT="USER_SUMMARY_INPUT",e.USER_SUMMARY_EVALUATING="USER_SUMMARY_EVALUATING",e.DISPLAY_SUMMARY_EVALUATION="DISPLAY_SUMMARY_EVALUATION",e.MCQ_SETUP="MCQ_SETUP",e.MCQ_SOLVE="MCQ_SOLVE",e.ESSAY_SETUP="ESSAY_SETUP",e.ESSAY_SOLVE="ESSAY_SOLVE",e.ESSAY_GRADING="ESSAY_GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(tt||{}),Ss=(e=>(e.AI_GENERATED="AI_GENERATED",e.RANDOM_SEARCH="RANDOM_SEARCH",e.USER_SPECIFIED="USER_SPECIFIED",e))(Ss||{}),ci=(e=>(e.POETRY=" ",e.SHORT_STORY=" ",e))(ci||{}),Gt=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_PROMPT="FETCHING_PROMPT",e.DISPLAY_PROMPT_AND_INPUT="DISPLAY_PROMPT_AND_INPUT",e.EVALUATING_WRITING="EVALUATING_WRITING",e.DISPLAY_EVALUATION="DISPLAY_EVALUATION",e.ERROR="ERROR",e))(Gt||{}),Et=(e=>(e.EXPLANATORY="",e.ARGUMENTATIVE="",e))(Et||{}),Je=(e=>(e.SELECT_SUB_TYPE="SELECT_SUB_TYPE",e.SELECT_SOURCE="SELECT_SOURCE",e.FETCHING_TEXT="FETCHING_TEXT",e.USER_SUMMARY_INPUT="USER_SUMMARY_INPUT",e.SUMMARY_EVALUATING="SUMMARY_EVALUATING",e.DISPLAY_SUMMARY_EVALUATION="DISPLAY_SUMMARY_EVALUATION",e.ESSAY_SETUP="ESSAY_SETUP",e.ESSAY_SOLVE="ESSAY_SOLVE",e.ESSAY_GRADING="ESSAY_GRADING",e.CLAIM_EVIDENCE_INPUT="CLAIM_EVIDENCE_INPUT",e.CLAIM_EVIDENCE_EVALUATING="CLAIM_EVIDENCE_EVALUATING",e.DISPLAY_CLAIM_EVIDENCE_EVALUATION="DISPLAY_CLAIM_EVIDENCE_EVALUATION",e.COUNTER_ARGUMENT_INPUT="COUNTER_ARGUMENT_INPUT",e.COUNTER_ARGUMENT_EVALUATING="COUNTER_ARGUMENT_EVALUATING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(Je||{}),ds=(e=>(e.AI_GENERATED="AI_GENERATED",e.TOPIC_SEARCH="TOPIC_SEARCH",e))(ds||{}),Qs=(e=>(e.ARGUMENTATIVE_ESSAY=" ",e.EXPLANATORY_ESSAY=" ",e))(Qs||{}),Zt=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_PROMPT="FETCHING_PROMPT",e.DISPLAY_PROMPT_AND_INPUT="DISPLAY_PROMPT_AND_INPUT",e.EVALUATING_WRITING="EVALUATING_WRITING",e.DISPLAY_EVALUATION="DISPLAY_EVALUATION",e.ERROR="ERROR",e))(Zt||{}),Xe=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_CONCEPT="FETCHING_CONCEPT",e.DISPLAY_CONCEPT="DISPLAY_CONCEPT",e.MCQ_SETUP="MCQ_SETUP",e.MCQ_SOLVE="MCQ_SOLVE",e.GRAMMAR_ESSAY_SOLVE="GRAMMAR_ESSAY_SOLVE",e.GRAMMAR_ESSAY_GRADING="GRAMMAR_ESSAY_GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(Xe||{});const Py={:[" (, , )"," (, )"," (, )"," (, )"]," ":["  (: , , , )","  ( : , )","  ( : )"]," ":["  ( )","  ( )"]," ":["   ( )","   (   )","  (, ,  )","  ()"," "," "],"/":["  (  )","  (   )","  ( )"," (   ,  )"," ( , )"]};var st=(e=>(e.SELECT_SOURCE_AND_DIFFICULTY="SELECT_SOURCE_AND_DIFFICULTY",e.FETCHING_TEXT="FETCHING_TEXT",e.USER_SUMMARY_INPUT="USER_SUMMARY_INPUT",e.USER_SUMMARY_EVALUATING="USER_SUMMARY_EVALUATING",e.DISPLAY_SUMMARY_EVALUATION="DISPLAY_SUMMARY_EVALUATION",e.MCQ_SETUP="MCQ_SETUP",e.MCQ_SOLVE="MCQ_SOLVE",e.ESSAY_SETUP="ESSAY_SETUP",e.ESSAY_SOLVE="ESSAY_SOLVE",e.ESSAY_GRADING="ESSAY_GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(st||{}),os=(e=>(e.AI_GENERATED="AI_GENERATED",e.TOPIC_SEARCH="TOPIC_SEARCH",e))(os||{}),Jt=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_PROMPT="FETCHING_PROMPT",e.DISPLAY_PROMPT_AND_INPUT="DISPLAY_PROMPT_AND_INPUT",e.EVALUATING_WRITING="EVALUATING_WRITING",e.DISPLAY_EVALUATION="DISPLAY_EVALUATION",e.ERROR="ERROR",e))(Jt||{}),ui=(e=>(e.DESCRIPTIVE_ESSAY=" ",e.NARRATIVE_ESSAY=" ",e.PERSUASIVE_ESSAY=" ",e))(ui||{}),Ke=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_CONCEPT="FETCHING_CONCEPT",e.DISPLAY_CONCEPT="DISPLAY_CONCEPT",e.MCQ_SETUP="MCQ_SETUP",e.MCQ_SOLVE="MCQ_SOLVE",e.GRAMMAR_ESSAY_SOLVE="GRAMMAR_ESSAY_SOLVE",e.GRAMMAR_ESSAY_GRADING="GRAMMAR_ESSAY_GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(Ke||{});const Gy={"Parts of Speech":["Nouns (Common, Proper, Countable, Uncountable)","Verbs (Action, Linking, Helping/Auxiliary)","Adjectives (Descriptive, Comparative, Superlative)","Adverbs (Manner, Place, Time, Frequency)","Pronouns (Personal, Possessive, Reflexive)","Prepositions (Common prepositions of time and place)","Conjunctions (Coordinating, Subordinating)","Interjections"],"Sentence Structure":["Basic Sentence Patterns (Subject-Verb, S-V-O)","Clauses (Independent, Dependent/Subordinate)","Types of Sentences (Simple, Compound, Complex, Compound-Complex)","Questions (Yes/No, Wh-questions)","Negation"],"Verb Tenses":["Simple Present & Present Continuous","Simple Past & Past Continuous","Simple Future (will/be going to) & Future Continuous","Present Perfect & Present Perfect Continuous","Past Perfect & Past Perfect Continuous","Future Perfect & Future Perfect Continuous"],"Modals & Voice":["Modal Verbs (can, could, may, might, must, shall, should, will, would)","Passive Voice (formation and usage)","Active vs. Passive Voice"],"Clauses & Conditionals":["Noun Clauses","Adjective (Relative) Clauses","Adverb Clauses","Conditional Sentences (Zero, First, Second, Third)"],"Punctuation & Mechanics":["Commas (lists, conjunctions, introductory elements, non-restrictive clauses)","Apostrophes (possessives, contractions)","Quotation Marks","Capitalization"]};var ft=(e=>(e.SELECT_LEVEL="SELECT_LEVEL",e.FETCHING_WORDS="FETCHING_WORDS",e.DISPLAY_WORDS="DISPLAY_WORDS",e.QUIZ_SETUP="QUIZ_SETUP",e.QUIZ_SOLVE="QUIZ_SOLVE",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(ft||{}),en=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_VERBS="FETCHING_VERBS",e.STUDY_VERBS="STUDY_VERBS",e.QUIZ_SETUP="QUIZ_SETUP",e.QUIZ_SOLVE="QUIZ_SOLVE",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(en||{}),Ht=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.GENERATING_QUESTIONS="GENERATING_QUESTIONS",e.SOLVING_PROBLEM="SOLVING_PROBLEM",e.GRADING="GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(Ht||{}),tn=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.GENERATING_PROBLEMS="GENERATING_PROBLEMS",e.SOLVING_PROBLEM="SOLVING_PROBLEM",e.GRADING_ALL="GRADING_ALL",e.SHOW_OVERALL_RESULTS="SHOW_OVERALL_RESULTS",e.ERROR="ERROR",e))(tn||{}),Co=(e=>(e.GRAPH_TO_EQUATION="   ",e.EQUATION_TO_GRAPH="   ",e.GRAPH_INTERPRETATION_ESSAY="  ()",e))(Co||{}),cn=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.GENERATING_PROBLEMS="GENERATING_PROBLEMS",e.SOLVING_PROBLEM="SOLVING_PROBLEM",e.GRADING_ALL="GRADING_ALL",e.SHOW_OVERALL_RESULTS="SHOW_OVERALL_RESULTS",e.ERROR="ERROR",e))(cn||{}),Hy=(e=>(e.DESCRIBING_SHAPES="  ()",e.SHAPE_CALCULATIONS="  (, , )",e.SHAPE_TRANSFORMATIONS="   /",e.COORDINATE_PLANE_GEOMETRY="  ",e))(Hy||{}),Fn=(e=>(e.AI_RECOMMENDED="AI  ",e.USER_KEYWORD="  ",e))(Fn||{}),un=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_CONTENT="FETCHING_CONTENT",e.DISPLAY_CONTENT_AND_INTERACTION="DISPLAY_CONTENT_AND_INTERACTION",e.GRADING="GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(un||{});const SE=["  ","   ","  ","  ","   ","  ","    ","  "];var dn=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_CONTENT="FETCHING_CONTENT",e.DISPLAY_CONTENT_AND_INTERACTION="DISPLAY_CONTENT_AND_INTERACTION",e.GRADING="GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(dn||{});const wE=["   ","  (/)","  ","  ","  ","  ","  "];var xn=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.FETCHING_CONTENT="FETCHING_CONTENT",e.DISPLAY_CONTENT_AND_INTERACTION="DISPLAY_CONTENT_AND_INTERACTION",e.GRADING="GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(xn||{});const CE=["  (, )","  (, , )","  ()","  (, )","   ","  "];var di=(e=>(e.PHYSICS="",e.CHEMISTRY="",e.LIFE_SCIENCE="",e))(di||{}),Fy=(e=>(e.MECHANICS="",e.THERMODYNAMICS="",e.WAVES_OPTICS=" ",e.ELECTROMAGNETISM="",e.MODERN_PHYSICS="",e))(Fy||{}),qy=(e=>(e.ATOMIC_STRUCTURE="  ",e.CHEMICAL_BONDING="   ",e.CHEMICAL_REACTIONS=" ",e.ACIDS_BASES=" ",e.ORGANIC_CHEMISTRY="",e))(qy||{}),$y=(e=>(e.CELL_BIOLOGY=" ",e.GENETICS="",e.ECOLOGY="",e.HUMAN_BODY="  ",e.EVOLUTION="",e))($y||{}),De=(e=>(e.SELECT_OPTIONS="SELECT_OPTIONS",e.GENERATING_QUESTIONS="GENERATING_QUESTIONS",e.MCQ_SOLVE="MCQ_SOLVE",e.ESSAY_SOLVE="ESSAY_SOLVE",e.ESSAY_GRADING="ESSAY_GRADING",e.SHOW_RESULTS="SHOW_RESULTS",e.ERROR="ERROR",e))(De||{}),de=(e=>(e.WELCOME="WELCOME",e.GENERATING_QUESTION="GENERATING_QUESTION",e.SHOWING_QUESTION="SHOWING_QUESTION",e.DETERMINING_LEVEL="DETERMINING_LEVEL",e.SHOWING_RESULTS="SHOWING_RESULTS",e.ERROR="ERROR",e))(de||{});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let AE,TE;function _E(){return{geminiUrl:AE,vertexUrl:TE}}function jE(e,t,n){var s,l,o;if(!(!((s=e.httpOptions)===null||s===void 0)&&s.baseUrl)){const a=_E();return e.vertexai?(l=a.vertexUrl)!==null&&l!==void 0?l:t:(o=a.geminiUrl)!==null&&o!==void 0?o:n}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class da{}function Me(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(s,l)=>{if(Object.prototype.hasOwnProperty.call(t,l)){const o=t[l];return o!=null?String(o):""}else throw new Error(`Key '${l}' not found in valueMap.`)})}function m(e,t,n){for(let o=0;o<t.length-1;o++){const a=t[o];if(a.endsWith("[]")){const i=a.slice(0,-2);if(!(i in e))if(Array.isArray(n))e[i]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(e[i])){const u=e[i];if(Array.isArray(n))for(let c=0;c<u.length;c++){const d=u[c];m(d,t.slice(o+1),n[c])}else for(const c of u)m(c,t.slice(o+1),n)}return}else if(a.endsWith("[0]")){const i=a.slice(0,-3);i in e||(e[i]=[{}]);const u=e[i];m(u[0],t.slice(o+1),n);return}(!e[a]||typeof e[a]!="object")&&(e[a]={}),e=e[a]}const s=t[t.length-1],l=e[s];if(l!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===l)return;if(typeof l=="object"&&typeof n=="object"&&l!==null&&n!==null)Object.assign(l,n);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else e[s]=n}function x(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const s=t[n];if(s.endsWith("[]")){const l=s.slice(0,-2);if(l in e){const o=e[l];return Array.isArray(o)?o.map(a=>x(a,t.slice(n+1))):void 0}else return}else e=e[s]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Vy(e,t){const n=Mt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function zy(e,t){return Array.isArray(t)?t.map(n=>$i(e,n)):[$i(e,t)]}function $i(e,t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function RE(e,t){const n=$i(e,t);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function IE(e,t){const n=$i(e,t);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function Hm(e,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Qy(e,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(n=>Hm(e,n)):[Hm(e,t)]}function qd(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Fm(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function qm(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Mn(e,t){if(t==null)throw new Error("ContentUnion is required");return qd(t)?t:{role:"user",parts:Qy(e,t)}}function Yy(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const s=Mn(e,n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(e.isVertexAI()){const n=Mn(e,t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Mn(e,n)):[Mn(e,t)]}function gr(e,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Fm(t)||qm(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Mn(e,t)]}const n=[],s=[],l=qd(t[0]);for(const o of t){const a=qd(o);if(a!=l)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)n.push(o);else{if(Fm(o)||qm(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");s.push(o)}}return l||n.push({role:"user",parts:Qy(e,s)}),n}function Wy(e,t){return t}function Xy(e,t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function mc(e,t){return t}function fc(e,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function ME(e,t,n,s=1){const l=!t.startsWith(`${n}/`)&&t.split("/").length===s;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:l?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:l?`${n}/${t}`:t}function yr(e,t){if(typeof t!="string")throw new Error("name must be a string");return ME(e,t,"cachedContents")}function Ky(e,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function br(e,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Zy(e,t){if(typeof t!="string")throw new Error("fromName must be a string");return t.startsWith("files/")?t.split("files/")[1]:t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DE(e,t){const n={};if(x(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const s=x(t,["thought"]);s!=null&&m(n,["thought"],s);const l=x(t,["codeExecutionResult"]);l!=null&&m(n,["codeExecutionResult"],l);const o=x(t,["executableCode"]);o!=null&&m(n,["executableCode"],o);const a=x(t,["fileData"]);a!=null&&m(n,["fileData"],a);const i=x(t,["functionCall"]);i!=null&&m(n,["functionCall"],i);const u=x(t,["functionResponse"]);u!=null&&m(n,["functionResponse"],u);const c=x(t,["inlineData"]);c!=null&&m(n,["inlineData"],c);const d=x(t,["text"]);return d!=null&&m(n,["text"],d),n}function $m(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>DE(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function OE(){return{}}function kE(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function LE(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],kE(e,s)),n}function BE(e,t){const n={};if(x(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");x(t,["googleSearch"])!=null&&m(n,["googleSearch"],OE());const l=x(t,["googleSearchRetrieval"]);l!=null&&m(n,["googleSearchRetrieval"],LE(e,l));const o=x(t,["codeExecution"]);o!=null&&m(n,["codeExecution"],o);const a=x(t,["functionDeclarations"]);return a!=null&&m(n,["functionDeclarations"],a),n}function UE(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["allowedFunctionNames"]);return l!=null&&m(n,["allowedFunctionNames"],l),n}function PE(e,t){const n={},s=x(t,["functionCallingConfig"]);return s!=null&&m(n,["functionCallingConfig"],UE(e,s)),n}function GE(e,t,n){const s={},l=x(t,["ttl"]);n!==void 0&&l!=null&&m(n,["ttl"],l);const o=x(t,["expireTime"]);n!==void 0&&o!=null&&m(n,["expireTime"],o);const a=x(t,["displayName"]);n!==void 0&&a!=null&&m(n,["displayName"],a);const i=x(t,["contents"]);if(n!==void 0&&i!=null){let h=gr(e,i);Array.isArray(h)&&(h=h.map(f=>$m(e,f))),m(n,["contents"],h)}const u=x(t,["systemInstruction"]);n!==void 0&&u!=null&&m(n,["systemInstruction"],$m(e,Mn(e,u)));const c=x(t,["tools"]);if(n!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(f=>BE(e,f))),m(n,["tools"],h)}const d=x(t,["toolConfig"]);return n!==void 0&&d!=null&&m(n,["toolConfig"],PE(e,d)),s}function HE(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["model"],Vy(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],GE(e,l,n)),n}function FE(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function qE(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function $E(e,t,n){const s={},l=x(t,["ttl"]);n!==void 0&&l!=null&&m(n,["ttl"],l);const o=x(t,["expireTime"]);return n!==void 0&&o!=null&&m(n,["expireTime"],o),s}function VE(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],$E(e,l,n)),n}function zE(e,t,n){const s={},l=x(t,["pageSize"]);n!==void 0&&l!=null&&m(n,["_query","pageSize"],l);const o=x(t,["pageToken"]);return n!==void 0&&o!=null&&m(n,["_query","pageToken"],o),s}function QE(e,t){const n={},s=x(t,["config"]);return s!=null&&m(n,["config"],zE(e,s,n)),n}function YE(e,t){const n={},s=x(t,["videoMetadata"]);s!=null&&m(n,["videoMetadata"],s);const l=x(t,["thought"]);l!=null&&m(n,["thought"],l);const o=x(t,["codeExecutionResult"]);o!=null&&m(n,["codeExecutionResult"],o);const a=x(t,["executableCode"]);a!=null&&m(n,["executableCode"],a);const i=x(t,["fileData"]);i!=null&&m(n,["fileData"],i);const u=x(t,["functionCall"]);u!=null&&m(n,["functionCall"],u);const c=x(t,["functionResponse"]);c!=null&&m(n,["functionResponse"],c);const d=x(t,["inlineData"]);d!=null&&m(n,["inlineData"],d);const h=x(t,["text"]);return h!=null&&m(n,["text"],h),n}function Vm(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>YE(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function WE(){return{}}function XE(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function KE(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],XE(e,s)),n}function ZE(e,t){const n={},s=x(t,["retrieval"]);s!=null&&m(n,["retrieval"],s),x(t,["googleSearch"])!=null&&m(n,["googleSearch"],WE());const o=x(t,["googleSearchRetrieval"]);o!=null&&m(n,["googleSearchRetrieval"],KE(e,o));const a=x(t,["codeExecution"]);a!=null&&m(n,["codeExecution"],a);const i=x(t,["functionDeclarations"]);return i!=null&&m(n,["functionDeclarations"],i),n}function JE(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["allowedFunctionNames"]);return l!=null&&m(n,["allowedFunctionNames"],l),n}function eN(e,t){const n={},s=x(t,["functionCallingConfig"]);return s!=null&&m(n,["functionCallingConfig"],JE(e,s)),n}function tN(e,t,n){const s={},l=x(t,["ttl"]);n!==void 0&&l!=null&&m(n,["ttl"],l);const o=x(t,["expireTime"]);n!==void 0&&o!=null&&m(n,["expireTime"],o);const a=x(t,["displayName"]);n!==void 0&&a!=null&&m(n,["displayName"],a);const i=x(t,["contents"]);if(n!==void 0&&i!=null){let h=gr(e,i);Array.isArray(h)&&(h=h.map(f=>Vm(e,f))),m(n,["contents"],h)}const u=x(t,["systemInstruction"]);n!==void 0&&u!=null&&m(n,["systemInstruction"],Vm(e,Mn(e,u)));const c=x(t,["tools"]);if(n!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(f=>ZE(e,f))),m(n,["tools"],h)}const d=x(t,["toolConfig"]);return n!==void 0&&d!=null&&m(n,["toolConfig"],eN(e,d)),s}function nN(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["model"],Vy(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],tN(e,l,n)),n}function sN(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function rN(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function lN(e,t,n){const s={},l=x(t,["ttl"]);n!==void 0&&l!=null&&m(n,["ttl"],l);const o=x(t,["expireTime"]);return n!==void 0&&o!=null&&m(n,["expireTime"],o),s}function oN(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],yr(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],lN(e,l,n)),n}function aN(e,t,n){const s={},l=x(t,["pageSize"]);n!==void 0&&l!=null&&m(n,["_query","pageSize"],l);const o=x(t,["pageToken"]);return n!==void 0&&o!=null&&m(n,["_query","pageToken"],o),s}function iN(e,t){const n={},s=x(t,["config"]);return s!=null&&m(n,["config"],aN(e,s,n)),n}function xi(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["model"]);o!=null&&m(n,["model"],o);const a=x(t,["createTime"]);a!=null&&m(n,["createTime"],a);const i=x(t,["updateTime"]);i!=null&&m(n,["updateTime"],i);const u=x(t,["expireTime"]);u!=null&&m(n,["expireTime"],u);const c=x(t,["usageMetadata"]);return c!=null&&m(n,["usageMetadata"],c),n}function cN(){return{}}function uN(e,t){const n={},s=x(t,["nextPageToken"]);s!=null&&m(n,["nextPageToken"],s);const l=x(t,["cachedContents"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(a=>xi(e,a))),m(n,["cachedContents"],o)}return n}function mi(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["model"]);o!=null&&m(n,["model"],o);const a=x(t,["createTime"]);a!=null&&m(n,["createTime"],a);const i=x(t,["updateTime"]);i!=null&&m(n,["updateTime"],i);const u=x(t,["expireTime"]);u!=null&&m(n,["expireTime"],u);const c=x(t,["usageMetadata"]);return c!=null&&m(n,["usageMetadata"],c),n}function dN(){return{}}function xN(e,t){const n={},s=x(t,["nextPageToken"]);s!=null&&m(n,["nextPageToken"],s);const l=x(t,["cachedContents"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(a=>mi(e,a))),m(n,["cachedContents"],o)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Fo;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Fo||(Fo={}));class K0{constructor(t,n,s,l){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,s,l)}init(t,n,s){var l,o;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};s?typeof s=="object"?a=Object.assign({},s):a=s:a={config:{}},a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(o=(l=a.config)===null||l===void 0?void 0:l.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var zm;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(zm||(zm={}));var Qm;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Qm||(Qm={}));var Ym;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Ym||(Ym={}));var Wm;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Wm||(Wm={}));var Xm;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Xm||(Xm={}));var Km;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Km||(Km={}));var Zm;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Zm||(Zm={}));var Jm;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(Jm||(Jm={}));var ef;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(ef||(ef={}));var tf;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(tf||(tf={}));var nf;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(nf||(nf={}));var sf;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(sf||(sf={}));var Vi;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Vi||(Vi={}));var rf;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(rf||(rf={}));var $d;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})($d||($d={}));var lf;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(lf||(lf={}));var of;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(of||(of={}));var af;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(af||(af={}));var cf;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(cf||(cf={}));var uf;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(uf||(uf={}));var df;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(df||(df={}));var xf;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(xf||(xf={}));var mf;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(mf||(mf={}));var ff;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(ff||(ff={}));var hf;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(hf||(hf={}));var pf;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(pf||(pf={}));var gf;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(gf||(gf={}));var yf;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(yf||(yf={}));var bf;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(bf||(bf={}));var vf;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(vf||(vf={}));var Ef;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Ef||(Ef={}));var Nf;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Nf||(Nf={}));class _a{get text(){var t,n,s,l,o,a,i,u;if(((l=(s=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",d=!1;const h=[];for(const f of(u=(i=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||i===void 0?void 0:i.parts)!==null&&u!==void 0?u:[]){for(const[p,v]of Object.entries(f))p!=="text"&&p!=="thought"&&(v!==null||v!==void 0)&&h.push(p);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,c+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?c:void 0}get data(){var t,n,s,l,o,a,i,u;if(((l=(s=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const d=[];for(const h of(u=(i=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||i===void 0?void 0:i.parts)!==null&&u!==void 0?u:[]){for(const[f,p]of Object.entries(h))f!=="inlineData"&&(p!==null||p!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var t,n,s,l,o,a,i,u;if(((l=(s=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(u=(i=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||i===void 0?void 0:i.parts)===null||u===void 0?void 0:u.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var t,n,s,l,o,a,i,u,c;if(((l=(s=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(u=(i=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||i===void 0?void 0:i.parts)===null||u===void 0?void 0:u.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var t,n,s,l,o,a,i,u,c;if(((l=(s=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(u=(i=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||i===void 0?void 0:i.parts)===null||u===void 0?void 0:u.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.output}}class Sf{}class wf{}class Cf{}class Af{}class mN{}class Tf{}class _f{}class jf{}class fN{}class Vd{constructor(t){const n={};for(const s of t.headers.entries())n[s[0]]=s[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class hN{}class pN{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gN extends da{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new K0(Fo.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(n),n)}async create(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=nN(this.apiClient,t);return i=Me("cachedContents",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>mi(this.apiClient,d))}else{const c=HE(this.apiClient,t);return i=Me("cachedContents",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>xi(this.apiClient,d))}}async get(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=sN(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>mi(this.apiClient,d))}else{const c=FE(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>xi(this.apiClient,d))}}async delete(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=rN(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(()=>{const d=dN(),h=new _f;return Object.assign(h,d),h})}else{const c=qE(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(()=>{const d=cN(),h=new _f;return Object.assign(h,d),h})}}async update(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=oN(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>mi(this.apiClient,d))}else{const c=VE(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>xi(this.apiClient,d))}}async listInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=iN(this.apiClient,t);return i=Me("cachedContents",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=xN(this.apiClient,d),f=new jf;return Object.assign(f,h),f})}else{const c=QE(this.apiClient,t);return i=Me("cachedContents",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=uN(this.apiClient,d),f=new jf;return Object.assign(f,h),f})}}}function Rf(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function yn(e){return this instanceof yn?(this.v=e,this):new yn(e)}function zi(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(e,t||[]),l,o=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",a),l[Symbol.asyncIterator]=function(){return this},l;function a(p){return function(v){return Promise.resolve(v).then(p,h)}}function i(p,v){s[p]&&(l[p]=function(S){return new Promise(function(N,E){o.push([p,S,N,E])>1||u(p,S)})},v&&(l[p]=v(l[p])))}function u(p,v){try{c(s[p](v))}catch(S){f(o[0][3],S)}}function c(p){p.value instanceof yn?Promise.resolve(p.value.v).then(d,h):f(o[0][2],p)}function d(p){u("next",p)}function h(p){u("throw",p)}function f(p,v){p(v),o.shift(),o.length&&u(o[0][0],o[0][1])}}function zd(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Rf=="function"?Rf(e):e[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(o){n[o]=e[o]&&function(a){return new Promise(function(i,u){a=e[o](a),l(i,u,a.done,a.value)})}}function l(o,a,i,u){Promise.resolve(u).then(function(c){o({value:c,done:i})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yN(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:Jy(n)}function Jy(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function bN(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function vN(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let s=0,l=e[0];for(;s<n;)if(e[s].role==="user")l=e[s],s++;else{const o=[];let a=!0;for(;s<n&&e[s].role==="model";)o.push(e[s]),a&&!Jy(e[s])&&(a=!1),s++;a&&(t.push(l),t.push(...o))}return t}class EN{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new NN(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class NN{constructor(t,n,s,l={},o=[]){this.apiClient=t,this.modelsModule=n,this.model=s,this.config=l,this.history=o,this.sendPromise=Promise.resolve(),bN(o)}async sendMessage(t){var n;await this.sendPromise;const s=Mn(this.apiClient,t.message),l=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,a;const u=(a=(o=(await l).candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content,c=u?[u]:[];this.recordHistory(s,c)})(),await this.sendPromise,l}async sendMessageStream(t){var n;await this.sendPromise;const s=Mn(this.apiClient,t.message),l=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=l.then(()=>{}).catch(()=>{});const o=await l;return this.processStreamResponse(o,s)}getHistory(t=!1){return t?vN(this.history):this.history}processStreamResponse(t,n){var s,l;return zi(this,arguments,function*(){var a,i,u,c;const d=[];try{for(var h=!0,f=zd(t),p;p=yield yn(f.next()),a=p.done,!a;h=!0){c=p.value,h=!1;const v=c;if(yN(v)){const S=(l=(s=v.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content;S!==void 0&&d.push(S)}yield yield yn(v)}}catch(v){i={error:v}}finally{try{!h&&!a&&(u=f.return)&&(yield yn(u.call(f)))}finally{if(i)throw i.error}}this.recordHistory(n,d)})}recordHistory(t,n){let s=[];n.length>0&&n.every(l=>l.role==="model")?s=n:s.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SN(e,t,n){const s={},l=x(t,["pageSize"]);n!==void 0&&l!=null&&m(n,["_query","pageSize"],l);const o=x(t,["pageToken"]);return n!==void 0&&o!=null&&m(n,["_query","pageToken"],o),s}function wN(e,t){const n={},s=x(t,["config"]);return s!=null&&m(n,["config"],SN(e,s,n)),n}function CN(e,t){const n={},s=x(t,["details"]);s!=null&&m(n,["details"],s);const l=x(t,["message"]);l!=null&&m(n,["message"],l);const o=x(t,["code"]);return o!=null&&m(n,["code"],o),n}function AN(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["mimeType"]);o!=null&&m(n,["mimeType"],o);const a=x(t,["sizeBytes"]);a!=null&&m(n,["sizeBytes"],a);const i=x(t,["createTime"]);i!=null&&m(n,["createTime"],i);const u=x(t,["expirationTime"]);u!=null&&m(n,["expirationTime"],u);const c=x(t,["updateTime"]);c!=null&&m(n,["updateTime"],c);const d=x(t,["sha256Hash"]);d!=null&&m(n,["sha256Hash"],d);const h=x(t,["uri"]);h!=null&&m(n,["uri"],h);const f=x(t,["downloadUri"]);f!=null&&m(n,["downloadUri"],f);const p=x(t,["state"]);p!=null&&m(n,["state"],p);const v=x(t,["source"]);v!=null&&m(n,["source"],v);const S=x(t,["videoMetadata"]);S!=null&&m(n,["videoMetadata"],S);const N=x(t,["error"]);return N!=null&&m(n,["error"],CN(e,N)),n}function TN(e,t){const n={},s=x(t,["file"]);s!=null&&m(n,["file"],AN(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function _N(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","file"],Zy(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function jN(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","file"],Zy(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function RN(e,t){const n={},s=x(t,["details"]);s!=null&&m(n,["details"],s);const l=x(t,["message"]);l!=null&&m(n,["message"],l);const o=x(t,["code"]);return o!=null&&m(n,["code"],o),n}function Qd(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["mimeType"]);o!=null&&m(n,["mimeType"],o);const a=x(t,["sizeBytes"]);a!=null&&m(n,["sizeBytes"],a);const i=x(t,["createTime"]);i!=null&&m(n,["createTime"],i);const u=x(t,["expirationTime"]);u!=null&&m(n,["expirationTime"],u);const c=x(t,["updateTime"]);c!=null&&m(n,["updateTime"],c);const d=x(t,["sha256Hash"]);d!=null&&m(n,["sha256Hash"],d);const h=x(t,["uri"]);h!=null&&m(n,["uri"],h);const f=x(t,["downloadUri"]);f!=null&&m(n,["downloadUri"],f);const p=x(t,["state"]);p!=null&&m(n,["state"],p);const v=x(t,["source"]);v!=null&&m(n,["source"],v);const S=x(t,["videoMetadata"]);S!=null&&m(n,["videoMetadata"],S);const N=x(t,["error"]);return N!=null&&m(n,["error"],RN(e,N)),n}function IN(e,t){const n={},s=x(t,["nextPageToken"]);s!=null&&m(n,["nextPageToken"],s);const l=x(t,["files"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(a=>Qd(e,a))),m(n,["files"],o)}return n}function MN(){return{}}function DN(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ON extends da{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new K0(Fo.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>Qd(this.apiClient,n))}async listInternal(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=wN(this.apiClient,t);return o=Me("files",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>{const c=IN(this.apiClient,u),d=new fN;return Object.assign(d,c),d})}}async createInternal(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=TN(this.apiClient,t);return o=Me("upload/v1beta/files",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(()=>{const u=MN(),c=new hN;return Object.assign(c,u),c})}}async get(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=_N(this.apiClient,t);return o=Me("files/{file}",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>Qd(this.apiClient,u))}}async delete(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=jN(this.apiClient,t);return o=Me("files/{file}",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(()=>{const u=DN(),c=new pN;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kN(e,t){const n={};if(x(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const s=x(t,["thought"]);s!=null&&m(n,["thought"],s);const l=x(t,["codeExecutionResult"]);l!=null&&m(n,["codeExecutionResult"],l);const o=x(t,["executableCode"]);o!=null&&m(n,["executableCode"],o);const a=x(t,["fileData"]);a!=null&&m(n,["fileData"],a);const i=x(t,["functionCall"]);i!=null&&m(n,["functionCall"],i);const u=x(t,["functionResponse"]);u!=null&&m(n,["functionResponse"],u);const c=x(t,["inlineData"]);c!=null&&m(n,["inlineData"],c);const d=x(t,["text"]);return d!=null&&m(n,["text"],d),n}function LN(e,t){const n={},s=x(t,["videoMetadata"]);s!=null&&m(n,["videoMetadata"],s);const l=x(t,["thought"]);l!=null&&m(n,["thought"],l);const o=x(t,["codeExecutionResult"]);o!=null&&m(n,["codeExecutionResult"],o);const a=x(t,["executableCode"]);a!=null&&m(n,["executableCode"],a);const i=x(t,["fileData"]);i!=null&&m(n,["fileData"],i);const u=x(t,["functionCall"]);u!=null&&m(n,["functionCall"],u);const c=x(t,["functionResponse"]);c!=null&&m(n,["functionResponse"],c);const d=x(t,["inlineData"]);d!=null&&m(n,["inlineData"],d);const h=x(t,["text"]);return h!=null&&m(n,["text"],h),n}function BN(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>kN(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function UN(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>LN(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function PN(){return{}}function GN(){return{}}function HN(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function FN(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function qN(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],HN(e,s)),n}function $N(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],FN(e,s)),n}function VN(e,t){const n={};if(x(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");x(t,["googleSearch"])!=null&&m(n,["googleSearch"],PN());const l=x(t,["googleSearchRetrieval"]);l!=null&&m(n,["googleSearchRetrieval"],qN(e,l));const o=x(t,["codeExecution"]);o!=null&&m(n,["codeExecution"],o);const a=x(t,["functionDeclarations"]);return a!=null&&m(n,["functionDeclarations"],a),n}function zN(e,t){const n={},s=x(t,["retrieval"]);s!=null&&m(n,["retrieval"],s),x(t,["googleSearch"])!=null&&m(n,["googleSearch"],GN());const o=x(t,["googleSearchRetrieval"]);o!=null&&m(n,["googleSearchRetrieval"],$N(e,o));const a=x(t,["codeExecution"]);a!=null&&m(n,["codeExecution"],a);const i=x(t,["functionDeclarations"]);return i!=null&&m(n,["functionDeclarations"],i),n}function QN(e,t){const n={},s=x(t,["handle"]);if(s!=null&&m(n,["handle"],s),x(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function YN(e,t){const n={},s=x(t,["handle"]);s!=null&&m(n,["handle"],s);const l=x(t,["transparent"]);return l!=null&&m(n,["transparent"],l),n}function WN(){return{}}function If(){return{}}function XN(e,t){const n={},s=x(t,["disabled"]);s!=null&&m(n,["disabled"],s);const l=x(t,["startOfSpeechSensitivity"]);l!=null&&m(n,["startOfSpeechSensitivity"],l);const o=x(t,["endOfSpeechSensitivity"]);o!=null&&m(n,["endOfSpeechSensitivity"],o);const a=x(t,["prefixPaddingMs"]);a!=null&&m(n,["prefixPaddingMs"],a);const i=x(t,["silenceDurationMs"]);return i!=null&&m(n,["silenceDurationMs"],i),n}function KN(e,t){const n={},s=x(t,["disabled"]);s!=null&&m(n,["disabled"],s);const l=x(t,["startOfSpeechSensitivity"]);l!=null&&m(n,["startOfSpeechSensitivity"],l);const o=x(t,["endOfSpeechSensitivity"]);o!=null&&m(n,["endOfSpeechSensitivity"],o);const a=x(t,["prefixPaddingMs"]);a!=null&&m(n,["prefixPaddingMs"],a);const i=x(t,["silenceDurationMs"]);return i!=null&&m(n,["silenceDurationMs"],i),n}function ZN(e,t){const n={},s=x(t,["automaticActivityDetection"]);s!=null&&m(n,["automaticActivityDetection"],XN(e,s));const l=x(t,["activityHandling"]);l!=null&&m(n,["activityHandling"],l);const o=x(t,["turnCoverage"]);return o!=null&&m(n,["turnCoverage"],o),n}function JN(e,t){const n={},s=x(t,["automaticActivityDetection"]);s!=null&&m(n,["automaticActivityDetection"],KN(e,s));const l=x(t,["activityHandling"]);l!=null&&m(n,["activityHandling"],l);const o=x(t,["turnCoverage"]);return o!=null&&m(n,["turnCoverage"],o),n}function eS(e,t){const n={},s=x(t,["targetTokens"]);return s!=null&&m(n,["targetTokens"],s),n}function tS(e,t){const n={},s=x(t,["targetTokens"]);return s!=null&&m(n,["targetTokens"],s),n}function nS(e,t){const n={},s=x(t,["triggerTokens"]);s!=null&&m(n,["triggerTokens"],s);const l=x(t,["slidingWindow"]);return l!=null&&m(n,["slidingWindow"],eS(e,l)),n}function sS(e,t){const n={},s=x(t,["triggerTokens"]);s!=null&&m(n,["triggerTokens"],s);const l=x(t,["slidingWindow"]);return l!=null&&m(n,["slidingWindow"],tS(e,l)),n}function rS(e,t,n){const s={},l=x(t,["generationConfig"]);n!==void 0&&l!=null&&m(n,["setup","generationConfig"],l);const o=x(t,["responseModalities"]);n!==void 0&&o!=null&&m(n,["setup","generationConfig","responseModalities"],o);const a=x(t,["temperature"]);n!==void 0&&a!=null&&m(n,["setup","generationConfig","temperature"],a);const i=x(t,["topP"]);n!==void 0&&i!=null&&m(n,["setup","generationConfig","topP"],i);const u=x(t,["topK"]);n!==void 0&&u!=null&&m(n,["setup","generationConfig","topK"],u);const c=x(t,["maxOutputTokens"]);n!==void 0&&c!=null&&m(n,["setup","generationConfig","maxOutputTokens"],c);const d=x(t,["mediaResolution"]);n!==void 0&&d!=null&&m(n,["setup","generationConfig","mediaResolution"],d);const h=x(t,["seed"]);n!==void 0&&h!=null&&m(n,["setup","generationConfig","seed"],h);const f=x(t,["speechConfig"]);n!==void 0&&f!=null&&m(n,["setup","generationConfig","speechConfig"],f);const p=x(t,["systemInstruction"]);n!==void 0&&p!=null&&m(n,["setup","systemInstruction"],BN(e,Mn(e,p)));const v=x(t,["tools"]);if(n!==void 0&&v!=null){let y=fc(e,v);Array.isArray(y)&&(y=y.map(b=>VN(e,mc(e,b)))),m(n,["setup","tools"],y)}const S=x(t,["sessionResumption"]);if(n!==void 0&&S!=null&&m(n,["setup","sessionResumption"],QN(e,S)),x(t,["inputAudioTranscription"])!==void 0)throw new Error("inputAudioTranscription parameter is not supported in Gemini API.");const N=x(t,["outputAudioTranscription"]);n!==void 0&&N!=null&&m(n,["setup","outputAudioTranscription"],WN());const E=x(t,["realtimeInputConfig"]);n!==void 0&&E!=null&&m(n,["setup","realtimeInputConfig"],ZN(e,E));const g=x(t,["contextWindowCompression"]);return n!==void 0&&g!=null&&m(n,["setup","contextWindowCompression"],nS(e,g)),s}function lS(e,t,n){const s={},l=x(t,["generationConfig"]);n!==void 0&&l!=null&&m(n,["setup","generationConfig"],l);const o=x(t,["responseModalities"]);n!==void 0&&o!=null&&m(n,["setup","generationConfig","responseModalities"],o);const a=x(t,["temperature"]);n!==void 0&&a!=null&&m(n,["setup","generationConfig","temperature"],a);const i=x(t,["topP"]);n!==void 0&&i!=null&&m(n,["setup","generationConfig","topP"],i);const u=x(t,["topK"]);n!==void 0&&u!=null&&m(n,["setup","generationConfig","topK"],u);const c=x(t,["maxOutputTokens"]);n!==void 0&&c!=null&&m(n,["setup","generationConfig","maxOutputTokens"],c);const d=x(t,["mediaResolution"]);n!==void 0&&d!=null&&m(n,["setup","generationConfig","mediaResolution"],d);const h=x(t,["seed"]);n!==void 0&&h!=null&&m(n,["setup","generationConfig","seed"],h);const f=x(t,["speechConfig"]);n!==void 0&&f!=null&&m(n,["setup","generationConfig","speechConfig"],f);const p=x(t,["systemInstruction"]);n!==void 0&&p!=null&&m(n,["setup","systemInstruction"],UN(e,Mn(e,p)));const v=x(t,["tools"]);if(n!==void 0&&v!=null){let b=fc(e,v);Array.isArray(b)&&(b=b.map(T=>zN(e,mc(e,T)))),m(n,["setup","tools"],b)}const S=x(t,["sessionResumption"]);n!==void 0&&S!=null&&m(n,["setup","sessionResumption"],YN(e,S));const N=x(t,["inputAudioTranscription"]);n!==void 0&&N!=null&&m(n,["setup","inputAudioTranscription"],If());const E=x(t,["outputAudioTranscription"]);n!==void 0&&E!=null&&m(n,["setup","outputAudioTranscription"],If());const g=x(t,["realtimeInputConfig"]);n!==void 0&&g!=null&&m(n,["setup","realtimeInputConfig"],JN(e,g));const y=x(t,["contextWindowCompression"]);return n!==void 0&&y!=null&&m(n,["setup","contextWindowCompression"],sS(e,y)),s}function oS(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["setup","model"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],rS(e,l,n)),n}function aS(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["setup","model"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],lS(e,l,n)),n}function iS(){return{}}function cS(){return{}}function uS(){return{}}function dS(){return{}}function xS(e,t){const n={},s=x(t,["media"]);s!=null&&m(n,["mediaChunks"],zy(e,s));const l=x(t,["audio"]);l!=null&&m(n,["audio"],IE(e,l));const o=x(t,["audioStreamEnd"]);o!=null&&m(n,["audioStreamEnd"],o);const a=x(t,["video"]);a!=null&&m(n,["video"],RE(e,a));const i=x(t,["text"]);return i!=null&&m(n,["text"],i),x(t,["activityStart"])!=null&&m(n,["activityStart"],iS()),x(t,["activityEnd"])!=null&&m(n,["activityEnd"],uS()),n}function mS(e,t){const n={},s=x(t,["media"]);if(s!=null&&m(n,["mediaChunks"],zy(e,s)),x(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const l=x(t,["audioStreamEnd"]);if(l!=null&&m(n,["audioStreamEnd"],l),x(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(x(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return x(t,["activityStart"])!=null&&m(n,["activityStart"],cS()),x(t,["activityEnd"])!=null&&m(n,["activityEnd"],dS()),n}function fS(){return{}}function hS(){return{}}function pS(e,t){const n={},s=x(t,["thought"]);s!=null&&m(n,["thought"],s);const l=x(t,["codeExecutionResult"]);l!=null&&m(n,["codeExecutionResult"],l);const o=x(t,["executableCode"]);o!=null&&m(n,["executableCode"],o);const a=x(t,["fileData"]);a!=null&&m(n,["fileData"],a);const i=x(t,["functionCall"]);i!=null&&m(n,["functionCall"],i);const u=x(t,["functionResponse"]);u!=null&&m(n,["functionResponse"],u);const c=x(t,["inlineData"]);c!=null&&m(n,["inlineData"],c);const d=x(t,["text"]);return d!=null&&m(n,["text"],d),n}function gS(e,t){const n={},s=x(t,["videoMetadata"]);s!=null&&m(n,["videoMetadata"],s);const l=x(t,["thought"]);l!=null&&m(n,["thought"],l);const o=x(t,["codeExecutionResult"]);o!=null&&m(n,["codeExecutionResult"],o);const a=x(t,["executableCode"]);a!=null&&m(n,["executableCode"],a);const i=x(t,["fileData"]);i!=null&&m(n,["fileData"],i);const u=x(t,["functionCall"]);u!=null&&m(n,["functionCall"],u);const c=x(t,["functionResponse"]);c!=null&&m(n,["functionResponse"],c);const d=x(t,["inlineData"]);d!=null&&m(n,["inlineData"],d);const h=x(t,["text"]);return h!=null&&m(n,["text"],h),n}function yS(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>pS(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function bS(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>gS(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function Mf(e,t){const n={},s=x(t,["text"]);s!=null&&m(n,["text"],s);const l=x(t,["finished"]);return l!=null&&m(n,["finished"],l),n}function Df(e,t){const n={},s=x(t,["text"]);s!=null&&m(n,["text"],s);const l=x(t,["finished"]);return l!=null&&m(n,["finished"],l),n}function vS(e,t){const n={},s=x(t,["modelTurn"]);s!=null&&m(n,["modelTurn"],yS(e,s));const l=x(t,["turnComplete"]);l!=null&&m(n,["turnComplete"],l);const o=x(t,["interrupted"]);o!=null&&m(n,["interrupted"],o);const a=x(t,["groundingMetadata"]);a!=null&&m(n,["groundingMetadata"],a);const i=x(t,["generationComplete"]);i!=null&&m(n,["generationComplete"],i);const u=x(t,["inputTranscription"]);u!=null&&m(n,["inputTranscription"],Mf(e,u));const c=x(t,["outputTranscription"]);return c!=null&&m(n,["outputTranscription"],Mf(e,c)),n}function ES(e,t){const n={},s=x(t,["modelTurn"]);s!=null&&m(n,["modelTurn"],bS(e,s));const l=x(t,["turnComplete"]);l!=null&&m(n,["turnComplete"],l);const o=x(t,["interrupted"]);o!=null&&m(n,["interrupted"],o);const a=x(t,["groundingMetadata"]);a!=null&&m(n,["groundingMetadata"],a);const i=x(t,["generationComplete"]);i!=null&&m(n,["generationComplete"],i);const u=x(t,["inputTranscription"]);u!=null&&m(n,["inputTranscription"],Df(e,u));const c=x(t,["outputTranscription"]);return c!=null&&m(n,["outputTranscription"],Df(e,c)),n}function NS(e,t){const n={},s=x(t,["id"]);s!=null&&m(n,["id"],s);const l=x(t,["args"]);l!=null&&m(n,["args"],l);const o=x(t,["name"]);return o!=null&&m(n,["name"],o),n}function SS(e,t){const n={},s=x(t,["args"]);s!=null&&m(n,["args"],s);const l=x(t,["name"]);return l!=null&&m(n,["name"],l),n}function wS(e,t){const n={},s=x(t,["functionCalls"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>NS(e,o))),m(n,["functionCalls"],l)}return n}function CS(e,t){const n={},s=x(t,["functionCalls"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>SS(e,o))),m(n,["functionCalls"],l)}return n}function AS(e,t){const n={},s=x(t,["ids"]);return s!=null&&m(n,["ids"],s),n}function TS(e,t){const n={},s=x(t,["ids"]);return s!=null&&m(n,["ids"],s),n}function ja(e,t){const n={},s=x(t,["modality"]);s!=null&&m(n,["modality"],s);const l=x(t,["tokenCount"]);return l!=null&&m(n,["tokenCount"],l),n}function Ra(e,t){const n={},s=x(t,["modality"]);s!=null&&m(n,["modality"],s);const l=x(t,["tokenCount"]);return l!=null&&m(n,["tokenCount"],l),n}function _S(e,t){const n={},s=x(t,["promptTokenCount"]);s!=null&&m(n,["promptTokenCount"],s);const l=x(t,["cachedContentTokenCount"]);l!=null&&m(n,["cachedContentTokenCount"],l);const o=x(t,["responseTokenCount"]);o!=null&&m(n,["responseTokenCount"],o);const a=x(t,["toolUsePromptTokenCount"]);a!=null&&m(n,["toolUsePromptTokenCount"],a);const i=x(t,["thoughtsTokenCount"]);i!=null&&m(n,["thoughtsTokenCount"],i);const u=x(t,["totalTokenCount"]);u!=null&&m(n,["totalTokenCount"],u);const c=x(t,["promptTokensDetails"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(v=>ja(e,v))),m(n,["promptTokensDetails"],p)}const d=x(t,["cacheTokensDetails"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(v=>ja(e,v))),m(n,["cacheTokensDetails"],p)}const h=x(t,["responseTokensDetails"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(v=>ja(e,v))),m(n,["responseTokensDetails"],p)}const f=x(t,["toolUsePromptTokensDetails"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(v=>ja(e,v))),m(n,["toolUsePromptTokensDetails"],p)}return n}function jS(e,t){const n={},s=x(t,["promptTokenCount"]);s!=null&&m(n,["promptTokenCount"],s);const l=x(t,["cachedContentTokenCount"]);l!=null&&m(n,["cachedContentTokenCount"],l);const o=x(t,["candidatesTokenCount"]);o!=null&&m(n,["responseTokenCount"],o);const a=x(t,["toolUsePromptTokenCount"]);a!=null&&m(n,["toolUsePromptTokenCount"],a);const i=x(t,["thoughtsTokenCount"]);i!=null&&m(n,["thoughtsTokenCount"],i);const u=x(t,["totalTokenCount"]);u!=null&&m(n,["totalTokenCount"],u);const c=x(t,["promptTokensDetails"]);if(c!=null){let v=c;Array.isArray(v)&&(v=v.map(S=>Ra(e,S))),m(n,["promptTokensDetails"],v)}const d=x(t,["cacheTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(S=>Ra(e,S))),m(n,["cacheTokensDetails"],v)}const h=x(t,["candidatesTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>Ra(e,S))),m(n,["responseTokensDetails"],v)}const f=x(t,["toolUsePromptTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(S=>Ra(e,S))),m(n,["toolUsePromptTokensDetails"],v)}const p=x(t,["trafficType"]);return p!=null&&m(n,["trafficType"],p),n}function RS(e,t){const n={},s=x(t,["timeLeft"]);return s!=null&&m(n,["timeLeft"],s),n}function IS(e,t){const n={},s=x(t,["timeLeft"]);return s!=null&&m(n,["timeLeft"],s),n}function MS(e,t){const n={},s=x(t,["newHandle"]);s!=null&&m(n,["newHandle"],s);const l=x(t,["resumable"]);l!=null&&m(n,["resumable"],l);const o=x(t,["lastConsumedClientMessageIndex"]);return o!=null&&m(n,["lastConsumedClientMessageIndex"],o),n}function DS(e,t){const n={},s=x(t,["newHandle"]);s!=null&&m(n,["newHandle"],s);const l=x(t,["resumable"]);l!=null&&m(n,["resumable"],l);const o=x(t,["lastConsumedClientMessageIndex"]);return o!=null&&m(n,["lastConsumedClientMessageIndex"],o),n}function OS(e,t){const n={};x(t,["setupComplete"])!=null&&m(n,["setupComplete"],fS());const l=x(t,["serverContent"]);l!=null&&m(n,["serverContent"],vS(e,l));const o=x(t,["toolCall"]);o!=null&&m(n,["toolCall"],wS(e,o));const a=x(t,["toolCallCancellation"]);a!=null&&m(n,["toolCallCancellation"],AS(e,a));const i=x(t,["usageMetadata"]);i!=null&&m(n,["usageMetadata"],_S(e,i));const u=x(t,["goAway"]);u!=null&&m(n,["goAway"],RS(e,u));const c=x(t,["sessionResumptionUpdate"]);return c!=null&&m(n,["sessionResumptionUpdate"],MS(e,c)),n}function kS(e,t){const n={};x(t,["setupComplete"])!=null&&m(n,["setupComplete"],hS());const l=x(t,["serverContent"]);l!=null&&m(n,["serverContent"],ES(e,l));const o=x(t,["toolCall"]);o!=null&&m(n,["toolCall"],CS(e,o));const a=x(t,["toolCallCancellation"]);a!=null&&m(n,["toolCallCancellation"],TS(e,a));const i=x(t,["usageMetadata"]);i!=null&&m(n,["usageMetadata"],jS(e,i));const u=x(t,["goAway"]);u!=null&&m(n,["goAway"],IS(e,u));const c=x(t,["sessionResumptionUpdate"]);return c!=null&&m(n,["sessionResumptionUpdate"],DS(e,c)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LS(e,t){const n={};if(x(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const s=x(t,["thought"]);s!=null&&m(n,["thought"],s);const l=x(t,["codeExecutionResult"]);l!=null&&m(n,["codeExecutionResult"],l);const o=x(t,["executableCode"]);o!=null&&m(n,["executableCode"],o);const a=x(t,["fileData"]);a!=null&&m(n,["fileData"],a);const i=x(t,["functionCall"]);i!=null&&m(n,["functionCall"],i);const u=x(t,["functionResponse"]);u!=null&&m(n,["functionResponse"],u);const c=x(t,["inlineData"]);c!=null&&m(n,["inlineData"],c);const d=x(t,["text"]);return d!=null&&m(n,["text"],d),n}function hc(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>LS(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function BS(e,t){const n={};if(x(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=x(t,["category"]);s!=null&&m(n,["category"],s);const l=x(t,["threshold"]);return l!=null&&m(n,["threshold"],l),n}function US(){return{}}function PS(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function GS(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],PS(e,s)),n}function HS(e,t){const n={};if(x(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");x(t,["googleSearch"])!=null&&m(n,["googleSearch"],US());const l=x(t,["googleSearchRetrieval"]);l!=null&&m(n,["googleSearchRetrieval"],GS(e,l));const o=x(t,["codeExecution"]);o!=null&&m(n,["codeExecution"],o);const a=x(t,["functionDeclarations"]);return a!=null&&m(n,["functionDeclarations"],a),n}function FS(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["allowedFunctionNames"]);return l!=null&&m(n,["allowedFunctionNames"],l),n}function qS(e,t){const n={},s=x(t,["functionCallingConfig"]);return s!=null&&m(n,["functionCallingConfig"],FS(e,s)),n}function $S(e,t){const n={},s=x(t,["voiceName"]);return s!=null&&m(n,["voiceName"],s),n}function VS(e,t){const n={},s=x(t,["prebuiltVoiceConfig"]);return s!=null&&m(n,["prebuiltVoiceConfig"],$S(e,s)),n}function zS(e,t){const n={},s=x(t,["voiceConfig"]);s!=null&&m(n,["voiceConfig"],VS(e,s));const l=x(t,["languageCode"]);return l!=null&&m(n,["languageCode"],l),n}function QS(e,t){const n={},s=x(t,["includeThoughts"]);s!=null&&m(n,["includeThoughts"],s);const l=x(t,["thinkingBudget"]);return l!=null&&m(n,["thinkingBudget"],l),n}function YS(e,t,n){const s={},l=x(t,["systemInstruction"]);n!==void 0&&l!=null&&m(n,["systemInstruction"],hc(e,Mn(e,l)));const o=x(t,["temperature"]);o!=null&&m(s,["temperature"],o);const a=x(t,["topP"]);a!=null&&m(s,["topP"],a);const i=x(t,["topK"]);i!=null&&m(s,["topK"],i);const u=x(t,["candidateCount"]);u!=null&&m(s,["candidateCount"],u);const c=x(t,["maxOutputTokens"]);c!=null&&m(s,["maxOutputTokens"],c);const d=x(t,["stopSequences"]);d!=null&&m(s,["stopSequences"],d);const h=x(t,["responseLogprobs"]);h!=null&&m(s,["responseLogprobs"],h);const f=x(t,["logprobs"]);f!=null&&m(s,["logprobs"],f);const p=x(t,["presencePenalty"]);p!=null&&m(s,["presencePenalty"],p);const v=x(t,["frequencyPenalty"]);v!=null&&m(s,["frequencyPenalty"],v);const S=x(t,["seed"]);S!=null&&m(s,["seed"],S);const N=x(t,["responseMimeType"]);N!=null&&m(s,["responseMimeType"],N);const E=x(t,["responseSchema"]);if(E!=null&&m(s,["responseSchema"],Wy(e,E)),x(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(x(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const g=x(t,["safetySettings"]);if(n!==void 0&&g!=null){let I=g;Array.isArray(I)&&(I=I.map(j=>BS(e,j))),m(n,["safetySettings"],I)}const y=x(t,["tools"]);if(n!==void 0&&y!=null){let I=fc(e,y);Array.isArray(I)&&(I=I.map(j=>HS(e,mc(e,j)))),m(n,["tools"],I)}const b=x(t,["toolConfig"]);if(n!==void 0&&b!=null&&m(n,["toolConfig"],qS(e,b)),x(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const T=x(t,["cachedContent"]);n!==void 0&&T!=null&&m(n,["cachedContent"],yr(e,T));const A=x(t,["responseModalities"]);A!=null&&m(s,["responseModalities"],A);const C=x(t,["mediaResolution"]);C!=null&&m(s,["mediaResolution"],C);const _=x(t,["speechConfig"]);if(_!=null&&m(s,["speechConfig"],zS(e,Xy(e,_))),x(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=x(t,["thinkingConfig"]);return L!=null&&m(s,["thinkingConfig"],QS(e,L)),s}function Of(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);if(l!=null){let a=gr(e,l);Array.isArray(a)&&(a=a.map(i=>hc(e,i))),m(n,["contents"],a)}const o=x(t,["config"]);return o!=null&&m(n,["generationConfig"],YS(e,o,n)),n}function WS(e,t,n){const s={},l=x(t,["taskType"]);n!==void 0&&l!=null&&m(n,["requests[]","taskType"],l);const o=x(t,["title"]);n!==void 0&&o!=null&&m(n,["requests[]","title"],o);const a=x(t,["outputDimensionality"]);if(n!==void 0&&a!=null&&m(n,["requests[]","outputDimensionality"],a),x(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(x(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function XS(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);l!=null&&m(n,["requests[]","content"],Yy(e,l));const o=x(t,["config"]);o!=null&&m(n,["config"],WS(e,o,n));const a=x(t,["model"]);return a!==void 0&&m(n,["requests[]","model"],Mt(e,a)),n}function KS(e,t,n){const s={};if(x(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(x(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const l=x(t,["numberOfImages"]);n!==void 0&&l!=null&&m(n,["parameters","sampleCount"],l);const o=x(t,["aspectRatio"]);n!==void 0&&o!=null&&m(n,["parameters","aspectRatio"],o);const a=x(t,["guidanceScale"]);if(n!==void 0&&a!=null&&m(n,["parameters","guidanceScale"],a),x(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=x(t,["safetyFilterLevel"]);n!==void 0&&i!=null&&m(n,["parameters","safetySetting"],i);const u=x(t,["personGeneration"]);n!==void 0&&u!=null&&m(n,["parameters","personGeneration"],u);const c=x(t,["includeSafetyAttributes"]);n!==void 0&&c!=null&&m(n,["parameters","includeSafetyAttributes"],c);const d=x(t,["includeRaiReason"]);n!==void 0&&d!=null&&m(n,["parameters","includeRaiReason"],d);const h=x(t,["language"]);n!==void 0&&h!=null&&m(n,["parameters","language"],h);const f=x(t,["outputMimeType"]);n!==void 0&&f!=null&&m(n,["parameters","outputOptions","mimeType"],f);const p=x(t,["outputCompressionQuality"]);if(n!==void 0&&p!=null&&m(n,["parameters","outputOptions","compressionQuality"],p),x(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(x(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function ZS(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["prompt"]);l!=null&&m(n,["instances[0]","prompt"],l);const o=x(t,["config"]);return o!=null&&m(n,["config"],KS(e,o,n)),n}function JS(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","name"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function ew(e,t,n){const s={},l=x(t,["displayName"]);n!==void 0&&l!=null&&m(n,["displayName"],l);const o=x(t,["description"]);return n!==void 0&&o!=null&&m(n,["description"],o),s}function tw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","name"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],ew(e,l,n)),n}function nw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","name"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function sw(e,t){const n={};if(x(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(x(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(x(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function rw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);if(l!=null){let a=gr(e,l);Array.isArray(a)&&(a=a.map(i=>hc(e,i))),m(n,["contents"],a)}const o=x(t,["config"]);return o!=null&&m(n,["config"],sw(e,o)),n}function lw(e,t){const n={};if(x(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=x(t,["imageBytes"]);s!=null&&m(n,["bytesBase64Encoded"],br(e,s));const l=x(t,["mimeType"]);return l!=null&&m(n,["mimeType"],l),n}function ow(e,t,n){const s={},l=x(t,["numberOfVideos"]);if(n!==void 0&&l!=null&&m(n,["parameters","sampleCount"],l),x(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(x(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=x(t,["durationSeconds"]);if(n!==void 0&&o!=null&&m(n,["parameters","durationSeconds"],o),x(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=x(t,["aspectRatio"]);if(n!==void 0&&a!=null&&m(n,["parameters","aspectRatio"],a),x(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const i=x(t,["personGeneration"]);if(n!==void 0&&i!=null&&m(n,["parameters","personGeneration"],i),x(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=x(t,["negativePrompt"]);if(n!==void 0&&u!=null&&m(n,["parameters","negativePrompt"],u),x(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function aw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["prompt"]);l!=null&&m(n,["instances[0]","prompt"],l);const o=x(t,["image"]);o!=null&&m(n,["instances[0]","image"],lw(e,o));const a=x(t,["config"]);return a!=null&&m(n,["config"],ow(e,a,n)),n}function iw(e,t){const n={},s=x(t,["videoMetadata"]);s!=null&&m(n,["videoMetadata"],s);const l=x(t,["thought"]);l!=null&&m(n,["thought"],l);const o=x(t,["codeExecutionResult"]);o!=null&&m(n,["codeExecutionResult"],o);const a=x(t,["executableCode"]);a!=null&&m(n,["executableCode"],a);const i=x(t,["fileData"]);i!=null&&m(n,["fileData"],i);const u=x(t,["functionCall"]);u!=null&&m(n,["functionCall"],u);const c=x(t,["functionResponse"]);c!=null&&m(n,["functionResponse"],c);const d=x(t,["inlineData"]);d!=null&&m(n,["inlineData"],d);const h=x(t,["text"]);return h!=null&&m(n,["text"],h),n}function kl(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>iw(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function cw(e,t){const n={},s=x(t,["featureSelectionPreference"]);return s!=null&&m(n,["featureSelectionPreference"],s),n}function uw(e,t){const n={},s=x(t,["method"]);s!=null&&m(n,["method"],s);const l=x(t,["category"]);l!=null&&m(n,["category"],l);const o=x(t,["threshold"]);return o!=null&&m(n,["threshold"],o),n}function dw(){return{}}function xw(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["dynamicThreshold"]);return l!=null&&m(n,["dynamicThreshold"],l),n}function mw(e,t){const n={},s=x(t,["dynamicRetrievalConfig"]);return s!=null&&m(n,["dynamicRetrievalConfig"],xw(e,s)),n}function eb(e,t){const n={},s=x(t,["retrieval"]);s!=null&&m(n,["retrieval"],s),x(t,["googleSearch"])!=null&&m(n,["googleSearch"],dw());const o=x(t,["googleSearchRetrieval"]);o!=null&&m(n,["googleSearchRetrieval"],mw(e,o));const a=x(t,["codeExecution"]);a!=null&&m(n,["codeExecution"],a);const i=x(t,["functionDeclarations"]);return i!=null&&m(n,["functionDeclarations"],i),n}function fw(e,t){const n={},s=x(t,["mode"]);s!=null&&m(n,["mode"],s);const l=x(t,["allowedFunctionNames"]);return l!=null&&m(n,["allowedFunctionNames"],l),n}function hw(e,t){const n={},s=x(t,["functionCallingConfig"]);return s!=null&&m(n,["functionCallingConfig"],fw(e,s)),n}function pw(e,t){const n={},s=x(t,["voiceName"]);return s!=null&&m(n,["voiceName"],s),n}function gw(e,t){const n={},s=x(t,["prebuiltVoiceConfig"]);return s!=null&&m(n,["prebuiltVoiceConfig"],pw(e,s)),n}function yw(e,t){const n={},s=x(t,["voiceConfig"]);s!=null&&m(n,["voiceConfig"],gw(e,s));const l=x(t,["languageCode"]);return l!=null&&m(n,["languageCode"],l),n}function bw(e,t){const n={},s=x(t,["includeThoughts"]);s!=null&&m(n,["includeThoughts"],s);const l=x(t,["thinkingBudget"]);return l!=null&&m(n,["thinkingBudget"],l),n}function vw(e,t,n){const s={},l=x(t,["systemInstruction"]);n!==void 0&&l!=null&&m(n,["systemInstruction"],kl(e,Mn(e,l)));const o=x(t,["temperature"]);o!=null&&m(s,["temperature"],o);const a=x(t,["topP"]);a!=null&&m(s,["topP"],a);const i=x(t,["topK"]);i!=null&&m(s,["topK"],i);const u=x(t,["candidateCount"]);u!=null&&m(s,["candidateCount"],u);const c=x(t,["maxOutputTokens"]);c!=null&&m(s,["maxOutputTokens"],c);const d=x(t,["stopSequences"]);d!=null&&m(s,["stopSequences"],d);const h=x(t,["responseLogprobs"]);h!=null&&m(s,["responseLogprobs"],h);const f=x(t,["logprobs"]);f!=null&&m(s,["logprobs"],f);const p=x(t,["presencePenalty"]);p!=null&&m(s,["presencePenalty"],p);const v=x(t,["frequencyPenalty"]);v!=null&&m(s,["frequencyPenalty"],v);const S=x(t,["seed"]);S!=null&&m(s,["seed"],S);const N=x(t,["responseMimeType"]);N!=null&&m(s,["responseMimeType"],N);const E=x(t,["responseSchema"]);E!=null&&m(s,["responseSchema"],Wy(e,E));const g=x(t,["routingConfig"]);g!=null&&m(s,["routingConfig"],g);const y=x(t,["modelSelectionConfig"]);y!=null&&m(s,["modelConfig"],cw(e,y));const b=x(t,["safetySettings"]);if(n!==void 0&&b!=null){let U=b;Array.isArray(U)&&(U=U.map($=>uw(e,$))),m(n,["safetySettings"],U)}const T=x(t,["tools"]);if(n!==void 0&&T!=null){let U=fc(e,T);Array.isArray(U)&&(U=U.map($=>eb(e,mc(e,$)))),m(n,["tools"],U)}const A=x(t,["toolConfig"]);n!==void 0&&A!=null&&m(n,["toolConfig"],hw(e,A));const C=x(t,["labels"]);n!==void 0&&C!=null&&m(n,["labels"],C);const _=x(t,["cachedContent"]);n!==void 0&&_!=null&&m(n,["cachedContent"],yr(e,_));const L=x(t,["responseModalities"]);L!=null&&m(s,["responseModalities"],L);const I=x(t,["mediaResolution"]);I!=null&&m(s,["mediaResolution"],I);const j=x(t,["speechConfig"]);j!=null&&m(s,["speechConfig"],yw(e,Xy(e,j)));const D=x(t,["audioTimestamp"]);D!=null&&m(s,["audioTimestamp"],D);const M=x(t,["thinkingConfig"]);return M!=null&&m(s,["thinkingConfig"],bw(e,M)),s}function kf(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);if(l!=null){let a=gr(e,l);Array.isArray(a)&&(a=a.map(i=>kl(e,i))),m(n,["contents"],a)}const o=x(t,["config"]);return o!=null&&m(n,["generationConfig"],vw(e,o,n)),n}function Ew(e,t,n){const s={},l=x(t,["taskType"]);n!==void 0&&l!=null&&m(n,["instances[]","task_type"],l);const o=x(t,["title"]);n!==void 0&&o!=null&&m(n,["instances[]","title"],o);const a=x(t,["outputDimensionality"]);n!==void 0&&a!=null&&m(n,["parameters","outputDimensionality"],a);const i=x(t,["mimeType"]);n!==void 0&&i!=null&&m(n,["instances[]","mimeType"],i);const u=x(t,["autoTruncate"]);return n!==void 0&&u!=null&&m(n,["parameters","autoTruncate"],u),s}function Nw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);l!=null&&m(n,["instances[]","content"],Yy(e,l));const o=x(t,["config"]);return o!=null&&m(n,["config"],Ew(e,o,n)),n}function Sw(e,t,n){const s={},l=x(t,["outputGcsUri"]);n!==void 0&&l!=null&&m(n,["parameters","storageUri"],l);const o=x(t,["negativePrompt"]);n!==void 0&&o!=null&&m(n,["parameters","negativePrompt"],o);const a=x(t,["numberOfImages"]);n!==void 0&&a!=null&&m(n,["parameters","sampleCount"],a);const i=x(t,["aspectRatio"]);n!==void 0&&i!=null&&m(n,["parameters","aspectRatio"],i);const u=x(t,["guidanceScale"]);n!==void 0&&u!=null&&m(n,["parameters","guidanceScale"],u);const c=x(t,["seed"]);n!==void 0&&c!=null&&m(n,["parameters","seed"],c);const d=x(t,["safetyFilterLevel"]);n!==void 0&&d!=null&&m(n,["parameters","safetySetting"],d);const h=x(t,["personGeneration"]);n!==void 0&&h!=null&&m(n,["parameters","personGeneration"],h);const f=x(t,["includeSafetyAttributes"]);n!==void 0&&f!=null&&m(n,["parameters","includeSafetyAttributes"],f);const p=x(t,["includeRaiReason"]);n!==void 0&&p!=null&&m(n,["parameters","includeRaiReason"],p);const v=x(t,["language"]);n!==void 0&&v!=null&&m(n,["parameters","language"],v);const S=x(t,["outputMimeType"]);n!==void 0&&S!=null&&m(n,["parameters","outputOptions","mimeType"],S);const N=x(t,["outputCompressionQuality"]);n!==void 0&&N!=null&&m(n,["parameters","outputOptions","compressionQuality"],N);const E=x(t,["addWatermark"]);n!==void 0&&E!=null&&m(n,["parameters","addWatermark"],E);const g=x(t,["enhancePrompt"]);return n!==void 0&&g!=null&&m(n,["parameters","enhancePrompt"],g),s}function ww(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["prompt"]);l!=null&&m(n,["instances[0]","prompt"],l);const o=x(t,["config"]);return o!=null&&m(n,["config"],Sw(e,o,n)),n}function Cw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","name"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function Aw(e,t,n){const s={},l=x(t,["displayName"]);n!==void 0&&l!=null&&m(n,["displayName"],l);const o=x(t,["description"]);return n!==void 0&&o!=null&&m(n,["description"],o),s}function Tw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],Aw(e,l,n)),n}function _w(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","name"],Mt(e,s));const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function jw(e,t,n){const s={},l=x(t,["systemInstruction"]);n!==void 0&&l!=null&&m(n,["systemInstruction"],kl(e,Mn(e,l)));const o=x(t,["tools"]);if(n!==void 0&&o!=null){let i=o;Array.isArray(i)&&(i=i.map(u=>eb(e,u))),m(n,["tools"],i)}const a=x(t,["generationConfig"]);return n!==void 0&&a!=null&&m(n,["generationConfig"],a),s}function Rw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);if(l!=null){let a=gr(e,l);Array.isArray(a)&&(a=a.map(i=>kl(e,i))),m(n,["contents"],a)}const o=x(t,["config"]);return o!=null&&m(n,["config"],jw(e,o,n)),n}function Iw(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["contents"]);if(l!=null){let a=gr(e,l);Array.isArray(a)&&(a=a.map(i=>kl(e,i))),m(n,["contents"],a)}const o=x(t,["config"]);return o!=null&&m(n,["config"],o),n}function Mw(e,t){const n={},s=x(t,["gcsUri"]);s!=null&&m(n,["gcsUri"],s);const l=x(t,["imageBytes"]);l!=null&&m(n,["bytesBase64Encoded"],br(e,l));const o=x(t,["mimeType"]);return o!=null&&m(n,["mimeType"],o),n}function Dw(e,t,n){const s={},l=x(t,["numberOfVideos"]);n!==void 0&&l!=null&&m(n,["parameters","sampleCount"],l);const o=x(t,["outputGcsUri"]);n!==void 0&&o!=null&&m(n,["parameters","storageUri"],o);const a=x(t,["fps"]);n!==void 0&&a!=null&&m(n,["parameters","fps"],a);const i=x(t,["durationSeconds"]);n!==void 0&&i!=null&&m(n,["parameters","durationSeconds"],i);const u=x(t,["seed"]);n!==void 0&&u!=null&&m(n,["parameters","seed"],u);const c=x(t,["aspectRatio"]);n!==void 0&&c!=null&&m(n,["parameters","aspectRatio"],c);const d=x(t,["resolution"]);n!==void 0&&d!=null&&m(n,["parameters","resolution"],d);const h=x(t,["personGeneration"]);n!==void 0&&h!=null&&m(n,["parameters","personGeneration"],h);const f=x(t,["pubsubTopic"]);n!==void 0&&f!=null&&m(n,["parameters","pubsubTopic"],f);const p=x(t,["negativePrompt"]);n!==void 0&&p!=null&&m(n,["parameters","negativePrompt"],p);const v=x(t,["enhancePrompt"]);return n!==void 0&&v!=null&&m(n,["parameters","enhancePrompt"],v),s}function Ow(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["_url","model"],Mt(e,s));const l=x(t,["prompt"]);l!=null&&m(n,["instances[0]","prompt"],l);const o=x(t,["image"]);o!=null&&m(n,["instances[0]","image"],Mw(e,o));const a=x(t,["config"]);return a!=null&&m(n,["config"],Dw(e,a,n)),n}function kw(e,t){const n={},s=x(t,["thought"]);s!=null&&m(n,["thought"],s);const l=x(t,["codeExecutionResult"]);l!=null&&m(n,["codeExecutionResult"],l);const o=x(t,["executableCode"]);o!=null&&m(n,["executableCode"],o);const a=x(t,["fileData"]);a!=null&&m(n,["fileData"],a);const i=x(t,["functionCall"]);i!=null&&m(n,["functionCall"],i);const u=x(t,["functionResponse"]);u!=null&&m(n,["functionResponse"],u);const c=x(t,["inlineData"]);c!=null&&m(n,["inlineData"],c);const d=x(t,["text"]);return d!=null&&m(n,["text"],d),n}function Lw(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>kw(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function Bw(e,t){const n={},s=x(t,["citationSources"]);return s!=null&&m(n,["citations"],s),n}function Uw(e,t){const n={},s=x(t,["content"]);s!=null&&m(n,["content"],Lw(e,s));const l=x(t,["citationMetadata"]);l!=null&&m(n,["citationMetadata"],Bw(e,l));const o=x(t,["tokenCount"]);o!=null&&m(n,["tokenCount"],o);const a=x(t,["finishReason"]);a!=null&&m(n,["finishReason"],a);const i=x(t,["avgLogprobs"]);i!=null&&m(n,["avgLogprobs"],i);const u=x(t,["groundingMetadata"]);u!=null&&m(n,["groundingMetadata"],u);const c=x(t,["index"]);c!=null&&m(n,["index"],c);const d=x(t,["logprobsResult"]);d!=null&&m(n,["logprobsResult"],d);const h=x(t,["safetyRatings"]);return h!=null&&m(n,["safetyRatings"],h),n}function Lf(e,t){const n={},s=x(t,["candidates"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(u=>Uw(e,u))),m(n,["candidates"],i)}const l=x(t,["modelVersion"]);l!=null&&m(n,["modelVersion"],l);const o=x(t,["promptFeedback"]);o!=null&&m(n,["promptFeedback"],o);const a=x(t,["usageMetadata"]);return a!=null&&m(n,["usageMetadata"],a),n}function Pw(e,t){const n={},s=x(t,["values"]);return s!=null&&m(n,["values"],s),n}function Gw(){return{}}function Hw(e,t){const n={},s=x(t,["embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Pw(e,a))),m(n,["embeddings"],o)}return x(t,["metadata"])!=null&&m(n,["metadata"],Gw()),n}function Fw(e,t){const n={},s=x(t,["bytesBase64Encoded"]);s!=null&&m(n,["imageBytes"],br(e,s));const l=x(t,["mimeType"]);return l!=null&&m(n,["mimeType"],l),n}function tb(e,t){const n={},s=x(t,["safetyAttributes","categories"]);s!=null&&m(n,["categories"],s);const l=x(t,["safetyAttributes","scores"]);l!=null&&m(n,["scores"],l);const o=x(t,["contentType"]);return o!=null&&m(n,["contentType"],o),n}function qw(e,t){const n={},s=x(t,["_self"]);s!=null&&m(n,["image"],Fw(e,s));const l=x(t,["raiFilteredReason"]);l!=null&&m(n,["raiFilteredReason"],l);const o=x(t,["_self"]);return o!=null&&m(n,["safetyAttributes"],tb(e,o)),n}function $w(e,t){const n={},s=x(t,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>qw(e,a))),m(n,["generatedImages"],o)}const l=x(t,["positivePromptSafetyAttributes"]);return l!=null&&m(n,["positivePromptSafetyAttributes"],tb(e,l)),n}function Vw(e,t){const n={},s=x(t,["baseModel"]);s!=null&&m(n,["baseModel"],s);const l=x(t,["createTime"]);l!=null&&m(n,["createTime"],l);const o=x(t,["updateTime"]);return o!=null&&m(n,["updateTime"],o),n}function Bf(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["description"]);o!=null&&m(n,["description"],o);const a=x(t,["version"]);a!=null&&m(n,["version"],a);const i=x(t,["_self"]);i!=null&&m(n,["tunedModelInfo"],Vw(e,i));const u=x(t,["inputTokenLimit"]);u!=null&&m(n,["inputTokenLimit"],u);const c=x(t,["outputTokenLimit"]);c!=null&&m(n,["outputTokenLimit"],c);const d=x(t,["supportedGenerationMethods"]);return d!=null&&m(n,["supportedActions"],d),n}function zw(){return{}}function Qw(e,t){const n={},s=x(t,["totalTokens"]);s!=null&&m(n,["totalTokens"],s);const l=x(t,["cachedContentTokenCount"]);return l!=null&&m(n,["cachedContentTokenCount"],l),n}function Yw(e,t){const n={},s=x(t,["video","uri"]);s!=null&&m(n,["uri"],s);const l=x(t,["video","encodedVideo"]);l!=null&&m(n,["videoBytes"],br(e,l));const o=x(t,["encoding"]);return o!=null&&m(n,["mimeType"],o),n}function Ww(e,t){const n={},s=x(t,["_self"]);return s!=null&&m(n,["video"],Yw(e,s)),n}function Xw(e,t){const n={},s=x(t,["generatedSamples"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(i=>Ww(e,i))),m(n,["generatedVideos"],a)}const l=x(t,["raiMediaFilteredCount"]);l!=null&&m(n,["raiMediaFilteredCount"],l);const o=x(t,["raiMediaFilteredReasons"]);return o!=null&&m(n,["raiMediaFilteredReasons"],o),n}function Kw(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["metadata"]);l!=null&&m(n,["metadata"],l);const o=x(t,["done"]);o!=null&&m(n,["done"],o);const a=x(t,["error"]);a!=null&&m(n,["error"],a);const i=x(t,["response","generateVideoResponse"]);return i!=null&&m(n,["response"],Xw(e,i)),n}function Zw(e,t){const n={},s=x(t,["videoMetadata"]);s!=null&&m(n,["videoMetadata"],s);const l=x(t,["thought"]);l!=null&&m(n,["thought"],l);const o=x(t,["codeExecutionResult"]);o!=null&&m(n,["codeExecutionResult"],o);const a=x(t,["executableCode"]);a!=null&&m(n,["executableCode"],a);const i=x(t,["fileData"]);i!=null&&m(n,["fileData"],i);const u=x(t,["functionCall"]);u!=null&&m(n,["functionCall"],u);const c=x(t,["functionResponse"]);c!=null&&m(n,["functionResponse"],c);const d=x(t,["inlineData"]);d!=null&&m(n,["inlineData"],d);const h=x(t,["text"]);return h!=null&&m(n,["text"],h),n}function Jw(e,t){const n={},s=x(t,["parts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Zw(e,a))),m(n,["parts"],o)}const l=x(t,["role"]);return l!=null&&m(n,["role"],l),n}function e2(e,t){const n={},s=x(t,["citations"]);return s!=null&&m(n,["citations"],s),n}function t2(e,t){const n={},s=x(t,["content"]);s!=null&&m(n,["content"],Jw(e,s));const l=x(t,["citationMetadata"]);l!=null&&m(n,["citationMetadata"],e2(e,l));const o=x(t,["finishMessage"]);o!=null&&m(n,["finishMessage"],o);const a=x(t,["finishReason"]);a!=null&&m(n,["finishReason"],a);const i=x(t,["avgLogprobs"]);i!=null&&m(n,["avgLogprobs"],i);const u=x(t,["groundingMetadata"]);u!=null&&m(n,["groundingMetadata"],u);const c=x(t,["index"]);c!=null&&m(n,["index"],c);const d=x(t,["logprobsResult"]);d!=null&&m(n,["logprobsResult"],d);const h=x(t,["safetyRatings"]);return h!=null&&m(n,["safetyRatings"],h),n}function Uf(e,t){const n={},s=x(t,["candidates"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>t2(e,d))),m(n,["candidates"],c)}const l=x(t,["createTime"]);l!=null&&m(n,["createTime"],l);const o=x(t,["responseId"]);o!=null&&m(n,["responseId"],o);const a=x(t,["modelVersion"]);a!=null&&m(n,["modelVersion"],a);const i=x(t,["promptFeedback"]);i!=null&&m(n,["promptFeedback"],i);const u=x(t,["usageMetadata"]);return u!=null&&m(n,["usageMetadata"],u),n}function n2(e,t){const n={},s=x(t,["truncated"]);s!=null&&m(n,["truncated"],s);const l=x(t,["token_count"]);return l!=null&&m(n,["tokenCount"],l),n}function s2(e,t){const n={},s=x(t,["values"]);s!=null&&m(n,["values"],s);const l=x(t,["statistics"]);return l!=null&&m(n,["statistics"],n2(e,l)),n}function r2(e,t){const n={},s=x(t,["billableCharacterCount"]);return s!=null&&m(n,["billableCharacterCount"],s),n}function l2(e,t){const n={},s=x(t,["predictions[]","embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>s2(e,a))),m(n,["embeddings"],o)}const l=x(t,["metadata"]);return l!=null&&m(n,["metadata"],r2(e,l)),n}function o2(e,t){const n={},s=x(t,["gcsUri"]);s!=null&&m(n,["gcsUri"],s);const l=x(t,["bytesBase64Encoded"]);l!=null&&m(n,["imageBytes"],br(e,l));const o=x(t,["mimeType"]);return o!=null&&m(n,["mimeType"],o),n}function nb(e,t){const n={},s=x(t,["safetyAttributes","categories"]);s!=null&&m(n,["categories"],s);const l=x(t,["safetyAttributes","scores"]);l!=null&&m(n,["scores"],l);const o=x(t,["contentType"]);return o!=null&&m(n,["contentType"],o),n}function a2(e,t){const n={},s=x(t,["_self"]);s!=null&&m(n,["image"],o2(e,s));const l=x(t,["raiFilteredReason"]);l!=null&&m(n,["raiFilteredReason"],l);const o=x(t,["_self"]);o!=null&&m(n,["safetyAttributes"],nb(e,o));const a=x(t,["prompt"]);return a!=null&&m(n,["enhancedPrompt"],a),n}function i2(e,t){const n={},s=x(t,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>a2(e,a))),m(n,["generatedImages"],o)}const l=x(t,["positivePromptSafetyAttributes"]);return l!=null&&m(n,["positivePromptSafetyAttributes"],nb(e,l)),n}function c2(e,t){const n={},s=x(t,["endpoint"]);s!=null&&m(n,["name"],s);const l=x(t,["deployedModelId"]);return l!=null&&m(n,["deployedModelId"],l),n}function u2(e,t){const n={},s=x(t,["labels","google-vertex-llm-tuning-base-model-id"]);s!=null&&m(n,["baseModel"],s);const l=x(t,["createTime"]);l!=null&&m(n,["createTime"],l);const o=x(t,["updateTime"]);return o!=null&&m(n,["updateTime"],o),n}function Pf(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["displayName"]);l!=null&&m(n,["displayName"],l);const o=x(t,["description"]);o!=null&&m(n,["description"],o);const a=x(t,["versionId"]);a!=null&&m(n,["version"],a);const i=x(t,["deployedModels"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(h=>c2(e,h))),m(n,["endpoints"],d)}const u=x(t,["labels"]);u!=null&&m(n,["labels"],u);const c=x(t,["_self"]);return c!=null&&m(n,["tunedModelInfo"],u2(e,c)),n}function d2(){return{}}function x2(e,t){const n={},s=x(t,["totalTokens"]);return s!=null&&m(n,["totalTokens"],s),n}function m2(e,t){const n={},s=x(t,["tokensInfo"]);return s!=null&&m(n,["tokensInfo"],s),n}function f2(e,t){const n={},s=x(t,["gcsUri"]);s!=null&&m(n,["uri"],s);const l=x(t,["bytesBase64Encoded"]);l!=null&&m(n,["videoBytes"],br(e,l));const o=x(t,["mimeType"]);return o!=null&&m(n,["mimeType"],o),n}function h2(e,t){const n={},s=x(t,["_self"]);return s!=null&&m(n,["video"],f2(e,s)),n}function p2(e,t){const n={},s=x(t,["videos"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(i=>h2(e,i))),m(n,["generatedVideos"],a)}const l=x(t,["raiMediaFilteredCount"]);l!=null&&m(n,["raiMediaFilteredCount"],l);const o=x(t,["raiMediaFilteredReasons"]);return o!=null&&m(n,["raiMediaFilteredReasons"],o),n}function g2(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["metadata"]);l!=null&&m(n,["metadata"],l);const o=x(t,["done"]);o!=null&&m(n,["done"],o);const a=x(t,["error"]);a!=null&&m(n,["error"],a);const i=x(t,["response"]);return i!=null&&m(n,["response"],p2(e,i)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const y2="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function b2(e,t,n){let s,l;n.data instanceof Blob?l=JSON.parse(await n.data.text()):l=JSON.parse(n.data),e.isVertexAI()?s=kS(e,l):s=OS(e,l),t(s)}class v2{constructor(t,n,s){this.apiClient=t,this.auth=n,this.webSocketFactory=s}async connect(t){var n,s,l,o;const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion();let u;const c=w2(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${a}/ws/google.cloud.aiplatform.${i}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(c);else{const b=this.apiClient.getApiKey();u=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateContent?key=${b}`}let d=()=>{};const h=new Promise(b=>{d=b}),f=t.callbacks,p=function(){var b;(b=f==null?void 0:f.onopen)===null||b===void 0||b.call(f),d({})},v=this.apiClient,S={onopen:p,onmessage:b=>{b2(v,f.onmessage,b)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(b){},onclose:(s=f==null?void 0:f.onclose)!==null&&s!==void 0?s:function(b){}},N=this.webSocketFactory.create(u,S2(c),S);N.connect(),await h;let E=Mt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const b=this.apiClient.getProject(),T=this.apiClient.getLocation();E=`projects/${b}/locations/${T}/`+E}let g={};this.apiClient.isVertexAI()&&((l=t.config)===null||l===void 0?void 0:l.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Vi.AUDIO]}:t.config.responseModalities=[Vi.AUDIO]),!((o=t.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const y={model:E,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?g=aS(this.apiClient,y):g=oS(this.apiClient,y),delete g.config,N.send(JSON.stringify(g)),new N2(N,this.apiClient)}}const E2={turnComplete:!0};class N2{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let s=[];try{s=gr(t,n.turns),t.isVertexAI()?s=s.map(l=>kl(t,l)):s=s.map(l=>hc(t,l))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:s,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let s=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?s=n.functionResponses:s=[n.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const o of s){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!t.isVertexAI()&&!("id"in o))throw new Error(y2)}return{toolResponse:{functionResponses:s}}}sendClientContent(t){t=Object.assign(Object.assign({},E2),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:mS(this.apiClient,t)}:n={realtimeInput:xS(this.apiClient,t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function S2(e){const t={};return e.forEach((n,s)=>{t[s]=n}),t}function w2(e){const t=new Headers;for(const[n,s]of Object.entries(e))t.append(n,s);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C2 extends da{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(s=>{var l;let o;const a=[];if(s!=null&&s.generatedImages)for(const u of s.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((l=u==null?void 0:u.safetyAttributes)===null||l===void 0?void 0:l.contentType)==="Positive Prompt"?o=u==null?void 0:u.safetyAttributes:a.push(u);let i;return o?i={generatedImages:a,positivePromptSafetyAttributes:o}:i={generatedImages:a},i})}async generateContentInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=kf(this.apiClient,t);return i=Me("{model}:generateContent",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=Uf(this.apiClient,d),f=new _a;return Object.assign(f,h),f})}else{const c=Of(this.apiClient,t);return i=Me("{model}:generateContent",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=Lf(this.apiClient,d),f=new _a;return Object.assign(f,h),f})}}async generateContentStreamInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=kf(this.apiClient,t);i=Me("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c.config,delete c._url,delete c._query;const d=this.apiClient;return a=d.requestStream({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(h){return zi(this,arguments,function*(){var f,p,v,S;try{for(var N=!0,E=zd(h),g;g=yield yn(E.next()),f=g.done,!f;N=!0){S=g.value,N=!1;const b=Uf(d,yield yn(S.json())),T=new _a;Object.assign(T,b),yield yield yn(T)}}catch(y){p={error:y}}finally{try{!N&&!f&&(v=E.return)&&(yield yn(v.call(E)))}finally{if(p)throw p.error}}})})}else{const c=Of(this.apiClient,t);i=Me("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c.config,delete c._url,delete c._query;const d=this.apiClient;return a=d.requestStream({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(h){return zi(this,arguments,function*(){var f,p,v,S;try{for(var N=!0,E=zd(h),g;g=yield yn(E.next()),f=g.done,!f;N=!0){S=g.value,N=!1;const b=Lf(d,yield yn(S.json())),T=new _a;Object.assign(T,b),yield yield yn(T)}}catch(y){p={error:y}}finally{try{!N&&!f&&(v=E.return)&&(yield yn(v.call(E)))}finally{if(p)throw p.error}}})})}}async embedContent(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=Nw(this.apiClient,t);return i=Me("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=l2(this.apiClient,d),f=new Sf;return Object.assign(f,h),f})}else{const c=XS(this.apiClient,t);return i=Me("{model}:batchEmbedContents",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=Hw(this.apiClient,d),f=new Sf;return Object.assign(f,h),f})}}async generateImagesInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=ww(this.apiClient,t);return i=Me("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=i2(this.apiClient,d),f=new wf;return Object.assign(f,h),f})}else{const c=ZS(this.apiClient,t);return i=Me("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=$w(this.apiClient,d),f=new wf;return Object.assign(f,h),f})}}async get(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=Cw(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>Pf(this.apiClient,d))}else{const c=JS(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>Bf(this.apiClient,d))}}async update(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=Tw(this.apiClient,t);return i=Me("{model}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>Pf(this.apiClient,d))}else{const c=tw(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>Bf(this.apiClient,d))}}async delete(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=_w(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(()=>{const d=d2(),h=new Cf;return Object.assign(h,d),h})}else{const c=nw(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(()=>{const d=zw(),h=new Cf;return Object.assign(h,d),h})}}async countTokens(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=Rw(this.apiClient,t);return i=Me("{model}:countTokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=x2(this.apiClient,d),f=new Af;return Object.assign(f,h),f})}else{const c=rw(this.apiClient,t);return i=Me("{model}:countTokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=Qw(this.apiClient,d),f=new Af;return Object.assign(f,h),f})}}async computeTokens(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI()){const i=Iw(this.apiClient,t);return o=Me("{model}:computeTokens",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>{const c=m2(this.apiClient,u),d=new mN;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=Ow(this.apiClient,t);return i=Me("{model}:predictLongRunning",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>g2(this.apiClient,d))}else{const c=aw(this.apiClient,t);return i=Me("{model}:predictLongRunning",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>Kw(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A2(e,t){const n={},s=x(t,["operationName"]);s!=null&&m(n,["_url","operationName"],s);const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function T2(e,t){const n={},s=x(t,["operationName"]);s!=null&&m(n,["_url","operationName"],s);const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function _2(e,t){const n={},s=x(t,["operationName"]);s!=null&&m(n,["operationName"],s);const l=x(t,["resourceName"]);l!=null&&m(n,["_url","resourceName"],l);const o=x(t,["config"]);return o!=null&&m(n,["config"],o),n}function j2(e,t){const n={},s=x(t,["video","uri"]);s!=null&&m(n,["uri"],s);const l=x(t,["video","encodedVideo"]);l!=null&&m(n,["videoBytes"],br(e,l));const o=x(t,["encoding"]);return o!=null&&m(n,["mimeType"],o),n}function R2(e,t){const n={},s=x(t,["_self"]);return s!=null&&m(n,["video"],j2(e,s)),n}function I2(e,t){const n={},s=x(t,["generatedSamples"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(i=>R2(e,i))),m(n,["generatedVideos"],a)}const l=x(t,["raiMediaFilteredCount"]);l!=null&&m(n,["raiMediaFilteredCount"],l);const o=x(t,["raiMediaFilteredReasons"]);return o!=null&&m(n,["raiMediaFilteredReasons"],o),n}function M2(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["metadata"]);l!=null&&m(n,["metadata"],l);const o=x(t,["done"]);o!=null&&m(n,["done"],o);const a=x(t,["error"]);a!=null&&m(n,["error"],a);const i=x(t,["response","generateVideoResponse"]);return i!=null&&m(n,["response"],I2(e,i)),n}function D2(e,t){const n={},s=x(t,["gcsUri"]);s!=null&&m(n,["uri"],s);const l=x(t,["bytesBase64Encoded"]);l!=null&&m(n,["videoBytes"],br(e,l));const o=x(t,["mimeType"]);return o!=null&&m(n,["mimeType"],o),n}function O2(e,t){const n={},s=x(t,["_self"]);return s!=null&&m(n,["video"],D2(e,s)),n}function k2(e,t){const n={},s=x(t,["videos"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(i=>O2(e,i))),m(n,["generatedVideos"],a)}const l=x(t,["raiMediaFilteredCount"]);l!=null&&m(n,["raiMediaFilteredCount"],l);const o=x(t,["raiMediaFilteredReasons"]);return o!=null&&m(n,["raiMediaFilteredReasons"],o),n}function Gf(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["metadata"]);l!=null&&m(n,["metadata"],l);const o=x(t,["done"]);o!=null&&m(n,["done"],o);const a=x(t,["error"]);a!=null&&m(n,["error"],a);const i=x(t,["response"]);return i!=null&&m(n,["response"],k2(e,i)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class L2 extends da{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,s=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=n.name.split("/operations/")[0];let o;return s&&"httpOptions"in s&&(o=s.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:l,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:n.name,config:s})}async getVideosOperationInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=T2(this.apiClient,t);return i=Me("{operationName}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>Gf(this.apiClient,d))}else{const c=A2(this.apiClient,t);return i=Me("{operationName}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>M2(this.apiClient,d))}}async fetchPredictVideosOperationInternal(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI()){const i=_2(this.apiClient,t);return o=Me("{resourceName}:fetchPredictOperation",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>Gf(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const B2="Content-Type",U2="X-Server-Timeout",P2="User-Agent",G2="x-goog-api-client",H2="0.12.0",F2=`google-genai-sdk/${H2}`,q2="v1beta1",$2="v1beta",Hf=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class sb extends Error{constructor(t,n){n?super(t,{cause:n}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class Yd extends Error{constructor(t,n){n?super(t,{cause:n}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class V2{constructor(t){var n,s;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const l={};this.clientOptions.vertexai?(l.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:q2,this.getProject()||this.getLocation()?(l.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(l.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(l.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:$2,l.baseUrl="https://generativelanguage.googleapis.com/"),l.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=l,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(l,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&s.push(t.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,s){const l=[this.getRequestUrlInternal(n)];return s&&l.push(this.getBaseResourcePath()),t!==""&&l.push(t),new URL(`${l.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const s=this.shouldPrependVertexProjectPath(t),l=this.constructUrl(t.path,n,s);if(t.queryParams)for(const[a,i]of Object.entries(t.queryParams))l.searchParams.append(a,String(i));let o={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=t.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,t.abortSignal),this.unaryApiCall(l,o,t.httpMethod)}patchHttpOptions(t,n){const s=JSON.parse(JSON.stringify(t));for(const[l,o]of Object.entries(n))typeof o=="object"?s[l]=Object.assign(Object.assign({},s[l]),o):o!==void 0&&(s[l]=o);return s}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const s=this.shouldPrependVertexProjectPath(t),l=this.constructUrl(t.path,n,s);(!l.searchParams.has("alt")||l.searchParams.get("alt")!=="sse")&&l.searchParams.set("alt","sse");let o={};return o.body=t.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,t.abortSignal),this.streamApiCall(l,o,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,s){if(n&&n.timeout||s){const l=new AbortController,o=l.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>l.abort(),n.timeout),s&&s.addEventListener("abort",()=>{l.abort()}),t.signal=o}return t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,s){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:s})).then(async l=>(await Ff(l),new Vd(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}async streamApiCall(t,n,s){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:s})).then(async l=>(await Ff(l),this.processStreamResponse(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}processStreamResponse(t){var n;return zi(this,arguments,function*(){const l=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!l)throw new Error("Response body is empty");try{let a="";for(;;){const{done:i,value:u}=yield yn(l.read());if(i){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=o.decode(u);try{const h=JSON.parse(c);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),p=f.status,v=f.code,S=`got status: ${p}. ${JSON.stringify(h)}`;if(v>=400&&v<500)throw new sb(S);if(v>=500&&v<600)throw new Yd(S)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}a+=c;let d=a.match(Hf);for(;d;){const h=d[1];try{const f=new Response(h,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield yn(new Vd(f)),a=a.slice(d[0].length),d=a.match(Hf)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{l.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const t={},n=F2+" "+this.clientOptions.userAgentExtra;return t[P2]=n,t[G2]=n,t[B2]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[s,l]of Object.entries(t.headers))n.append(s,l);t.timeout&&t.timeout>0&&n.append(U2,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var s;const l={};n!=null&&(l.mimeType=n.mimeType,l.name=n.name,l.displayName=n.displayName),l.name&&!l.name.startsWith("files/")&&(l.name=`files/${l.name}`);const o=this.clientOptions.uploader,a=await o.stat(t);l.sizeBytes=String(a.size);const i=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:a.type;if(i===void 0||i==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=i;const u=await this.fetchUploadUrl(l,n);return o.upload(t,u,this)}async fetchUploadUrl(t,n){var s;let l={};n!=null&&n.httpOptions?l=n.httpOptions:l={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const o={file:t},a=await this.request({path:Me("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:l});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const i=(s=a==null?void 0:a.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(i===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return i}}async function Ff(e){var t;if(e===void 0)throw new Yd("response is undefined");if(!e.ok){const n=e.status,s=e.statusText;let l;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?l=await e.json():l={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${n} ${s}. ${JSON.stringify(l)}`;throw n>=400&&n<500?new sb(o):n>=500&&n<600?new Yd(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z2(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],s);const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function Q2(e,t,n){const s={},l=x(t,["pageSize"]);n!==void 0&&l!=null&&m(n,["_query","pageSize"],l);const o=x(t,["pageToken"]);n!==void 0&&o!=null&&m(n,["_query","pageToken"],o);const a=x(t,["filter"]);return n!==void 0&&a!=null&&m(n,["_query","filter"],a),s}function Y2(e,t){const n={},s=x(t,["config"]);return s!=null&&m(n,["config"],Q2(e,s,n)),n}function W2(e,t){const n={},s=x(t,["textInput"]);s!=null&&m(n,["textInput"],s);const l=x(t,["output"]);return l!=null&&m(n,["output"],l),n}function X2(e,t){const n={};if(x(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=x(t,["examples"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(o=>W2(e,o))),m(n,["examples","examples"],l)}return n}function K2(e,t,n){const s={};if(x(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const l=x(t,["tunedModelDisplayName"]);if(n!==void 0&&l!=null&&m(n,["displayName"],l),x(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=x(t,["epochCount"]);n!==void 0&&o!=null&&m(n,["tuningTask","hyperparameters","epochCount"],o);const a=x(t,["learningRateMultiplier"]);if(a!=null&&m(s,["tuningTask","hyperparameters","learningRateMultiplier"],a),x(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const i=x(t,["batchSize"]);n!==void 0&&i!=null&&m(n,["tuningTask","hyperparameters","batchSize"],i);const u=x(t,["learningRate"]);return n!==void 0&&u!=null&&m(n,["tuningTask","hyperparameters","learningRate"],u),s}function Z2(e,t){const n={},s=x(t,["baseModel"]);s!=null&&m(n,["baseModel"],s);const l=x(t,["trainingDataset"]);l!=null&&m(n,["tuningTask","trainingData"],X2(e,l));const o=x(t,["config"]);return o!=null&&m(n,["config"],K2(e,o,n)),n}function J2(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["_url","name"],s);const l=x(t,["config"]);return l!=null&&m(n,["config"],l),n}function eC(e,t,n){const s={},l=x(t,["pageSize"]);n!==void 0&&l!=null&&m(n,["_query","pageSize"],l);const o=x(t,["pageToken"]);n!==void 0&&o!=null&&m(n,["_query","pageToken"],o);const a=x(t,["filter"]);return n!==void 0&&a!=null&&m(n,["_query","filter"],a),s}function tC(e,t){const n={},s=x(t,["config"]);return s!=null&&m(n,["config"],eC(e,s,n)),n}function nC(e,t,n){const s={},l=x(t,["gcsUri"]);if(n!==void 0&&l!=null&&m(n,["supervisedTuningSpec","trainingDatasetUri"],l),x(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function sC(e,t){const n={},s=x(t,["gcsUri"]);return s!=null&&m(n,["validationDatasetUri"],s),n}function rC(e,t,n){const s={},l=x(t,["validationDataset"]);n!==void 0&&l!=null&&m(n,["supervisedTuningSpec"],sC(e,l));const o=x(t,["tunedModelDisplayName"]);n!==void 0&&o!=null&&m(n,["tunedModelDisplayName"],o);const a=x(t,["description"]);n!==void 0&&a!=null&&m(n,["description"],a);const i=x(t,["epochCount"]);n!==void 0&&i!=null&&m(n,["supervisedTuningSpec","hyperParameters","epochCount"],i);const u=x(t,["learningRateMultiplier"]);n!==void 0&&u!=null&&m(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const c=x(t,["adapterSize"]);if(n!==void 0&&c!=null&&m(n,["supervisedTuningSpec","hyperParameters","adapterSize"],c),x(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(x(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return s}function lC(e,t){const n={},s=x(t,["baseModel"]);s!=null&&m(n,["baseModel"],s);const l=x(t,["trainingDataset"]);l!=null&&m(n,["supervisedTuningSpec","trainingDatasetUri"],nC(e,l,n));const o=x(t,["config"]);return o!=null&&m(n,["config"],rC(e,o,n)),n}function oC(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["model"],s);const l=x(t,["name"]);return l!=null&&m(n,["endpoint"],l),n}function rb(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["state"]);l!=null&&m(n,["state"],Ky(e,l));const o=x(t,["createTime"]);o!=null&&m(n,["createTime"],o);const a=x(t,["tuningTask","startTime"]);a!=null&&m(n,["startTime"],a);const i=x(t,["tuningTask","completeTime"]);i!=null&&m(n,["endTime"],i);const u=x(t,["updateTime"]);u!=null&&m(n,["updateTime"],u);const c=x(t,["description"]);c!=null&&m(n,["description"],c);const d=x(t,["baseModel"]);d!=null&&m(n,["baseModel"],d);const h=x(t,["_self"]);h!=null&&m(n,["tunedModel"],oC(e,h));const f=x(t,["distillationSpec"]);f!=null&&m(n,["distillationSpec"],f);const p=x(t,["experiment"]);p!=null&&m(n,["experiment"],p);const v=x(t,["labels"]);v!=null&&m(n,["labels"],v);const S=x(t,["pipelineJob"]);S!=null&&m(n,["pipelineJob"],S);const N=x(t,["tunedModelDisplayName"]);return N!=null&&m(n,["tunedModelDisplayName"],N),n}function aC(e,t){const n={},s=x(t,["nextPageToken"]);s!=null&&m(n,["nextPageToken"],s);const l=x(t,["tunedModels"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(a=>rb(e,a))),m(n,["tuningJobs"],o)}return n}function iC(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["metadata"]);l!=null&&m(n,["metadata"],l);const o=x(t,["done"]);o!=null&&m(n,["done"],o);const a=x(t,["error"]);return a!=null&&m(n,["error"],a),n}function cC(e,t){const n={},s=x(t,["model"]);s!=null&&m(n,["model"],s);const l=x(t,["endpoint"]);return l!=null&&m(n,["endpoint"],l),n}function Wd(e,t){const n={},s=x(t,["name"]);s!=null&&m(n,["name"],s);const l=x(t,["state"]);l!=null&&m(n,["state"],Ky(e,l));const o=x(t,["createTime"]);o!=null&&m(n,["createTime"],o);const a=x(t,["startTime"]);a!=null&&m(n,["startTime"],a);const i=x(t,["endTime"]);i!=null&&m(n,["endTime"],i);const u=x(t,["updateTime"]);u!=null&&m(n,["updateTime"],u);const c=x(t,["error"]);c!=null&&m(n,["error"],c);const d=x(t,["description"]);d!=null&&m(n,["description"],d);const h=x(t,["baseModel"]);h!=null&&m(n,["baseModel"],h);const f=x(t,["tunedModel"]);f!=null&&m(n,["tunedModel"],cC(e,f));const p=x(t,["supervisedTuningSpec"]);p!=null&&m(n,["supervisedTuningSpec"],p);const v=x(t,["tuningDataStats"]);v!=null&&m(n,["tuningDataStats"],v);const S=x(t,["encryptionSpec"]);S!=null&&m(n,["encryptionSpec"],S);const N=x(t,["partnerModelTuningSpec"]);N!=null&&m(n,["partnerModelTuningSpec"],N);const E=x(t,["distillationSpec"]);E!=null&&m(n,["distillationSpec"],E);const g=x(t,["experiment"]);g!=null&&m(n,["experiment"],g);const y=x(t,["labels"]);y!=null&&m(n,["labels"],y);const b=x(t,["pipelineJob"]);b!=null&&m(n,["pipelineJob"],b);const T=x(t,["tunedModelDisplayName"]);return T!=null&&m(n,["tunedModelDisplayName"],T),n}function uC(e,t){const n={},s=x(t,["nextPageToken"]);s!=null&&m(n,["nextPageToken"],s);const l=x(t,["tuningJobs"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(a=>Wd(e,a))),m(n,["tuningJobs"],o)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dC extends da{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new K0(Fo.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const s=await this.tuneMldevInternal(n);let l="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?l=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(l=s.name.split("/operations/")[0]),{name:l,state:$d.JOB_STATE_QUEUED}}}}async getInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=J2(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>Wd(this.apiClient,d))}else{const c=z2(this.apiClient,t);return i=Me("{name}",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>rb(this.apiClient,d))}}async listInternal(t){var n,s,l,o;let a,i="",u={};if(this.apiClient.isVertexAI()){const c=tC(this.apiClient,t);return i=Me("tuningJobs",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=uC(this.apiClient,d),f=new Tf;return Object.assign(f,h),f})}else{const c=Y2(this.apiClient,t);return i=Me("tunedModels",c._url),u=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(l=t.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),a.then(d=>{const h=aC(this.apiClient,d),f=new Tf;return Object.assign(f,h),f})}}async tuneInternal(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI()){const i=lC(this.apiClient,t);return o=Me("tuningJobs",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>Wd(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,s;let l,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=Z2(this.apiClient,t);return o=Me("tunedModels",i._url),a=i._query,delete i.config,delete i._url,delete i._query,l=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),l.then(u=>iC(this.apiClient,u))}}}const xC=1024*1024*8;async function mC(e,t,n){var s,l;let o=0,a=0,i=new Vd(new Response),u="upload";for(o=e.size;a<o;){const d=Math.min(xC,o-a),h=e.slice(a,a+d);if(a+d>=o&&(u+=", finalize"),i=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(d)}}}),a+=d,((s=i==null?void 0:i.headers)===null||s===void 0?void 0:s["x-goog-upload-status"])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const c=await(i==null?void 0:i.json());if(((l=i==null?void 0:i.headers)===null||l===void 0?void 0:l["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function fC(e){return{size:e.size,type:e.type}}class hC{async upload(t,n,s){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await mC(t,n,s)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await fC(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pC{create(t,n,s){return new gC(t,n,s)}}class gC{constructor(t,n,s){this.url=t,this.headers=n,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qf="x-goog-api-key";class yC{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(qf)===null&&t.append(qf,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bC="gl-node/";class lb{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const s=jE(t,void 0,void 0);s&&(t.httpOptions?t.httpOptions.baseUrl=s:t.httpOptions={baseUrl:s}),this.apiVersion=t.apiVersion;const l=new yC(this.apiKey);this.apiClient=new V2({auth:l,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:bC+"web",uploader:new hC}),this.models=new C2(this.apiClient),this.live=new v2(this.apiClient,l,new pC),this.chats=new EN(this.models,this.apiClient),this.caches=new gN(this.apiClient),this.files=new ON(this.apiClient),this.operations=new L2(this.apiClient),this.tunings=new dC(this.apiClient)}}var ob={exports:{}};function vC(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jc={exports:{}};const EC={},NC=Object.freeze(Object.defineProperty({__proto__:null,default:EC},Symbol.toStringTag,{value:"Module"})),SC=Cb(NC);var $f;function Ye(){return $f||($f=1,function(e,t){(function(n,s){e.exports=s()})(Ge,function(){var n=n||function(s,l){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Ge<"u"&&Ge.crypto&&(o=Ge.crypto),!o&&typeof vC=="function")try{o=SC}catch{}var a=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function g(){}return function(y){var b;return g.prototype=y,b=new g,g.prototype=null,b}}(),u={},c=u.lib={},d=c.Base=function(){return{extend:function(g){var y=i(this);return g&&y.mixIn(g),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var y in g)g.hasOwnProperty(y)&&(this[y]=g[y]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=c.WordArray=d.extend({init:function(g,y){g=this.words=g||[],y!=l?this.sigBytes=y:this.sigBytes=g.length*4},toString:function(g){return(g||p).stringify(this)},concat:function(g){var y=this.words,b=g.words,T=this.sigBytes,A=g.sigBytes;if(this.clamp(),T%4)for(var C=0;C<A;C++){var _=b[C>>>2]>>>24-C%4*8&255;y[T+C>>>2]|=_<<24-(T+C)%4*8}else for(var L=0;L<A;L+=4)y[T+L>>>2]=b[L>>>2];return this.sigBytes+=A,this},clamp:function(){var g=this.words,y=this.sigBytes;g[y>>>2]&=4294967295<<32-y%4*8,g.length=s.ceil(y/4)},clone:function(){var g=d.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var y=[],b=0;b<g;b+=4)y.push(a());return new h.init(y,g)}}),f=u.enc={},p=f.Hex={stringify:function(g){for(var y=g.words,b=g.sigBytes,T=[],A=0;A<b;A++){var C=y[A>>>2]>>>24-A%4*8&255;T.push((C>>>4).toString(16)),T.push((C&15).toString(16))}return T.join("")},parse:function(g){for(var y=g.length,b=[],T=0;T<y;T+=2)b[T>>>3]|=parseInt(g.substr(T,2),16)<<24-T%8*4;return new h.init(b,y/2)}},v=f.Latin1={stringify:function(g){for(var y=g.words,b=g.sigBytes,T=[],A=0;A<b;A++){var C=y[A>>>2]>>>24-A%4*8&255;T.push(String.fromCharCode(C))}return T.join("")},parse:function(g){for(var y=g.length,b=[],T=0;T<y;T++)b[T>>>2]|=(g.charCodeAt(T)&255)<<24-T%4*8;return new h.init(b,y)}},S=f.Utf8={stringify:function(g){try{return decodeURIComponent(escape(v.stringify(g)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(g){return v.parse(unescape(encodeURIComponent(g)))}},N=c.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=S.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var y,b=this._data,T=b.words,A=b.sigBytes,C=this.blockSize,_=C*4,L=A/_;g?L=s.ceil(L):L=s.max((L|0)-this._minBufferSize,0);var I=L*C,j=s.min(I*4,A);if(I){for(var D=0;D<I;D+=C)this._doProcessBlock(T,D);y=T.splice(0,I),b.sigBytes-=j}return new h.init(y,j)},clone:function(){var g=d.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});c.Hasher=N.extend({cfg:d.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){N.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){g&&this._append(g);var y=this._doFinalize();return y},blockSize:16,_createHelper:function(g){return function(y,b){return new g.init(b).finalize(y)}},_createHmacHelper:function(g){return function(y,b){return new E.HMAC.init(g,b).finalize(y)}}});var E=u.algo={};return u}(Math);return n})}(Jc)),Jc.exports}var eu={exports:{}},Vf;function pc(){return Vf||(Vf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(s){var l=n,o=l.lib,a=o.Base,i=o.WordArray,u=l.x64={};u.Word=a.extend({init:function(c,d){this.high=c,this.low=d}}),u.WordArray=a.extend({init:function(c,d){c=this.words=c||[],d!=s?this.sigBytes=d:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,d=c.length,h=[],f=0;f<d;f++){var p=c[f];h.push(p.high),h.push(p.low)}return i.create(h,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),d=c.words=this.words.slice(0),h=d.length,f=0;f<h;f++)d[f]=d[f].clone();return c}})}(),n})}(eu)),eu.exports}var tu={exports:{}},zf;function wC(){return zf||(zf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(){if(typeof ArrayBuffer=="function"){var s=n,l=s.lib,o=l.WordArray,a=o.init,i=o.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var c=u.byteLength,d=[],h=0;h<c;h++)d[h>>>2]|=u[h]<<24-h%4*8;a.call(this,d,c)}else a.apply(this,arguments)};i.prototype=o}}(),n.lib.WordArray})}(tu)),tu.exports}var nu={exports:{}},Qf;function CC(){return Qf||(Qf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=s.enc;a.Utf16=a.Utf16BE={stringify:function(u){for(var c=u.words,d=u.sigBytes,h=[],f=0;f<d;f+=2){var p=c[f>>>2]>>>16-f%4*8&65535;h.push(String.fromCharCode(p))}return h.join("")},parse:function(u){for(var c=u.length,d=[],h=0;h<c;h++)d[h>>>1]|=u.charCodeAt(h)<<16-h%2*16;return o.create(d,c*2)}},a.Utf16LE={stringify:function(u){for(var c=u.words,d=u.sigBytes,h=[],f=0;f<d;f+=2){var p=i(c[f>>>2]>>>16-f%4*8&65535);h.push(String.fromCharCode(p))}return h.join("")},parse:function(u){for(var c=u.length,d=[],h=0;h<c;h++)d[h>>>1]|=i(u.charCodeAt(h)<<16-h%2*16);return o.create(d,c*2)}};function i(u){return u<<8&4278255360|u>>>8&16711935}}(),n.enc.Utf16})}(nu)),nu.exports}var su={exports:{}},Yf;function Hr(){return Yf||(Yf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=s.enc;a.Base64={stringify:function(u){var c=u.words,d=u.sigBytes,h=this._map;u.clamp();for(var f=[],p=0;p<d;p+=3)for(var v=c[p>>>2]>>>24-p%4*8&255,S=c[p+1>>>2]>>>24-(p+1)%4*8&255,N=c[p+2>>>2]>>>24-(p+2)%4*8&255,E=v<<16|S<<8|N,g=0;g<4&&p+g*.75<d;g++)f.push(h.charAt(E>>>6*(3-g)&63));var y=h.charAt(64);if(y)for(;f.length%4;)f.push(y);return f.join("")},parse:function(u){var c=u.length,d=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var f=0;f<d.length;f++)h[d.charCodeAt(f)]=f}var p=d.charAt(64);if(p){var v=u.indexOf(p);v!==-1&&(c=v)}return i(u,c,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function i(u,c,d){for(var h=[],f=0,p=0;p<c;p++)if(p%4){var v=d[u.charCodeAt(p-1)]<<p%4*2,S=d[u.charCodeAt(p)]>>>6-p%4*2,N=v|S;h[f>>>2]|=N<<24-f%4*8,f++}return o.create(h,f)}}(),n.enc.Base64})}(su)),su.exports}var ru={exports:{}},Wf;function AC(){return Wf||(Wf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=s.enc;a.Base64url={stringify:function(u,c){c===void 0&&(c=!0);var d=u.words,h=u.sigBytes,f=c?this._safe_map:this._map;u.clamp();for(var p=[],v=0;v<h;v+=3)for(var S=d[v>>>2]>>>24-v%4*8&255,N=d[v+1>>>2]>>>24-(v+1)%4*8&255,E=d[v+2>>>2]>>>24-(v+2)%4*8&255,g=S<<16|N<<8|E,y=0;y<4&&v+y*.75<h;y++)p.push(f.charAt(g>>>6*(3-y)&63));var b=f.charAt(64);if(b)for(;p.length%4;)p.push(b);return p.join("")},parse:function(u,c){c===void 0&&(c=!0);var d=u.length,h=c?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var p=0;p<h.length;p++)f[h.charCodeAt(p)]=p}var v=h.charAt(64);if(v){var S=u.indexOf(v);S!==-1&&(d=S)}return i(u,d,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function i(u,c,d){for(var h=[],f=0,p=0;p<c;p++)if(p%4){var v=d[u.charCodeAt(p-1)]<<p%4*2,S=d[u.charCodeAt(p)]>>>6-p%4*2,N=v|S;h[f>>>2]|=N<<24-f%4*8,f++}return o.create(h,f)}}(),n.enc.Base64url})}(ru)),ru.exports}var lu={exports:{}},Xf;function Fr(){return Xf||(Xf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(s){var l=n,o=l.lib,a=o.WordArray,i=o.Hasher,u=l.algo,c=[];(function(){for(var S=0;S<64;S++)c[S]=s.abs(s.sin(S+1))*4294967296|0})();var d=u.MD5=i.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(S,N){for(var E=0;E<16;E++){var g=N+E,y=S[g];S[g]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var b=this._hash.words,T=S[N+0],A=S[N+1],C=S[N+2],_=S[N+3],L=S[N+4],I=S[N+5],j=S[N+6],D=S[N+7],M=S[N+8],U=S[N+9],$=S[N+10],B=S[N+11],k=S[N+12],H=S[N+13],F=S[N+14],Z=S[N+15],z=b[0],q=b[1],Y=b[2],V=b[3];z=h(z,q,Y,V,T,7,c[0]),V=h(V,z,q,Y,A,12,c[1]),Y=h(Y,V,z,q,C,17,c[2]),q=h(q,Y,V,z,_,22,c[3]),z=h(z,q,Y,V,L,7,c[4]),V=h(V,z,q,Y,I,12,c[5]),Y=h(Y,V,z,q,j,17,c[6]),q=h(q,Y,V,z,D,22,c[7]),z=h(z,q,Y,V,M,7,c[8]),V=h(V,z,q,Y,U,12,c[9]),Y=h(Y,V,z,q,$,17,c[10]),q=h(q,Y,V,z,B,22,c[11]),z=h(z,q,Y,V,k,7,c[12]),V=h(V,z,q,Y,H,12,c[13]),Y=h(Y,V,z,q,F,17,c[14]),q=h(q,Y,V,z,Z,22,c[15]),z=f(z,q,Y,V,A,5,c[16]),V=f(V,z,q,Y,j,9,c[17]),Y=f(Y,V,z,q,B,14,c[18]),q=f(q,Y,V,z,T,20,c[19]),z=f(z,q,Y,V,I,5,c[20]),V=f(V,z,q,Y,$,9,c[21]),Y=f(Y,V,z,q,Z,14,c[22]),q=f(q,Y,V,z,L,20,c[23]),z=f(z,q,Y,V,U,5,c[24]),V=f(V,z,q,Y,F,9,c[25]),Y=f(Y,V,z,q,_,14,c[26]),q=f(q,Y,V,z,M,20,c[27]),z=f(z,q,Y,V,H,5,c[28]),V=f(V,z,q,Y,C,9,c[29]),Y=f(Y,V,z,q,D,14,c[30]),q=f(q,Y,V,z,k,20,c[31]),z=p(z,q,Y,V,I,4,c[32]),V=p(V,z,q,Y,M,11,c[33]),Y=p(Y,V,z,q,B,16,c[34]),q=p(q,Y,V,z,F,23,c[35]),z=p(z,q,Y,V,A,4,c[36]),V=p(V,z,q,Y,L,11,c[37]),Y=p(Y,V,z,q,D,16,c[38]),q=p(q,Y,V,z,$,23,c[39]),z=p(z,q,Y,V,H,4,c[40]),V=p(V,z,q,Y,T,11,c[41]),Y=p(Y,V,z,q,_,16,c[42]),q=p(q,Y,V,z,j,23,c[43]),z=p(z,q,Y,V,U,4,c[44]),V=p(V,z,q,Y,k,11,c[45]),Y=p(Y,V,z,q,Z,16,c[46]),q=p(q,Y,V,z,C,23,c[47]),z=v(z,q,Y,V,T,6,c[48]),V=v(V,z,q,Y,D,10,c[49]),Y=v(Y,V,z,q,F,15,c[50]),q=v(q,Y,V,z,I,21,c[51]),z=v(z,q,Y,V,k,6,c[52]),V=v(V,z,q,Y,_,10,c[53]),Y=v(Y,V,z,q,$,15,c[54]),q=v(q,Y,V,z,A,21,c[55]),z=v(z,q,Y,V,M,6,c[56]),V=v(V,z,q,Y,Z,10,c[57]),Y=v(Y,V,z,q,j,15,c[58]),q=v(q,Y,V,z,H,21,c[59]),z=v(z,q,Y,V,L,6,c[60]),V=v(V,z,q,Y,B,10,c[61]),Y=v(Y,V,z,q,C,15,c[62]),q=v(q,Y,V,z,U,21,c[63]),b[0]=b[0]+z|0,b[1]=b[1]+q|0,b[2]=b[2]+Y|0,b[3]=b[3]+V|0},_doFinalize:function(){var S=this._data,N=S.words,E=this._nDataBytes*8,g=S.sigBytes*8;N[g>>>5]|=128<<24-g%32;var y=s.floor(E/4294967296),b=E;N[(g+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,N[(g+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,S.sigBytes=(N.length+1)*4,this._process();for(var T=this._hash,A=T.words,C=0;C<4;C++){var _=A[C];A[C]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}return T},clone:function(){var S=i.clone.call(this);return S._hash=this._hash.clone(),S}});function h(S,N,E,g,y,b,T){var A=S+(N&E|~N&g)+y+T;return(A<<b|A>>>32-b)+N}function f(S,N,E,g,y,b,T){var A=S+(N&g|E&~g)+y+T;return(A<<b|A>>>32-b)+N}function p(S,N,E,g,y,b,T){var A=S+(N^E^g)+y+T;return(A<<b|A>>>32-b)+N}function v(S,N,E,g,y,b,T){var A=S+(E^(N|~g))+y+T;return(A<<b|A>>>32-b)+N}l.MD5=i._createHelper(d),l.HmacMD5=i._createHmacHelper(d)}(Math),n.MD5})}(lu)),lu.exports}var ou={exports:{}},Kf;function ab(){return Kf||(Kf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=l.Hasher,i=s.algo,u=[],c=i.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,h){for(var f=this._hash.words,p=f[0],v=f[1],S=f[2],N=f[3],E=f[4],g=0;g<80;g++){if(g<16)u[g]=d[h+g]|0;else{var y=u[g-3]^u[g-8]^u[g-14]^u[g-16];u[g]=y<<1|y>>>31}var b=(p<<5|p>>>27)+E+u[g];g<20?b+=(v&S|~v&N)+1518500249:g<40?b+=(v^S^N)+1859775393:g<60?b+=(v&S|v&N|S&N)-1894007588:b+=(v^S^N)-899497514,E=N,N=S,S=v<<30|v>>>2,v=p,p=b}f[0]=f[0]+p|0,f[1]=f[1]+v|0,f[2]=f[2]+S|0,f[3]=f[3]+N|0,f[4]=f[4]+E|0},_doFinalize:function(){var d=this._data,h=d.words,f=this._nDataBytes*8,p=d.sigBytes*8;return h[p>>>5]|=128<<24-p%32,h[(p+64>>>9<<4)+14]=Math.floor(f/4294967296),h[(p+64>>>9<<4)+15]=f,d.sigBytes=h.length*4,this._process(),this._hash},clone:function(){var d=a.clone.call(this);return d._hash=this._hash.clone(),d}});s.SHA1=a._createHelper(c),s.HmacSHA1=a._createHmacHelper(c)}(),n.SHA1})}(ou)),ou.exports}var au={exports:{}},Zf;function Z0(){return Zf||(Zf=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){return function(s){var l=n,o=l.lib,a=o.WordArray,i=o.Hasher,u=l.algo,c=[],d=[];(function(){function p(E){for(var g=s.sqrt(E),y=2;y<=g;y++)if(!(E%y))return!1;return!0}function v(E){return(E-(E|0))*4294967296|0}for(var S=2,N=0;N<64;)p(S)&&(N<8&&(c[N]=v(s.pow(S,1/2))),d[N]=v(s.pow(S,1/3)),N++),S++})();var h=[],f=u.SHA256=i.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(p,v){for(var S=this._hash.words,N=S[0],E=S[1],g=S[2],y=S[3],b=S[4],T=S[5],A=S[6],C=S[7],_=0;_<64;_++){if(_<16)h[_]=p[v+_]|0;else{var L=h[_-15],I=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,j=h[_-2],D=(j<<15|j>>>17)^(j<<13|j>>>19)^j>>>10;h[_]=I+h[_-7]+D+h[_-16]}var M=b&T^~b&A,U=N&E^N&g^E&g,$=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),B=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),k=C+B+M+d[_]+h[_],H=$+U;C=A,A=T,T=b,b=y+k|0,y=g,g=E,E=N,N=k+H|0}S[0]=S[0]+N|0,S[1]=S[1]+E|0,S[2]=S[2]+g|0,S[3]=S[3]+y|0,S[4]=S[4]+b|0,S[5]=S[5]+T|0,S[6]=S[6]+A|0,S[7]=S[7]+C|0},_doFinalize:function(){var p=this._data,v=p.words,S=this._nDataBytes*8,N=p.sigBytes*8;return v[N>>>5]|=128<<24-N%32,v[(N+64>>>9<<4)+14]=s.floor(S/4294967296),v[(N+64>>>9<<4)+15]=S,p.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p}});l.SHA256=i._createHelper(f),l.HmacSHA256=i._createHmacHelper(f)}(Math),n.SHA256})}(au)),au.exports}var iu={exports:{}},Jf;function TC(){return Jf||(Jf=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Z0())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=s.algo,i=a.SHA256,u=a.SHA224=i.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=i._doFinalize.call(this);return c.sigBytes-=4,c}});s.SHA224=i._createHelper(u),s.HmacSHA224=i._createHmacHelper(u)}(),n.SHA224})}(iu)),iu.exports}var cu={exports:{}},eh;function ib(){return eh||(eh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),pc())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.Hasher,a=s.x64,i=a.Word,u=a.WordArray,c=s.algo;function d(){return i.create.apply(i,arguments)}var h=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],f=[];(function(){for(var v=0;v<80;v++)f[v]=d()})();var p=c.SHA512=o.extend({_doReset:function(){this._hash=new u.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(v,S){for(var N=this._hash.words,E=N[0],g=N[1],y=N[2],b=N[3],T=N[4],A=N[5],C=N[6],_=N[7],L=E.high,I=E.low,j=g.high,D=g.low,M=y.high,U=y.low,$=b.high,B=b.low,k=T.high,H=T.low,F=A.high,Z=A.low,z=C.high,q=C.low,Y=_.high,V=_.low,R=L,X=I,W=j,G=D,P=M,Q=U,K=$,ae=B,O=k,se=H,J=F,re=Z,ie=z,le=q,pe=Y,ee=V,ue=0;ue<80;ue++){var fe,ye,Re=f[ue];if(ue<16)ye=Re.high=v[S+ue*2]|0,fe=Re.low=v[S+ue*2+1]|0;else{var ne=f[ue-15],ge=ne.high,ke=ne.low,te=(ge>>>1|ke<<31)^(ge>>>8|ke<<24)^ge>>>7,xe=(ke>>>1|ge<<31)^(ke>>>8|ge<<24)^(ke>>>7|ge<<25),he=f[ue-2],be=he.high,ve=he.low,$e=(be>>>19|ve<<13)^(be<<3|ve>>>29)^be>>>6,ot=(ve>>>19|be<<13)^(ve<<3|be>>>29)^(ve>>>6|be<<26),_n=f[ue-7],Ee=_n.high,Ie=_n.low,Be=f[ue-16],at=Be.high,gn=Be.low;fe=xe+Ie,ye=te+Ee+(fe>>>0<xe>>>0?1:0),fe=fe+ot,ye=ye+$e+(fe>>>0<ot>>>0?1:0),fe=fe+gn,ye=ye+at+(fe>>>0<gn>>>0?1:0),Re.high=ye,Re.low=fe}var At=O&J^~O&ie,gt=se&re^~se&le,_e=R&W^R&P^W&P,Ps=X&G^X&Q^G&Q,jt=(R>>>28|X<<4)^(R<<30|X>>>2)^(R<<25|X>>>7),Ln=(X>>>28|R<<4)^(X<<30|R>>>2)^(X<<25|R>>>7),Eb=(O>>>14|se<<18)^(O>>>18|se<<14)^(O<<23|se>>>9),Nb=(se>>>14|O<<18)^(se>>>18|O<<14)^(se<<23|O>>>9),mx=h[ue],Sb=mx.high,fx=mx.low,Bn=ee+Nb,Gs=pe+Eb+(Bn>>>0<ee>>>0?1:0),Bn=Bn+gt,Gs=Gs+At+(Bn>>>0<gt>>>0?1:0),Bn=Bn+fx,Gs=Gs+Sb+(Bn>>>0<fx>>>0?1:0),Bn=Bn+fe,Gs=Gs+ye+(Bn>>>0<fe>>>0?1:0),hx=Ln+Ps,wb=jt+_e+(hx>>>0<Ln>>>0?1:0);pe=ie,ee=le,ie=J,le=re,J=O,re=se,se=ae+Bn|0,O=K+Gs+(se>>>0<ae>>>0?1:0)|0,K=P,ae=Q,P=W,Q=G,W=R,G=X,X=Bn+hx|0,R=Gs+wb+(X>>>0<Bn>>>0?1:0)|0}I=E.low=I+X,E.high=L+R+(I>>>0<X>>>0?1:0),D=g.low=D+G,g.high=j+W+(D>>>0<G>>>0?1:0),U=y.low=U+Q,y.high=M+P+(U>>>0<Q>>>0?1:0),B=b.low=B+ae,b.high=$+K+(B>>>0<ae>>>0?1:0),H=T.low=H+se,T.high=k+O+(H>>>0<se>>>0?1:0),Z=A.low=Z+re,A.high=F+J+(Z>>>0<re>>>0?1:0),q=C.low=q+le,C.high=z+ie+(q>>>0<le>>>0?1:0),V=_.low=V+ee,_.high=Y+pe+(V>>>0<ee>>>0?1:0)},_doFinalize:function(){var v=this._data,S=v.words,N=this._nDataBytes*8,E=v.sigBytes*8;S[E>>>5]|=128<<24-E%32,S[(E+128>>>10<<5)+30]=Math.floor(N/4294967296),S[(E+128>>>10<<5)+31]=N,v.sigBytes=S.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v},blockSize:1024/32});s.SHA512=o._createHelper(p),s.HmacSHA512=o._createHmacHelper(p)}(),n.SHA512})}(cu)),cu.exports}var uu={exports:{}},th;function _C(){return th||(th=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),pc(),ib())})(Ge,function(n){return function(){var s=n,l=s.x64,o=l.Word,a=l.WordArray,i=s.algo,u=i.SHA512,c=i.SHA384=u.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var d=u._doFinalize.call(this);return d.sigBytes-=16,d}});s.SHA384=u._createHelper(c),s.HmacSHA384=u._createHmacHelper(c)}(),n.SHA384})}(uu)),uu.exports}var du={exports:{}},nh;function jC(){return nh||(nh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),pc())})(Ge,function(n){return function(s){var l=n,o=l.lib,a=o.WordArray,i=o.Hasher,u=l.x64,c=u.Word,d=l.algo,h=[],f=[],p=[];(function(){for(var N=1,E=0,g=0;g<24;g++){h[N+5*E]=(g+1)*(g+2)/2%64;var y=E%5,b=(2*N+3*E)%5;N=y,E=b}for(var N=0;N<5;N++)for(var E=0;E<5;E++)f[N+5*E]=E+(2*N+3*E)%5*5;for(var T=1,A=0;A<24;A++){for(var C=0,_=0,L=0;L<7;L++){if(T&1){var I=(1<<L)-1;I<32?_^=1<<I:C^=1<<I-32}T&128?T=T<<1^113:T<<=1}p[A]=c.create(C,_)}})();var v=[];(function(){for(var N=0;N<25;N++)v[N]=c.create()})();var S=d.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var N=this._state=[],E=0;E<25;E++)N[E]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(N,E){for(var g=this._state,y=this.blockSize/2,b=0;b<y;b++){var T=N[E+2*b],A=N[E+2*b+1];T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var C=g[b];C.high^=A,C.low^=T}for(var _=0;_<24;_++){for(var L=0;L<5;L++){for(var I=0,j=0,D=0;D<5;D++){var C=g[L+5*D];I^=C.high,j^=C.low}var M=v[L];M.high=I,M.low=j}for(var L=0;L<5;L++)for(var U=v[(L+4)%5],$=v[(L+1)%5],B=$.high,k=$.low,I=U.high^(B<<1|k>>>31),j=U.low^(k<<1|B>>>31),D=0;D<5;D++){var C=g[L+5*D];C.high^=I,C.low^=j}for(var H=1;H<25;H++){var I,j,C=g[H],F=C.high,Z=C.low,z=h[H];z<32?(I=F<<z|Z>>>32-z,j=Z<<z|F>>>32-z):(I=Z<<z-32|F>>>64-z,j=F<<z-32|Z>>>64-z);var q=v[f[H]];q.high=I,q.low=j}var Y=v[0],V=g[0];Y.high=V.high,Y.low=V.low;for(var L=0;L<5;L++)for(var D=0;D<5;D++){var H=L+5*D,C=g[H],R=v[H],X=v[(L+1)%5+5*D],W=v[(L+2)%5+5*D];C.high=R.high^~X.high&W.high,C.low=R.low^~X.low&W.low}var C=g[0],G=p[_];C.high^=G.high,C.low^=G.low}},_doFinalize:function(){var N=this._data,E=N.words;this._nDataBytes*8;var g=N.sigBytes*8,y=this.blockSize*32;E[g>>>5]|=1<<24-g%32,E[(s.ceil((g+1)/y)*y>>>5)-1]|=128,N.sigBytes=E.length*4,this._process();for(var b=this._state,T=this.cfg.outputLength/8,A=T/8,C=[],_=0;_<A;_++){var L=b[_],I=L.high,j=L.low;I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,j=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,C.push(j),C.push(I)}return new a.init(C,T)},clone:function(){for(var N=i.clone.call(this),E=N._state=this._state.slice(0),g=0;g<25;g++)E[g]=E[g].clone();return N}});l.SHA3=i._createHelper(S),l.HmacSHA3=i._createHmacHelper(S)}(Math),n.SHA3})}(du)),du.exports}var xu={exports:{}},sh;function RC(){return sh||(sh=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var l=n,o=l.lib,a=o.WordArray,i=o.Hasher,u=l.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),d=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),h=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=a.create([0,1518500249,1859775393,2400959708,2840853838]),v=a.create([1352829926,1548603684,1836072691,2053994217,0]),S=u.RIPEMD160=i.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,C){for(var _=0;_<16;_++){var L=C+_,I=A[L];A[L]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}var j=this._hash.words,D=p.words,M=v.words,U=c.words,$=d.words,B=h.words,k=f.words,H,F,Z,z,q,Y,V,R,X,W;Y=H=j[0],V=F=j[1],R=Z=j[2],X=z=j[3],W=q=j[4];for(var G,_=0;_<80;_+=1)G=H+A[C+U[_]]|0,_<16?G+=N(F,Z,z)+D[0]:_<32?G+=E(F,Z,z)+D[1]:_<48?G+=g(F,Z,z)+D[2]:_<64?G+=y(F,Z,z)+D[3]:G+=b(F,Z,z)+D[4],G=G|0,G=T(G,B[_]),G=G+q|0,H=q,q=z,z=T(Z,10),Z=F,F=G,G=Y+A[C+$[_]]|0,_<16?G+=b(V,R,X)+M[0]:_<32?G+=y(V,R,X)+M[1]:_<48?G+=g(V,R,X)+M[2]:_<64?G+=E(V,R,X)+M[3]:G+=N(V,R,X)+M[4],G=G|0,G=T(G,k[_]),G=G+W|0,Y=W,W=X,X=T(R,10),R=V,V=G;G=j[1]+Z+X|0,j[1]=j[2]+z+W|0,j[2]=j[3]+q+Y|0,j[3]=j[4]+H+V|0,j[4]=j[0]+F+R|0,j[0]=G},_doFinalize:function(){var A=this._data,C=A.words,_=this._nDataBytes*8,L=A.sigBytes*8;C[L>>>5]|=128<<24-L%32,C[(L+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,A.sigBytes=(C.length+1)*4,this._process();for(var I=this._hash,j=I.words,D=0;D<5;D++){var M=j[D];j[D]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360}return I},clone:function(){var A=i.clone.call(this);return A._hash=this._hash.clone(),A}});function N(A,C,_){return A^C^_}function E(A,C,_){return A&C|~A&_}function g(A,C,_){return(A|~C)^_}function y(A,C,_){return A&_|C&~_}function b(A,C,_){return A^(C|~_)}function T(A,C){return A<<C|A>>>32-C}l.RIPEMD160=i._createHelper(S),l.HmacRIPEMD160=i._createHmacHelper(S)}(),n.RIPEMD160})}(xu)),xu.exports}var mu={exports:{}},rh;function J0(){return rh||(rh=1,function(e,t){(function(n,s){e.exports=s(Ye())})(Ge,function(n){(function(){var s=n,l=s.lib,o=l.Base,a=s.enc,i=a.Utf8,u=s.algo;u.HMAC=o.extend({init:function(c,d){c=this._hasher=new c.init,typeof d=="string"&&(d=i.parse(d));var h=c.blockSize,f=h*4;d.sigBytes>f&&(d=c.finalize(d)),d.clamp();for(var p=this._oKey=d.clone(),v=this._iKey=d.clone(),S=p.words,N=v.words,E=0;E<h;E++)S[E]^=1549556828,N[E]^=909522486;p.sigBytes=v.sigBytes=f,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var d=this._hasher,h=d.finalize(c);d.reset();var f=d.finalize(this._oKey.clone().concat(h));return f}})})()})}(mu)),mu.exports}var fu={exports:{}},lh;function IC(){return lh||(lh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Z0(),J0())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.Base,a=l.WordArray,i=s.algo,u=i.SHA256,c=i.HMAC,d=i.PBKDF2=o.extend({cfg:o.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,f){for(var p=this.cfg,v=c.create(p.hasher,h),S=a.create(),N=a.create([1]),E=S.words,g=N.words,y=p.keySize,b=p.iterations;E.length<y;){var T=v.update(f).finalize(N);v.reset();for(var A=T.words,C=A.length,_=T,L=1;L<b;L++){_=v.finalize(_),v.reset();for(var I=_.words,j=0;j<C;j++)A[j]^=I[j]}S.concat(T),g[0]++}return S.sigBytes=y*4,S}});s.PBKDF2=function(h,f,p){return d.create(p).compute(h,f)}}(),n.PBKDF2})}(fu)),fu.exports}var hu={exports:{}},oh;function vr(){return oh||(oh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),ab(),J0())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.Base,a=l.WordArray,i=s.algo,u=i.MD5,c=i.EvpKDF=o.extend({cfg:o.extend({keySize:128/32,hasher:u,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,h){for(var f,p=this.cfg,v=p.hasher.create(),S=a.create(),N=S.words,E=p.keySize,g=p.iterations;N.length<E;){f&&v.update(f),f=v.update(d).finalize(h),v.reset();for(var y=1;y<g;y++)f=v.finalize(f),v.reset();S.concat(f)}return S.sigBytes=E*4,S}});s.EvpKDF=function(d,h,f){return c.create(f).compute(d,h)}}(),n.EvpKDF})}(hu)),hu.exports}var pu={exports:{}},ah;function an(){return ah||(ah=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),vr())})(Ge,function(n){n.lib.Cipher||function(s){var l=n,o=l.lib,a=o.Base,i=o.WordArray,u=o.BufferedBlockAlgorithm,c=l.enc;c.Utf8;var d=c.Base64,h=l.algo,f=h.EvpKDF,p=o.Cipher=u.extend({cfg:a.extend(),createEncryptor:function(I,j){return this.create(this._ENC_XFORM_MODE,I,j)},createDecryptor:function(I,j){return this.create(this._DEC_XFORM_MODE,I,j)},init:function(I,j,D){this.cfg=this.cfg.extend(D),this._xformMode=I,this._key=j,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(I){return this._append(I),this._process()},finalize:function(I){I&&this._append(I);var j=this._doFinalize();return j},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function I(j){return typeof j=="string"?L:A}return function(j){return{encrypt:function(D,M,U){return I(M).encrypt(j,D,M,U)},decrypt:function(D,M,U){return I(M).decrypt(j,D,M,U)}}}}()});o.StreamCipher=p.extend({_doFinalize:function(){var I=this._process(!0);return I},blockSize:1});var v=l.mode={},S=o.BlockCipherMode=a.extend({createEncryptor:function(I,j){return this.Encryptor.create(I,j)},createDecryptor:function(I,j){return this.Decryptor.create(I,j)},init:function(I,j){this._cipher=I,this._iv=j}}),N=v.CBC=function(){var I=S.extend();I.Encryptor=I.extend({processBlock:function(D,M){var U=this._cipher,$=U.blockSize;j.call(this,D,M,$),U.encryptBlock(D,M),this._prevBlock=D.slice(M,M+$)}}),I.Decryptor=I.extend({processBlock:function(D,M){var U=this._cipher,$=U.blockSize,B=D.slice(M,M+$);U.decryptBlock(D,M),j.call(this,D,M,$),this._prevBlock=B}});function j(D,M,U){var $,B=this._iv;B?($=B,this._iv=s):$=this._prevBlock;for(var k=0;k<U;k++)D[M+k]^=$[k]}return I}(),E=l.pad={},g=E.Pkcs7={pad:function(I,j){for(var D=j*4,M=D-I.sigBytes%D,U=M<<24|M<<16|M<<8|M,$=[],B=0;B<M;B+=4)$.push(U);var k=i.create($,M);I.concat(k)},unpad:function(I){var j=I.words[I.sigBytes-1>>>2]&255;I.sigBytes-=j}};o.BlockCipher=p.extend({cfg:p.cfg.extend({mode:N,padding:g}),reset:function(){var I;p.reset.call(this);var j=this.cfg,D=j.iv,M=j.mode;this._xformMode==this._ENC_XFORM_MODE?I=M.createEncryptor:(I=M.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==I?this._mode.init(this,D&&D.words):(this._mode=I.call(M,this,D&&D.words),this._mode.__creator=I)},_doProcessBlock:function(I,j){this._mode.processBlock(I,j)},_doFinalize:function(){var I,j=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(j.pad(this._data,this.blockSize),I=this._process(!0)):(I=this._process(!0),j.unpad(I)),I},blockSize:128/32});var y=o.CipherParams=a.extend({init:function(I){this.mixIn(I)},toString:function(I){return(I||this.formatter).stringify(this)}}),b=l.format={},T=b.OpenSSL={stringify:function(I){var j,D=I.ciphertext,M=I.salt;return M?j=i.create([1398893684,1701076831]).concat(M).concat(D):j=D,j.toString(d)},parse:function(I){var j,D=d.parse(I),M=D.words;return M[0]==1398893684&&M[1]==1701076831&&(j=i.create(M.slice(2,4)),M.splice(0,4),D.sigBytes-=16),y.create({ciphertext:D,salt:j})}},A=o.SerializableCipher=a.extend({cfg:a.extend({format:T}),encrypt:function(I,j,D,M){M=this.cfg.extend(M);var U=I.createEncryptor(D,M),$=U.finalize(j),B=U.cfg;return y.create({ciphertext:$,key:D,iv:B.iv,algorithm:I,mode:B.mode,padding:B.padding,blockSize:I.blockSize,formatter:M.format})},decrypt:function(I,j,D,M){M=this.cfg.extend(M),j=this._parse(j,M.format);var U=I.createDecryptor(D,M).finalize(j.ciphertext);return U},_parse:function(I,j){return typeof I=="string"?j.parse(I,this):I}}),C=l.kdf={},_=C.OpenSSL={execute:function(I,j,D,M,U){if(M||(M=i.random(64/8)),U)var $=f.create({keySize:j+D,hasher:U}).compute(I,M);else var $=f.create({keySize:j+D}).compute(I,M);var B=i.create($.words.slice(j),D*4);return $.sigBytes=j*4,y.create({key:$,iv:B,salt:M})}},L=o.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:_}),encrypt:function(I,j,D,M){M=this.cfg.extend(M);var U=M.kdf.execute(D,I.keySize,I.ivSize,M.salt,M.hasher);M.iv=U.iv;var $=A.encrypt.call(this,I,j,U.key,M);return $.mixIn(U),$},decrypt:function(I,j,D,M){M=this.cfg.extend(M),j=this._parse(j,M.format);var U=M.kdf.execute(D,I.keySize,I.ivSize,j.salt,M.hasher);M.iv=U.iv;var $=A.decrypt.call(this,I,j,U.key,M);return $}})}()})}(pu)),pu.exports}var gu={exports:{}},ih;function MC(){return ih||(ih=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.mode.CFB=function(){var s=n.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(o,a){var i=this._cipher,u=i.blockSize;l.call(this,o,a,u,i),this._prevBlock=o.slice(a,a+u)}}),s.Decryptor=s.extend({processBlock:function(o,a){var i=this._cipher,u=i.blockSize,c=o.slice(a,a+u);l.call(this,o,a,u,i),this._prevBlock=c}});function l(o,a,i,u){var c,d=this._iv;d?(c=d.slice(0),this._iv=void 0):c=this._prevBlock,u.encryptBlock(c,0);for(var h=0;h<i;h++)o[a+h]^=c[h]}return s}(),n.mode.CFB})}(gu)),gu.exports}var yu={exports:{}},ch;function DC(){return ch||(ch=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.mode.CTR=function(){var s=n.lib.BlockCipherMode.extend(),l=s.Encryptor=s.extend({processBlock:function(o,a){var i=this._cipher,u=i.blockSize,c=this._iv,d=this._counter;c&&(d=this._counter=c.slice(0),this._iv=void 0);var h=d.slice(0);i.encryptBlock(h,0),d[u-1]=d[u-1]+1|0;for(var f=0;f<u;f++)o[a+f]^=h[f]}});return s.Decryptor=l,s}(),n.mode.CTR})}(yu)),yu.exports}var bu={exports:{}},uh;function OC(){return uh||(uh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var s=n.lib.BlockCipherMode.extend();function l(i){if((i>>24&255)===255){var u=i>>16&255,c=i>>8&255,d=i&255;u===255?(u=0,c===255?(c=0,d===255?d=0:++d):++c):++u,i=0,i+=u<<16,i+=c<<8,i+=d}else i+=1<<24;return i}function o(i){return(i[0]=l(i[0]))===0&&(i[1]=l(i[1])),i}var a=s.Encryptor=s.extend({processBlock:function(i,u){var c=this._cipher,d=c.blockSize,h=this._iv,f=this._counter;h&&(f=this._counter=h.slice(0),this._iv=void 0),o(f);var p=f.slice(0);c.encryptBlock(p,0);for(var v=0;v<d;v++)i[u+v]^=p[v]}});return s.Decryptor=a,s}(),n.mode.CTRGladman})}(bu)),bu.exports}var vu={exports:{}},dh;function kC(){return dh||(dh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.mode.OFB=function(){var s=n.lib.BlockCipherMode.extend(),l=s.Encryptor=s.extend({processBlock:function(o,a){var i=this._cipher,u=i.blockSize,c=this._iv,d=this._keystream;c&&(d=this._keystream=c.slice(0),this._iv=void 0),i.encryptBlock(d,0);for(var h=0;h<u;h++)o[a+h]^=d[h]}});return s.Decryptor=l,s}(),n.mode.OFB})}(vu)),vu.exports}var Eu={exports:{}},xh;function LC(){return xh||(xh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.mode.ECB=function(){var s=n.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(l,o){this._cipher.encryptBlock(l,o)}}),s.Decryptor=s.extend({processBlock:function(l,o){this._cipher.decryptBlock(l,o)}}),s}(),n.mode.ECB})}(Eu)),Eu.exports}var Nu={exports:{}},mh;function BC(){return mh||(mh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.pad.AnsiX923={pad:function(s,l){var o=s.sigBytes,a=l*4,i=a-o%a,u=o+i-1;s.clamp(),s.words[u>>>2]|=i<<24-u%4*8,s.sigBytes+=i},unpad:function(s){var l=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=l}},n.pad.Ansix923})}(Nu)),Nu.exports}var Su={exports:{}},fh;function UC(){return fh||(fh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.pad.Iso10126={pad:function(s,l){var o=l*4,a=o-s.sigBytes%o;s.concat(n.lib.WordArray.random(a-1)).concat(n.lib.WordArray.create([a<<24],1))},unpad:function(s){var l=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=l}},n.pad.Iso10126})}(Su)),Su.exports}var wu={exports:{}},hh;function PC(){return hh||(hh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.pad.Iso97971={pad:function(s,l){s.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(s,l)},unpad:function(s){n.pad.ZeroPadding.unpad(s),s.sigBytes--}},n.pad.Iso97971})}(wu)),wu.exports}var Cu={exports:{}},ph;function GC(){return ph||(ph=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.pad.ZeroPadding={pad:function(s,l){var o=l*4;s.clamp(),s.sigBytes+=o-(s.sigBytes%o||o)},unpad:function(s){for(var l=s.words,o=s.sigBytes-1,o=s.sigBytes-1;o>=0;o--)if(l[o>>>2]>>>24-o%4*8&255){s.sigBytes=o+1;break}}},n.pad.ZeroPadding})}(Cu)),Cu.exports}var Au={exports:{}},gh;function HC(){return gh||(gh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(Au)),Au.exports}var Tu={exports:{}},yh;function FC(){return yh||(yh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),an())})(Ge,function(n){return function(s){var l=n,o=l.lib,a=o.CipherParams,i=l.enc,u=i.Hex,c=l.format;c.Hex={stringify:function(d){return d.ciphertext.toString(u)},parse:function(d){var h=u.parse(d);return a.create({ciphertext:h})}}}(),n.format.Hex})}(Tu)),Tu.exports}var _u={exports:{}},bh;function qC(){return bh||(bh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.BlockCipher,a=s.algo,i=[],u=[],c=[],d=[],h=[],f=[],p=[],v=[],S=[],N=[];(function(){for(var y=[],b=0;b<256;b++)b<128?y[b]=b<<1:y[b]=b<<1^283;for(var T=0,A=0,b=0;b<256;b++){var C=A^A<<1^A<<2^A<<3^A<<4;C=C>>>8^C&255^99,i[T]=C,u[C]=T;var _=y[T],L=y[_],I=y[L],j=y[C]*257^C*16843008;c[T]=j<<24|j>>>8,d[T]=j<<16|j>>>16,h[T]=j<<8|j>>>24,f[T]=j;var j=I*16843009^L*65537^_*257^T*16843008;p[C]=j<<24|j>>>8,v[C]=j<<16|j>>>16,S[C]=j<<8|j>>>24,N[C]=j,T?(T=_^y[y[y[I^_]]],A^=y[y[A]]):T=A=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],g=a.AES=o.extend({_doReset:function(){var y;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var b=this._keyPriorReset=this._key,T=b.words,A=b.sigBytes/4,C=this._nRounds=A+6,_=(C+1)*4,L=this._keySchedule=[],I=0;I<_;I++)I<A?L[I]=T[I]:(y=L[I-1],I%A?A>6&&I%A==4&&(y=i[y>>>24]<<24|i[y>>>16&255]<<16|i[y>>>8&255]<<8|i[y&255]):(y=y<<8|y>>>24,y=i[y>>>24]<<24|i[y>>>16&255]<<16|i[y>>>8&255]<<8|i[y&255],y^=E[I/A|0]<<24),L[I]=L[I-A]^y);for(var j=this._invKeySchedule=[],D=0;D<_;D++){var I=_-D;if(D%4)var y=L[I];else var y=L[I-4];D<4||I<=4?j[D]=y:j[D]=p[i[y>>>24]]^v[i[y>>>16&255]]^S[i[y>>>8&255]]^N[i[y&255]]}}},encryptBlock:function(y,b){this._doCryptBlock(y,b,this._keySchedule,c,d,h,f,i)},decryptBlock:function(y,b){var T=y[b+1];y[b+1]=y[b+3],y[b+3]=T,this._doCryptBlock(y,b,this._invKeySchedule,p,v,S,N,u);var T=y[b+1];y[b+1]=y[b+3],y[b+3]=T},_doCryptBlock:function(y,b,T,A,C,_,L,I){for(var j=this._nRounds,D=y[b]^T[0],M=y[b+1]^T[1],U=y[b+2]^T[2],$=y[b+3]^T[3],B=4,k=1;k<j;k++){var H=A[D>>>24]^C[M>>>16&255]^_[U>>>8&255]^L[$&255]^T[B++],F=A[M>>>24]^C[U>>>16&255]^_[$>>>8&255]^L[D&255]^T[B++],Z=A[U>>>24]^C[$>>>16&255]^_[D>>>8&255]^L[M&255]^T[B++],z=A[$>>>24]^C[D>>>16&255]^_[M>>>8&255]^L[U&255]^T[B++];D=H,M=F,U=Z,$=z}var H=(I[D>>>24]<<24|I[M>>>16&255]<<16|I[U>>>8&255]<<8|I[$&255])^T[B++],F=(I[M>>>24]<<24|I[U>>>16&255]<<16|I[$>>>8&255]<<8|I[D&255])^T[B++],Z=(I[U>>>24]<<24|I[$>>>16&255]<<16|I[D>>>8&255]<<8|I[M&255])^T[B++],z=(I[$>>>24]<<24|I[D>>>16&255]<<16|I[M>>>8&255]<<8|I[U&255])^T[B++];y[b]=H,y[b+1]=F,y[b+2]=Z,y[b+3]=z},keySize:256/32});s.AES=o._createHelper(g)}(),n.AES})}(_u)),_u.exports}var ju={exports:{}},vh;function $C(){return vh||(vh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.WordArray,a=l.BlockCipher,i=s.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=i.DES=a.extend({_doReset:function(){for(var E=this._key,g=E.words,y=[],b=0;b<56;b++){var T=u[b]-1;y[b]=g[T>>>5]>>>31-T%32&1}for(var A=this._subKeys=[],C=0;C<16;C++){for(var _=A[C]=[],L=d[C],b=0;b<24;b++)_[b/6|0]|=y[(c[b]-1+L)%28]<<31-b%6,_[4+(b/6|0)]|=y[28+(c[b+24]-1+L)%28]<<31-b%6;_[0]=_[0]<<1|_[0]>>>31;for(var b=1;b<7;b++)_[b]=_[b]>>>(b-1)*4+3;_[7]=_[7]<<5|_[7]>>>27}for(var I=this._invSubKeys=[],b=0;b<16;b++)I[b]=A[15-b]},encryptBlock:function(E,g){this._doCryptBlock(E,g,this._subKeys)},decryptBlock:function(E,g){this._doCryptBlock(E,g,this._invSubKeys)},_doCryptBlock:function(E,g,y){this._lBlock=E[g],this._rBlock=E[g+1],v.call(this,4,252645135),v.call(this,16,65535),S.call(this,2,858993459),S.call(this,8,16711935),v.call(this,1,1431655765);for(var b=0;b<16;b++){for(var T=y[b],A=this._lBlock,C=this._rBlock,_=0,L=0;L<8;L++)_|=h[L][((C^T[L])&f[L])>>>0];this._lBlock=C,this._rBlock=A^_}var I=this._lBlock;this._lBlock=this._rBlock,this._rBlock=I,v.call(this,1,1431655765),S.call(this,8,16711935),S.call(this,2,858993459),v.call(this,16,65535),v.call(this,4,252645135),E[g]=this._lBlock,E[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function v(E,g){var y=(this._lBlock>>>E^this._rBlock)&g;this._rBlock^=y,this._lBlock^=y<<E}function S(E,g){var y=(this._rBlock>>>E^this._lBlock)&g;this._lBlock^=y,this._rBlock^=y<<E}s.DES=a._createHelper(p);var N=i.TripleDES=a.extend({_doReset:function(){var E=this._key,g=E.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var y=g.slice(0,2),b=g.length<4?g.slice(0,2):g.slice(2,4),T=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=p.createEncryptor(o.create(y)),this._des2=p.createEncryptor(o.create(b)),this._des3=p.createEncryptor(o.create(T))},encryptBlock:function(E,g){this._des1.encryptBlock(E,g),this._des2.decryptBlock(E,g),this._des3.encryptBlock(E,g)},decryptBlock:function(E,g){this._des3.decryptBlock(E,g),this._des2.encryptBlock(E,g),this._des1.decryptBlock(E,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=a._createHelper(N)}(),n.TripleDES})}(ju)),ju.exports}var Ru={exports:{}},Eh;function VC(){return Eh||(Eh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.StreamCipher,a=s.algo,i=a.RC4=o.extend({_doReset:function(){for(var d=this._key,h=d.words,f=d.sigBytes,p=this._S=[],v=0;v<256;v++)p[v]=v;for(var v=0,S=0;v<256;v++){var N=v%f,E=h[N>>>2]>>>24-N%4*8&255;S=(S+p[v]+E)%256;var g=p[v];p[v]=p[S],p[S]=g}this._i=this._j=0},_doProcessBlock:function(d,h){d[h]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var d=this._S,h=this._i,f=this._j,p=0,v=0;v<4;v++){h=(h+1)%256,f=(f+d[h])%256;var S=d[h];d[h]=d[f],d[f]=S,p|=d[(d[h]+d[f])%256]<<24-v*8}return this._i=h,this._j=f,p}s.RC4=o._createHelper(i);var c=a.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var d=this.cfg.drop;d>0;d--)u.call(this)}});s.RC4Drop=o._createHelper(c)}(),n.RC4})}(Ru)),Ru.exports}var Iu={exports:{}},Nh;function zC(){return Nh||(Nh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.StreamCipher,a=s.algo,i=[],u=[],c=[],d=a.Rabbit=o.extend({_doReset:function(){for(var f=this._key.words,p=this.cfg.iv,v=0;v<4;v++)f[v]=(f[v]<<8|f[v]>>>24)&16711935|(f[v]<<24|f[v]>>>8)&4278255360;var S=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],N=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var v=0;v<4;v++)h.call(this);for(var v=0;v<8;v++)N[v]^=S[v+4&7];if(p){var E=p.words,g=E[0],y=E[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,T=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,A=b>>>16|T&4294901760,C=T<<16|b&65535;N[0]^=b,N[1]^=A,N[2]^=T,N[3]^=C,N[4]^=b,N[5]^=A,N[6]^=T,N[7]^=C;for(var v=0;v<4;v++)h.call(this)}},_doProcessBlock:function(f,p){var v=this._X;h.call(this),i[0]=v[0]^v[5]>>>16^v[3]<<16,i[1]=v[2]^v[7]>>>16^v[5]<<16,i[2]=v[4]^v[1]>>>16^v[7]<<16,i[3]=v[6]^v[3]>>>16^v[1]<<16;for(var S=0;S<4;S++)i[S]=(i[S]<<8|i[S]>>>24)&16711935|(i[S]<<24|i[S]>>>8)&4278255360,f[p+S]^=i[S]},blockSize:128/32,ivSize:64/32});function h(){for(var f=this._X,p=this._C,v=0;v<8;v++)u[v]=p[v];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<u[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<u[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<u[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<u[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<u[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<u[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<u[6]>>>0?1:0)|0,this._b=p[7]>>>0<u[7]>>>0?1:0;for(var v=0;v<8;v++){var S=f[v]+p[v],N=S&65535,E=S>>>16,g=((N*N>>>17)+N*E>>>15)+E*E,y=((S&4294901760)*S|0)+((S&65535)*S|0);c[v]=g^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}s.Rabbit=o._createHelper(d)}(),n.Rabbit})}(Iu)),Iu.exports}var Mu={exports:{}},Sh;function QC(){return Sh||(Sh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.StreamCipher,a=s.algo,i=[],u=[],c=[],d=a.RabbitLegacy=o.extend({_doReset:function(){var f=this._key.words,p=this.cfg.iv,v=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],S=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var N=0;N<4;N++)h.call(this);for(var N=0;N<8;N++)S[N]^=v[N+4&7];if(p){var E=p.words,g=E[0],y=E[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,T=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,A=b>>>16|T&4294901760,C=T<<16|b&65535;S[0]^=b,S[1]^=A,S[2]^=T,S[3]^=C,S[4]^=b,S[5]^=A,S[6]^=T,S[7]^=C;for(var N=0;N<4;N++)h.call(this)}},_doProcessBlock:function(f,p){var v=this._X;h.call(this),i[0]=v[0]^v[5]>>>16^v[3]<<16,i[1]=v[2]^v[7]>>>16^v[5]<<16,i[2]=v[4]^v[1]>>>16^v[7]<<16,i[3]=v[6]^v[3]>>>16^v[1]<<16;for(var S=0;S<4;S++)i[S]=(i[S]<<8|i[S]>>>24)&16711935|(i[S]<<24|i[S]>>>8)&4278255360,f[p+S]^=i[S]},blockSize:128/32,ivSize:64/32});function h(){for(var f=this._X,p=this._C,v=0;v<8;v++)u[v]=p[v];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<u[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<u[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<u[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<u[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<u[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<u[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<u[6]>>>0?1:0)|0,this._b=p[7]>>>0<u[7]>>>0?1:0;for(var v=0;v<8;v++){var S=f[v]+p[v],N=S&65535,E=S>>>16,g=((N*N>>>17)+N*E>>>15)+E*E,y=((S&4294901760)*S|0)+((S&65535)*S|0);c[v]=g^y}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}s.RabbitLegacy=o._createHelper(d)}(),n.RabbitLegacy})}(Mu)),Mu.exports}var Du={exports:{}},wh;function YC(){return wh||(wh=1,function(e,t){(function(n,s,l){e.exports=s(Ye(),Hr(),Fr(),vr(),an())})(Ge,function(n){return function(){var s=n,l=s.lib,o=l.BlockCipher,a=s.algo;const i=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var d={pbox:[],sbox:[]};function h(N,E){let g=E>>24&255,y=E>>16&255,b=E>>8&255,T=E&255,A=N.sbox[0][g]+N.sbox[1][y];return A=A^N.sbox[2][b],A=A+N.sbox[3][T],A}function f(N,E,g){let y=E,b=g,T;for(let A=0;A<i;++A)y=y^N.pbox[A],b=h(N,y)^b,T=y,y=b,b=T;return T=y,y=b,b=T,b=b^N.pbox[i],y=y^N.pbox[i+1],{left:y,right:b}}function p(N,E,g){let y=E,b=g,T;for(let A=i+1;A>1;--A)y=y^N.pbox[A],b=h(N,y)^b,T=y,y=b,b=T;return T=y,y=b,b=T,b=b^N.pbox[1],y=y^N.pbox[0],{left:y,right:b}}function v(N,E,g){for(let C=0;C<4;C++){N.sbox[C]=[];for(let _=0;_<256;_++)N.sbox[C][_]=c[C][_]}let y=0;for(let C=0;C<i+2;C++)N.pbox[C]=u[C]^E[y],y++,y>=g&&(y=0);let b=0,T=0,A=0;for(let C=0;C<i+2;C+=2)A=f(N,b,T),b=A.left,T=A.right,N.pbox[C]=b,N.pbox[C+1]=T;for(let C=0;C<4;C++)for(let _=0;_<256;_+=2)A=f(N,b,T),b=A.left,T=A.right,N.sbox[C][_]=b,N.sbox[C][_+1]=T;return!0}var S=a.Blowfish=o.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var N=this._keyPriorReset=this._key,E=N.words,g=N.sigBytes/4;v(d,E,g)}},encryptBlock:function(N,E){var g=f(d,N[E],N[E+1]);N[E]=g.left,N[E+1]=g.right},decryptBlock:function(N,E){var g=p(d,N[E],N[E+1]);N[E]=g.left,N[E+1]=g.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=o._createHelper(S)}(),n.Blowfish})}(Du)),Du.exports}(function(e,t){(function(n,s,l){e.exports=s(Ye(),pc(),wC(),CC(),Hr(),AC(),Fr(),ab(),Z0(),TC(),ib(),_C(),jC(),RC(),J0(),IC(),vr(),an(),MC(),DC(),OC(),kC(),LC(),BC(),UC(),PC(),GC(),HC(),FC(),qC(),$C(),VC(),zC(),QC(),YC())})(Ge,function(n){return n})})(ob);var WC=ob.exports;const XC=Fh(WC),KC="lwd-gemini-super-secret-salt-for-local-hashing",Xd=e=>XC.SHA256(e+KC).toString(),Ch=(e,t)=>Xd(e)===t;function rn(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const gc="lwdUserApiKey";let al=null;const Se="gemini-2.5-flash-preview-04-17",ex=()=>!localStorage.getItem(gc),cb=e=>{localStorage.setItem(gc,e),al=new lb({apiKey:e})},ub=()=>localStorage.getItem(gc),ZC=()=>{localStorage.removeItem(gc),al=null};function we(){if(al)return al;const e=ub();if(!e)throw new Error("API Key is not set. Please set it in the application settings.");return al=new lb({apiKey:e}),al}const JC=e=>{let t=e.trim();const n=/```(json)?\s*\n?(.*?)\n?\s*```/s,s=t.match(n);s&&s[2]&&(t=s[2].trim());const l=t.indexOf("["),o=t.lastIndexOf("]"),a=t.indexOf("{"),i=t.lastIndexOf("}"),u=l!==-1&&o>l,c=a!==-1&&i>a;return u&&(!c||l<a)?t.substring(l,o+1):c?t.substring(a,i+1):t},Ae=(e,t)=>{if(!e)throw new Error(`Received an empty API response for ${t}.`);const n=JC(e);try{return JSON.parse(n)}catch(s){throw console.error(`Failed to parse JSON for ${t}:`,s,"Raw:",e,"Sanitized (len: "+n.length+"):",n,"Sanitized End (last 10 chars):",n.slice(-10)),new Error(`API response for ${t} is not valid JSON. Content: ${n.substring(0,100)}...`)}},pl=2,db=1e3;async function je(e,t,n,s){if(ex())throw new Error(`API key is not configured. Cannot make API call for ${n}.`);let l=0;for(;l<=pl;)try{const o=await e();let a=Array.isArray(o)?o.map(u=>u.text).join(""):o.text;return a=a??"",t(a,n)}catch(o){if(l++,console.warn(`Attempt ${l} failed for ${n}:`,o),l>pl)throw console.error(`All ${pl+1} attempts failed for ${n}.`),o instanceof Error?new Error(`Gemini API error after retries (${n}): ${o.message}`):new Error(`Gemini API error after retries (${n}): An unknown error occurred.`);await new Promise(a=>setTimeout(a,db*l))}throw new Error(`Exhausted retries for ${n}. This should not happen.`)}async function bs(e,t){if(ex())throw new Error(`API key is not configured. Cannot make API call for ${t}.`);let n=0;for(;n<=pl;)try{const l=(await e()).text;if(!l||!l.trim())throw new Error(`AI    (${t}).`);return l}catch(s){if(n++,console.warn(`Attempt ${n} failed for text generation (${t}):`,s),n>pl)throw console.error(`All ${pl+1} text generation attempts failed for ${t}.`),s instanceof Error?new Error(`Gemini API error after retries (text generation - ${t}): ${s.message}`):new Error(`Gemini API error after retries (text generation - ${t}): An unknown error occurred.`);await new Promise(l=>setTimeout(l,db*n))}throw new Error(`Exhausted retries for text generation (${t}). This should not happen.`)}const eA=async e=>{const t="Similar question generation for review quiz",n=`
        .       ,    **   ** .
      , ,    ,           .

    -   : "${e.questionText}"
    -   : "${e.correctAnswer}"
    -   : "${e.explanation||" "}"

      ,     JSON  .     .
    
    JSON :
    {
      "question": "    ",
      "options": [" 1", " 2", " 3", " 4"],
      "answer_index": 0,
      "explanation": "    "
    }
    `,s=we();return je(()=>s.models.generateContent({model:Se,contents:n,config:{responseMimeType:"application/json"}}),(l,o)=>Ae(l,o),t)},tA=async()=>{const e="Korean literary text generation",t="    (,   ,  ) .   200 400  .        .",n=we();return bs(()=>n.models.generateContent({model:Se,contents:t}),e)},Ah=async e=>{var u,c,d;const t=`Korean literary text search (query: ${e})`,n=` : "${e}"

        .    200 500  .  ,      .  JSON  :
{
  "title": "   (     )",
  "author": "  (     )",
  "passage": "    (     )"
}`,l=await we().models.generateContent({model:Se,contents:n,config:{tools:[{googleSearch:{}}]}}),o=Ae(l.text??"",t);if(!o.passage||!o.passage.trim())throw new Error(`AI "${e}"      .`);let a;const i=(d=(c=(u=l.candidates)==null?void 0:u[0])==null?void 0:c.groundingMetadata)==null?void 0:d.groundingChunks;return i&&i.length>0&&i[0].web&&(a=i[0].web.uri),{title:o.title||e,author:o.author,content:o.passage,url:a}},nA=async(e,t)=>{const n="Korean literature user summary evaluation",s=`       .
: """${e.substring(0,1500)}${e.length>1500?"...":""}"""
 : """${t}"""
 :  ,    , ,   .
  ,     . 2-4 .
JSON  : {"feedback": "  "}`,l=we(),o=await je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n);if(!o.feedback)throw new Error("AI   .");return o},sA=async(e,t,n)=>{const s=`Korean literature MCQ generation (count: ${t}, difficulty: ${n})`,l=`       ${t} .
: """${e.substring(0,2e3)}${e.length>2e3?"... ()":""}"""
 : ${n}.
    4    .      ,     .       .
 (0-3)      .
JSON  .      :
{
  "question": " ",
  "options": ["1", "2", "3", "4"],
  "answer_index": 0,
  "explanation": " "
}
    : [{"question": "...", ...}, ...]`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),s);if(!Array.isArray(a)||a.some(i=>!i.question||!i.options||i.options.length!==4||i.answer_index===void 0||!i.explanation))throw new Error(`AI     . (${t} ).   .`);return a.slice(0,t)},rA=async(e,t,n)=>{const s=`Korean literature essay question generation (count: ${t}, difficulty: ${n})`,l=`    , '${n}'      ${t}  .     , ,     .      (solutionText)  .
: """${e.substring(0,2e3)}${e.length>2e3?"... ()":""}"""
JSON       : [{"questionText": "1 ", "solutionText": "1   ..."}, ...]`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),s);if(!Array.isArray(a)||!a.every(i=>typeof i.questionText=="string"&&i.questionText.trim()!==""&&typeof i.solutionText=="string"))throw new Error("AI      .");return a.slice(0,t)},lA=async(e,t,n,s,l)=>{const o="Korean literature essay answer evaluation",i=[{text:`   ,  ,    .
 (): """${e.substring(0,1e3)}..."""
: """${t}"""
 : """${n}"""
 : ${s}.
 :  ,  ,   , .
${l?"      ,      .":""}
0 20  ,    .
JSON  : {"score": 15, "feedback": "    ..."}`}];l&&i.push({inlineData:{mimeType:"image/png",data:l.split(",")[1]}});const u=we(),c=await je(()=>u.models.generateContent({model:Se,contents:[{role:"user",parts:i}],config:{responseMimeType:"application/json"}}),(d,h)=>Ae(d,h),o);if(typeof c.score!="number"||!c.feedback)throw new Error("AI     .");return c},oA=async(e,t,n,s)=>{const l="Korean literature weak points feedback generation",o=t.map(c=>`: "${c.originalQuestionText.substring(0,30)}..." :${c.isCorrectAttempt}`).join(`
`),a=n.map(c=>`: "${c.questionText.substring(0,30)}..." :${c.score||""}`).join(`
`),i=`       (: ${s}).
: """${e.substring(0,500)}..."""
 :
${o||"  "}
 :
${a||"  "}
      (1-2) ,     2-3 .`,u=we();return bs(()=>u.models.generateContent({model:Se,contents:i}),l)},aA=async(e,t)=>{const n=`Korean literary writing prompt (difficulty: ${e}, genre: ${t})`,s=`'{difficulty}'        .  '${t}'.
        2-3  .
JSON  : {"topic": "  ", "tips": ["1", "2"]}`,l=we(),o=await je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n);if(!o.topic||!o.tips)throw new Error("AI    .");return o},iA=async(e,t,n,s)=>{const l=`Korean literary writing evaluation (genre: ${s})`,o=`   '${s}'    . ( : ${n})
: """${e.topic}"""
 : """${t}"""
 :  , ,  ,    ,   .
0 100  ,   ,   ,    .
JSON  :
{"score": 85, "feedback": " ...", "strengths": [" 1", " 2"], "areasForImprovement": ["1", "2"]}`,a=we(),i=await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),l);if(typeof i.score!="number"||!i.feedback||!i.strengths||!i.areasForImprovement)throw new Error("AI     .");return i},cA=async(e,t)=>{const n=`Korean non-fiction text generation (difficulty: ${e}, type: ${t})`,s=e===me.ES_1_2?"150-250":e<=me.MS_1_2?"300-500":"500-700",l=`      :
-  : ${e}
-  : ${t} (: ${t===Et.EXPLANATORY?"  ,   ":"   ,   /"})
- :  ${s}
- :    
-       .`,o=we();return bs(()=>o.models.generateContent({model:Se,contents:l}),n)},uA=async(e,t,n)=>{var h,f,p;const s=`Korean non-fiction text search (topic: ${e}, type: ${n})`,l=t===me.ES_1_2?"150-250":t<=me.MS_1_2?"300-500":"500-700",o=`  : "${e}"
   '${n}'     .   ${l},   '${t}'.
 ,  ( URL ) ,       .
JSON  :
{
  "title": "      (  )",
  "passage": "   (     )",
  "topic": "${e}"
}`,i=await we().models.generateContent({model:Se,contents:o,config:{tools:[{googleSearch:{}}]}}),u=Ae(i.text??"",s);if(!u.passage||!u.passage.trim())throw new Error(`AI "${e}"     .`);let c;const d=(p=(f=(h=i.candidates)==null?void 0:h[0])==null?void 0:f.groundingMetadata)==null?void 0:p.groundingChunks;return d&&d.length>0&&d[0].web&&(c=d[0].web.uri),{title:u.title,content:u.passage,topic:u.topic||e,url:c}},dA=async(e,t,n,s)=>{const l="Korean non-fiction summary evaluation",o=s===Et.EXPLANATORY?50:30,a=`  (${s})     . ( : ${n})
: """${e.substring(0,1500)}${e.length>1500?"...":""}"""
 : """${t}"""
 :  (, ,   )  ,  ,  , .
${o}   ,    .
JSON  : {"score": ${Math.floor(o*.8)}, "feedback": " ..."}`,i=we(),u=await je(()=>i.models.generateContent({model:Se,contents:a,config:{responseMimeType:"application/json"}}),(c,d)=>Ae(c,d),l);if(typeof u.score!="number"||!u.feedback)throw new Error("AI     .");return u.score=Math.max(0,Math.min(o,u.score)),u},xA=async(e,t,n)=>{const s="Korean non-fiction (explanatory) essay question generation",l=`    , '${n}'      ${t}  .      ,  ,     .      (solutionText)  .
: """${e.substring(0,2e3)}${e.length>2e3?"... ()":""}"""
JSON       : [{"questionText": "1 ", "solutionText": "1   ..."}, ...]`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),s);if(!Array.isArray(a)||!a.every(i=>typeof i.questionText=="string"&&i.questionText.trim()!==""&&typeof i.solutionText=="string"))throw new Error("AI       .");return a.slice(0,t)},mA=async(e,t,n,s)=>{const l="Korean non-fiction (explanatory) essay answer evaluation",o=`   ,  ,   . ( : ${s})
 (): """${e.substring(0,1e3)}..."""
: """${t}"""
 : """${n}"""
 :   ,  ,  ,  .
0 25  ,    .
JSON  : {"score": 20, "feedback": "    ..."}`,a=we(),i=await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),l);if(typeof i.score!="number"||!i.feedback)throw new Error("AI      .");return i.score=Math.max(0,Math.min(25,i.score)),i},fA=async(e,t,n)=>{const s="Korean non-fiction claim/evidence evaluation",l=`      / . ( : ${n})
    : """${e.substring(0,1500)}..."""
     : "${t.claim}"
     :
    ${t.evidence.map((i,u)=>`-  ${u+1}: ${i}`).join(`
`)}

     :  ,    ,    ,   .
    20   ,    .
    JSON  : {"score": 15, "feedback": " ..."}`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),s);if(typeof a.score!="number"||!a.feedback)throw new Error("AI /   .");return a.score=Math.max(0,Math.min(20,a.score)),a},hA=async(e,t,n,s)=>{const l="Korean non-fiction counter-argument evaluation",o=`   ,  ,     . ( : ${s})
     (): """${e.substring(0,1500)}..."""
    / : "${t}"
     : "${n}"

     :  ,   ,     ,  .
    50   ,    .
    JSON  : {"score": 40, "feedback": " ..."}`,a=we(),i=await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),l);if(typeof i.score!="number"||!i.feedback)throw new Error("AI    .");return i.score=Math.max(0,Math.min(50,i.score)),i},Th=async(e,t,n,s,l,o,a,i)=>{const u="Korean non-fiction weak points feedback generation";let c="";if(n===Et.EXPLANATORY){const f=s;c=` : ${f.summary}/50,  : ${f.essays}/${((o==null?void 0:o.length)||0)*25}`}else{const f=s;c=` : ${f.summary}/30, / : ${f.claimEvidence}/20,  : ${f.counterArgument}/50}`}const d=`   (${n})    (: ${t}).
    : """${e.substring(0,500)}..."""
     :
    - ${c}
    -  : ${l||""}
    ${a?`- / : ${a}`:""}
    ${i?`-  : ${i}`:""}
    ${o?`-  : ${o.map(f=>{var p;return`Q: ${f.questionText.substring(0,20)}... Score: ${f.score}, Feedback: ${(p=f.feedback)==null?void 0:p.substring(0,30)}...`}).join(`
`)}`:""}

          (1-2) ,     2-3 .`,h=we();return bs(()=>h.models.generateContent({model:Se,contents:d}),u)},pA=async(e,t)=>{const n=`Korean non-fiction writing prompt (type: ${t})`,s=`'${e}'        .   '${t}'.
                2-3  .
    JSON  : {"topic": "  ", "tips": ["1", "2"]}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},gA=async(e,t,n,s)=>{const l=`Korean non-fiction writing evaluation (type: ${s})`,o=`   '${s}'    . ( : ${n})
    : """${e.topic}"""
     : """${t}"""
     :  ,  ,  ,  ,    .
    0 100  ,   ,   ,    .
    JSON  :
    {"score": 85, "feedback": " ...", "strengths": [" 1", " 2"], "areasForImprovement": ["1", "2"]}`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},yA=async(e,t)=>{const n=`Korean grammar concept generation (category: ${t})`,s=Py[t].join(", "),l=`    , '${e}'         .
    : "${t}" (  : ${s})
       (1)  , (2)      .
    JSON  :
    {
      "topic": "   ",
      "explanation": "    .",
      "examples_text": "    .    ."
    }`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),n);if(!a.topic||!a.explanation||!a.examples_text)throw new Error("AI    .");return{...a,topicName:a.topic,examplesText:a.examples_text,categoryKey:t,difficulty:e}},bA=async(e,t,n,s)=>{const l=`Korean grammar MCQ generation (topic: ${e})`,o=`     , '${s}'     ${n} .
     : "${e}"
       : """${t}"""
        4    .
     (0-3)      .
    JSON   : [{"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}, ...]`,a=we(),i=await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),l);if(!Array.isArray(i)||i.length===0)throw new Error("AI     .");return i},vA=async(e,t)=>{const n="Korean grammar essay evaluation",s=`          .  .
     : "${e.topicName}"
    AI    (): """${e.explanation}"""
      (  ): """${t}"""
     :     ,    .
    30   ,    .
    JSON  : {"score": 25, "feedback": " ..."}`,l=we(),o=await je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n);if(typeof o.score!="number"||!o.feedback)throw new Error("AI     .");return o.score=Math.max(0,Math.min(30,o.score)),o},EA=async(e,t,n,s)=>{const l="Korean grammar weak points feedback",o=t.map(u=>`Q: "${u.originalQuestionText.substring(0,20)}..." -> ${u.isCorrectAttempt?"":""}`).join(`
`),a=`    '${e.topicName}'  .
     :
    ${o}
       :
    - : ${n}/30
    - : ${s}
         ,      2-3 .`,i=we();return bs(()=>i.models.generateContent({model:Se,contents:a}),l)},NA=async e=>{const t="English reading text generation",n=`Generate a short English reading passage suitable for a learner at the '${e}' level. The passage should be about a general interest topic. Provide a title for the passage.
    Respond in JSON format: {"title": "The Generated Title", "content": "The generated English passage content..."}`,s=we(),l=await je(()=>s.models.generateContent({model:Se,contents:n,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),t);if(!l.title||!l.content)throw new Error("AI failed to generate a valid English reading text.");return{...l,sourceType:os.AI_GENERATED,difficulty:e}},SA=async(e,t)=>{var u,c,d,h,f,p;const n=`English reading text search (topic: ${e})`,s=`Find an English text passage about "${e}" suitable for a '${t}' level learner. The passage should be factual and informative. Provide a title and the source URL if possible.
    Respond in JSON format: {"title": "Found Title", "url": "http://source.url", "content": "The found English passage..."}`,o=await we().models.generateContent({model:Se,contents:s,config:{tools:[{googleSearch:{}}]}}),a=Ae(o.text??"",n);if(!a.content)throw new Error(`AI could not find content for the topic "${e}".`);const i=((p=(f=(h=(d=(c=(u=o.candidates)==null?void 0:u[0])==null?void 0:c.groundingMetadata)==null?void 0:d.groundingChunks)==null?void 0:h[0])==null?void 0:f.web)==null?void 0:p.uri)||a.url;return{...a,sourceType:os.TOPIC_SEARCH,difficulty:t,topic:e,url:i}},wA=async(e,t,n)=>{const s="English reading summary evaluation",l=`Evaluate the user's summary of the following English text. The user's proficiency is '${n}'.
    Original Text: """${e.substring(0,2e3)}..."""
    User's Summary: """${t}"""
    Evaluation criteria: Accuracy, inclusion of main ideas, conciseness, and grammatical correctness.
    Provide a score out of 30 and feedback in Korean.
    Respond in JSON format: {"score": 25, "feedback": " ..."}`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),s);if(typeof a.score!="number"||!a.feedback)throw new Error("AI failed to generate a valid summary evaluation.");return a.score=Math.max(0,Math.min(30,a.score)),a},_h=async(e,t,n)=>{const s="English reading MCQ generation",l=`Based on the following English text, generate ${t} multiple-choice questions suitable for a '${n}' level learner.
    Text: """${e.substring(0,2500)}..."""
    Each question should have 4 options. Include the 0-based index of the correct answer and a brief explanation in Korean.
    Respond in a JSON array format: [{"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}, ...]`,o=we();return je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),s)},jh=async(e,t,n)=>{const s="English reading essay question generation",l=`Based on the following English text, generate ${t} short essay questions suitable for a '${n}' level learner. The questions should test comprehension, inference, or analysis. Also provide a model answer (solutionText) for each question.
    Text: """${e.substring(0,2500)}..."""
    Respond in a JSON array format: [{"questionText": "...", "solutionText": "..."}, ...]`,o=we();return je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),s)},CA=async(e,t,n,s)=>{const l="English reading essay evaluation",o=`Evaluate the user's answer to an essay question based on an English text. Learner level is '${s}'.
    Text (for context): """${e.substring(0,1e3)}..."""
    Question: "${t}"
    User's Answer: "${n}"
    Evaluation criteria: Comprehension of the question, relevance of the answer, use of evidence from the text, and language proficiency.
    Provide a score out of 20 and feedback in Korean.
    Respond in JSON format: {"score": 18, "feedback": " ..."}`,a=we(),i=await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),l);if(typeof i.score!="number"||!i.feedback)throw new Error("AI failed to generate a valid essay evaluation.");return i.score=Math.max(0,Math.min(20,i.score)),i},AA=async(e,t,n,s,l)=>{const o="English reading weak points feedback",a=t.map(d=>`Q: "${d.originalQuestionText.substring(0,30)}..." -> ${d.isCorrectAttempt?"Correct":"Incorrect"}`).join(`
`),i=n.map(d=>`Q: "${d.questionText.substring(0,30)}..." -> Score: ${d.score||0}`).join(`
`),u=`A student at the '${s}' level has completed an English reading module on the topic "${e.topic||e.title}".
    Results:
    - Summary Score: ${l.summary}/${l.totalSummaryPossible}
    - MCQ Score: ${l.mcq}/${l.totalMcqPossible} (${a})
    - Essay Score: ${l.essay}/${l.totalEssayPossible} (${i})

    Based on these results, analyze the student's overall weaknesses (e.g., vocabulary, inference, main idea identification) and provide 2-3 sentences of constructive feedback and advice in Korean.`,c=we();return bs(()=>c.models.generateContent({model:Se,contents:u}),o)},TA=async(e,t)=>{const n=`English writing prompt generation (type: ${t})`,s=`Generate an English writing prompt for a '${e}' level learner. The genre is '${t}'.
    Also provide 2-3 short tips to help them get started.
    Respond in JSON format: {"topic": "The generated topic...", "tips": ["Tip 1...", "Tip 2..."]}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},_A=async(e,t,n,s)=>{const l="English writing evaluation",o=`Evaluate the following English essay written by a '${n}' level student. The genre is '${s}'.
    Topic: """${e.topic}"""
    Student's Writing: """${t}"""
    Evaluation Criteria: Task achievement, coherence and cohesion, lexical resource, grammatical range and accuracy.
    Provide a score out of 100, overall feedback, a list of strengths, and a list of areas for improvement. Provide all text feedback in Korean.
    Respond in JSON format: {"score": 85, "feedback": " ...", "strengths": [" 1"], "areasForImprovement": ["1"]}`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},jA=async(e,t)=>{const n=`English grammar concept generation (category: ${t})`,s=Gy[t].join(", "),l=`From the English grammar category "${t}" (e.g., ${s}), randomly select one specific topic suitable for a '${e}' level learner.
    Provide a clear explanation and several example sentences for the selected topic.
    Respond in JSON format:
    {
      "topic": "Selected Topic Name",
      "explanation": "A clear explanation of the grammar concept.",
      "examples_text": "Several example sentences, separated by newlines."
    }`,o=we(),a=await je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),n);if(!a.topic||!a.explanation||!a.examples_text)throw new Error("AI failed to generate a valid grammar concept.");return{...a,topicName:a.topic,examplesText:a.examples_text,categoryKey:t,difficulty:e}},RA=async(e,t,n,s)=>{const l=`English grammar MCQ generation (topic: ${e})`,o=`Based on the English grammar concept "${e}", generate ${n} multiple-choice questions for a '${s}' level learner.
    Concept Info: """${t}"""
    Each question should have 4 options. Include the 0-based index of the correct answer and a brief explanation in Korean.
    Respond in a JSON array format: [{"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}, ...]`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},IA=async(e,t)=>{const n="English grammar essay evaluation",s=`A student was asked to explain the English grammar concept "${e.topicName}" and provide examples. Evaluate their response.
    Reference Explanation: """${e.explanation}"""
    Student's Answer: """${t}"""
    Evaluation Criteria: Accuracy of the explanation, correctness and relevance of the examples.
    Provide a score out of 30 and feedback in Korean.
    Respond in JSON format: {"score": 25, "feedback": " ..."}`,l=we(),o=await je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n);if(typeof o.score!="number"||!o.feedback)throw new Error("AI failed to generate a valid grammar essay evaluation.");return o.score=Math.max(0,Math.min(30,o.score)),o},MA=async(e,t,n,s)=>{const l="English grammar weak points feedback",o=t.map(u=>`Q: "${u.originalQuestionText.substring(0,20)}..." -> ${u.isCorrectAttempt?"Correct":"Incorrect"}`).join(`
`),a=`A student studied the English grammar topic '${e.topicName}'.
    MCQ Results:
    ${o}
    Explanation Task Results:
    - Score: ${n}/30
    - Feedback: ${s}
    Based on all of this, analyze their weaknesses and provide 2-3 sentences of constructive feedback in Korean.`,i=we();return bs(()=>i.models.generateContent({model:Se,contents:a}),l)},DA=async(e,t)=>{const n=`English vocabulary generation (level: ${e})`,s=`Generate a list of ${t} English vocabulary words suitable for a '${e}' level learner. For each word, provide its part of speech, a Korean definition, and an English example sentence.
    Respond in a JSON array format: [{"word": "...", "part_of_speech": "...", "korean_definition": "...", "example_sentence": "..."}, ...]`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},OA=async(e,t)=>{const n="English vocabulary quiz generation",s=e.map(a=>`"${a.word}" (${a.koreanDefinition})`).join(", "),l=`From the following list of English words, create ${t} multiple-choice quiz questions: ${s}.
    Mix up question types (e.g., word to definition, definition to word). Each question must have 4 options.
    For each question, provide the word being quizzed, the question type, the question text, options, and the 0-based index of the correct answer.
    Respond in a JSON array format: [{"word": "...", "question_type": "...", "question_text_hint": "...", "options": [...], "correct_option_index": 0}, ...]`,o=we();return je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n)},kA=async(e,t,n)=>{const s="English vocabulary feedback generation",l=e.map(i=>`Q: "${i.questionText}" -> Correct Answer: "${i.options[i.correctOptionIndex]}" -> User Answer: "${i.options[i.userAnswerIndex??-1]}" -> ${i.isCorrect?"Correct":"Incorrect"}`).join(`
`),o=`A student at '${n}' level completed a vocabulary quiz with a score of ${t.quizCorrectAnswers}/${t.quizTotalQuestions}.
    Quiz details:
    ${l}
    Provide overall feedback in Korean, highlighting any patterns of mistakes and giving advice for future vocabulary study. Keep it to 2-4 sentences.`,a=we();return bs(()=>a.models.generateContent({model:Se,contents:o}),s)},LA=async(e,t)=>{const n="Irregular verbs generation",s=`Generate a list of ${t} English irregular verbs appropriate for a '${e}' level learner. For each verb, provide its base form, past simple, past participle, and a Korean meaning.
    Respond in a JSON array format: [{"base": "...", "past_simple": "...", "past_participle": "...", "korean_meaning": "..."}, ...]`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},BA=async(e,t)=>{const n="Irregular verbs quiz generation",s=e.map(a=>a.base).join(", "),l=`From the following list of irregular verbs, create ${t} multiple-choice quiz questions: ${s}.
    Vary the quiz types (e.g., base_to_past, base_to_participle, korean_to_base).
    For each question, provide the base form of the verb, the quiz type, question text, 4 options, and the 0-based index of the correct answer.
    Respond in a JSON array format: [{"base_form": "...", "quiz_type": "...", "question_text": "...", "options": [...], "correct_option_index": 0}, ...]`,o=we();return je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n)},UA=async(e,t,n,s)=>{const l="Math problem generation",o=`Generate a set of math problems for a learner at the '${e}' level.
    Problem types to include: ${t.join(", ")}.
    Generate ${n} problems of type 'answer_input' and ${s} problems of type 'essay'.
    For 'answer_input' problems, provide the 'expected_answer'. For 'essay' problems, provide a 'solution_guide'.
    Respond in a JSON array format: [{"question_text": "...", "question_type": "...", "expected_answer": "...", "solution_guide": "...", "topic_category": "..."}, ...]`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},PA=async(e,t)=>{const n="Math answer_input evaluation",s=`Evaluate a student's answer to a math problem. The student's level is '${t}'.
    Problem: "${e.questionText}"
    Expected Answer: "${e.expectedAnswer}"
    Student's Answer: "${e.userAnswerText}"
    Time Taken: ${e.timeTakenSeconds} seconds.
    ${e.userSolutionImageBase64?"The student also provided an image of their work.":""}
    
    Evaluate the following and provide scores:
    1.  Answer Correctness (answerScore): 0-15 points.
    2.  Solution Process (processScore): Based on the provided solution image (if any), score from 0-10. If no image, give 5 for a correct answer, 0 for incorrect.
    3.  Time Efficiency (timeScore): Score from 0-5.
    Provide overall feedback in Korean.
    Respond in JSON format: {"answerScore": 15, "processScore": 8, "timeScore": 4, "feedback": "..."}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},GA=async(e,t)=>{const n="Math essay evaluation",s=`Evaluate a student's essay answer to a math problem. The student's level is '${t}'.
    Problem: "${e.questionText}"
    Model Solution Guide: "${e.solutionGuide}"
    Student's Answer: "${e.userAnswerText}"
    Time Taken: ${e.timeTakenSeconds} seconds.
    ${e.userSolutionImageBase64?"The student also provided an image of their work.":""}
    
    Evaluate the following and provide scores:
    1.  Answer Correctness (answerScore): 0-10 points.
    2.  Solution Process (processScore): Logical flow and correctness of steps. Score 0-10.
    3.  Descriptive Writing (writingScore): Clarity and use of mathematical language. Score 0-5.
    4.  Time Efficiency (timeScore): Score from 0-5.
    Provide overall feedback in Korean.
    Respond in JSON format: {"answerScore": 10, "processScore": 8, "writingScore": 4, "timeScore": 3, "feedback": "..."}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},HA=async(e,t)=>{const n="Math graph problem generation",s=`Generate a math problem involving graphs for a '${e}' level learner.
    The interaction type should be: "${t}".
    - For 'GRAPH_TO_EQUATION', provide 'graph_data' and 'correct_equation'.
    - For 'EQUATION_TO_GRAPH', provide 'equation_to_graph_details' including 'equation_string', axis config, and optionally target plot points.
    - For 'GRAPH_INTERPRETATION_ESSAY', provide 'graph_data' and 'problem_title' asking for interpretation.
    
    Always provide 'topic', 'problem_title', and 'overall_solution_guide'.
    'graph_data' should be an SVG string.
    
    Respond in the MathGraphProblemApiResponseItem JSON format.`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},FA=async(e,t)=>{const n="Math graph problem evaluation",s=`Evaluate a student's solution to a math graph problem.
    Problem Type: "${e.interactionType}"
    Problem: "${e.problemTitle}"
    Reference Solution Guide: "${e.overallSolutionGuide}"
    
    Student's Input:
    - Equation: ${t.equation||"N/A"}
    - Interpretation: ${t.interpretation||"N/A"}
    - Drawing Data: ${t.drawingData?"Provided":"N/A"}
    
    Evaluate the student's submission based on the problem type. Provide a score out of 20, a boolean 'isCorrect', and feedback in Korean.
    Respond in JSON format: {"score": 18, "isCorrect": true, "feedback": "..."}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},qA=async(e,t)=>{const n="Math geometry problem generation",s=`Generate a math geometry problem for a '${e}' level learner.
    Sub-category: "${t}".
    Provide 'problem_title', 'question_text', and 'solution_guide'.
    If the problem involves a visual shape, provide 'shape_svg_data' as an SVG string.
    Provide 'expected_answer_text' for calculation problems or 'expected_description' for descriptive problems.
    Respond in the MathGeometryProblemApiResponseItem JSON format.`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},$A=async(e,t)=>{const n="Math geometry problem evaluation",s=`Evaluate a student's solution to a math geometry problem.
    Problem: "${e.problemTitle}"
    Question: "${e.questionText}"
    Reference Solution Guide: "${e.solutionGuide}"
    
    Student's Input:
    - Text Answer: ${t.textInput||"N/A"}
    - Solution Image: ${t.solutionImageBase64?"Provided":"N/A"}
    
    Evaluate the student's submission. Provide a score out of 20, a boolean 'isCorrect', and feedback in Korean.
    Respond in JSON format: {"score": 18, "isCorrect": true, "feedback": "..."}`,l=we();return je(()=>l.models.generateContent({model:Se,contents:s,config:{responseMimeType:"application/json"}}),(o,a)=>Ae(o,a),n)},tx=async(e,t,n)=>{var c,d,h,f,p,v;const s=`Social studies content generation (${e})`,l=`Generate an explanatory text about the social studies topic: "${t}".
    Subject: ${e}
    The text should be suitable for a '${n}' level learner and be in Korean.
    Search the web for factual information if necessary. Provide a source URL if you use one.
    Respond in JSON format: {"topic": "${t}", "explanation": "...", "sourceUrl": "...", "difficulty": "${n}"}`,a=await we().models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),i=Ae(a.text??"",s),u=((v=(p=(f=(h=(d=(c=a.candidates)==null?void 0:c[0])==null?void 0:d.groundingMetadata)==null?void 0:h.groundingChunks)==null?void 0:f[0])==null?void 0:p.web)==null?void 0:v.uri)||i.sourceUrl;return{...i,sourceUrl:u,difficulty:n}},nx=async(e,t,n,s,l)=>{const o=`Social studies MCQ generation (${l})`,a=`Based on the following text about "${t}" (Subject: ${l}), generate ${n} multiple-choice questions for a '${s}' level learner.
    Text: """${e.substring(0,2e3)}..."""
    Questions and options should be in Korean. Provide a brief explanation for the correct answer in Korean.
    Respond in a JSON array format: [{"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}, ...]`,i=we();return je(()=>i.models.generateContent({model:Se,contents:a,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),o)},sx=async(e,t,n,s)=>{const l=`Social studies essay generation (${s})`,o=`Based on the text about "${t}" (Subject: ${s}), generate one short essay question for a '${n}' level learner. Also provide a model answer (solutionText).
    Text: """${e.substring(0,2e3)}..."""
    Respond in JSON format: {"questionText": "...", "solutionText": "..."}`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},rx=async(e,t,n,s,l,o)=>{const a=`Social studies essay evaluation (${o})`,i=`Evaluate a student's essay answer for a social studies question. Level: '${l}'.
    Topic: "${t}"
    Question: "${n}"
    Student's Answer: "${s}"
    Evaluation criteria: Understanding of the concept, logical reasoning, use of relevant information.
    Provide a score out of 20 and feedback in Korean.
    Respond in JSON format: {"score": 17, "feedback": "..."}`,u=we(),c=await je(()=>u.models.generateContent({model:Se,contents:i,config:{responseMimeType:"application/json"}}),(d,h)=>Ae(d,h),a);if(typeof c.score!="number"||!c.feedback)throw new Error("AI failed to generate a valid essay evaluation.");return c.score=Math.max(0,Math.min(20,c.score)),c},lx=async(e,t,n,s)=>{const l=`Social studies weak points feedback (${s})`,o=t.map(c=>`Q: "${c.originalQuestionText.substring(0,20)}..." -> ${c.isCorrectAttempt?"":""}`).join(`
`),a=n?`Essay Q: "${n.questionText.substring(0,20)}..." -> Score: ${n.score||0}`:"No essay.",i=`A student completed a social studies module on "${e.topic}" (Subject: ${s}).
    Results:
    - MCQs:
    ${o}
    - Essay:
    ${a}
    Based on these results, analyze their weaknesses and provide 2-3 sentences of constructive feedback and advice in Korean.`,u=we();return bs(()=>u.models.generateContent({model:Se,contents:i}),l)},ox=async(e,t,n,s)=>{const l=`Science MCQ generation (${e} - ${t})`,o=`Generate ${s} multiple-choice questions about ${e} focusing on the sub-category '${t}' for a '${n}' level learner.
    Questions and options should be in Korean. Provide a brief explanation for the correct answer in Korean.
    Respond in a JSON array format: [{"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}, ...]`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},ax=async(e,t,n,s)=>{const l=`Science essay generation (${e} - ${t})`,o=`Generate ${s} short essay questions about ${e} focusing on '${t}' for a '${n}' level learner.
    Also provide a model answer (solutionText) for each question.
    Respond in a JSON array format: [{"questionText": "...", "solutionText": "...", "subCategory": "${t}"}, ...]`,a=we();return je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(i,u)=>Ae(i,u),l)},ix=async(e,t,n,s,l,o,a)=>{const i=`Science essay evaluation (${s} - ${l})`,u=`Evaluate a student's essay answer for a science question. Level: '${o}'.
    Subject: ${s} - ${l}
    Question: "${e}"
    Model Solution: "${n}"
    Student's Answer: "${t}"
    ${a?"The student provided a handwritten solution image.":""}
    Evaluation criteria: Scientific accuracy, logical explanation, use of correct terminology.
    Provide a score out of 25 and feedback in Korean.
    Respond in JSON format: {"score": 22, "feedback": "..."}`,c=we(),d=await je(()=>c.models.generateContent({model:Se,contents:u,config:{responseMimeType:"application/json"}}),(h,f)=>Ae(h,f),i);if(typeof d.score!="number"||!d.feedback)throw new Error("AI failed to generate a valid essay evaluation.");return d.score=Math.max(0,Math.min(25,d.score)),d},cx=async(e,t,n,s,l)=>{const o=`Science weak points feedback (${e} - ${t})`,a=s.map(d=>`Q: "${d.originalQuestionText.substring(0,20)}..." -> ${d.isCorrectAttempt?"":""}`).join(`
`),i=l.map(d=>`Essay Q: "${d.questionText.substring(0,20)}..." -> Score: ${d.score||0}`).join(`
`),u=`A student completed a science module.
    Subject: ${e} - ${t}
    Difficulty: ${n}
    Results:
    - MCQs:
${a}
    - Essays:
${i}
    Based on these results, analyze their weaknesses and provide 2-3 sentences of constructive feedback and advice in Korean.`,c=we();return bs(()=>c.models.generateContent({model:Se,contents:u}),o)},xa=async(e,t,n)=>{const s=`${e} Assessment Question Generation`,l=t.map(u=>`Q (level ${u.difficultyPresented}): ${u.isCorrect?"Correct":"Incorrect"}`).join("; "),o=`Generate a single multiple-choice assessment question for the subject "${e}".
    The student's current estimated level is '${n}'.
    Their performance history so far is: ${l||"No history yet"}.
    Adjust the difficulty of the new question based on this information. The question should be a good differentiator at this level.
    The question and options must be in Korean.
    Respond in JSON format: {"question": "...", "options": [...], "answer_index": 0, "explanation": "..."}`,a=we();return{...await je(()=>a.models.generateContent({model:Se,contents:o,config:{responseMimeType:"application/json"}}),(u,c)=>Ae(u,c),s),id:rn(),difficultyUsedToGenerate:n,subject:e}},Ll=async(e,t)=>{const n=`${e} Assessed Level Determination`,s=t.map(a=>`Q (Presented at ${a.difficultyPresented}, Subject: ${a.subject}): ${a.isCorrect?"Correct":"Incorrect"}`).join(`
`),l=`Based on the following assessment history for a student, determine their final assessed proficiency level for the subject "${e}" and provide overall feedback.
    History:
    ${s}

    Your analysis should result in one of the StudyDifficulty enum values. Provide overall feedback, strengths, and areas for improvement in Korean.
    For a comprehensive assessment, also provide a breakdown of estimated levels for each subject found in the history.
    
    Respond in JSON format: 
    {
      "assessedLevel": "MS_1_2", 
      "feedback": " ...",
      "strengths": ["1", "2"],
      "areasForImprovement": ["1"],
      "subjectBreakdown": { "": "MS_1_2", "": "ES_5_6" }
    }`,o=we();return je(()=>o.models.generateContent({model:Se,contents:l,config:{responseMimeType:"application/json"}}),(a,i)=>Ae(a,i),n)},VA=(e,t)=>xa("",e,t),zA=e=>Ll("",e),QA=(e,t)=>xa("",e,t),YA=e=>Ll("",e),WA=(e,t)=>xa("",e,t),XA=e=>Ll("",e),KA=(e,t)=>xa("",e,t),ZA=e=>Ll("",e),JA=(e,t)=>xa("",e,t),eT=e=>Ll("",e),tT=async(e,t)=>{const n="Comprehensive Assessment Question Generation",s=e.map(c=>`Q (Subject ${c.subject}, Presented at ${c.difficultyPresented}): ${c.isCorrect?"Correct":"Incorrect"}`).join("; "),l=["","","","",""],o=l[e.length%l.length],a=`Generate a single multiple-choice assessment question for the subject "${o}".
    This is part of a COMPREHENSIVE assessment.
    The student's current estimated overall level is '${t}'.
    Their performance history so far is: ${s||"No history yet"}.
    Adjust the difficulty of the new question based on this information. The question should be a good differentiator at this level for the given subject.
    The question and options must be in Korean (except for English subject questions).
    Respond in JSON format: {"question": "...", "options": [...], "answer_index": 0, "explanation": "...", "subject": "${o}"}`,i=we();return{...await je(()=>i.models.generateContent({model:Se,contents:a,config:{responseMimeType:"application/json"}}),(c,d)=>Ae(c,d),n),id:rn(),difficultyUsedToGenerate:t}},nT=e=>Ll("",e),Ne=({size:e="md",color:t,className:n=""})=>{const s={xs:"h-4 w-4",sm:"h-5 w-5",md:"h-8 w-8",lg:"h-12 w-12"},l=t?void 0:"var(--accent-primary)";return r.jsxs("svg",{className:`animate-spin ${s[e]} ${t||""} ${n}`,style:{color:l},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},xb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M4 4l3 16h3l3-16h3l3 16h3"})]}),mb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{fillRule:"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 5.518a.75.75 0 001.329.364L11.858 3.9a.75.75 0 01.95.35l.807 1.533a.75.75 0 001.329-.364l.173-1.032a1.875 1.875 0 00-3.4-.635L10.343 2.25zM12 5.518a2.625 2.625 0 00-2.625 2.625v1.875c0 .414.336.75.75.75h3.75a.75.75 0 00.75-.75V8.143a2.625 2.625 0 00-2.625-2.625zM10.5 10.875a.375.375 0 11-.75 0 .375.375 0 01.75 0zM14.25 10.875a.375.375 0 11-.75 0 .375.375 0 01.75 0zM8.822 13.157a1.875 1.875 0 00-1.671 1.009l-.42 1.05a.75.75 0 01-1.329-.364l1.153-3.46a.75.75 0 00-.364-1.329L3.9 9.05a1.875 1.875 0 00-.635-3.4l-1.032.173a.75.75 0 01-.364-1.329l1.533-.807a.75.75 0 00.35-.95L2.25 3.9c-.426-.815-.096-1.845.635-2.253l1.567-.85a1.875 1.875 0 001.009-1.671L5.518 9.05l3.46-1.153a.75.75 0 001.329.364l1.05.42a1.875 1.875 0 003.218 0l1.05-.42a.75.75 0 001.329-.364l3.46 1.153a.75.75 0 00.364-1.329l-1.153-3.46a1.875 1.875 0 00-1.67-1.009l-1.05-.42a.75.75 0 01-.364-1.329l.807-1.533a.75.75 0 00-.95-.35L18.06 5.47a1.875 1.875 0 00-3.4.635l-.173 1.032a.75.75 0 01-1.329.364l-.807-1.533a.75.75 0 00-.35-.95L10.343 2.25zM12 12.875a2.625 2.625 0 100 5.25 2.625 2.625 0 000-5.25z",clipRule:"evenodd"}),r.jsx("path",{d:"M12 15.375a.375.375 0 110-.75.375.375 0 010 .75z"})]}),sT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 016.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-6.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",clipRule:"evenodd"})]}),rT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})]}),Qi=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})]}),fb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"})]}),lT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})]}),oT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})]}),Kd=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c1.153 0 2.242.078 3.223.224M5.256 5.79c-.007.04-.014.081-.021.12L5.13 5.91M5.79 5.79L4.21 4.21M19.79 5.79L21.37 4.21m-1.215 1.58L12 3.372M4.772 5.79L12 12m6.73-6.21L12 12"})]}),Dn=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M21.42 10.73l-9.19-5.25a1 1 0 00-1.05 0l-9.19 5.25a1 1 0 00-.58.9V17a1 1 0 001 1h18a1 1 0 001-1v-5.37a1 1 0 00-.58-.9z"}),r.jsx("path",{d:"M4 10v.01"}),r.jsx("path",{d:"M16 18v-2a2 2 0 00-2-2H8a2 2 0 00-2 2v2"})]}),_t=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5C17.7 10.2 18 9 18 7.5a6 6 0 00-12 0c0 1.5.3 2.7 1.5 3.9.8.8 1.3 1.5 1.5 2.5"}),r.jsx("path",{d:"M9 18h6"}),r.jsx("path",{d:"M10 22h4"})]}),aT=({className:e,strokeWidth:t=2,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 18L9 12l6-6"})]}),iT=({className:e,strokeWidth:t=2,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6l6 6-6 6"})]}),Yi=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M17 7L7 17"}),r.jsx("path",{d:"M17 17L7 7"}),r.jsx("path",{d:"M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"})]}),ns=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"}),r.jsx("path",{d:"M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"})]}),nt=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M12 3L9.65 8.35L4 9.24l4.05 3.95L7.06 19L12 16.01L16.94 19l-1.01-5.81L20 9.24l-5.65-.89L12 3z"}),r.jsx("path",{d:"M22 11L19 10"})," ",r.jsx("path",{d:"M20 4l-2 3"})," ",r.jsx("path",{d:"M4 20l2-3"})," ",r.jsx("path",{d:"M2 13l3 1"})]}),Lr=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),kt=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),r.jsx("path",{d:"M16 5L20 9"})]}),cT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),r.jsx("polyline",{points:"9 15 12 18 15 15"})]}),En=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),r.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Oe=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),r.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),ls=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M21.5 2v6h-6"})," ",r.jsx("path",{d:"M2.5 22v-6h6"}),r.jsx("path",{d:"M22 11.5A10 10 0 003.2 7.2M2 12.5a10 10 0 0018.8 4.2"})]}),io=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("path",{d:"M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"})]}),hb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",ry:"2"}),r.jsx("line",{x1:"8",y1:"6",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"10",x2:"16",y2:"10"}),r.jsx("line",{x1:"8",y1:"14",x2:"16",y2:"14"}),r.jsx("line",{x1:"8",y1:"18",x2:"16",y2:"18"})]}),pb=({className:e,strokeWidth:t=2,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})," ",r.jsx("polyline",{points:"12 5 19 12 12 19"})]}),pn=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M9 14L4 9l5-5"})," ",r.jsx("path",{d:"M4 9h10.5a5.5 5.5 0 015.5 5.5v0a5.5 5.5 0 01-5.5 5.5H11"})]}),Ce=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"})," ",r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),pt=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M4 21v-7m0-4V3m8 18v-9m0-4V3m8 18v-5m0-4V3M1 14h6M9 8h6m-2 8h6"})]}),Ao=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M8 2h8"})," ",r.jsx("path",{d:"M6 22h12"})," ",r.jsx("path",{d:"M7 2l2 12v6a2 2 0 002 2h2a2 2 0 002-2v-6l2-12"})," ",r.jsx("path",{d:"M9 12h6"})]}),To=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M16 16.5L19 12l-7-7-7 7 3 4.5"})," ",r.jsx("path",{d:"M12 3v19"})," ",r.jsx("path",{d:"M2 22h20"})," ",r.jsx("path",{d:"M5 12h14"})]}),uT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"}),r.jsx("path",{d:"M8 10h8M8 14h4"})]}),Bs=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"})," ",r.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),gb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),r.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),Yn=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})]}),dT=({className:e,strokeWidth:t=2,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})," ",r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Rs=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("polyline",{points:"16 18 22 12 16 6"})," ",r.jsx("polyline",{points:"8 6 2 12 8 18"})]}),qo=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M8 21L4 17L8 13"})," ",r.jsx("path",{d:"M16 21L20 17L16 13"}),r.jsx("path",{d:"M14 4L5 21"})," ",r.jsx("path",{d:"M19 4L10 21"})]}),$o=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M12 6c-2.5 0-5 1.5-5 4v8c0 2.5 2.5 4 5 4s5-1.5 5-4v-3"}),r.jsx("path",{d:"M12 6c2.5 0 5 1.5 5 4v3"}),r.jsx("line",{x1:"7",y1:"10",x2:"17",y2:"10"}),r.jsx("line",{x1:"10",y1:"18",x2:"10",y2:"15"}),r.jsx("line",{x1:"14",y1:"18",x2:"14",y2:"15"})]}),Vo=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M4 12h13M4 6h13M4 18h7"}),r.jsx("path",{d:"M10 4v16"}),r.jsx("path",{d:"M19 4l-4 8 4 8"})]}),zo=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M4 12c0-4.42 3.58-8 8-8s8 3.58 8 8-3.58 8-8 8"}),r.jsx("path",{d:"M4 12h16"}),r.jsx("line",{x1:"10",y1:"18",x2:"14",y2:"6"})]}),Qo=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 22V2M2 12h20M12 2a15.3 15.3 0 00-4 10 15.3 15.3 0 004 10 15.3 15.3 0 004-10 15.3 15.3 0 00-4-10z"})]}),Yo=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"12",cy:"12",r:"1"}),r.jsx("path",{d:"M20.24 12.24a8 8 0 10-16.48 0M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"})]}),ux=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M3 3v18h18"}),r.jsx("path",{d:"M18 17V9"}),r.jsx("path",{d:"M13 17V5"}),r.jsx("path",{d:"M8 17v-3"})]}),yb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),r.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),r.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),xT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M1 6v16l7-4 8 4 7-4V2l-7 4-8-4-7 4z"}),r.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),r.jsx("line",{x1:"16",y1:"6",x2:"16",y2:"22"})]}),dx=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-8 h-8",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"}),r.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),mT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),xx=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),fT=({className:e,strokeWidth:t=2,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("polyline",{points:"20 6 9 17 4 12"})]}),hT=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M8.5 2.5a2.5 2.5 0 0 1 3 0L20 11a2.5 2.5 0 0 1 0 3L14.5 20a2.5 2.5 0 0 1-3.5 0l-5-5a2.5 2.5 0 0 1 0-3l4-4Z"}),r.jsx("path",{d:"M5 14l-3 3"}),r.jsx("path",{d:"M12 12l5 5"})]}),Rh=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"}),r.jsx("path",{d:"M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"}),r.jsx("path",{d:"M12 17h.01"})]}),Ia=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"}),r.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),bb=({className:e,strokeWidth:t=1.5,style:n,title:s})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:t,stroke:"currentColor",className:e||"w-6 h-6",style:n,children:[s&&r.jsx("title",{children:s}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18h.008v.008H9.75v-.008ZM7.5 18h.008v.008H7.5v-.008ZM14.25 15h.008v.008h-.008v-.008ZM14.25 18h.008v.008h-.008v-.008ZM16.5 15h.008v.008h-.008v-.008ZM16.5 18h.008v.008h-.008v-.008Z"})]}),He="var(--accent-korean)",Ih=2,zl=2,Ma=5,Da=20,pT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(tt.SELECT_SOURCE),[o,a]=w.useState(null),[i,u]=w.useState(null),[c,d]=w.useState(""),[h,f]=w.useState(""),[p,v]=w.useState(t||me.MS_1_2),[S,N]=w.useState(null),[E,g]=w.useState(""),[y,b]=w.useState(null),[T,A]=w.useState([]),[C,_]=w.useState(0),[L,I]=w.useState(void 0),[j,D]=w.useState([]),[M,U]=w.useState(Array(zl).fill("")),[$,B]=w.useState({mcq:0,essay:0,total:0}),[k,H]=w.useState(null),[F,Z]=w.useState(null),[z,q]=w.useState(null);w.useRef(null);const Y=w.useRef(null),V=w.useRef(null);w.useEffect(()=>{t&&v(t)},[t]);const R=()=>a(null),X=(ee=!1)=>{l(tt.SELECT_SOURCE),a(null),u(null),d(""),f(""),ee||v(t||me.MS_1_2),N(null),g(""),b(null),A([]),D([]),U(Array(zl).fill("")),B({mcq:0,essay:0,total:0}),H(null),_(0),I(void 0),Z(null),q(null)},W=()=>{X(!1),e()},G=ee=>{R(),u(ee),ee!==Ss.USER_SPECIFIED&&P(ee)},P=w.useCallback(async(ee,ue,fe)=>{l(tt.FETCHING_TEXT),Z(ee===Ss.AI_GENERATED?"AI    ...":"    ..."),N(null),g(""),b(null),A([]),D([]),B({mcq:0,essay:0,total:0}),H(null);try{let ye=null;if(ee===Ss.AI_GENERATED)ye={content:await tA(),title:"AI  "};else if(ee===Ss.RANDOM_SEARCH)ye=await Ah("    ");else if(ee===Ss.USER_SPECIFIED){if(!(ue!=null&&ue.trim())){a({type:"validation",message:"  ."}),l(tt.SELECT_SOURCE),Z(null);return}ye=await Ah(`${ue} ${fe||""}`.trim())}ye&&ye.content?(N(ye),l(tt.USER_SUMMARY_INPUT)):(a({type:"api",message:"  .    ."}),l(tt.ERROR))}catch(ye){console.error(ye);let Re="    .       .",ne=ye instanceof Error?ye.message:String(ye);if(ye instanceof Error&&ye.message.startsWith("Gemini API error")){const ge=ye.message.substring(ye.message.indexOf(":")+1).trim();Re=`AI     . (${ge.substring(0,100)}${ge.length>100?"...":""}).   .`}else ye instanceof Error&&(Re=ye.message);a({type:"api",message:Re,details:ne}),l(tt.ERROR)}finally{Z(null)}},[p]),Q=async()=>{if(!S||!E.trim()){a({type:"validation",message:"  ."});return}R(),l(tt.USER_SUMMARY_EVALUATING),Z("   ...");try{const ee=await nA(S.content,E);b(ee.feedback),l(tt.DISPLAY_SUMMARY_EVALUATION)}catch(ee){console.error(ee),a({type:"api",message:ee instanceof Error?ee.message:"    "}),l(tt.USER_SUMMARY_INPUT)}finally{Z(null)}},K=async()=>{if(S){l(tt.MCQ_SETUP),Z(`    (: ${p})...`),R();try{const ue=(await sA(S.content,Ih,p)).map((fe,ye)=>({id:`mcq-${ye}-${crypto.randomUUID()}`,originalQuestionText:fe.question,options:fe.options,correctAnswerIndex:fe.answer_index,explanation:fe.explanation,attemptsOnConcept:0,isConceptMastered:!1}));A(ue),_(0),I(void 0),l(tt.MCQ_SOLVE)}catch(ee){console.error(ee),a({type:"api",message:ee instanceof Error?ee.message:"     "}),l(tt.ERROR)}finally{Z(null)}}},ae=()=>{if(L===void 0||C>=T.length){a({type:"validation",message:" ."});return}R();const ee=T[C],ue=L===ee.correctAnswerIndex,fe={...ee,userAnswerIndex:L,isCorrectAttempt:ue,attemptsOnConcept:ee.attemptsOnConcept+1,isConceptMastered:ee.isConceptMastered||ue};A(T.map((Re,ne)=>ne===C?fe:Re));let ye=$.mcq;ue&&fe.attemptsOnConcept===1&&(ye+=Ma),B(Re=>({...Re,mcq:ye,total:ye+Re.essay})),setTimeout(()=>{C>=T.length-1?O():(_(Re=>Re+1),I(void 0)),Y.current&&(Y.current.scrollTop=0)},1500)},O=w.useCallback(async()=>{if(S){l(tt.ESSAY_SETUP),Z(`    (: ${p})...`),R();try{const ue=(await rA(S.content,zl,p)).map((fe,ye)=>({id:`essay-${ye}-${crypto.randomUUID()}`,questionText:fe.questionText,solutionText:fe.solutionText,userAnswer:"",isGrading:!1}));D(ue),U(Array(zl).fill("")),l(tt.ESSAY_SOLVE)}catch(ee){console.error(ee),a({type:"api",message:ee instanceof Error?ee.message:"     "}),l(tt.ERROR)}finally{Z(null)}Y.current&&(Y.current.scrollTop=0)}},[S,p]),se=(ee,ue)=>{const fe=[...M];fe[ee]=ue,U(fe)},J=async()=>{if(!S)return;l(tt.ESSAY_GRADING),Z("       ..."),R();const ee=await Promise.all(j.map(async(Re,ne)=>{const ge=M[ne];let ke={...Re,isGrading:!0,userNotepadImageBase64:z};D(te=>te.map(xe=>xe.id===Re.id?ke:xe));try{const te=await lA(S.content,Re.questionText,ge,p,z);return{...ke,userAnswer:ge,score:te.score,feedback:te.feedback,isGrading:!1}}catch(te){return console.error(`Error grading essay ${ne}:`,te),a(xe=>({type:"api",message:xe?`${xe.message},   ${ne+1}  .`:`  ${ne+1}  .`,details:String(te)})),{...ke,userAnswer:ge,score:0,feedback:"   .",isGrading:!1}}}));D(ee);const ue=ee.reduce((Re,ne)=>Re+(ne.score||0),0),ye=$.mcq+ue;B(Re=>({...Re,essay:ue,total:ye}));try{const Re=await oA(S.content,T,ee,p);H(Re),n&&n({id:crypto.randomUUID(),subject:" ",moduleType:S.title||"  ",completedAt:new Date().toISOString(),difficulty:p,score:ye,maxPossibleScore:Ih*Ma+zl*Da,feedbackItems:[{type:"weak_points",feedback:Re}]})}catch(Re){console.error("Error generating weak points feedback:",Re),H("    .")}l(tt.SHOW_RESULTS),Z(null),Y.current&&(Y.current.scrollTop=0)},re=()=>o?r.jsxs("div",{className:"w-full my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:o.message})]}),r.jsx("button",{onClick:R,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),o.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",o.details.substring(0,200),"..."]})]}):null,ie=(ee,ue,fe=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[ue,fe&&s!==tt.SELECT_SOURCE&&r.jsxs("button",{onClick:W,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"    "]})]});if(F)return ie(" ",r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:He}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:F})]}),!1);if(s===tt.ERROR)return ie(" ",r.jsxs("div",{className:"p-6 text-center wonder-panel",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),re(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>X(!0),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:He},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}),!1);const le=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(ns,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:He},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:"  "})]}),r.jsx("p",{className:"mb-6 text-body text-slate-200 leading-relaxed",children:"AI      .   ."}),r.jsxs("div",{className:"my-6 md:my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:He}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(ee=>r.jsx("button",{onClick:()=>v(ee),className:`wonder-button wonder-button-secondary px-4 py-2 text-xs sm:px-5 sm:py-2.5 sm:text-sm ${p===ee?"active":""}`,style:p===ee?{borderColor:He,backgroundColor:`color-mix(in srgb, ${He} 25%, transparent)`,color:He}:{},children:ee},ee))})]}),re(),r.jsxs("div",{className:"space-y-4 sm:space-y-0 sm:grid sm:grid-cols-2 sm:gap-4 justify-center mt-8",children:[r.jsxs("button",{onClick:()=>G(Ss.AI_GENERATED),className:"wonder-button wonder-button-primary w-full flex items-center justify-center px-6 py-3.5",style:{backgroundColor:He,borderColor:He},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"})," AI  "]}),r.jsxs("button",{onClick:()=>G(Ss.RANDOM_SEARCH),className:"wonder-button wonder-button-primary w-full flex items-center justify-center px-6 py-3.5",style:{backgroundColor:"var(--accent-secondary)",borderColor:"var(--accent-secondary)"},children:[r.jsx(Lr,{className:"w-5 h-5 mr-2.5"}),"   "]})]}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-[var(--border-panel)]",children:[r.jsx("h2",{className:"text-h3 font-semibold mb-4 text-slate-100",children:",   "}),r.jsxs("div",{className:"space-y-4 sm:max-w-md mx-auto",children:[r.jsx("input",{type:"text",placeholder:"  ",value:c,onChange:ee=>d(ee.target.value),className:"wonder-input w-full p-3.5"}),r.jsx("input",{type:"text",placeholder:"   ( )",value:h,onChange:ee=>f(ee.target.value),className:"wonder-input w-full p-3.5"}),r.jsx("button",{onClick:()=>P(Ss.USER_SPECIFIED,c,h),disabled:!c.trim(),className:"wonder-button wonder-button-primary w-full px-6 py-3.5",style:{backgroundColor:"var(--accent-science)",borderColor:"var(--accent-science)"},children:"   "})]})]}),r.jsxs("button",{onClick:W,className:"wonder-button wonder-button-secondary mt-10 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),pe=()=>{switch(s){case tt.USER_SUMMARY_INPUT:return r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-3 flex items-center",style:{color:He},children:[r.jsx(kt,{className:"w-6 h-6 mr-2"}),"  "]}),r.jsx("p",{className:"text-body text-slate-200 mb-4 leading-relaxed",children:"    . AI ."}),r.jsx("textarea",{value:E,onChange:ne=>g(ne.target.value),placeholder:"   ...",rows:6,className:"wonder-input w-full p-3.5 text-base","aria-label":"  "}),r.jsx("button",{onClick:Q,disabled:!E.trim(),className:"wonder-button wonder-button-primary mt-4 w-full px-8 py-3.5 text-lg",style:{backgroundColor:He,borderColor:He},children:"   AI "})]});case tt.DISPLAY_SUMMARY_EVALUATION:return r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-3 flex items-center",style:{color:He},children:[r.jsx(Yi,{className:"w-6 h-6 mr-2"}),"    AI "]}),r.jsxs("div",{className:"mb-4 p-4 wonder-panel border-slate-600/50",children:[r.jsx("p",{className:"font-medium text-slate-200 mb-1",children:"  :"}),r.jsx("p",{className:"text-slate-100 whitespace-pre-wrap text-body",children:E})]}),y&&r.jsxs("div",{className:"mb-6 p-4 wonder-panel",style:{borderColor:`color-mix(in srgb, ${He} 70%, transparent)`},children:[r.jsx("p",{className:"font-medium mb-1",style:{color:He},children:"AI :"}),r.jsx("p",{className:"text-slate-100 whitespace-pre-wrap text-body",children:y})]}),r.jsxs("button",{onClick:K,className:"wonder-button wonder-button-primary w-full px-8 py-3.5 text-lg",style:{backgroundColor:"var(--accent-english)",borderColor:"var(--accent-english)"},children:["   (: ",p,")"]})]});case tt.MCQ_SOLVE:const ee=T[C];if(!ee)return r.jsx("p",{children:"   ..."});const ue=ee.userAnswerIndex!==void 0;return r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h2 font-semibold mb-2",style:{color:He},children:["  ",C+1,"/",T.length]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-5",children:["(: ",p,")"]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap leading-relaxed",children:ee.originalQuestionText}),r.jsx("div",{className:"space-y-3 mb-6",children:ee.options.map((ne,ge)=>{const ke=L===ge;let te="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",xe={};return ue?ge===ee.correctAnswerIndex?(te+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.2)]",xe={color:"var(--color-correct)",fontWeight:"600"}):ge===ee.userAnswerIndex?(te+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.2)]",xe={color:"var(--color-incorrect)"}):te+=" opacity-60 border-[var(--border-panel)]":ke?(te+=` active border-[${He}]`,xe={borderColor:He,backgroundColor:`color-mix(in srgb, ${He} 20%, transparent)`,color:He}):te+=` border-[var(--border-panel)] hover:border-[${He}]`,r.jsxs("button",{onClick:()=>{ue||I(ge)},disabled:ue,className:te,style:xe,"aria-label":` ${String.fromCharCode(65+ge)}: ${ne}`,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+ge),"."]})," ",ne]},ge)})}),ue&&ee.isCorrectAttempt===!1&&r.jsxs("div",{className:"my-4 p-4 wonder-panel bg-red-700/20 border-red-500/60",children:[r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx(Oe,{className:"w-5 h-5 mr-2 text-red-300"}),r.jsx("p",{className:"font-semibold text-red-200",children:"."})]}),r.jsxs("p",{className:"text-slate-200 whitespace-pre-wrap ml-7 text-body",children:[": ",ee.options[ee.correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-300 whitespace-pre-wrap ml-7 mt-1 text-caption",children:[": ",ee.explanation]})]}),ue&&ee.isCorrectAttempt===!0&&r.jsxs("div",{className:"my-4 p-3.5 wonder-panel bg-green-700/30 border-green-500/60 text-green-200 font-semibold flex items-center text-body",children:[r.jsx(En,{className:"w-6 h-6 mr-2.5 text-green-300"})," !"]}),!ue&&r.jsx("button",{onClick:ae,disabled:L===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:He,borderColor:He},children:" "})]});case tt.ESSAY_SOLVE:return r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h2 font-semibold mb-6",style:{color:He},children:["  (: ",p,")"]}),j.map((ne,ge)=>r.jsxs("div",{className:"mb-8 pb-8 border-b-2 border-[var(--border-panel)] last:border-b-0 last:pb-0",children:[r.jsxs("h3",{className:"text-h4 font-semibold text-slate-100 mb-2",children:[" ",ge+1,":"]}),r.jsx("p",{className:"text-body text-slate-200 mb-3 whitespace-pre-wrap leading-relaxed",children:ne.questionText}),r.jsx("textarea",{value:M[ge],onChange:ke=>se(ge,ke.target.value),placeholder:"  ...",rows:6,className:"wonder-input w-full p-3.5 text-base",disabled:ne.isGrading,"aria-label":`  ${ge+1} `}),ne.isGrading&&r.jsxs("div",{className:"flex items-center text-slate-400 mt-2",children:[r.jsx(Ne,{size:"xs"}),r.jsx("span",{className:"ml-2 animate-pulse",children:" ..."})]}),ne.feedback&&!ne.isGrading&&r.jsxs("div",{className:"mt-4 p-3.5 wonder-panel border-slate-600/50",children:[r.jsxs("p",{className:"text-body font-semibold",style:{color:He},children:["AI   (: ",ne.score,"/",Da,"):"]}),r.jsx("p",{className:"text-caption text-slate-200 whitespace-pre-wrap mt-1",children:ne.feedback})]})]},ne.id)),r.jsx("button",{onClick:J,disabled:M.some(ne=>!ne.trim()),className:"wonder-button wonder-button-primary w-full mt-4 px-8 py-3.5 text-lg",style:{backgroundColor:"var(--accent-english)",borderColor:"var(--accent-english)"},children:"   "})]});case tt.SHOW_RESULTS:const fe=T.length*Ma+j.length*Da,ye=fe>0?Math.round($.total/fe*100):0;let Re="var(--color-incorrect)";return ye>=80?Re="var(--color-correct)":ye>=50&&(Re="var(--color-warning)"),r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left",style:{borderColor:He},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-8 text-center sm:text-left",children:[r.jsx(Dn,{className:"h-12 w-12 sm:h-14 sm:w-14 mr-0 sm:mr-4 mb-2 sm:mb-0",style:{color:He}}),r.jsx("h2",{className:"text-h1 font-bold text-shadow-subtle",style:{color:He},children:"   "}),r.jsxs("p",{className:"text-caption text-slate-400",children:["(",p,")"]})]}),S&&r.jsxs("div",{className:"mb-6 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-1.5",children:" "}),r.jsxs("p",{className:"text-body text-slate-200",children:[S.title,S.author?` (: ${S.author})`:""]})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{className:"wonder-panel p-4 border border-slate-700/30",children:[r.jsx("p",{className:"text-caption text-slate-400",children:""}),r.jsxs("p",{className:"text-h4 font-bold",style:{color:He},children:[$.mcq," / ",T.length*Ma]})]}),r.jsxs("div",{className:"wonder-panel p-4 border border-slate-700/30",children:[r.jsx("p",{className:"text-caption text-slate-400",children:""}),r.jsxs("p",{className:"text-h4 font-bold",style:{color:He},children:[$.essay," / ",j.length*Da]})]}),r.jsxs("div",{className:"wonder-panel p-4 border-green-600/50 bg-green-700/20",children:[r.jsx("p",{className:"text-caption text-slate-300",children:""}),r.jsxs("p",{className:"text-h3 font-extrabold text-green-300",children:[$.total," / ",fe]})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${ye}%`,backgroundColor:Re}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[ye,"% "]})]})]}),k&&r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)] text-left",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-3 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"}),"AI  "]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",style:{borderColor:`color-mix(in srgb,${He} 50%,transparent)`},children:k})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:()=>X(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center px-6 py-3.5",children:[r.jsx(pn,{className:"w-5 h-5 mr-2.5"}),"   ( )"]})})]});default:return ie(" ",r.jsx("p",{children:"   .  ."}),!0)}};return s===tt.SELECT_SOURCE?ie(" ",le(),!1):s===tt.FETCHING_TEXT||s===tt.USER_SUMMARY_EVALUATING||s===tt.MCQ_SETUP||s===tt.ESSAY_SETUP||s===tt.ESSAY_GRADING?ie(" ",r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:He}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:F})]}),!1):ie(" ",r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[r.jsx("div",{ref:V,className:"lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin",children:S&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold flex items-center",style:{color:He},children:[r.jsx(ns,{className:"w-6 h-6 mr-2"})," ",S.title||" "]}),r.jsx("button",{onClick:W,title:" ",className:"wonder-button wonder-button-secondary p-2 hidden lg:block",style:{color:He},children:r.jsx(Ce,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[r.jsxs("p",{className:"text-xs text-slate-400",children:[S.author?`: ${S.author}`:""," ",S.url&&r.jsx("a",{href:S.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline ml-2",style:{color:He},children:""})]}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium shadow-sm border",style:{backgroundColor:`color-mix(in srgb,${He} 20%,transparent)`,color:He,borderColor:`color-mix(in srgb,${He} 40%,transparent)`},children:p})]}),r.jsx("div",{className:"prose-wonder max-w-none text-slate-200 whitespace-pre-wrap text-sm leading-relaxed",children:S.content})]})}),r.jsxs("div",{ref:Y,className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start scrollbar-thin",children:[re(),pe()]})]}))},Oa="var(--accent-science)",ka="var(--accent-assessment)",gT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(Je.SELECT_SUB_TYPE),[o,a]=w.useState(null),[i,u]=w.useState(null),[c,d]=w.useState(ds.AI_GENERATED),[h,f]=w.useState(""),[p,v]=w.useState(t||me.MS_1_2),[S,N]=w.useState(null),[E,g]=w.useState(""),[y,b]=w.useState(null),[T,A]=w.useState([]),[C,_]=w.useState([]),[L,I]=w.useState({claim:"",evidence:[""]}),[j,D]=w.useState(null),[M,U]=w.useState(""),[$,B]=w.useState(null),[k,H]=w.useState(null),[F,Z]=w.useState(null),[z,q]=w.useState(null),Y=w.useRef(null),V=w.useRef(null);w.useEffect(()=>{t&&v(t)},[t]);const R=o===Et.EXPLANATORY?Oa:ka,X=()=>u(null),W=(ne=!1)=>{ne?l(Je.SELECT_SUB_TYPE):(l(Je.SELECT_SUB_TYPE),a(null),v(t||me.MS_1_2),d(ds.AI_GENERATED),f("")),u(null),N(null),g(""),b(null),A([]),_([]),I({claim:"",evidence:[""]}),D(null),U(""),B(null),H(null),Z(null),q(null)},G=()=>{W(!1),e()},P=ne=>{a(ne),H(ne===Et.EXPLANATORY?{summary:0,essays:0,total:0}:{summary:0,claimEvidence:0,counterArgument:0,total:0})},Q=w.useCallback(async()=>{if(!o){u({type:"runtime",message:"   ."});return}if(c===ds.TOPIC_SEARCH&&!h.trim()){u({type:"validation",message:"  ."});return}l(Je.FETCHING_TEXT),q(c===ds.AI_GENERATED?`AI ${o}  ...`:`"${h}"  ...`),N(null),g(""),X();try{let ne=null;c===ds.AI_GENERATED?ne={content:await cA(p,o),title:`AI  ${o}  (${p})`}:c===ds.TOPIC_SEARCH&&(ne=await uA(h,p,o)),ne!=null&&ne.content?(N(ne),l(Je.USER_SUMMARY_INPUT)):(u({type:"api",message:"  ."}),l(Je.ERROR))}catch(ne){console.error(ne),u({type:"api",message:ne instanceof Error?ne.message:"  .",details:String(ne)}),l(Je.ERROR)}finally{q(null)}},[p,o,c,h]),K=async()=>{if(!S||!E.trim()||!o||!k){u({type:"validation",message:"   /  ."});return}X(),l(Je.SUMMARY_EVALUATING),q(" ...");try{const ne=await dA(S.content,E,p,o);b(ne),o===Et.EXPLANATORY?H(ge=>({...ge,summary:ne.score,total:ne.score+ge.essays})):o===Et.ARGUMENTATIVE&&H(ge=>({...ge,summary:ne.score,total:ne.score+ge.claimEvidence+ge.counterArgument})),l(Je.DISPLAY_SUMMARY_EVALUATION),Y.current&&(Y.current.scrollTop=0)}catch(ne){console.error(ne),u({type:"api",message:ne instanceof Error?ne.message:"  "}),l(Je.USER_SUMMARY_INPUT)}finally{q(null)}},ae=()=>{o===Et.EXPLANATORY?O():o===Et.ARGUMENTATIVE&&l(Je.CLAIM_EVIDENCE_INPUT),Y.current&&(Y.current.scrollTop=0)},O=async()=>{if(S){l(Je.ESSAY_SETUP),q("  ..."),X();try{const ge=(await xA(S.content,2,p)).map((ke,te)=>({id:`nf-essay-${te}-${crypto.randomUUID()}`,questionText:ke.questionText,solutionText:ke.solutionText,userAnswer:"",isGrading:!1}));A(ge),_(Array(ge.length).fill("")),l(Je.ESSAY_SOLVE)}catch(ne){console.error(ne),u({type:"api",message:ne instanceof Error?ne.message:"   ."}),l(Je.ERROR)}finally{q(null)}}},se=(ne,ge)=>{const ke=[...C];ke[ne]=ge,_(ke)},J=async()=>{if(!S||o!==Et.EXPLANATORY||!k||C.some(he=>!he.trim())){u({type:"validation",message:"    ."});return}l(Je.ESSAY_GRADING),q("     ..."),X();const ne=T.map(async(he,be)=>{const ve=C[be];let $e={...he,isGrading:!0};A(ot=>ot.map(_n=>_n.id===he.id?$e:_n));try{const ot=await mA(S.content,he.questionText,ve,p);return{...$e,userAnswer:ve,score:ot.score,feedback:ot.feedback,isGrading:!1}}catch(ot){return console.error(ot),u(_n=>({type:"api",message:_n?`${_n.message}, ${be+1} .`:`${be+1} .`,details:String(ot)})),{...$e,userAnswer:ve,score:0,feedback:" .",isGrading:!1}}}),ge=await Promise.all(ne);A(ge);const ke=ge.reduce((he,be)=>he+(be.score||0),0),te=k,xe={...te,essays:ke,total:te.summary+ke};H(xe);try{const he=await Th(S.content,p,o,xe,(y==null?void 0:y.feedback)||null,ge);Z(he),n&&n({id:crypto.randomUUID(),subject:" ",moduleType:o,completedAt:new Date().toISOString(),difficulty:p,score:xe.total,maxPossibleScore:50+T.length*25,feedbackItems:[{type:"weak_points",feedback:he}]})}catch(he){console.error(he),Z("  .")}l(Je.SHOW_RESULTS),Y.current&&(Y.current.scrollTop=0),q(null)},re=(ne,ge,ke)=>{I(te=>{if(ne==="evidence"&&typeof ke=="number"){const xe=[...te.evidence];return xe[ke]=ge,{...te,evidence:xe}}return{...te,[ne]:ge}})},ie=()=>{I(ne=>({...ne,evidence:[...ne.evidence,""]}))},le=ne=>{L.evidence.length>1&&I(ge=>({...ge,evidence:ge.evidence.filter((ke,te)=>te!==ne)}))},pe=async()=>{if(!S||o!==Et.ARGUMENTATIVE||!k||!L.claim.trim()||L.evidence.some(ne=>!ne.trim())){u({type:"validation",message:"     ."});return}X(),l(Je.CLAIM_EVIDENCE_EVALUATING),q("/ ...");try{const ne=await fA(S.content,L,p);D(ne);const ge=k;H({...ge,claimEvidence:ne.score,total:ge.summary+ne.score+ge.counterArgument}),l(Je.DISPLAY_CLAIM_EVIDENCE_EVALUATION)}catch(ne){console.error(ne),u({type:"api",message:ne instanceof Error?ne.message:"/  ."}),l(Je.CLAIM_EVIDENCE_INPUT)}finally{q(null),Y.current&&(Y.current.scrollTop=0)}},ee=async()=>{if(!S||o!==Et.ARGUMENTATIVE||!k||!L.claim.trim()||!M.trim()){u({type:"validation",message:"     ."});return}X(),l(Je.COUNTER_ARGUMENT_EVALUATING),q(" ...");try{const ne=await hA(S.content,L.claim,M,p);B(ne);const ge=k,ke={...ge,counterArgument:ne.score,total:ge.summary+ge.claimEvidence+ne.score};H(ke);const te=await Th(S.content,p,o,ke,(y==null?void 0:y.feedback)||null,void 0,(j==null?void 0:j.feedback)||null,ne.feedback);Z(te),n&&n({id:crypto.randomUUID(),subject:" ",moduleType:o,completedAt:new Date().toISOString(),difficulty:p,score:ke.total,maxPossibleScore:100,feedbackItems:[{type:"weak_points",feedback:te}]}),l(Je.SHOW_RESULTS)}catch(ne){console.error(ne),u({type:"api",message:ne instanceof Error?ne.message:"  ."}),l(Je.COUNTER_ARGUMENT_INPUT)}finally{q(null),Y.current&&(Y.current.scrollTop=0)}},ue=()=>i?r.jsxs("div",{className:"my-4 p-3 bg-red-700/20 border border-red-500/60 text-red-200 rounded-md text-sm",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{children:[r.jsx("strong",{className:"font-semibold",children:":"})," ",i.message]}),r.jsx("button",{onClick:X,className:"p-1 hover:bg-red-500/30 rounded-full",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),i.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-80",children:[" : ",i.details]})]}):null,fe=(ne,ge=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[ne,ge&&r.jsxs("button",{onClick:G,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"    "]})]});if(z)return fe(r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center wonder-panel",children:[r.jsx(Ne,{size:"lg",color:R}),r.jsx("p",{className:"text-text-secondary mt-5 text-lg animate-pulse",children:z})]}),!1);if(s===Je.ERROR)return fe(r.jsxs("div",{className:"p-6 text-center wonder-panel",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),ue(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>W(!1),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:R},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}),!1);const ye=r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[o===Et.EXPLANATORY?r.jsx(Ao,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:Oa},strokeWidth:1.2}):o===Et.ARGUMENTATIVE?r.jsx(To,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:ka},strokeWidth:1.2}):r.jsx(ns,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:R},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:" "})]}),r.jsx("p",{className:"mb-6 text-body text-text-secondary leading-relaxed",children:"AI       ."}),ue(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:R}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(ne=>r.jsx("button",{onClick:()=>v(ne),className:`wonder-button wonder-button-secondary p-3 text-sm ${p===ne?"active":""}`,style:p===ne?{borderColor:R,backgroundColor:`color-mix(in srgb,${R} 25%,transparent)`,color:"var(--text-primary)"}:{},children:ne},ne))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(ns,{className:"w-6 h-6 mr-2",style:{color:R}}),"   "]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("button",{onClick:()=>P(Et.EXPLANATORY),className:`wonder-button p-4 text-lg ${o===Et.EXPLANATORY?"wonder-button-primary active":"wonder-button-secondary"}`,style:o===Et.EXPLANATORY?{backgroundColor:Oa,borderColor:Oa}:{},children:[r.jsx(Ao,{className:"w-6 h-6 mr-2 inline"})," "]}),r.jsxs("button",{onClick:()=>P(Et.ARGUMENTATIVE),className:`wonder-button p-4 text-lg ${o===Et.ARGUMENTATIVE?"wonder-button-primary active":"wonder-button-secondary"}`,style:o===Et.ARGUMENTATIVE?{backgroundColor:ka,borderColor:ka}:{},children:[r.jsx(To,{className:"w-6 h-6 mr-2 inline"})," "]})]})]}),o&&r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-text-primary flex items-center justify-center",children:[r.jsx(Lr,{className:"w-6 h-6 mr-2",style:{color:R}}),"   "]}),r.jsx("div",{className:"flex justify-center space-x-3 mb-4",children:Object.values(ds).map(ne=>r.jsx("button",{onClick:()=>d(ne),className:`wonder-button text-xs px-3 py-1.5 sm:px-4 sm:py-2 ${c===ne?"active":""}`,style:c===ne?{borderColor:R,backgroundColor:`color-mix(in srgb,${R} 70%,transparent)`,color:R}:{},children:ne},ne))}),c===ds.TOPIC_SEARCH&&r.jsx("div",{className:"flex items-center space-x-2",children:r.jsx("input",{type:"text",value:h,onChange:ne=>f(ne.target.value),placeholder:"   (: AI )",className:"wonder-input flex-grow p-3"})})]}),r.jsxs("button",{onClick:Q,disabled:!o||c===ds.TOPIC_SEARCH&&!h.trim(),className:"wonder-button wonder-button-primary w-full max-w-xs mx-auto px-8 py-3.5 text-lg mt-8",style:{backgroundColor:R,borderColor:R},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),Re=()=>{if(!S||!o)return r.jsx("p",{children:"  ."});let ne;switch(s){case Je.USER_SUMMARY_INPUT:ne=r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:R},children:[r.jsx(kt,{className:"w-6 h-6 mr-2 inline"})," "]}),r.jsx("p",{className:"text-text-secondary mb-3 text-sm",children:"    ."}),r.jsx("textarea",{value:E,onChange:be=>g(be.target.value),placeholder:" ...",rows:5,className:"wonder-input w-full p-2.5 text-sm"}),r.jsx("button",{onClick:K,disabled:!E.trim(),className:"wonder-button wonder-button-primary w-full mt-3 py-2.5",style:{backgroundColor:R},children:"   "})]});break;case Je.DISPLAY_SUMMARY_EVALUATION:ne=y?r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:R},children:[r.jsx(Yi,{className:"w-6 h-6 mr-2 inline"})," "]}),r.jsxs("div",{className:"mb-3 p-3 wonder-panel border-border-panel",children:[r.jsx("p",{className:"font-medium text-text-primary text-sm",children:" :"}),r.jsx("p",{className:"text-text-secondary whitespace-pre-wrap text-xs",children:E})]}),r.jsxs("div",{className:"p-3 wonder-panel",style:{borderColor:`color-mix(in srgb,${R} 70%,transparent)`},children:[r.jsxs("p",{className:"font-medium mb-1 text-sm",style:{color:R},children:["AI  (: ",y.score,"/",o===Et.EXPLANATORY?50:30,"):"]}),r.jsx("p",{className:"text-text-secondary whitespace-pre-wrap text-xs",children:y.feedback})]}),r.jsx("button",{onClick:ae,className:"wonder-button wonder-button-primary w-full mt-4 py-2.5",style:{backgroundColor:"var(--accent-english)"},children:o===Et.EXPLANATORY?"  ":"/ "})]}):null;break;case Je.ESSAY_SOLVE:ne=r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-3",style:{color:R},children:" "}),T.map((be,ve)=>r.jsxs("div",{className:"mb-4 p-3 border border-border-panel rounded",children:[r.jsxs("h4",{className:"text-md font-medium text-text-primary mb-1",children:[" ",ve+1,":"]}),r.jsx("p",{className:"text-text-secondary text-sm whitespace-pre-wrap mb-1.5",children:be.questionText}),r.jsx("textarea",{value:C[ve],onChange:$e=>se(ve,$e.target.value),placeholder:" ...",rows:3,className:"wonder-input w-full p-2 text-xs"})]},be.id)),r.jsx("button",{onClick:J,disabled:C.some(be=>!be.trim()),className:"wonder-button wonder-button-primary w-full mt-3 py-2.5",style:{backgroundColor:"var(--accent-english)"},children:"  "})]});break;case Je.CLAIM_EVIDENCE_INPUT:ne=r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:R},children:[r.jsx(Lr,{className:"w-6 h-6 mr-2 inline"}),"/ "]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{htmlFor:"claim",className:"block text-sm font-medium text-text-primary mb-1",children:" :"}),r.jsx("input",{type:"text",id:"claim",value:L.claim,onChange:be=>re("claim",be.target.value),className:"wonder-input w-full p-2 text-sm"})]}),L.evidence.map((be,ve)=>r.jsxs("div",{className:"mb-2",children:[r.jsxs("label",{htmlFor:`ev-${ve}`,className:"block text-sm font-medium text-text-primary mb-1",children:[" ",ve+1,":"]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"text",id:`ev-${ve}`,value:be,onChange:$e=>re("evidence",$e.target.value,ve),className:"wonder-input flex-grow p-2 text-sm"}),r.jsx("button",{onClick:()=>le(ve),disabled:L.evidence.length<=1,className:"wonder-button wonder-button-destructive p-1.5 ml-2 text-xs",children:r.jsx(Oe,{className:"w-4 h-4"})})]})]},ve)),r.jsx("button",{onClick:ie,className:"wonder-button wonder-button-secondary text-xs px-2 py-1 mb-3",style:{borderColor:R,color:R},children:"+  "}),r.jsx("button",{onClick:pe,disabled:!L.claim.trim()||L.evidence.some(be=>!be.trim()),className:"wonder-button wonder-button-primary w-full py-2.5",style:{backgroundColor:R},children:"/ "})]});break;case Je.DISPLAY_CLAIM_EVIDENCE_EVALUATION:ne=j?r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:R},children:[r.jsx(Yi,{className:"w-6 h-6 mr-2 inline"}),"/ "]}),r.jsxs("div",{className:"p-3 wonder-panel",style:{borderColor:`color-mix(in srgb,${R} 70%,transparent)`},children:[r.jsxs("p",{className:"font-medium mb-1 text-sm",style:{color:R},children:["AI  (: ",j.score,"/20):"]}),r.jsx("p",{className:"text-text-secondary whitespace-pre-wrap text-xs",children:j.feedback})]}),r.jsx("button",{onClick:()=>{l(Je.COUNTER_ARGUMENT_INPUT),Y.current&&(Y.current.scrollTop=0)},className:"wonder-button wonder-button-primary w-full mt-4 py-2.5",style:{backgroundColor:"var(--accent-english)"},children:" "})]}):null;break;case Je.COUNTER_ARGUMENT_INPUT:ne=r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:R},children:[r.jsx(uT,{className:"w-6 h-6 mr-2 inline"})," "]}),r.jsx("div",{className:"p-2 mb-3 wonder-panel border-border-panel text-xs",children:r.jsxs("p",{className:"text-text-secondary",children:[" : ",r.jsxs("strong",{style:{color:`color-mix(in srgb,${R} 80%,white)`},children:['"',L.claim,'"']})]})}),r.jsx("p",{className:"text-text-secondary mb-2 text-sm",children:"       ."}),r.jsx("textarea",{value:M,onChange:be=>U(be.target.value),placeholder:" ...",rows:6,className:"wonder-input w-full p-2 text-sm"}),r.jsx("button",{onClick:ee,disabled:!M.trim(),className:"wonder-button wonder-button-primary w-full mt-3 py-2.5",style:{backgroundColor:R},children:" "})]});break;case Je.SHOW_RESULTS:const ge=o===Et.EXPLANATORY,ke=k,te=ge?50+T.length*25:100,xe=te>0?Math.round(ke.total/te*100):0;let he="var(--color-incorrect)";xe>=80?he="var(--color-correct)":xe>=50&&(he="var(--color-warning)"),ne=r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[o===Et.EXPLANATORY?r.jsx(Ao,{className:"w-8 h-8 mr-2",style:{color:R}}):r.jsx(To,{className:"w-8 h-8 mr-2",style:{color:R}}),r.jsxs("h2",{className:"text-h2 font-semibold",style:{color:R},children:[" : ",o]})]}),r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:" "}),r.jsxs("div",{className:`grid grid-cols-1 ${ge?"sm:grid-cols-3":"sm:grid-cols-2 md:grid-cols-4"} gap-3 text-xs`,children:[r.jsxs("div",{className:"wonder-panel p-2 border border-border-panel",children:[r.jsx("p",{className:"text-text-secondary",children:""}),r.jsxs("p",{className:"text-md font-bold",style:{color:R},children:[ke.summary,"/",ge?50:30]})]}),ge&&r.jsxs("div",{className:"wonder-panel p-2 border border-border-panel",children:[r.jsx("p",{className:"text-text-secondary",children:""}),r.jsxs("p",{className:"text-md font-bold",style:{color:R},children:[ke.essays,"/",T.length*25]})]}),!ge&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wonder-panel p-2 border border-border-panel",children:[r.jsx("p",{className:"text-text-secondary",children:"/"}),r.jsxs("p",{className:"text-md font-bold",style:{color:R},children:[ke.claimEvidence,"/20"]})]}),r.jsxs("div",{className:"wonder-panel p-2 border border-border-panel",children:[r.jsx("p",{className:"text-text-secondary",children:""}),r.jsxs("p",{className:"text-md font-bold",style:{color:R},children:[ke.counterArgument,"/50"]})]})]}),r.jsxs("div",{className:`wonder-panel p-2 border-green-600/50 bg-green-700/20 ${ge?"":"md:col-span-4"}`,children:[r.jsx("p",{className:"text-text-tertiary",children:""}),r.jsxs("p",{className:"text-md font-bold text-color-correct",children:[ke.total,"/",te]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-1.5",children:r.jsx("div",{className:"h-1.5 rounded-full",style:{width:`${xe}%`,backgroundColor:he}})}),r.jsxs("p",{className:"text-right text-xs text-text-tertiary mt-0.5",children:[xe,"% "]})]})]}),F&&r.jsxs("div",{className:"mb-4 text-left",children:[r.jsxs("h4",{className:"text-md font-semibold text-text-primary mb-1 flex items-center",children:[r.jsx(_t,{className:"w-4 h-4 mr-1.5 text-yellow-300"}),"AI  "]}),r.jsx("div",{className:"p-2.5 wonder-panel text-text-secondary whitespace-pre-wrap prose-wonder max-w-none text-xs leading-relaxed",style:{borderColor:`color-mix(in srgb,${R} 50%,transparent)`},children:F})]}),r.jsxs("p",{className:"mt-3 text-center text-xs text-text-tertiary",children:["Let We Do (",new Date().toLocaleDateString(),")"]}),r.jsx("div",{className:"mt-5 flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3",children:r.jsxs("button",{onClick:()=>W(!0),className:"wonder-button wonder-button-primary flex items-center justify-center text-sm py-2",style:{backgroundColor:R,borderColor:R},children:[r.jsx(nt,{className:"w-4 h-4 mr-1.5"}),"  "]})})]});break;default:ne=r.jsx("p",{children:"  ..."})}return r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{ref:V,className:"lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold flex items-center",style:{color:R},children:[r.jsx(ns,{className:"w-6 h-6 mr-2"})," ",S.title||`${o} `]}),r.jsx("button",{onClick:G,title:"",className:"wonder-button wonder-button-secondary p-2 hidden lg:block",style:{color:R},children:r.jsx(Ce,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[r.jsxs("div",{className:"text-xs text-text-tertiary",children:[S.topic?`: ${S.topic}`:""," ",S.url&&r.jsx("a",{href:S.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline ml-2",style:{color:R},children:""})]}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium shadow-sm border",style:{backgroundColor:`color-mix(in srgb,${R} 20%,transparent)`,color:R,borderColor:`color-mix(in srgb,${R} 40%,transparent)`},children:p})]}),r.jsx("div",{className:"prose-wonder max-w-none text-text-secondary whitespace-pre-wrap text-sm leading-relaxed",children:S.content})]}),r.jsxs("div",{ref:Y,className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin",children:[ue(),ne]})]})};return s===Je.SELECT_SUB_TYPE?fe(ye,!1):fe(Re(),!0)},et="var(--accent-assessment)",yT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(Xe.SELECT_OPTIONS),[o,a]=w.useState(null),[i,u]=w.useState(t||me.MS_1_2),[c,d]=w.useState(null),[h,f]=w.useState(null),[p,v]=w.useState([]),[S,N]=w.useState(0),[E,g]=w.useState(void 0),[y,b]=w.useState(""),[T,A]=w.useState(null),[C,_]=w.useState({mcq:0,essay:0,totalMcqPossible:0,totalEssayPossible:30,total:0}),[L,I]=w.useState(null),[j,D]=w.useState(null),M=w.useRef(null),[U,$]=w.useState(!1);w.useEffect(()=>{t&&u(t)},[t]);const B=()=>a(null),k=(G=!1)=>{l(Xe.SELECT_OPTIONS),a(null),G||(u(t||me.MS_1_2),d(null)),f(null),v([]),N(0),g(void 0),b(""),A(null),$(!1),_({mcq:0,essay:0,totalMcqPossible:0,totalEssayPossible:30,total:0}),I(null),D(null)},H=()=>{k(!1),e()},F=G=>{B(),d(G),Z(G)},Z=w.useCallback(async G=>{l(Xe.FETCHING_CONCEPT),D(`AI '${G}'     ...`),f(null),B();try{const P=await yA(i,G);if(P!=null&&P.explanation&&P.examplesText)f(P),l(Xe.DISPLAY_CONCEPT);else throw new Error("Failed to fetch valid grammar concept.")}catch(P){console.error(P),a({type:"api",message:P instanceof Error?P.message:"   .",details:String(P)}),l(Xe.ERROR)}finally{D(null)}},[i]),z=async()=>{if(h){l(Xe.MCQ_SETUP),D("  ..."),B();try{const G=3+Math.floor(Math.random()*2),P=`${h.explanation}

:
${h.examplesText}`,K=(await bA(h.topicName,P,G,i)).map((ae,O)=>({id:`mcq-gram-${O}-${crypto.randomUUID()}`,originalQuestionText:ae.question,options:ae.options,correctAnswerIndex:ae.answer_index,explanation:ae.explanation,attemptsOnConcept:0,isConceptMastered:!1}));v(K),N(0),g(void 0),_(ae=>({...ae,mcq:0,essay:0,totalMcqPossible:K.length*5,total:0})),l(Xe.MCQ_SOLVE),M.current&&(M.current.scrollTop=0)}catch(G){console.error(G),a({type:"api",message:G instanceof Error?G.message:"   .",details:String(G)}),l(Xe.ERROR)}finally{D(null)}}},q=()=>{if(E===void 0||S>=p.length){a({type:"validation",message:"  ."});return}B();const G=p[S],P=E===G.correctAnswerIndex,Q={...G,userAnswerIndex:E,isCorrectAttempt:P,attemptsOnConcept:G.attemptsOnConcept+1,isConceptMastered:G.isConceptMastered||P},K=p.map((ae,O)=>O===S?Q:ae);v(K),P&&Q.attemptsOnConcept===1&&_(ae=>({...ae,mcq:ae.mcq+5,total:ae.mcq+5+ae.essay})),setTimeout(()=>{S>=K.length-1?l(Xe.GRAMMAR_ESSAY_SOLVE):(N(ae=>ae+1),g(void 0)),M.current&&(M.current.scrollTop=0)},1200)},Y=async()=>{if(!h||!y.trim()){a({type:"validation",message:"   ."});return}B(),$(!0),l(Xe.GRAMMAR_ESSAY_GRADING),D("    ...");try{const G=await vA(h,y);A(G);const P=G.score,Q={...C,essay:P,total:C.mcq+P};_(Q),D("  ...");const K=await EA(h,p,P,G.feedback);I(K),n&&h&&n({id:crypto.randomUUID(),subject:" ",moduleType:h.topicName,completedAt:new Date().toISOString(),difficulty:i,score:Q.total,maxPossibleScore:C.totalMcqPossible+C.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:K}]}),l(Xe.SHOW_RESULTS)}catch(G){console.error(G),a({type:"api",message:G instanceof Error?G.message:"  / .",details:String(G)}),l(Xe.GRAMMAR_ESSAY_SOLVE)}finally{$(!1),D(null),M.current&&(M.current.scrollTop=0)}},V=(G=!1)=>o?r.jsxs("div",{className:`w-full my-3 ${G?"":"max-w-xl mx-auto"} bg-red-700/20 border border-red-500/50 text-red-200 px-3 py-2.5 rounded-lg shadow-md text-xs sm:text-sm`,role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-0.5 text-red-100",children:""}),r.jsx("span",{className:"block sm:inline",children:o.message})]}),r.jsx("button",{onClick:B,className:"wonder-button p-1 text-red-300 hover:text-white rounded-full hover:bg-red-600/40",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),o.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-70",children:[" : ",o.details.substring(0,150),"..."]})]}):null,R=(G,P,Q=!0)=>r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-5xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Rs,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:et},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:et},children:G}),s!==Xe.SELECT_OPTIONS&&h&&r.jsxs("p",{className:"text-caption text-text-tertiary",children:["(",h.topicName," - ",i,")"]})]})]}),V(!0),P,Q&&s!==Xe.SELECT_OPTIONS&&r.jsxs("button",{onClick:H,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"})," "]})]})}),X=()=>r.jsxs("div",{className:"text-center",children:[V(),r.jsx("p",{className:"text-body text-text-secondary mb-6",children:"AI       ."}),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:et}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(G=>r.jsx("button",{onClick:()=>u(G),className:`wonder-button wonder-button-secondary p-3 text-sm ${i===G?"active":""}`,style:i===G?{borderColor:et,backgroundColor:`color-mix(in srgb,${et} 25%,transparent)`,color:"var(--text-primary)"}:{},children:G},G))})]}),r.jsxs("div",{className:"mt-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-text-primary flex items-center justify-center",children:[r.jsx(Rs,{className:"w-6 h-6 mr-2",style:{color:et}}),"    "]}),r.jsx("p",{className:"text-sm text-center mb-3 text-text-secondary",children:"   AI   ."}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.keys(Py).map(G=>r.jsx("button",{onClick:()=>F(G),disabled:s===Xe.FETCHING_CONCEPT&&c===G,className:`wonder-button wonder-button-secondary p-4 ${c===G&&s!==Xe.FETCHING_CONCEPT?"active":""} disabled:opacity-70`,style:c===G&&s!==Xe.FETCHING_CONCEPT?{borderColor:et,backgroundColor:`color-mix(in srgb,${et} 25%,transparent)`,color:"var(--text-primary)"}:{},children:G},G))})]}),s===Xe.FETCHING_CONCEPT&&j&&r.jsxs("div",{className:"mt-6 flex justify-center items-center",children:[r.jsx(Ne,{size:"sm",color:et}),r.jsx("p",{className:"ml-2 text-sm opacity-80 animate-pulse text-text-secondary",children:j})]})]}),W=()=>{if(!h&&s!==Xe.ERROR&&!j)return r.jsx("div",{className:"w-full h-96 flex items-center justify-center",children:j?r.jsx(Ne,{size:"lg",color:et}):r.jsx("p",{className:"text-text-secondary",children:"  ..."})});if(!h&&s===Xe.ERROR&&o)return V();if(!h&&s!==Xe.FETCHING_CONCEPT)return null;let G;switch(s){case Xe.DISPLAY_CONCEPT:G=r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-3",style:{color:et},children:"  "}),r.jsx("p",{className:"text-text-secondary mb-6",children:"   ,   ."}),r.jsx("button",{onClick:z,className:"wonder-button wonder-button-primary w-full py-3 text-lg",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:"  "})]});break;case Xe.MCQ_SETUP:G=r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[r.jsx(Ne,{size:"md",color:et}),r.jsx("p",{className:"ml-3 text-text-secondary animate-pulse",children:"  ..."})]});break;case Xe.MCQ_SOLVE:const P=p[S];G=P?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:et},children:["  ",S+1,"/",p.length]}),r.jsx("p",{className:"text-h4 text-text-primary mb-5 whitespace-pre-wrap",children:P.originalQuestionText}),r.jsx("div",{className:"space-y-3 mb-5",children:P.options.map((le,pe)=>{const ee=E===pe;let ue="wonder-button wonder-button-secondary w-full text-left p-3 border-2",fe={};return P.userAnswerIndex!==void 0?pe===P.correctAnswerIndex?(ue+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.15)]",fe={color:"var(--color-correct)",fontWeight:"500"}):pe===P.userAnswerIndex?(ue+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.15)]",fe={color:"var(--color-incorrect)"}):ue+=" opacity-60 border-[var(--border-panel)]":ee?(ue+=` active border-[${et}]`,fe={borderColor:et,backgroundColor:`color-mix(in srgb,${et} 20%,transparent)`,color:"var(--text-primary)"}):ue+=` border-[var(--border-panel)] hover:border-[${et}]`,r.jsxs("button",{onClick:()=>P.userAnswerIndex===void 0&&g(pe),disabled:P.userAnswerIndex!==void 0,className:ue,style:fe,children:[r.jsxs("span",{className:"font-mono mr-1.5",children:[String.fromCharCode(65+pe),"."]}),le]},pe)})}),P.userAnswerIndex!==void 0&&!P.isCorrectAttempt&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-red-800/30 border-red-600/50 text-sm",children:[r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx(Oe,{className:"w-4 h-4 mr-1.5 text-red-300"}),r.jsx("p",{className:"font-medium text-red-200",children:"."})]}),r.jsxs("p",{className:"text-text-secondary",children:[": ",P.options[P.correctAnswerIndex]]}),r.jsxs("p",{className:"text-text-tertiary text-xs",children:[": ",P.explanation]}),P.attemptsOnConcept<2&&r.jsx("button",{onClick:()=>{g(void 0),v(le=>le.map(pe=>pe.id===P.id?{...P,userAnswerIndex:void 0}:pe))},className:"wonder-button wonder-button-secondary mt-1.5 ml-5 px-2 py-1 text-xs",style:{borderColor:"var(--color-warning)",color:"var(--color-warning)"},children:" "})]}),P.userAnswerIndex!==void 0&&P.isCorrectAttempt&&r.jsxs("div",{className:"my-3 p-2.5 wonder-panel bg-green-800/30 border-green-600/50 text-green-200 font-medium flex items-center text-sm",children:[r.jsx(En,{className:"w-5 h-5 mr-2 text-green-300"}),"!"]}),P.userAnswerIndex===void 0&&r.jsx("button",{onClick:q,disabled:E===void 0,className:"wonder-button wonder-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:et,borderColor:et},children:" "}),P.userAnswerIndex!==void 0&&(P.isCorrectAttempt||P.attemptsOnConcept>=2)&&r.jsx("button",{onClick:()=>{S>=p.length-1?l(Xe.GRAMMAR_ESSAY_SOLVE):(N(le=>le+1),g(void 0))},className:"wonder-button wonder-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:S>=p.length-1?"  ( )":" "})]}):r.jsx("div",{children:"   ..."});break;case Xe.GRAMMAR_ESSAY_SOLVE:G=r.jsxs("div",{children:[r.jsx("h2",{className:"text-h3 font-semibold mb-3",style:{color:et},children:"  "}),r.jsxs("p",{className:"text-text-secondary mb-1.5 text-sm",children:["  ",r.jsxs("strong",{className:"text-text-primary",style:{color:`color-mix(in srgb,${et} 80%,white)`},children:['"',h==null?void 0:h.topicName,'"']}),"    ,    2  ."]}),r.jsx("p",{className:"text-xs text-text-tertiary mb-3",children:"(AI ,   .  30)"}),r.jsx("textarea",{value:y,onChange:le=>b(le.target.value),placeholder:"   ...",rows:8,className:"wonder-input w-full p-2.5 text-sm"}),r.jsx("button",{onClick:Y,disabled:!y.trim()||U,className:"wonder-button wonder-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:U?r.jsx(Ne,{size:"xs",color:"text-white"}):"   "})]});break;case Xe.GRAMMAR_ESSAY_GRADING:G=r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[r.jsx(Ne,{size:"md",color:et}),r.jsx("p",{className:"ml-3 text-text-secondary animate-pulse",children:"  ..."})]});break;case Xe.SHOW_RESULTS:const{mcq:Q,essay:K,totalMcqPossible:ae,totalEssayPossible:O,total:se}=C,J=ae+O,re=J>0?Math.round(se/J*100):0;let ie="var(--color-incorrect)";re>=80?ie="var(--color-correct)":re>=50&&(ie="var(--color-warning)"),h&&`${h.topicName}`,G=r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"mb-5 pb-5 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[r.jsxs("div",{className:"wonder-panel-inset p-3",children:[r.jsx("p",{className:"text-xs text-text-secondary",children:" "}),r.jsxs("p",{className:"text-lg font-bold",style:{color:et},children:[Q,"/",ae]})]}),r.jsxs("div",{className:"wonder-panel-inset p-3",children:[r.jsx("p",{className:"text-xs text-text-secondary",children:" "}),r.jsxs("p",{className:"text-lg font-bold",style:{color:`color-mix(in srgb,${et} 80%,white)`},children:[K,"/",O]})]}),r.jsxs("div",{className:"wonder-panel-inset p-3 border-green-600/50 bg-green-700/20",children:[r.jsx("p",{className:"text-xs text-text-tertiary",children:""}),r.jsxs("p",{className:"text-lg font-bold text-color-correct",children:[se,"/",J]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full",style:{width:`${re}%`,backgroundColor:ie}})}),r.jsxs("p",{className:"text-right text-xs text-text-tertiary mt-0.5",children:[re,"% "]})]})]}),L&&r.jsxs("div",{className:"mb-5 pb-5 border-b border-[var(--border-panel)] text-left",children:[r.jsxs("h3",{className:"text-h4 font-semibold text-text-primary mb-1.5 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-1.5 text-yellow-300"}),"AI  "]}),r.jsx("div",{className:"p-3 wonder-panel-inset text-text-secondary whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",children:L}),(T==null?void 0:T.feedback)&&r.jsxs("div",{className:"mt-2 p-2.5 wonder-panel-inset text-xs",children:[r.jsx("p",{className:"font-medium",style:{color:`color-mix(in srgb,${et} 80%,white)`},children:"   :"}),r.jsx("p",{className:"text-text-secondary whitespace-pre-wrap mt-0.5",children:T.feedback})]})]}),p.length>0&&r.jsxs("div",{className:"text-left text-xs",children:[r.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-1",children:"  :"}),r.jsx("ul",{className:"list-decimal list-inside pl-3 space-y-0.5 text-text-tertiary",children:p.map(le=>r.jsxs("li",{children:[le.originalQuestionText.substring(0,40),"..."]},le.id))})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-text-tertiary",children:["Let We Do (",new Date().toLocaleDateString(),")"]}),r.jsx("div",{className:"mt-6 flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3",children:r.jsxs("button",{onClick:()=>k(!0),className:"wonder-button wonder-button-primary flex items-center justify-center text-sm py-2",style:{backgroundColor:et,borderColor:et},children:[r.jsx(Rs,{className:"w-4 h-4 mr-1.5"}),"   ( )"]})})]});break;default:G=r.jsx("p",{children:"  ..."})}return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[h&&r.jsxs("div",{className:"lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin",children:[r.jsx("div",{className:"flex justify-between items-center mb-3",children:r.jsxs("h2",{className:"text-h3 font-semibold flex items-center",style:{color:et},children:[r.jsx(Rs,{className:"w-6 h-6 mr-2"})," ",h.topicName]})}),r.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[r.jsxs("span",{className:"text-xs text-text-tertiary",children:[": ",h.categoryKey]}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium shadow-sm border",style:{backgroundColor:`color-mix(in srgb,${et} 20%,transparent)`,color:et,borderColor:`color-mix(in srgb,${et} 40%,transparent)`},children:h.difficulty})]}),r.jsx("h4",{className:"text-md font-medium text-text-primary mt-3 mb-1",children:":"}),r.jsx("div",{className:"prose-wonder max-w-none text-text-secondary whitespace-pre-wrap text-sm leading-relaxed",children:h.explanation}),r.jsx("h4",{className:"text-md font-medium text-text-primary mt-3 mb-1",children:":"}),r.jsx("div",{className:"prose-wonder max-w-none text-text-secondary whitespace-pre-wrap text-sm leading-relaxed",children:h.examplesText})]}),r.jsxs("div",{ref:M,className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin",children:[V(!0),G]})]})};return j&&(s===Xe.FETCHING_CONCEPT||s===Xe.MCQ_SETUP||s===Xe.GRAMMAR_ESSAY_GRADING)?R(" ",r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[j&&r.jsx(Ne,{size:"lg",color:et}),j&&r.jsx("p",{className:"text-text-secondary ml-4 text-lg animate-pulse",children:j})]}),!1):s===Xe.ERROR?R(" ",r.jsxs("div",{children:[V(),r.jsx("button",{onClick:H,className:"wonder-button wonder-button-secondary mt-4 block mx-auto",children:""})]}),!1):s===Xe.SELECT_OPTIONS?R(" ",X(),!1):R(" ",W(),!0)},Ut="var(--accent-korean)",bT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(Gt.SELECT_OPTIONS),[o,a]=w.useState(null),[i,u]=w.useState(t||me.MS_1_2),[c,d]=w.useState(ci.POETRY),[h,f]=w.useState(null),[p,v]=w.useState(""),[S,N]=w.useState(null),[E,g]=w.useState({writing:0,total:0}),[y,b]=w.useState(null),[T,A]=w.useState("prompt"),C=w.useRef(null);w.useEffect(()=>{t&&u(t)},[t]);const _=()=>a(null),L=(k=!1)=>{l(Gt.SELECT_OPTIONS),a(null),k||u(t||me.MS_1_2),d(ci.POETRY),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt"),b(null)},I=()=>{L(!1),e()},j=w.useCallback(async()=>{if(!c){a({type:"validation",message:"  ."}),l(Gt.SELECT_OPTIONS);return}l(Gt.FETCHING_PROMPT),b("AI    ..."),_(),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt");try{const k=await aA(i,c);if(k!=null&&k.topic)f(k),l(Gt.DISPLAY_PROMPT_AND_INPUT),A("input");else throw new Error("AI     .")}catch(k){console.error(k),a({type:"api",message:k instanceof Error?k.message:"     ",details:String(k)}),l(Gt.ERROR)}finally{b(null)}},[i,c]),D=async()=>{if(!h||!p.trim()){a({type:"validation",message:"  ."});return}_(),l(Gt.EVALUATING_WRITING),b("AI    ...");try{const k=await iA(h,p,i,c);N(k),g({writing:k.score,total:k.score}),n&&n({id:crypto.randomUUID(),subject:"  ",moduleType:c,completedAt:new Date().toISOString(),difficulty:i,score:k.score,maxPossibleScore:100,feedbackItems:[{type:"writing_eval",feedback:k.feedback,score:k.score,maxScore:100}]}),l(Gt.DISPLAY_EVALUATION),A("input"),C.current&&(C.current.scrollTop=0)}catch(k){console.error(k),a({type:"api",message:k instanceof Error?k.message:"    ",details:String(k)}),l(Gt.DISPLAY_PROMPT_AND_INPUT)}finally{b(null)}},M=()=>o?r.jsx("div",{className:"w-full my-4 bg-color-incorrect/10 border border-color-incorrect/30 text-color-incorrect px-4 py-3 rounded-lg",role:"alert",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:o.message})]}),r.jsx("button",{onClick:_,className:"p-1.5 rounded-full hover:bg-color-incorrect/20 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]})}):null,U=()=>r.jsxs("div",{className:"w-full max-w-2xl text-center mx-auto p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(kt,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:Ut},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:"  "})]}),r.jsx("p",{className:"mb-4 text-body text-text-secondary leading-relaxed",children:"AI       ."}),M(),r.jsxs("div",{className:"my-6 md:my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(pt,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:Ut}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(k=>r.jsx("button",{onClick:()=>u(k),className:`wonder-button wonder-button-secondary px-4 py-2 text-xs sm:px-5 sm:py-2.5 sm:text-sm ${i===k?"active":""}`,style:i===k?{borderColor:Ut,backgroundColor:`color-mix(in srgb, ${Ut} 25%, transparent)`,color:`color-mix(in srgb, ${Ut} 100%, var(--text-primary))`}:{},children:k},k))})]}),r.jsxs("div",{className:"my-6 md:my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(kt,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"var(--accent-secondary)"}}),"   "]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Object.values(ci).map(k=>r.jsx("button",{onClick:()=>d(k),className:`wonder-button wonder-button-secondary p-3 sm:p-4 text-sm sm:text-base ${c===k?"active":""}`,style:c===k?{borderColor:"var(--accent-secondary)",backgroundColor:"color-mix(in srgb, var(--accent-secondary) 25%, transparent)",color:"var(--accent-secondary)"}:{},children:k},k))})]}),r.jsx("button",{onClick:j,disabled:s===Gt.FETCHING_PROMPT||!c,className:"wonder-button wonder-button-primary mt-8 w-full max-w-xs mx-auto px-8 py-3.5 text-lg",style:{backgroundColor:Ut,borderColor:Ut},children:s===Gt.FETCHING_PROMPT?r.jsx(Ne,{size:"sm",color:"text-white"}):"  "}),r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),$=k=>r.jsxs("div",{className:"w-full h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Ut}),r.jsx("p",{className:"text-text-secondary mt-5 text-lg animate-pulse",children:k})]}),B=()=>{if(!h)return null;const k=T==="prompt",H=T==="input";let F;if(s===Gt.DISPLAY_PROMPT_AND_INPUT||s===Gt.EVALUATING_WRITING)F=r.jsxs("div",{className:"flex-grow flex flex-col",children:[r.jsx("textarea",{value:p,onChange:Z=>v(Z.target.value),placeholder:"   ...",rows:15,className:"wonder-input w-full p-3.5 text-base flex-grow","aria-label":"  ",disabled:s===Gt.EVALUATING_WRITING}),r.jsx("button",{onClick:D,disabled:!p.trim()||s===Gt.EVALUATING_WRITING,className:"wonder-button wonder-button-primary mt-4 w-full px-8 py-3.5 text-lg",style:{backgroundColor:Ut,borderColor:Ut},children:s===Gt.EVALUATING_WRITING?r.jsx(Ne,{size:"sm",color:"white"}):"   AI "})]});else if(s===Gt.DISPLAY_EVALUATION&&S){const{score:Z,feedback:z,strengths:q,areasForImprovement:Y}=S;let V="var(--color-incorrect)";Z>=80?V="var(--color-correct)":Z>=50&&(V="var(--color-warning)"),F=r.jsxs("div",{children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:"AI  "}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:Ut},children:[Z,r.jsx("span",{className:"text-2xl text-text-tertiary",children:"/100"})]}),r.jsx("div",{className:"w-full bg-bg-base rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full transition-all duration-500 ease-out",style:{width:`${Z}%`,backgroundColor:V}})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-1",children:" "}),r.jsx("p",{className:"text-sm text-text-secondary whitespace-pre-wrap",children:z})]}),(q==null?void 0:q.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-green-500 mb-1",children:"  "}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:q.map((R,X)=>r.jsx("li",{children:R},`s-${X}`))})]}),(Y==null?void 0:Y.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-yellow-500 mb-1",children:"  "}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:Y.map((R,X)=>r.jsx("li",{children:R},`a-${X}`))})]})]})]})}return r.jsxs("div",{className:"w-full max-w-4xl mx-auto p-2",children:[r.jsxs("div",{className:"wonder-panel p-6 sm:p-8",ref:C,children:[r.jsxs("div",{className:"flex justify-between items-start mb-4 pb-4 border-b border-border-panel",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(ns,{className:"w-8 h-8 flex-shrink-0",style:{color:Ut}}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-h2 font-bold",style:{color:Ut},children:c}),r.jsx("p",{className:"text-sm text-text-secondary",children:"AI      ."})]})]}),r.jsx("span",{className:"text-xs font-semibold px-3 py-1 rounded-full bg-bg-base border border-border-interactive text-text-secondary",style:{borderColor:Ut,color:Ut},children:i})]}),M(),k&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:" "}),r.jsx("p",{className:"text-body text-text-secondary whitespace-pre-wrap leading-relaxed mb-4",children:h.topic}),h.tips&&h.tips.length>0&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-border-interactive",children:[r.jsx("h4",{className:"text-md font-semibold text-yellow-500 mb-1",children:"AI  :"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-0.5",children:h.tips.map((Z,z)=>r.jsx("li",{children:Z},`tip-${z}`))})]})]}),H&&F]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary text-sm",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),"    "]})}),r.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col space-y-3 z-40",children:[r.jsx("button",{onClick:()=>A("prompt"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="prompt"?"active":""}`,style:T==="prompt"?{borderColor:Ut,backgroundColor:`color-mix(in srgb, ${Ut} 20%, transparent)`}:{},children:r.jsx(Bs,{className:"w-6 h-6",title:" "})}),r.jsx("button",{onClick:()=>A("input"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="input"?"active":""}`,style:T==="input"?{borderColor:Ut,backgroundColor:`color-mix(in srgb, ${Ut} 20%, transparent)`}:{},children:r.jsx(Yn,{className:"w-6 h-6",title:""})})]})]})};return s===Gt.SELECT_OPTIONS?U():y?$(y):o?r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 wonder-panel",children:[M(),r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary mt-4",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),""]})]}):B()},vT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(Zt.SELECT_OPTIONS),[o,a]=w.useState(null),[i,u]=w.useState(t||me.MS_1_2),[c,d]=w.useState(Qs.ARGUMENTATIVE_ESSAY),[h,f]=w.useState(null),[p,v]=w.useState(""),[S,N]=w.useState(null),[E,g]=w.useState({writing:0,total:0}),[y,b]=w.useState(null),[T,A]=w.useState("prompt"),C=w.useRef(null),_=c===Qs.EXPLANATORY_ESSAY?"var(--accent-science)":"var(--accent-assessment)";w.useEffect(()=>{t&&u(t)},[t]);const L=()=>a(null),I=(H=!1)=>{l(Zt.SELECT_OPTIONS),a(null),H||u(t||me.MS_1_2),d(Qs.ARGUMENTATIVE_ESSAY),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt"),b(null)},j=()=>{I(!1),e()},D=w.useCallback(async()=>{if(!c){a({type:"validation",message:"  ."});return}l(Zt.FETCHING_PROMPT),b(`AI '${c}'    ...`),L(),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt");try{const H=await pA(i,c);if(H!=null&&H.topic)f(H),l(Zt.DISPLAY_PROMPT_AND_INPUT),A("input");else throw new Error("AI     .")}catch(H){console.error(H),a({type:"api",message:H instanceof Error?H.message:"     ",details:String(H)}),l(Zt.ERROR)}finally{b(null)}},[i,c]),M=async()=>{if(!h||!p.trim()){a({type:"validation",message:"  ."});return}L(),l(Zt.EVALUATING_WRITING),b("AI    ...");try{const H=await gA(h,p,i,c);N(H);const F={writing:H.score,total:H.score};g(F),n&&n({id:crypto.randomUUID(),subject:"  ",moduleType:c,completedAt:new Date().toISOString(),difficulty:i,score:F.total,maxPossibleScore:100,feedbackItems:[{type:"writing_eval",feedback:H.feedback,score:H.score,maxScore:100}]}),l(Zt.DISPLAY_EVALUATION),A("input"),C.current&&(C.current.scrollTop=0)}catch(H){console.error(H),a({type:"api",message:H instanceof Error?H.message:"    ",details:String(H)}),l(Zt.DISPLAY_PROMPT_AND_INPUT)}finally{b(null)}},U=()=>o?r.jsx("div",{className:"w-full my-4 bg-color-incorrect/10 border border-color-incorrect/30 text-color-incorrect px-4 py-3 rounded-lg",role:"alert",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:o.message})]}),r.jsx("button",{onClick:L,className:"p-1.5 rounded-full hover:bg-color-incorrect/20 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]})}):null,$=()=>r.jsxs("div",{className:"w-full max-w-2xl text-center mx-auto p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(kt,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:_},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:"  "})]}),r.jsx("p",{className:"mb-4 text-body text-text-secondary leading-relaxed",children:"AI         ."}),U(),r.jsxs("div",{className:"my-6 md:my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(pt,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:_}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(H=>r.jsx("button",{onClick:()=>u(H),className:`wonder-button wonder-button-secondary px-4 py-2 text-xs sm:px-5 sm:py-2.5 sm:text-sm ${i===H?"active":""}`,style:i===H?{borderColor:_,backgroundColor:`color-mix(in srgb, ${_} 25%, transparent)`,color:`color-mix(in srgb, ${_} 100%, var(--text-primary))`}:{},children:H},H))})]}),r.jsxs("div",{className:"my-6 md:my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(kt,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:_}}),"   "]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Object.values(Qs).map(H=>r.jsx("button",{onClick:()=>d(H),className:`wonder-button wonder-button-secondary p-3 sm:p-4 text-sm sm:text-base ${c===H?"active":""}`,style:c===H?{borderColor:H===Qs.EXPLANATORY_ESSAY?"var(--accent-science)":"var(--accent-assessment)",backgroundColor:`color-mix(in srgb, ${H===Qs.EXPLANATORY_ESSAY?"var(--accent-science)":"var(--accent-assessment)"} 25%, transparent)`,color:H===Qs.EXPLANATORY_ESSAY?"var(--accent-science)":"var(--accent-assessment)"}:{},children:H},H))})]}),r.jsx("button",{onClick:D,disabled:s===Zt.FETCHING_PROMPT||!c,className:"wonder-button wonder-button-primary mt-8 w-full max-w-xs mx-auto px-8 py-3.5 text-lg",style:{backgroundColor:_,borderColor:_},children:s===Zt.FETCHING_PROMPT?r.jsx(Ne,{size:"sm",color:"text-white"}):"  "}),r.jsxs("button",{onClick:j,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),B=H=>r.jsxs("div",{className:"w-full h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:_}),r.jsx("p",{className:"text-text-secondary mt-5 text-lg animate-pulse",children:H})]}),k=()=>{if(!h)return null;const H=T==="prompt",F=T==="input";let Z;if(s===Zt.DISPLAY_PROMPT_AND_INPUT||s===Zt.EVALUATING_WRITING)Z=r.jsxs("div",{className:"flex-grow flex flex-col",children:[r.jsx("textarea",{value:p,onChange:z=>v(z.target.value),placeholder:"  ...",rows:15,className:"wonder-input w-full p-3.5 text-base flex-grow","aria-label":"  ",disabled:s===Zt.EVALUATING_WRITING}),r.jsx("button",{onClick:M,disabled:!p.trim()||s===Zt.EVALUATING_WRITING,className:"wonder-button wonder-button-primary mt-4 w-full px-8 py-3.5 text-lg",style:{backgroundColor:_,borderColor:_},children:s===Zt.EVALUATING_WRITING?r.jsx(Ne,{size:"sm",color:"white"}):"   AI "})]});else if(s===Zt.DISPLAY_EVALUATION&&S){const{score:z,feedback:q,strengths:Y,areasForImprovement:V}=S;let R="var(--color-incorrect)";z>=80?R="var(--color-correct)":z>=50&&(R="var(--color-warning)"),Z=r.jsxs("div",{children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:"AI  "}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:_},children:[z,r.jsx("span",{className:"text-2xl text-text-tertiary",children:"/100"})]}),r.jsx("div",{className:"w-full bg-bg-base rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full transition-all duration-500 ease-out",style:{width:`${z}%`,backgroundColor:R}})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-1",children:" "}),r.jsx("p",{className:"text-sm text-text-secondary whitespace-pre-wrap",children:q})]}),(Y==null?void 0:Y.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-green-500 mb-1",children:"  "}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:Y.map((X,W)=>r.jsx("li",{children:X},`s-${W}`))})]}),(V==null?void 0:V.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-yellow-500 mb-1",children:"  "}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:V.map((X,W)=>r.jsx("li",{children:X},`a-${W}`))})]})]})]})}return r.jsxs("div",{className:"w-full max-w-4xl mx-auto p-2",children:[r.jsxs("div",{className:"wonder-panel p-6 sm:p-8",ref:C,children:[r.jsxs("div",{className:"flex justify-between items-start mb-4 pb-4 border-b border-border-panel",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(kt,{className:"w-8 h-8 flex-shrink-0",style:{color:_}}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-h2 font-bold",style:{color:_},children:c}),r.jsx("p",{className:"text-sm text-text-secondary",children:"AI      ."})]})]}),r.jsx("span",{className:"text-xs font-semibold px-3 py-1 rounded-full bg-bg-base border border-border-interactive text-text-secondary",style:{borderColor:_,color:_},children:i})]}),U(),H&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:" "}),r.jsx("p",{className:"text-body text-text-secondary whitespace-pre-wrap leading-relaxed mb-4",children:h.topic}),h.tips&&h.tips.length>0&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-border-interactive",children:[r.jsx("h4",{className:"text-md font-semibold text-yellow-500 mb-1",children:"AI  :"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-0.5",children:h.tips.map((z,q)=>r.jsx("li",{children:z},`tip-${q}`))})]})]}),F&&Z]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("button",{onClick:j,className:"wonder-button wonder-button-secondary text-sm",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),"    "]})}),r.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col space-y-3 z-40",children:[r.jsx("button",{onClick:()=>A("prompt"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="prompt"?"active":""}`,style:T==="prompt"?{borderColor:_,backgroundColor:`color-mix(in srgb, ${_} 20%, transparent)`}:{},children:r.jsx(Bs,{className:"w-6 h-6",title:" "})}),r.jsx("button",{onClick:()=>A("input"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="input"?"active":""}`,style:T==="input"?{borderColor:_,backgroundColor:`color-mix(in srgb, ${_} 20%, transparent)`}:{},children:r.jsx(Yn,{className:"w-6 h-6",title:""})})]})]})};return s===Zt.SELECT_OPTIONS?$():y?B(y):o?r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 wonder-panel",children:[U(),r.jsxs("button",{onClick:j,className:"wonder-button wonder-button-secondary mt-4",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),""]})]}):k()},La=2,Ou=1,ku=30,Ql=5,Mh=20,We="var(--accent-english)",ET=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(st.SELECT_SOURCE_AND_DIFFICULTY),[a,i]=w.useState(null),[u,c]=w.useState(null),[d,h]=w.useState(""),[f,p]=w.useState(t||me.MS_1_2),[v,S]=w.useState(null),[N,E]=w.useState(""),[g,y]=w.useState(null),[b,T]=w.useState([]),[A,C]=w.useState(0),[_,L]=w.useState(void 0),[I,j]=w.useState([]),[D,M]=w.useState([]),[U,$]=w.useState({summary:0,mcq:0,essay:0,total:0,totalSummaryPossible:ku,totalMcqPossible:La*Ql,totalEssayPossible:Ou*Mh}),[B,k]=w.useState(null),[H,F]=w.useState(null),[Z,z]=w.useState(!1),q=w.useRef(null),Y=w.useRef(null);w.useEffect(()=>{t&&p(t)},[t]);const V=()=>i(null),R=te=>r.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:We}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:te})]}),X=(te=!1)=>{o(st.SELECT_SOURCE_AND_DIFFICULTY),i(null),c(null),h(""),te||p(t||me.MS_1_2),S(null),E(""),y(null),T([]),j([]),M([]),$({summary:0,mcq:0,essay:0,total:0,totalSummaryPossible:ku,totalMcqPossible:La*Ql,totalEssayPossible:Ou*Mh}),k(null),C(0),L(void 0),F(null)},W=()=>{X(!1),e()},G=te=>{V(),c(te),te===os.AI_GENERATED&&P(te)},P=w.useCallback(async(te,xe)=>{o(st.FETCHING_TEXT),F(te===os.AI_GENERATED?"AI    ...":`"${xe}"     ...`),S(null),V();try{let he=null;if(te===os.AI_GENERATED)he=await NA(f);else if(te===os.TOPIC_SEARCH&&(xe!=null&&xe.trim()))he=await SA(xe,f);else if(te===os.TOPIC_SEARCH&&!(xe!=null&&xe.trim())){i({type:"validation",message:"  ."}),o(st.SELECT_SOURCE_AND_DIFFICULTY),F(null);return}he&&he.content?(S(he),o(st.USER_SUMMARY_INPUT)):(i({type:"api",message:"  .     ."}),o(st.ERROR))}catch(he){console.error(he),i({type:"api",message:he instanceof Error?he.message:"    .",details:String(he)}),o(st.ERROR)}finally{F(null)}},[f]),Q=async()=>{if(!v||!N.trim()){i({type:"validation",message:"  ."});return}V(),o(st.USER_SUMMARY_EVALUATING),F("AI    ...");try{const te=await wA(v.content,N,f);y(te),$(xe=>({...xe,summary:te.score,total:te.score+xe.mcq+xe.essay})),o(st.DISPLAY_SUMMARY_EVALUATION)}catch(te){console.error(te),i({type:"api",message:te instanceof Error?te.message:"    .",details:String(te)}),o(st.USER_SUMMARY_INPUT)}finally{F(null)}},K=async()=>{if(v){o(st.MCQ_SETUP),F("AI    ..."),V();try{const xe=(await _h(v.content,La,f)).map((he,be)=>({id:`eng-mcq-${be}-${crypto.randomUUID()}`,originalQuestionText:he.question,options:he.options,correctAnswerIndex:he.answer_index,explanation:he.explanation,attemptsOnConcept:0,isConceptMastered:!1}));T(xe),C(0),L(void 0),o(st.MCQ_SOLVE)}catch(te){console.error(te),i({type:"api",message:te instanceof Error?te.message:"    .",details:String(te)}),o(st.ERROR)}finally{F(null)}}},ae=()=>{if(_===void 0){i({type:"validation",message:" ."});return}V();let xe={...b[A]};xe.userAnswerIndex=_,xe.isCorrectAttempt=_===xe.correctAnswerIndex,xe.attemptsOnConcept+=1;let he=U.mcq;xe.isCorrectAttempt&&(xe.isConceptMastered=!0,xe.attemptsOnConcept===1&&(he+=Ql));const be=b.map(ve=>ve.id===xe.id?xe:ve);T(be),$(ve=>({...ve,mcq:he,total:ve.summary+he+ve.essay})),(xe.isCorrectAttempt||xe.attemptsOnConcept>=2)&&setTimeout(()=>{A>=b.length-1?O():(C(ve=>ve+1),L(void 0)),q.current&&(q.current.scrollTop=0)},xe.isCorrectAttempt?1200:2e3)},O=w.useCallback(async()=>{if(v){o(st.ESSAY_SETUP),F("AI    ..."),V();try{const xe=(await jh(v.content,Ou,f)).map((he,be)=>({id:`eng-essay-${be}-${crypto.randomUUID()}`,questionText:he.questionText,solutionText:he.solutionText,userAnswer:"",isGrading:!1}));j(xe),M(Array(xe.length).fill("")),o(st.ESSAY_SOLVE)}catch(te){console.error(te),i({type:"api",message:te instanceof Error?te.message:"    .",details:String(te)}),o(st.ERROR)}finally{F(null)}q.current&&(q.current.scrollTop=0)}},[v,f]),se=(te,xe)=>{const he=[...D];he[te]=xe,M(he)},J=async()=>{if(!v||D.some($e=>!$e.trim())){i({type:"validation",message:"   ."});return}o(st.ESSAY_GRADING),F("AI    ..."),V();let te=0;const xe=I.map(async($e,ot)=>{const _n=D[ot];let Ee={...$e,isGrading:!0};j(Ie=>Ie.map(Be=>Be.id===$e.id?Ee:Be));try{const Ie=await CA(v.content,$e.questionText,_n,f);return te+=Ie.score,{...Ee,userAnswer:_n,score:Ie.score,feedback:Ie.feedback,isGrading:!1}}catch(Ie){return console.error(`Error grading essay ${ot}:`,Ie),i(Be=>({type:"api",message:Be!=null&&Be.message?`${Be.message},   ${ot+1}  .`:`  ${ot+1}  .`,details:String(Ie)})),{...Ee,userAnswer:_n,score:0,feedback:"  .",isGrading:!1}}}),he=await Promise.all(xe);j(he);const be=he.reduce(($e,ot)=>$e+(ot.score||0),0),ve={...U,essay:be,total:U.summary+U.mcq+be};$(ve),F("AI    ...");try{const $e=await AA(v,b,he,f,ve);k($e),n&&v&&n({id:crypto.randomUUID(),subject:"English Reading",moduleType:v.topic||v.title||"Reading Passage",completedAt:new Date().toISOString(),difficulty:f,score:ve.total,maxPossibleScore:ve.totalSummaryPossible+ve.totalMcqPossible+ve.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:$e}]})}catch($e){console.error("Error generating weak points feedback:",$e),k("     .")}o(st.SHOW_RESULTS),F(null),q.current&&(q.current.scrollTop=0)},re=w.useCallback(async(te,xe)=>{if(!(Z||!window.confirm("       ,     .  ?"))){if(z(!0),F("AI      ..."),V(),xe==="mcq"&&v){const he=b.findIndex(be=>be.id===te);if(he===-1){z(!1),F(null);return}if(T(be=>be.map(ve=>ve.id===te?{...ve,hintUsed:!0,userAnswerIndex:ve.correctAnswerIndex,isCorrectAttempt:!1}:ve)),U.mcq>0){const be=b[he];be.isCorrectAttempt&&be.attemptsOnConcept===1&&$(ve=>({...ve,mcq:ve.mcq-Ql,total:ve.total-Ql}))}try{const be=await _h(v.content,1,f);if(be.length>0){const ve=be[0],$e={id:`eng-mcq-hint-${crypto.randomUUID()}`,originalQuestionText:ve.question,options:ve.options,correctAnswerIndex:ve.answer_index,explanation:ve.explanation,attemptsOnConcept:0,isConceptMastered:!1};T(ot=>[...ot,$e])}}catch(be){console.error("Failed to generate hint question",be),i({type:"api",message:"   ."})}}else if(xe==="essay"&&v){if(I.findIndex(be=>be.id===te)===-1){z(!1),F(null);return}j(be=>be.map(ve=>ve.id===te?{...ve,hintUsed:!0,score:0,feedback:` : ${ve.solutionText}`}:ve));try{const be=await jh(v.content,1,f);if(be.length>0){const ve=be[0],$e={id:`eng-essay-hint-${crypto.randomUUID()}`,questionText:ve.questionText,solutionText:ve.solutionText,userAnswer:"",isGrading:!1};j(ot=>[...ot,$e]),M(ot=>[...ot,""])}}catch(be){console.error("Failed to generate hint essay question",be),i({type:"api",message:"    ."})}}z(!1),F(null)}},[b,I,v,f,Z,U.mcq]),ie=()=>a?r.jsxs("div",{className:"w-full my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:""}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:V,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]})]}):null,le=(te,xe,he=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[xe,he&&l!==st.SELECT_SOURCE_AND_DIFFICULTY&&r.jsxs("button",{onClick:W,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]}),pe=()=>r.jsxs("div",{className:"wonder-panel p-6 text-center max-w-2xl mx-auto",children:[ie(),r.jsxs("button",{onClick:W,className:"wonder-button wonder-button-primary mt-6",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2 inline"}),"  "]})]}),ee=(te="my-6",xe="px-4 py-2 text-xs sm:px-5 sm:py-2.5 sm:text-sm")=>r.jsxs("div",{className:te,children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:We}}),"  "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(he=>r.jsx("button",{onClick:()=>p(he),className:`wonder-button wonder-button-secondary ${xe} ${f===he?"active":""}`,style:f===he?{borderColor:We,backgroundColor:`color-mix(in srgb, ${We} 25%, transparent)`,color:We}:{},children:he},he))})]}),ue=()=>r.jsxs("div",{className:"w-full max-w-2xl text-center mx-auto p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(ns,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:We},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:"  "})]}),r.jsx("p",{className:"mb-6 text-body text-slate-200 leading-relaxed",children:"AI      .    ."}),ie(),ee("my-6 md:my-8"),r.jsxs("div",{className:"mt-8 space-y-4",children:[r.jsxs("button",{onClick:()=>G(os.AI_GENERATED),className:"wonder-button wonder-button-primary w-full sm:max-w-md mx-auto flex items-center justify-center px-6 py-3.5",style:{backgroundColor:We,borderColor:We},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"})," AI   "]}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-[var(--border-panel)] sm:max-w-md mx-auto",children:[r.jsx("h2",{className:"text-h3 font-semibold mb-3 text-slate-100",children:",  :"}),r.jsx("input",{type:"text",value:d,onChange:te=>h(te.target.value),placeholder:": space exploration, climate change",className:"wonder-input w-full p-3.5 mb-3"}),r.jsx("button",{onClick:()=>P(os.TOPIC_SEARCH,d),disabled:!d.trim()||l===st.FETCHING_TEXT,className:"wonder-button wonder-button-primary w-full flex items-center justify-center px-6 py-3.5",style:{backgroundColor:"var(--accent-secondary)",borderColor:"var(--accent-secondary)"},children:l===st.FETCHING_TEXT&&u===os.TOPIC_SEARCH?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(Lr,{className:"w-5 h-5 mr-2.5"}),"  "]})})]})]}),r.jsxs("button",{onClick:W,className:"wonder-button wonder-button-secondary mt-10 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),fe=()=>v?r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-3 flex items-center",style:{color:We},children:[r.jsx(kt,{className:"w-6 h-6 mr-2"}),"  "]}),r.jsx("p",{className:"text-body text-slate-300 mb-4",children:"  2-3    ."}),r.jsx("textarea",{value:N,onChange:te=>E(te.target.value),placeholder:"   ...",rows:5,className:"wonder-input w-full p-3.5 text-base","aria-label":"  "}),r.jsx("button",{onClick:Q,disabled:!N.trim()||l===st.USER_SUMMARY_EVALUATING,className:"wonder-button wonder-button-primary mt-4 w-full px-8 py-3.5 text-lg",style:{backgroundColor:We,borderColor:We},children:l===st.USER_SUMMARY_EVALUATING?r.jsx(Ne,{size:"sm",color:"text-white"}):"   AI "})]}):null,ye=()=>g?r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-3 flex items-center",style:{color:We},children:[r.jsx(Yi,{className:"w-6 h-6 mr-2"}),"    AI "]}),r.jsxs("div",{className:"mb-4 p-4 wonder-panel border-slate-600/50",children:[r.jsx("p",{className:"font-medium text-slate-200 mb-1",children:" :"}),r.jsx("p",{className:"text-slate-100 whitespace-pre-wrap text-body",children:N})]}),r.jsxs("div",{className:"mb-6 p-4 wonder-panel",style:{borderColor:`color-mix(in srgb, ${We} 70%, transparent)`},children:[r.jsxs("p",{className:"font-medium mb-1",style:{color:We},children:["AI  (: ",g.score,"/",ku,"):"]}),r.jsx("p",{className:"text-slate-100 whitespace-pre-wrap text-body",children:g.feedback})]}),r.jsxs("button",{onClick:K,className:"wonder-button wonder-button-primary w-full px-8 py-3.5 text-lg",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:["   (",La," )"]})]}):null,Re=()=>{const te=b[A];if(!te)return r.jsx("div",{className:"h-60",children:R(H||"   ...")});const xe=te.userAnswerIndex!==void 0;return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h2",{className:"text-h2 font-semibold",style:{color:We},children:["  ",A+1,"/",b.length]}),!xe&&r.jsxs("button",{onClick:()=>re(te.id,"mcq"),disabled:Z,className:"wonder-button wonder-button-secondary text-xs p-1.5",title:"AI   ( )",children:[r.jsx(Rh,{className:"w-4 h-4 mr-1"})," "]})]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-5",children:["(: ",f,")"]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap leading-relaxed",children:te.originalQuestionText}),r.jsx("div",{className:"space-y-3 mb-6",children:te.options.map((he,be)=>{const ve=_===be;let $e="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",ot={};return xe?be===te.correctAnswerIndex?($e+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.2)]",ot={color:"var(--color-correct)",fontWeight:"600"}):be===te.userAnswerIndex?($e+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.2)]",ot={color:"var(--color-incorrect)"}):$e+=" opacity-60 border-[var(--border-panel)]":ve?($e+=` active border-[${We}]`,ot={borderColor:We,backgroundColor:`color-mix(in srgb, ${We} 20%, transparent)`,color:We}):$e+=` border-[var(--border-panel)] hover:border-[${We}]`,r.jsxs("button",{onClick:()=>{xe||L(be)},disabled:xe,className:$e,style:ot,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+be),"."]})," ",he]},be)})}),te.hintUsed&&r.jsxs("div",{className:"my-4 p-3 wonder-panel bg-sky-800/20 border-sky-600/50 text-sky-200",children:[r.jsx("p",{className:"font-semibold text-sm",children:"  "}),r.jsxs("p",{className:"text-xs mt-1",children:[": ",te.options[te.correctAnswerIndex]]}),r.jsxs("p",{className:"text-xs mt-1",children:[": ",te.explanation]})]}),xe&&!te.hintUsed&&(te.isCorrectAttempt?r.jsxs("div",{className:"my-4 p-3.5 wonder-panel bg-green-700/30 border-green-500/60 text-green-200 font-semibold flex items-center text-body",children:[r.jsx(En,{className:"w-6 h-6 mr-2.5 text-green-300"})," !"]}):r.jsxs("div",{className:"my-4 p-4 wonder-panel bg-red-700/20 border-red-500/60",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Oe,{className:"w-6 h-6 mr-2.5 text-red-300"}),r.jsx("p",{className:"font-semibold text-red-200 text-body",children:"."})]}),r.jsxs("p",{className:"text-slate-200 ml-9 text-sm",children:[": ",te.options[te.correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-300 ml-9 mt-1 text-sm",children:[": ",te.explanation]})]})),!xe&&r.jsx("button",{onClick:ae,disabled:_===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:We,borderColor:We},children:" "}),xe&&r.jsx("button",{onClick:()=>{A>=b.length-1?O():(C(he=>he+1),L(void 0))},className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:A>=b.length-1?" ":" "})]})},ne=()=>r.jsxs("div",{children:[r.jsx("h2",{className:"text-h2 font-semibold mb-6",style:{color:We},children:" "}),I.map((te,xe)=>r.jsxs("div",{className:"mb-8 p-4 wonder-panel border-slate-600/50",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h3",{className:"text-h4 font-semibold text-slate-100",children:[" ",xe+1,":"]}),!te.hintUsed&&!te.feedback&&r.jsxs("button",{onClick:()=>re(te.id,"essay"),disabled:Z,className:"wonder-button wonder-button-secondary text-xs p-1.5",title:"AI   ( )",children:[r.jsx(Rh,{className:"w-4 h-4 mr-1"})," "]})]}),r.jsx("p",{className:"text-body text-slate-200 mb-3 whitespace-pre-wrap leading-relaxed",children:te.questionText}),te.hintUsed?r.jsxs("div",{className:"p-3 bg-sky-800/20 border border-sky-600/50 rounded-md text-sky-200",children:[r.jsx("p",{className:"font-semibold text-sm",children:"   (AI  )"}),r.jsx("p",{className:"text-xs mt-1 whitespace-pre-wrap",children:te.feedback})]}):r.jsx("textarea",{value:D[xe],onChange:he=>se(xe,he.target.value),placeholder:"   ...",rows:6,className:"wonder-input w-full p-3.5 text-base","aria-label":`  ${xe+1} `})]},te.id)),r.jsx("button",{onClick:J,disabled:D.some(te=>!te.trim())||I.every(te=>te.hintUsed),className:"wonder-button wonder-button-primary w-full mt-4 px-8 py-3.5 text-lg",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:"      "})]}),ge=()=>{const te=U.totalSummaryPossible+U.totalMcqPossible+U.totalEssayPossible,xe=te>0?Math.round(U.total/te*100):0;let he="var(--color-incorrect)";return xe>=80?he="var(--color-correct)":xe>=50&&(he="var(--color-warning)"),r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left",style:{borderColor:We},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Dn,{className:"h-12 w-12 sm:h-14 sm:w-14 mr-0 sm:mr-4 mb-2 sm:mb-0",style:{color:We}}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:We},children:"   "}),r.jsxs("p",{className:"text-caption text-slate-400",children:[(v==null?void 0:v.title)||(v==null?void 0:v.topic)||" "," (",f,")"]})]})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:We},children:[U.summary," / ",U.totalSummaryPossible]})]}),r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:We},children:[U.mcq," / ",U.totalMcqPossible]})]}),r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:We},children:[U.essay," / ",U.totalEssayPossible]})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsxs("p",{className:"text-lg font-semibold text-center text-green-300",children:[": ",U.total," / ",te]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5 mt-1",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${xe}%`,backgroundColor:he}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[xe,"% "]})]})]}),B&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2 text-yellow-300"}),"AI   ()"]}),r.jsx("div",{className:"p-4 wonder-panel-inset text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",children:B})]}),r.jsxs("div",{className:"mt-5 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:()=>X(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center px-6 py-3.5",children:[r.jsx(pn,{className:"w-5 h-5 mr-2.5"}),"   ( )"]})})]})},ke=()=>{let te;switch(l){case st.USER_SUMMARY_INPUT:te=fe();break;case st.DISPLAY_SUMMARY_EVALUATION:te=ye();break;case st.MCQ_SOLVE:te=Re();break;case st.ESSAY_SOLVE:te=ne();break;case st.SHOW_RESULTS:return ge();default:te=R("  ...")}return r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[v&&r.jsxs("div",{ref:Y,className:"lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold flex items-center",style:{color:We},children:[r.jsx(ns,{className:"w-6 h-6 mr-2"})," ",v.title||"Reading Passage"]}),r.jsx("button",{onClick:W,title:"",className:"wonder-button wonder-button-secondary p-2 hidden lg:block",style:{color:We},children:r.jsx(Ce,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[r.jsx("p",{className:"text-xs text-slate-400",children:v.topic?`: ${v.topic}`:""}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium shadow-sm border",style:{backgroundColor:`color-mix(in srgb,${We} 20%,transparent)`,color:We,borderColor:`color-mix(in srgb,${We} 40%,transparent)`},children:f})]}),r.jsx("div",{className:"prose-wonder max-w-none text-slate-200 whitespace-pre-wrap text-sm leading-relaxed",children:v.content})]}),r.jsxs("div",{ref:q,className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin",children:[ie(),te]})]})};return H?le("  ",R(H),!1):l===st.ERROR?le("  ",pe()):l===st.SELECT_SOURCE_AND_DIFFICULTY?le("  ",ue(),!1):le("  ",ke())},Pt="var(--accent-english)",NT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n})=>{const[s,l]=w.useState(Jt.SELECT_OPTIONS),[o,a]=w.useState(null),[i,u]=w.useState(t||me.MS_1_2),[c,d]=w.useState(ui.DESCRIPTIVE_ESSAY),[h,f]=w.useState(null),[p,v]=w.useState(""),[S,N]=w.useState(null),[E,g]=w.useState({writing:0,total:0}),[y,b]=w.useState(null),[T,A]=w.useState("prompt"),C=w.useRef(null);w.useEffect(()=>{t&&u(t)},[t]);const _=()=>a(null),L=(k=!1)=>{l(Jt.SELECT_OPTIONS),a(null),k||u(t||me.MS_1_2),d(ui.DESCRIPTIVE_ESSAY),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt"),b(null)},I=()=>{L(!1),e()},j=w.useCallback(async()=>{if(!c){a({type:"validation",message:"Please select a writing type."});return}l(Jt.FETCHING_PROMPT),b(`AI is generating an English writing prompt for '${c}'...`),_(),f(null),v(""),N(null),g({writing:0,total:0}),A("prompt");try{const k=await TA(i,c);if(k!=null&&k.topic)f(k),l(Jt.DISPLAY_PROMPT_AND_INPUT),A("input");else throw new Error("AI failed to generate a valid writing prompt.")}catch(k){console.error(k),a({type:"api",message:k instanceof Error?k.message:"Error loading prompt.",details:String(k)}),l(Jt.ERROR)}finally{b(null)}},[i,c]),D=async()=>{if(!h||!p.trim()){a({type:"validation",message:"Please enter your writing."});return}_(),l(Jt.EVALUATING_WRITING),b("AI is evaluating your writing (Feedback in Korean)...");try{const k=await _A(h,p,i,c);N(k),g({writing:k.score,total:k.score}),n&&n({id:crypto.randomUUID(),subject:"English Writing",moduleType:c,completedAt:new Date().toISOString(),difficulty:i,score:k.score,maxPossibleScore:100,feedbackItems:[{type:"writing_eval",feedback:k.feedback,score:k.score,maxScore:100}]}),l(Jt.DISPLAY_EVALUATION),A("input"),C.current&&(C.current.scrollTop=0)}catch(k){console.error(k),a({type:"api",message:k instanceof Error?k.message:"Error evaluating writing.",details:String(k)}),l(Jt.DISPLAY_PROMPT_AND_INPUT)}finally{b(null)}},M=()=>o?r.jsx("div",{className:"w-full my-4 bg-color-incorrect/10 border border-color-incorrect/30 text-color-incorrect px-4 py-3 rounded-lg",role:"alert",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1",children:"Error"}),r.jsx("span",{className:"block sm:inline text-sm",children:o.message})]}),r.jsx("button",{onClick:_,className:"p-1.5 rounded-full hover:bg-color-incorrect/20 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]})}):null,U=()=>r.jsxs("div",{className:"w-full max-w-2xl text-center mx-auto p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(kt,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:Pt},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:"English Writing"})]}),r.jsx("p",{className:"mb-4 text-body text-text-secondary leading-relaxed",children:"Practice writing English essays on various topics and get feedback from AI (in Korean)."}),M(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:Pt}})," Difficulty Level"]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(k=>r.jsx("button",{onClick:()=>u(k),className:`wonder-button wonder-button-secondary p-3 text-sm ${i===k?"active":""}`,style:i===k?{borderColor:Pt,backgroundColor:`color-mix(in srgb,${Pt} 25%,transparent)`,color:`color-mix(in srgb, ${Pt} 100%, var(--text-primary))`}:{},children:k},k))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-text-primary flex items-center justify-center",children:[r.jsx(kt,{className:"w-6 h-6 mr-2",style:{color:"var(--accent-secondary)"}})," Writing Type"]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:Object.values(ui).map(k=>r.jsx("button",{onClick:()=>d(k),className:`wonder-button wonder-button-secondary p-3 text-sm ${c===k?"active":""}`,style:c===k?{borderColor:"var(--accent-secondary)",backgroundColor:"color-mix(in srgb,var(--accent-secondary) 25%,transparent)",color:"var(--accent-secondary)"}:{},children:k},k))})]}),r.jsx("button",{onClick:j,disabled:s===Jt.FETCHING_PROMPT||!c,className:"wonder-button wonder-button-primary mt-8 w-full max-w-xs mx-auto px-8 py-3.5 text-lg",style:{backgroundColor:Pt,borderColor:Pt},children:s===Jt.FETCHING_PROMPT?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"})," Get Writing Prompt"]})}),r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," Go Home"]})]}),$=k=>r.jsxs("div",{className:"w-full h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Pt}),r.jsx("p",{className:"text-text-secondary mt-5 text-lg animate-pulse",children:k})]}),B=()=>{if(!h)return null;const k=T==="prompt",H=T==="input";let F;if(s===Jt.DISPLAY_PROMPT_AND_INPUT||s===Jt.EVALUATING_WRITING)F=r.jsxs("div",{className:"flex-grow flex flex-col",children:[r.jsx("textarea",{value:p,onChange:Z=>v(Z.target.value),placeholder:"Write your essay here...",rows:15,className:"wonder-input w-full p-3.5 text-base flex-grow","aria-label":"English writing input",disabled:s===Jt.EVALUATING_WRITING}),r.jsx("button",{onClick:D,disabled:!p.trim()||s===Jt.EVALUATING_WRITING,className:"wonder-button wonder-button-primary mt-4 w-full px-8 py-3.5 text-lg",style:{backgroundColor:Pt,borderColor:Pt},children:s===Jt.EVALUATING_WRITING?r.jsx(Ne,{size:"sm",color:"white"}):"Submit for AI Evaluation"})]});else if(s===Jt.DISPLAY_EVALUATION&&S){const{score:Z,feedback:z,strengths:q,areasForImprovement:Y}=S;let V="var(--color-incorrect)";Z>=80?V="var(--color-correct)":Z>=50&&(V="var(--color-warning)"),F=r.jsxs("div",{children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:"AI Evaluation Score"}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:Pt},children:[Z,r.jsx("span",{className:"text-2xl text-text-tertiary",children:"/100"})]}),r.jsx("div",{className:"w-full bg-bg-base rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${Z}%`,backgroundColor:V}})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-1",children:"Overall Feedback (Korean)"}),r.jsx("p",{className:"text-sm text-text-secondary whitespace-pre-wrap",children:z})]}),(q==null?void 0:q.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-green-500 mb-1",children:" Strengths"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:q.map((R,X)=>r.jsx("li",{children:R},`s-${X}`))})]}),(Y==null?void 0:Y.length)>0&&r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-yellow-500 mb-1",children:" Areas for Improvement"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-1",children:Y.map((R,X)=>r.jsx("li",{children:R},`a-${X}`))})]})]})]})}return r.jsxs("div",{className:"w-full max-w-4xl mx-auto p-2",children:[r.jsxs("div",{className:"wonder-panel p-6 sm:p-8",ref:C,children:[r.jsxs("div",{className:"flex justify-between items-start mb-4 pb-4 border-b border-border-panel",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(ns,{className:"w-8 h-8 flex-shrink-0",style:{color:Pt}}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-h2 font-bold",style:{color:Pt},children:c}),r.jsx("p",{className:"text-sm text-text-secondary",children:"Write an essay based on the AI prompt."})]})]}),r.jsx("span",{className:"text-xs font-semibold px-3 py-1 rounded-full bg-bg-base border border-border-interactive text-text-secondary",style:{borderColor:Pt,color:Pt},children:i})]}),M(),k&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold text-text-primary mb-2",children:"Writing Prompt"}),r.jsx("p",{className:"text-body text-text-secondary whitespace-pre-wrap leading-relaxed mb-4",children:h.topic}),h.tips&&h.tips.length>0&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-border-interactive",children:[r.jsx("h4",{className:"text-md font-semibold text-yellow-500 mb-1",children:"AI Writing Tips:"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-text-secondary space-y-0.5",children:h.tips.map((Z,z)=>r.jsx("li",{children:Z},`tip-${z}`))})]})]}),H&&F]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary text-sm",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"})," Stop & Go Home"]})}),r.jsxs("div",{className:"fixed bottom-6 right-6 flex flex-col space-y-3 z-40",children:[r.jsx("button",{onClick:()=>A("prompt"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="prompt"?"active":""}`,style:T==="prompt"?{borderColor:Pt,backgroundColor:`color-mix(in srgb, ${Pt} 20%, transparent)`}:{},children:r.jsx(Bs,{className:"w-6 h-6",title:"View Prompt"})}),r.jsx("button",{onClick:()=>A("input"),className:`wonder-button wonder-button-secondary p-3 shadow-lg ${T==="input"?"active":""}`,style:T==="input"?{borderColor:Pt,backgroundColor:`color-mix(in srgb, ${Pt} 20%, transparent)`}:{},children:r.jsx(Yn,{className:"w-6 h-6",title:"Write"})})]})]})};return s===Jt.SELECT_OPTIONS?U():y?$(y):o?r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 wonder-panel",children:[M(),r.jsxs("button",{onClick:I,className:"wonder-button wonder-button-secondary mt-4",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Home"]})]}):B()},Ba=3,Ua=30,Yl=5,Ue="var(--accent-english)",ST=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(Ke.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState(null),[v,S]=w.useState([]),[N,E]=w.useState(0),[g,y]=w.useState(void 0),[b,T]=w.useState(""),[A,C]=w.useState(null),[_,L]=w.useState({mcq:0,essay:0,totalMcqPossible:Ba*Yl,totalEssayPossible:Ua,total:0}),[I,j]=w.useState(null),[D,M]=w.useState(null),U=w.useRef(null),[$,B]=w.useState(!1);w.useEffect(()=>{t&&c(t)},[t]);const k=()=>i(null),H=(P=!1)=>{o(Ke.SELECT_OPTIONS),i(null),P||(c(t||me.MS_1_2),h(null)),p(null),S([]),E(0),y(void 0),T(""),C(null),B(!1),L({mcq:0,essay:0,totalMcqPossible:Ba*Yl,totalEssayPossible:Ua,total:0}),j(null),M(null)},F=()=>{H(!1),e()},Z=P=>{k(),h(P),z(P)},z=w.useCallback(async P=>{o(Ke.FETCHING_CONCEPT),M(`AI is generating an English grammar topic for '${P}'...`),p(null),S([]),T(""),C(null),k();try{const Q=await jA(u,P);if(Q!=null&&Q.explanation&&Q.examplesText)p(Q),o(Ke.DISPLAY_CONCEPT);else throw new Error("Failed to fetch valid grammar concept.")}catch(Q){console.error(Q),i({type:"api",message:Q instanceof Error?Q.message:"Error loading concept.",details:String(Q)}),o(Ke.ERROR)}finally{M(null)}},[u]),q=async()=>{if(f){o(Ke.MCQ_SETUP),M("AI is generating MCQs..."),k();try{const P=`${f.explanation}

Examples:
${f.examplesText}`,K=(await RA(f.topicName,P,Ba,u)).map((ae,O)=>({id:`eng-gram-mcq-${O}-${crypto.randomUUID()}`,originalQuestionText:ae.question,options:ae.options,correctAnswerIndex:ae.answer_index,explanation:ae.explanation,attemptsOnConcept:0,isConceptMastered:!1}));S(K),E(0),y(void 0),L(ae=>({...ae,mcq:0,essay:0,totalMcqPossible:K.length*Yl,total:0})),o(Ke.MCQ_SOLVE),U.current&&(U.current.scrollTop=0)}catch(P){console.error(P),i({type:"api",message:P instanceof Error?P.message:"Error generating MCQs.",details:String(P)}),o(Ke.ERROR)}finally{M(null)}}},Y=()=>{if(g===void 0||N>=v.length){i({type:"validation",message:"Please select an answer."});return}k();const P=v[N],Q=g===P.correctAnswerIndex,K={...P,userAnswerIndex:g,isCorrectAttempt:Q,attemptsOnConcept:P.attemptsOnConcept+1,isConceptMastered:P.isConceptMastered||Q},ae=v.map((O,se)=>se===N?K:O);S(ae),Q&&K.attemptsOnConcept===1?L(O=>({...O,mcq:O.mcq+Yl,total:O.mcq+Yl+O.essay})):Q||s&&f&&s({id:crypto.randomUUID(),subject:"English Grammar",moduleType:f.topicName,questionText:K.originalQuestionText,userAnswer:K.options[g],correctAnswer:K.options[K.correctAnswerIndex],aiAnalysis:K.explanation,timestamp:new Date().toISOString()}),(K.isCorrectAttempt||K.attemptsOnConcept>=2)&&setTimeout(()=>{N>=ae.length-1?o(Ke.GRAMMAR_ESSAY_SOLVE):(E(O=>O+1),y(void 0)),U.current&&(U.current.scrollTop=0)},K.isCorrectAttempt?1200:2e3)},V=async()=>{if(!f||!b.trim()){i({type:"validation",message:"Please enter your explanation and examples."});return}k(),B(!0),o(Ke.GRAMMAR_ESSAY_GRADING),M("AI is evaluating your explanation (Feedback in Korean)...");try{const P=await IA(f,b);C(P);const Q=P.score,K={..._,essay:Q,total:_.mcq+Q};L(K),s&&Q<Ua/2&&s({id:crypto.randomUUID(),subject:"English Grammar",moduleType:f.topicName,questionText:`Explain the concept: "${f.topicName}"`,userAnswer:b,correctAnswer:"A correct and clear explanation with valid examples.",aiAnalysis:P.feedback,timestamp:new Date().toISOString()}),M("AI is generating final feedback...");const ae=await MA(f,v,Q,P.feedback);j(ae),n&&n({id:crypto.randomUUID(),subject:"English Grammar",moduleType:f.topicName,completedAt:new Date().toISOString(),difficulty:u,score:K.total,maxPossibleScore:K.totalMcqPossible+K.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:ae}]}),o(Ke.SHOW_RESULTS)}catch(P){console.error(P),i({type:"api",message:P instanceof Error?P.message:"Error during essay grading/feedback.",details:String(P)}),o(Ke.GRAMMAR_ESSAY_SOLVE)}finally{B(!1),M(null)}U.current&&(U.current.scrollTop=0)},R=(P=!1)=>a?r.jsxs("div",{className:`w-full my-3 ${P?"":"max-w-xl mx-auto"} bg-red-700/20 border border-red-500/50 text-red-200 px-3 py-2.5 rounded-lg shadow-md text-xs sm:text-sm`,role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-0.5 text-red-100",children:"Error"}),r.jsx("span",{className:"block sm:inline",children:a.message})]}),r.jsx("button",{onClick:k,className:"lumin-button p-1 text-red-300 hover:text-white rounded-full hover:bg-red-600/40",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-70",children:["Details: ",a.details.substring(0,150),"..."]})]}):null,X=(P,Q,K=!0)=>r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-5xl mx-auto",children:r.jsxs("div",{className:"lumin-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Rs,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Ue},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Ue},children:P}),l!==Ke.SELECT_OPTIONS&&f&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",f.topicName," - ",u,")"]})]})]}),R(!0),Q,K&&l!==Ke.SELECT_OPTIONS&&r.jsxs("button",{onClick:F,className:"lumin-button lumin-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"})," Go Home"]})]})}),W=()=>r.jsxs("div",{className:"text-center",children:[R(),r.jsx("p",{className:"text-body text-slate-200 mb-6",children:"Learn English grammar with AI and test your understanding."}),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:Ue}})," Difficulty Level"]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(P=>r.jsx("button",{onClick:()=>c(P),className:`lumin-button lumin-button-secondary p-3 text-sm ${u===P?"active":""}`,style:u===P?{borderColor:Ue,backgroundColor:`color-mix(in srgb,${Ue} 25%,transparent)`,color:Ue}:{},children:P},P))})]}),r.jsxs("div",{className:"mt-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(Rs,{className:"w-6 h-6 mr-2",style:{color:Ue}})," Grammar Category"]}),r.jsx("p",{className:"text-sm text-center mb-3 opacity-80",style:{color:`color-mix(in srgb,${Ue} 70%,white)`},children:"AI will select a specific topic within this category."}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.keys(Gy).map(P=>r.jsx("button",{onClick:()=>Z(P),disabled:l===Ke.FETCHING_CONCEPT&&d===P,className:`lumin-button lumin-button-secondary p-4 ${d===P&&l!==Ke.FETCHING_CONCEPT?"active":""} disabled:opacity-70`,style:d===P&&l!==Ke.FETCHING_CONCEPT?{borderColor:Ue,backgroundColor:`color-mix(in srgb,${Ue} 25%,transparent)`,color:Ue}:{},children:P},P))})]}),l===Ke.FETCHING_CONCEPT&&D&&r.jsxs("div",{className:"mt-6 flex justify-center items-center",children:[r.jsx(Ne,{size:"sm",color:Ue}),r.jsx("p",{className:"ml-2 text-sm opacity-80 animate-pulse",style:{color:`color-mix(in srgb,${Ue} 80%,white)`},children:D})]})]}),G=()=>{if(!f&&l!==Ke.ERROR&&!D)return r.jsx("div",{className:"w-full h-96 flex items-center justify-center",children:D?r.jsx(Ne,{size:"lg",color:Ue}):r.jsx("p",{children:"Preparing concept..."})});if(!f&&l===Ke.ERROR&&a)return R();if(!f&&l!==Ke.FETCHING_CONCEPT)return null;let P;switch(l){case Ke.DISPLAY_CONCEPT:P=r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-3",style:{color:Ue},children:"Concept Review"}),r.jsx("p",{className:"text-slate-200 mb-6",children:"Review the explanation and examples. Then, start the quiz."}),r.jsxs("button",{onClick:q,className:"lumin-button lumin-button-primary w-full py-3 text-lg",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:["Start MCQ Quiz (",Ba," Qs)"]})]});break;case Ke.MCQ_SETUP:P=r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[r.jsx(Ne,{size:"md",color:Ue}),r.jsx("p",{className:"ml-3 text-slate-300 animate-pulse",children:"Generating MCQs..."})]});break;case Ke.MCQ_SOLVE:const Q=v[N];P=Q?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:Ue},children:["MCQ ",N+1,"/",v.length]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-5 whitespace-pre-wrap",children:Q.originalQuestionText}),r.jsx("div",{className:"space-y-3 mb-5",children:Q.options.map((pe,ee)=>{const ue=g===ee;let fe="lumin-button lumin-button-secondary w-full text-left p-3 border-2",ye={};return Q.userAnswerIndex!==void 0?ee===Q.correctAnswerIndex?(fe+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.15)]",ye={color:"var(--color-correct)",fontWeight:"500"}):ee===Q.userAnswerIndex?(fe+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.15)]",ye={color:"var(--color-incorrect)"}):fe+=" opacity-60 border-[var(--border-panel)]":ue?(fe+=` active border-[${Ue}]`,ye={borderColor:Ue,backgroundColor:`color-mix(in srgb,${Ue} 20%,transparent)`,color:Ue}):fe+=` border-[var(--border-panel)] hover:border-[${Ue}]`,r.jsxs("button",{onClick:()=>Q.userAnswerIndex===void 0&&y(ee),disabled:Q.userAnswerIndex!==void 0,className:fe,style:ye,children:[r.jsxs("span",{className:"font-mono mr-1.5",children:[String.fromCharCode(65+ee),"."]}),pe]},ee)})}),Q.userAnswerIndex!==void 0&&!Q.isCorrectAttempt&&r.jsxs("div",{className:"my-3 p-3 lumin-panel bg-red-800/30 border-red-600/50 text-sm",children:[r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx(Oe,{className:"w-4 h-4 mr-1.5 text-red-300"}),r.jsx("p",{className:"font-medium text-red-200",children:"Incorrect."})]}),r.jsxs("p",{className:"text-slate-300",children:["Correct: ",Q.options[Q.correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-400 text-xs",children:["Explanation (Korean): ",Q.explanation]}),Q.attemptsOnConcept<2&&r.jsx("button",{onClick:()=>{y(void 0),S(pe=>pe.map(ee=>ee.id===Q.id?{...Q,userAnswerIndex:void 0}:ee))},className:"lumin-button lumin-button-secondary mt-1.5 ml-5 px-2 py-1 text-xs",style:{borderColor:"var(--color-warning)",color:"var(--color-warning)"},children:"Try Again"})]}),Q.userAnswerIndex!==void 0&&Q.isCorrectAttempt&&r.jsxs("div",{className:"my-3 p-2.5 lumin-panel bg-green-800/30 border-green-600/50 text-green-200 font-medium flex items-center text-sm",children:[r.jsx(En,{className:"w-5 h-5 mr-2 text-green-300"}),"Correct!"]}),Q.userAnswerIndex===void 0&&r.jsx("button",{onClick:Y,disabled:g===void 0,className:"lumin-button lumin-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:Ue,borderColor:Ue},children:"Submit Answer"}),Q.userAnswerIndex!==void 0&&(Q.isCorrectAttempt||Q.attemptsOnConcept>=2)&&r.jsx("button",{onClick:()=>{N>=v.length-1?o(Ke.GRAMMAR_ESSAY_SOLVE):(E(pe=>pe+1),y(void 0))},className:"lumin-button lumin-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:N>=v.length-1?"Proceed to Explanation Task":"Next Question"})]}):r.jsx("div",{children:"Loading MCQ..."});break;case Ke.GRAMMAR_ESSAY_SOLVE:P=r.jsxs("div",{children:[r.jsx("h2",{className:"text-h3 font-semibold mb-3",style:{color:Ue},children:"Explain & Exemplify"}),r.jsxs("p",{className:"text-slate-200 mb-1.5 text-sm",children:["Explain ",r.jsxs("strong",{style:{color:`color-mix(in srgb,${Ue} 80%,white)`},children:['"',f==null?void 0:f.topicName,'"']})," in your own words (in English). Provide 2+ original example sentences."]}),r.jsxs("p",{className:"text-xs text-slate-400 mb-3",children:["(AI will evaluate this; feedback in Korean. Max ",Ua," pts)"]}),r.jsx("textarea",{value:b,onChange:pe=>T(pe.target.value),placeholder:"Your explanation and examples...",rows:8,className:"lumin-input w-full p-2.5 text-sm"}),r.jsx("button",{onClick:V,disabled:!b.trim()||$,className:"lumin-button lumin-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:$?r.jsx(Ne,{size:"xs",color:"text-white"}):"Submit Explanation"})]});break;case Ke.GRAMMAR_ESSAY_GRADING:P=r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[r.jsx(Ne,{size:"md",color:Ue}),r.jsx("p",{className:"ml-3 text-slate-300 animate-pulse",children:"Evaluating explanation..."})]});break;case Ke.SHOW_RESULTS:const{mcq:K,essay:ae,totalMcqPossible:O,totalEssayPossible:se,total:J}=_,re=O+se,ie=re>0?Math.round(J/re*100):0;let le="var(--color-incorrect)";ie>=80?le="var(--color-correct)":ie>=50&&(le="var(--color-warning)"),f&&`${f.topicName}`,P=r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"mb-5 pb-5 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2",children:"Score Summary"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[r.jsxs("div",{className:"lumin-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:"MCQ Quiz"}),r.jsxs("p",{className:"text-lg font-bold",style:{color:Ue},children:[K,"/",O]})]}),r.jsxs("div",{className:"lumin-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:"Explanation"}),r.jsxs("p",{className:"text-lg font-bold",style:{color:`color-mix(in srgb,${Ue} 80%,white)`},children:[ae,"/",se]})]}),r.jsxs("div",{className:"lumin-panel p-3 border-green-600/50 bg-green-700/20",children:[r.jsx("p",{className:"text-xs text-slate-300",children:"Total"}),r.jsxs("p",{className:"text-lg font-bold text-green-300",children:[J,"/",re]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full",style:{width:`${ie}%`,backgroundColor:le}})}),r.jsxs("p",{className:"text-right text-xs text-slate-400 mt-0.5",children:[ie,"% Overall"]})]})]}),I&&r.jsxs("div",{className:"mb-5 pb-5 border-b border-[var(--border-panel)] text-left",children:[r.jsxs("h3",{className:"text-h4 font-semibold text-slate-100 mb-1.5 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-1.5 text-yellow-300"}),"AI Feedback (Korean)"]}),r.jsx("div",{className:"p-3 lumin-panel text-slate-200 whitespace-pre-wrap prose-lumin max-w-none text-sm leading-relaxed",style:{borderColor:`color-mix(in srgb,${Ue} 50%,transparent)`},children:I}),(A==null?void 0:A.feedback)&&r.jsxs("div",{className:"mt-2 p-2.5 lumin-panel text-xs",style:{borderColor:`color-mix(in srgb,${Ue} 70%,transparent)`},children:[r.jsx("p",{className:"font-medium",style:{color:`color-mix(in srgb,${Ue} 80%,white)`},children:"On Your Explanation (Korean):"}),r.jsx("p",{className:"text-slate-300 whitespace-pre-wrap mt-0.5",children:A.feedback})]})]}),v.length>0&&r.jsxs("div",{className:"text-left text-xs",children:[r.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-1",children:"MCQs Reviewed:"}),r.jsx("ul",{className:"list-decimal list-inside pl-3 space-y-0.5 text-slate-400",children:v.map(pe=>r.jsxs("li",{children:[pe.originalQuestionText.substring(0,40),"..."]},pe.id))})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]}),r.jsx("div",{className:"mt-6 flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3",children:r.jsxs("button",{onClick:()=>H(!0),className:"lumin-button lumin-button-primary flex items-center justify-center text-sm py-2",style:{backgroundColor:Ue,borderColor:Ue},children:[r.jsx(ls,{className:"w-4 h-4 mr-1.5"}),"New Concept (Same Settings)"]})})]});break;default:P=r.jsx("p",{children:"Loading interaction..."})}return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[f&&r.jsxs("div",{className:"lg:w-2/5 lumin-panel p-4 sm:p-6 lg:sticky lg:top-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin",children:[r.jsx("div",{className:"flex justify-between items-center mb-3",children:r.jsxs("h2",{className:"text-h3 font-semibold flex items-center",style:{color:Ue},children:[r.jsx(Rs,{className:"w-6 h-6 mr-2"})," ",f.topicName]})}),r.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[r.jsxs("span",{className:"text-xs text-slate-400",children:["Category: ",f.categoryKey]}),r.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium shadow-sm border",style:{backgroundColor:`color-mix(in srgb,${Ue} 20%,transparent)`,color:Ue,borderColor:`color-mix(in srgb,${Ue} 40%,transparent)`},children:f.difficulty})]}),r.jsx("h4",{className:"text-md font-medium text-slate-100 mt-3 mb-1",children:"Explanation:"}),r.jsx("div",{className:"prose-lumin max-w-none text-slate-200 whitespace-pre-wrap text-sm leading-relaxed",children:f.explanation}),r.jsx("h4",{className:"text-md font-medium text-slate-100 mt-3 mb-1",children:"Examples:"}),r.jsx("div",{className:"prose-lumin max-w-none text-slate-200 whitespace-pre-wrap text-sm leading-relaxed",children:f.examplesText})]}),r.jsxs("div",{ref:U,className:"lg:w-3/5 lumin-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin",children:[R(!0),P]})]})};return D&&(l===Ke.FETCHING_CONCEPT||l===Ke.MCQ_SETUP||l===Ke.GRAMMAR_ESSAY_GRADING)?X("English Grammar",r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[D&&r.jsx(Ne,{size:"lg",color:Ue}),D&&r.jsx("p",{className:"text-slate-300 ml-4 text-lg animate-pulse",children:D})]}),!1):l===Ke.ERROR?X("English Grammar",r.jsxs("div",{children:[R(),r.jsx("button",{onClick:F,className:"lumin-button lumin-button-secondary mt-4 block mx-auto",children:"Go Home"})]}),!1):l===Ke.SELECT_OPTIONS?X("English Grammar",W(),!1):X("English Grammar",G(),!0)},Dh=10,Pa=5,it="var(--accent-english)",wT=({onGoHome:e,initialDifficulty:t})=>{const[n,s]=w.useState(ft.SELECT_LEVEL),[l,o]=w.useState(null),[a,i]=w.useState(t||me.MS_1_2),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,p]=w.useState(0),[v,S]=w.useState(void 0),[N,E]=w.useState({quizCorrectAnswers:0,quizTotalQuestions:0,wordsMasteredCount:0}),[g,y]=w.useState(null),[b,T]=w.useState(null),[A,C]=w.useState("question"),_=w.useRef(null);w.useEffect(()=>{t&&i(t)},[t]);const L=()=>o(null),I=(R=!1)=>{c([]),h([]),p(0),S(void 0),E({quizCorrectAnswers:0,quizTotalQuestions:0,wordsMasteredCount:0}),y(null),L(),R||i(t||me.MS_1_2),C("question")},j=()=>{s(ft.SELECT_LEVEL),I(!1),e()},D=w.useCallback(async R=>{i(R),s(ft.FETCHING_WORDS),T(`AI is generating ${Dh} words for '${R}' level...`),I(!0);try{const W=(await DA(R,Dh)).map((G,P)=>({id:`vocab-${R}-${P}-${crypto.randomUUID()}`,word:G.word,koreanDefinition:G.korean_definition,partOfSpeech:G.part_of_speech,exampleSentence:G.example_sentence,isRevealed:!1}));c(W),s(ft.DISPLAY_WORDS)}catch(X){console.error(X),o({type:"api",message:X instanceof Error?X.message:"Error generating word list.",details:String(X)}),s(ft.ERROR)}finally{T(null)}},[]),M=R=>c(X=>X.map(W=>W.id===R?{...W,isRevealed:!W.isRevealed}:W)),U=w.useCallback(async()=>{if(u.length===0){o({type:"runtime",message:"No words to quiz. Generate words first."});return}s(ft.QUIZ_SETUP),T(`AI is creating a ${Pa}-question quiz...`),p(0),S(void 0),E({quizCorrectAnswers:0,quizTotalQuestions:Pa,wordsMasteredCount:0}),y(null),L(),C("options");try{const R=await OA(u,Pa),X=R.reduce((W,G,P)=>{const Q=u.find(ae=>ae.word.toLowerCase()===G.word.toLowerCase());if(!Q)return console.warn(`Quiz item for API word "${G.word}" skipped.`),W;let K=G.question_text_hint||(G.question_type==="word_to_definition"?`Meaning of "${Q.word}"?`:`Word for "${Q.koreanDefinition}"?`);return W.push({id:`quiz-${P}-${Q.id}-${crypto.randomUUID()}`,wordToQuiz:Q,questionText:K,options:G.options,correctOptionIndex:G.correct_option_index}),W},[]);if(X.length===0&&R.length>0&&u.length>0)throw new Error("Failed to create quiz: No valid questions generated.");E(W=>({...W,quizTotalQuestions:X.length})),h(X),X.length>0?s(ft.QUIZ_SOLVE):(o({type:"runtime",message:"No valid questions for quiz. Try new words or level."}),s(ft.DISPLAY_WORDS))}catch(R){console.error(R),o({type:"api",message:R instanceof Error?R.message:"Error creating quiz.",details:String(R)}),s(ft.ERROR)}finally{T(null)}},[u]),$=()=>{if(v===void 0||f>=d.length)return;const R=d[f],X=v===R.correctOptionIndex;h(W=>W.map((G,P)=>P===f?{...G,userAnswerIndex:v,isCorrect:X}:G)),X&&E(W=>({...W,quizCorrectAnswers:W.quizCorrectAnswers+1}))},B=async()=>{if(S(void 0),f<d.length-1)p(R=>R+1),C("options");else{s(ft.SHOW_RESULTS),T("AI is generating quiz feedback (Korean)...");try{const R={...N,quizTotalQuestions:d.length},X=await kA(d,R,a);y(X)}catch(R){console.error(R),y("Error generating quiz feedback (Korean).")}finally{T(null)}}},k=(R=!1)=>l?r.jsxs("div",{className:`w-full my-3 ${R?"":"max-w-xl mx-auto"} bg-red-700/20 border border-red-500/50 text-red-200 px-3 py-2.5 rounded-lg shadow-md text-xs sm:text-sm`,role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-0.5 text-red-100",children:"Error"}),r.jsx("span",{className:"block sm:inline",children:l.message})]}),r.jsx("button",{onClick:L,className:"lumin-button p-1 text-red-300 hover:text-white rounded-full hover:bg-red-600/40",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),l.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-70",children:["Details: ",l.details.substring(0,150),"..."]})]}):null,H=(R,X,W=!0,G=!1)=>r.jsx("div",{className:`p-1 sm:p-2 w-full ${G?"max-w-7xl":"max-w-3xl"} mx-auto`,children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(qo,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:it},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:it},children:R}),n!==ft.SELECT_LEVEL&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(Level: ",a,")"]})]})]}),k(!0),X,W&&n!==ft.SELECT_LEVEL&&r.jsxs("button",{onClick:j,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"})," Go Home"]})]})}),F=()=>r.jsxs("div",{className:"text-center",children:[k(),r.jsx("p",{className:"text-body text-slate-200 mb-6",children:"Learn English vocabulary by level and test your knowledge."}),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:it}})," Select Level"]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(R=>r.jsx("button",{onClick:()=>D(R),className:`wonder-button wonder-button-secondary p-3 text-sm ${a===R&&n!==ft.FETCHING_WORDS?"active":""}`,style:a===R&&n!==ft.FETCHING_WORDS?{borderColor:it,backgroundColor:`color-mix(in srgb,${it} 25%,transparent)`,color:"var(--text-primary)"}:{},children:R},R))})]})]}),Z=()=>r.jsxs("div",{className:"text-center",children:[k(),r.jsxs("h2",{className:"text-h2 font-semibold mb-2",style:{color:it},children:["'",a,"' Word List (",u.length," words)"]}),r.jsx("p",{className:"text-slate-300 mb-5 text-sm",children:"Click word to reveal details. Study them, then quiz yourself!"}),r.jsx("div",{className:"space-y-2.5 mb-6 max-h-[60vh] overflow-y-auto scrollbar-thin pr-2",children:u.map(R=>r.jsxs("div",{className:"wonder-panel wonder-panel-interactive p-0",children:[r.jsxs("button",{onClick:()=>M(R.id),className:"w-full flex justify-between items-center text-left p-3 focus:outline-none rounded-lg","aria-expanded":R.isRevealed,"aria-controls":`details-${R.id}`,children:[r.jsx("h3",{className:"text-lg font-medium",style:{color:it},children:R.word}),R.isRevealed?r.jsx(gb,{className:"w-5 h-5",style:{color:it}}):r.jsx(Bs,{className:"w-5 h-5 text-slate-400"})]}),R.isRevealed&&r.jsxs("div",{id:`details-${R.id}`,className:"px-3 pb-3 pt-1.5 border-t border-[var(--border-panel)] text-xs text-left",children:[r.jsxs("p",{className:"text-slate-200 my-0.5",children:[r.jsx("strong",{style:{color:it},children:"Meaning (KR):"})," ",R.koreanDefinition]}),R.partOfSpeech&&r.jsxs("p",{className:"text-slate-400",children:[r.jsx("strong",{style:{color:it},children:"Part of Speech:"})," ",R.partOfSpeech]}),R.exampleSentence&&r.jsxs("p",{className:"text-slate-300 mt-0.5",children:[r.jsx("strong",{style:{color:it},children:"Example:"})," ",r.jsx("em",{className:"italic",children:R.exampleSentence})]})]})]},R.id))}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-3",children:[r.jsxs("button",{onClick:U,disabled:u.length<1,className:"wonder-button wonder-button-primary w-full sm:w-auto px-6 py-3 text-md",style:{backgroundColor:it,borderColor:it},children:[r.jsx(nt,{className:"w-5 h-5 mr-1.5 inline"}),"Start Quiz (",Pa," Qs)"]}),r.jsxs("button",{onClick:()=>{s(ft.SELECT_LEVEL),I(!1)},className:"wonder-button wonder-button-secondary w-full sm:w-auto px-5 py-3 text-sm",children:[r.jsx(pt,{className:"w-4 h-4 mr-1.5 inline"}),"Change Level"]})]})]}),z=()=>{if(d.length===0||f>=d.length)return r.jsx("div",{className:"p-4 text-center text-slate-400",children:"Quiz loading error or no questions."});const R=d[f],X=R.userAnswerIndex!==void 0,W=`lg:w-2/5 wonder-panel p-4 sm:p-6 self-start scrollbar-thin ${A==="question"?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,G=`lg:w-3/5 wonder-panel p-4 sm:p-6 self-start scrollbar-thin ${A==="options"?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",children:[r.jsxs("button",{onClick:()=>C("question"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${A==="question"?"active":""}`,style:A==="question"?{borderColor:it,backgroundColor:`color-mix(in srgb, ${it} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Bs,{className:"w-4 h-4 inline mr-1.5"})," Question"]}),r.jsxs("button",{onClick:()=>C("options"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${A==="options"?"active":""}`,style:A==="options"?{borderColor:it,backgroundColor:`color-mix(in srgb, ${it} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Yn,{className:"w-4 h-4 inline mr-1.5"})," Options"]})]}),r.jsxs("div",{className:W,children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:it},children:["Vocabulary Quiz ",f+1,"/",N.quizTotalQuestions]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:["(Level: ",a,")"]}),r.jsx("p",{className:"text-lg text-slate-100 mb-5 whitespace-pre-wrap leading-relaxed text-center",children:R.questionText})]}),r.jsxs("div",{className:G,ref:_,children:[k(!0),r.jsx("div",{className:"space-y-2.5 mb-5",children:R.options.map((P,Q)=>{const K=v===Q;let ae="wonder-button wonder-button-secondary w-full text-left p-3 border-2 text-sm",O={};return X?Q===R.correctOptionIndex?(ae+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.15)]",O={color:"var(--color-correct)",fontWeight:"500"}):Q===R.userAnswerIndex?(ae+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.15)]",O={color:"var(--color-incorrect)"}):ae+=" opacity-60 border-[var(--border-panel)]":K?(ae+=` active border-[${it}]`,O={borderColor:it,backgroundColor:`color-mix(in srgb,${it} 20%,transparent)`,color:"var(--text-primary)"}):ae+=` border-[var(--border-panel)] hover:border-[${it}]`,r.jsxs("button",{onClick:()=>!X&&S(Q),disabled:X,className:ae,style:O,children:[r.jsxs("span",{className:"font-mono mr-1.5",children:[String.fromCharCode(65+Q),"."]})," ",P]},Q)})}),X&&r.jsx("div",{className:`my-3 p-2.5 rounded-md border text-xs ${R.isCorrect?"bg-green-800/30 border-green-600/60 text-green-300":"bg-red-800/30 border-red-600/60 text-red-300"}`,children:R.isCorrect?r.jsxs("div",{className:"flex items-center",children:[r.jsx(En,{className:"w-4 h-4 mr-1.5 text-green-400"}),"Correct!"]}):r.jsxs("div",{className:"flex items-center",children:[r.jsx(Oe,{className:"w-4 h-4 mr-1.5 text-red-400"}),"Incorrect. Correct: '",R.options[R.correctOptionIndex],"'."]})}),X?r.jsx("button",{onClick:B,className:"wonder-button wonder-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:"var(--accent-korean)",borderColor:"var(--accent-korean)"},children:f<d.length-1?"Next Question":"Show Results"}):r.jsx("button",{onClick:$,disabled:v===void 0,className:"wonder-button wonder-button-primary w-full mt-3 py-2.5 text-md",style:{backgroundColor:it,borderColor:it},children:"Submit Answer"})]})]})},q=()=>{const R=N.quizTotalQuestions>0?Math.round(N.quizCorrectAnswers/N.quizTotalQuestions*100):0;let X="var(--color-incorrect)";return R>=80?X="var(--color-correct)":R>=60&&(X="var(--color-warning)"),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"mb-5 pb-5 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2",children:"Quiz Results"}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:it},children:[N.quizCorrectAnswers,r.jsxs("span",{className:"text-3xl text-slate-400",children:["/",N.quizTotalQuestions]})]}),r.jsxs("p",{className:"text-lg text-slate-200",children:["Correct: ",R,"%"]}),r.jsx("div",{className:"mt-2 w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${R}%`,backgroundColor:X}})})]}),g&&!b&&r.jsxs("div",{className:"mb-5 text-left",children:[r.jsxs("h4",{className:"text-md font-semibold text-slate-100 mb-1 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-1.5 text-yellow-300"}),"AI Feedback (Korean):"]}),r.jsx("div",{className:"p-3 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-xs leading-relaxed",style:{borderColor:`color-mix(in srgb,${it} 50%,transparent)`},children:g})]}),b&&r.jsxs("div",{className:"my-3 flex items-center justify-center",children:[r.jsx(Ne,{size:"sm",color:it}),r.jsx("p",{className:"text-xs text-slate-400 ml-2 animate-pulse",children:b})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]}),r.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("button",{onClick:()=>U(),disabled:d.length===0&&u.length===0,className:"wonder-button wonder-button-primary flex items-center justify-center text-sm py-2",style:{backgroundColor:it,borderColor:it},children:[r.jsx(ls,{className:"w-4 h-4 mr-1.5"}),"Retake Quiz"]}),r.jsxs("button",{onClick:()=>{s(ft.SELECT_LEVEL),I(!1)},className:"wonder-button wonder-button-secondary sm:col-span-1 flex items-center justify-center text-sm py-2",children:[r.jsx(pt,{className:"w-4 h-4 mr-1.5"}),"Change Level"]})]})]})};let Y;const V=n===ft.QUIZ_SOLVE;if(b&&(n===ft.FETCHING_WORDS||n===ft.QUIZ_SETUP||n===ft.SHOW_RESULTS&&b.includes("feedback")))Y=r.jsxs("div",{className:"h-60 flex items-center justify-center",children:[b&&r.jsx(Ne,{size:"lg",color:it}),b&&r.jsx("p",{className:"text-slate-300 ml-4 text-lg animate-pulse",children:b})]});else if(n===ft.ERROR)Y=r.jsx("div",{children:k()});else switch(n){case ft.SELECT_LEVEL:Y=F();break;case ft.DISPLAY_WORDS:Y=Z();break;case ft.QUIZ_SOLVE:Y=z();break;case ft.SHOW_RESULTS:Y=q();break;default:Y=F()}return H("English Vocabulary",Y,n!==ft.SELECT_LEVEL,V)},CT=15,Lu=10,zt="var(--accent-english)",AT=({onGoHome:e,initialDifficulty:t})=>{const[n,s]=w.useState(en.SELECT_OPTIONS),[l,o]=w.useState(null),[a,i]=w.useState(t||me.MS_1_2),[u,c]=w.useState([]),[d,h]=w.useState([]),[f,p]=w.useState(0),[v,S]=w.useState(void 0),[N,E]=w.useState({correct:0,total:0}),[g,y]=w.useState(null);w.useEffect(()=>{t&&i(t)},[t]);const b=()=>o(null),T=(F=!1)=>{s(en.SELECT_OPTIONS),F||i(t||me.MS_1_2),c([]),h([]),p(0),S(void 0),E({correct:0,total:0}),b(),y(null)},A=()=>{T(!1),e()},C=w.useCallback(async()=>{s(en.FETCHING_VERBS),y(`AI '${a}'      ...`),b();try{const Z=(await LA(a,CT)).map((z,q)=>({id:`verb-${a}-${q}-${crypto.randomUUID()}`,base:z.base,pastSimple:z.past_simple,pastParticiple:z.past_participle,korean:z.korean_meaning,isRevealed:!1}));c(Z),s(en.STUDY_VERBS)}catch(F){console.error(F),o({type:"api",message:"     .",details:String(F)}),s(en.ERROR)}finally{y(null)}},[a]),_=F=>c(Z=>Z.map(z=>z.id===F?{...z,isRevealed:!z.isRevealed}:z)),L=w.useCallback(async()=>{if(u.length===0){o({type:"runtime",message:"   ."});return}s(en.QUIZ_SETUP),y(`AI ${Lu}    ...`),b();try{const Z=(await BA(u,Lu)).reduce((z,q)=>{const Y=u.find(V=>V.base.toLowerCase()===q.base_form.toLowerCase());return Y&&z.push({id:`quiz-${Y.id}-${crypto.randomUUID()}`,verb:Y,quizType:q.quiz_type,questionText:q.question_text,options:q.options,correctOptionIndex:q.correct_option_index}),z},[]);h(Z),E({correct:0,total:Z.length}),p(0),S(void 0),Z.length>0?s(en.QUIZ_SOLVE):(o({type:"runtime",message:"   .  ."}),s(en.STUDY_VERBS))}catch(F){console.error(F),o({type:"api",message:"    .",details:String(F)}),s(en.ERROR)}finally{y(null)}},[u]),I=()=>{if(v===void 0)return;const F=d[f],Z=v===F.correctOptionIndex;h(z=>z.map((q,Y)=>Y===f?{...q,userAnswerIndex:v,isCorrect:Z}:q)),Z&&E(z=>({...z,correct:z.correct+1}))},j=()=>{f<d.length-1?(p(F=>F+1),S(void 0)):s(en.SHOW_RESULTS)},D=()=>l?r.jsxs("div",{className:"my-4 p-3 bg-red-700/20 border border-red-500/60 text-red-200 rounded-md text-sm",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{children:[r.jsx("strong",{className:"font-semibold",children:":"})," ",l.message]}),r.jsx("button",{onClick:b,className:"p-1 hover:bg-red-500/30 rounded-full",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),l.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-80",children:[" : ",l.details]})]}):null,M=()=>r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:zt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:g})]}),U=()=>r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-body text-slate-200 mb-6",children:"       ."}),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:zt}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(F=>r.jsx("button",{onClick:()=>i(F),className:`lumin-button lumin-button-secondary p-3 text-sm ${a===F?"active":""}`,style:a===F?{borderColor:zt,backgroundColor:`color-mix(in srgb,${zt} 25%,transparent)`,color:zt}:{},children:F},F))})]}),r.jsxs("button",{onClick:C,className:"lumin-button lumin-button-primary mt-6 px-8 py-3.5 text-lg",style:{backgroundColor:zt,borderColor:zt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"   "]})]}),$=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("h2",{className:"text-h2 font-semibold mb-2",style:{color:zt},children:["'",a,"'    "]}),r.jsx("p",{className:"text-slate-300 mb-5 text-sm",children:"     ."}),r.jsx("div",{className:"space-y-2 mb-6 max-h-[60vh] overflow-y-auto scrollbar-thin pr-2 text-left",children:u.map(F=>r.jsxs("div",{className:"lumin-panel p-0",children:[r.jsxs("button",{onClick:()=>_(F.id),className:"w-full flex justify-between items-center text-left p-3 focus:outline-none rounded-lg",children:[r.jsx("h3",{className:"text-lg font-medium",style:{color:zt},children:F.base}),F.isRevealed?r.jsx(gb,{className:"w-5 h-5",style:{color:zt}}):r.jsx(Bs,{className:"w-5 h-5 text-slate-400"})]}),F.isRevealed&&r.jsxs("div",{className:"px-3 pb-3 pt-1.5 border-t border-[var(--border-panel)] text-sm",children:[r.jsxs("p",{className:"text-slate-200",children:[r.jsx("strong",{children:":"})," ",F.pastSimple]}),r.jsxs("p",{className:"text-slate-200",children:[r.jsx("strong",{children:":"})," ",F.pastParticiple]}),r.jsxs("p",{className:"text-slate-300",children:[r.jsx("strong",{children:":"})," ",F.korean]})]})]},F.id))}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-3",children:[r.jsxs("button",{onClick:L,className:"lumin-button lumin-button-primary w-full sm:w-auto px-6 py-3 text-md",style:{backgroundColor:zt,borderColor:zt},children:[r.jsx(Yn,{className:"w-5 h-5 mr-1.5 inline"}),"  (",Lu," )"]}),r.jsxs("button",{onClick:C,className:"lumin-button lumin-button-secondary w-full sm:w-auto px-5 py-3 text-sm",children:[r.jsx(ls,{className:"w-4 h-4 mr-1.5 inline"}),"   "]})]})]}),B=()=>{const F=d[f];if(!F)return r.jsx("p",{children:"   ..."});const Z=F.userAnswerIndex!==void 0;return r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-1",style:{color:zt},children:["   ",f+1,"/",N.total]}),r.jsx("p",{className:"text-slate-100 mb-4 whitespace-pre-wrap text-lg py-3 border-y border-slate-700",children:F.questionText}),r.jsx("div",{className:"space-y-3",children:F.options.map((z,q)=>{const Y=v===q;let V="lumin-button lumin-button-secondary w-full text-left p-3.5 border-2",R={};return Z?q===F.correctOptionIndex?(V+=" border-[var(--color-correct)] bg-green-800/20",R={color:"var(--color-correct)"}):q===F.userAnswerIndex?(V+=" border-[var(--color-incorrect)] bg-red-800/20",R={color:"var(--color-incorrect)"}):V+=" opacity-60":Y&&(V+=" active",R={borderColor:zt,backgroundColor:`color-mix(in srgb, ${zt} 20%, transparent)`}),r.jsxs("button",{onClick:()=>!Z&&S(q),disabled:Z,className:V,style:R,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+q),"."]}),z]},q)})}),Z&&r.jsx("div",{className:"mt-4 p-3 rounded-md",style:{backgroundColor:F.isCorrect?"rgba(52, 211, 153, 0.1)":"rgba(244, 63, 94, 0.1)"},children:r.jsx("p",{className:"font-semibold",style:{color:F.isCorrect?"var(--color-correct)":"var(--color-incorrect)"},children:F.isCorrect?"!":`.  '${F.options[F.correctOptionIndex]}'.`})}),!Z&&r.jsx("button",{onClick:I,disabled:v===void 0,className:"lumin-button lumin-button-primary w-full mt-4 py-3",children:" "}),Z&&r.jsx("button",{onClick:j,className:"lumin-button lumin-button-primary w-full mt-4 py-3",style:{backgroundColor:"var(--accent-korean)"},children:f<d.length-1?" ":" "})]})},k=()=>{const F=N.total>0?Math.round(N.correct/N.total*100):0;let Z="var(--color-incorrect)";return F>=80?Z="var(--color-correct)":F>=50&&(Z="var(--color-warning)"),r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-h2 font-semibold mb-4",style:{color:zt},children:" "}),r.jsxs("p",{className:"text-5xl font-extrabold",style:{color:`color-mix(in srgb, ${Z} 90%, white)`},children:[N.correct,r.jsxs("span",{className:"text-3xl text-slate-400",children:[" / ",N.total]})]}),r.jsxs("p",{className:"text-lg text-slate-200 mb-4",children:[": ",F,"%"]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${F}%`,backgroundColor:Z}})}),r.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:L,className:"lumin-button lumin-button-primary flex items-center justify-center",children:[r.jsx(ls,{className:"w-5 h-5 mr-2"})," "]}),r.jsxs("button",{onClick:()=>s(en.STUDY_VERBS),className:"lumin-button lumin-button-secondary flex items-center justify-center",children:[r.jsx(qo,{className:"w-5 h-5 mr-2"})," "]})]})]})};let H;if(g)H=M();else if(l)H=D();else switch(n){case en.SELECT_OPTIONS:H=U();break;case en.STUDY_VERBS:H=$();break;case en.QUIZ_SOLVE:H=B();break;case en.SHOW_RESULTS:H=k();break;default:H=U()}return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"lumin-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(qo,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:zt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:zt},children:"  "}),n!==en.SELECT_OPTIONS&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(: ",a,")"]})]})]}),H,n!==en.SELECT_OPTIONS&&r.jsxs("button",{onClick:A,className:"lumin-button lumin-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"})," "]})]})})},TT=({userProfile:e,onShowReport:t})=>{const n=w.useRef(null),s=e.completedModules||[],l=s.length,o=s.reduce((S,N)=>S+N.score,0),a=new Date,i=new Date(a.getFullYear(),a.getMonth(),a.getDate()),u=new Date(a);u.setDate(a.getDate()-a.getDay()),u.setHours(0,0,0,0);const c=s.filter(S=>new Date(S.completedAt)>=i),d=c.length,h=c.reduce((S,N)=>S+N.score,0),f=s.filter(S=>new Date(S.completedAt)>=u),p=f.length,v=f.reduce((S,N)=>S+N.score,0);return r.jsxs("div",{ref:n,className:"wonder-panel p-5 sm:p-6 border-2 border-border-panel",children:[r.jsx("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-4",children:r.jsxs("h2",{className:"text-xl font-semibold text-text-primary flex items-center mb-3 sm:mb-0",children:[r.jsx(ux,{className:"w-6 h-6 mr-3 text-accent-primary"})," "]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-5",children:[r.jsxs("div",{className:"bg-bg-base p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:"  "}),r.jsxs("div",{className:"flex items-baseline justify-center gap-x-2 mt-1",children:[r.jsx("span",{className:"text-2xl font-bold text-accent-secondary",children:l}),r.jsx("span",{className:"text-base text-text-secondary",children:""}),r.jsx("span",{className:"text-lg font-semibold text-text-tertiary",children:"/"}),r.jsx("span",{className:"text-2xl font-bold text-accent-secondary",children:o}),r.jsx("span",{className:"text-base text-text-secondary",children:""})]})]}),r.jsxs("div",{className:"bg-bg-base p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:"  "}),r.jsxs("div",{className:"flex items-baseline justify-center gap-x-2 mt-1",children:[r.jsx("span",{className:"text-2xl font-bold text-color-correct",children:p}),r.jsx("span",{className:"text-base text-text-secondary",children:""}),r.jsx("span",{className:"text-lg font-semibold text-text-tertiary",children:"/"}),r.jsx("span",{className:"text-2xl font-bold text-color-correct",children:v}),r.jsx("span",{className:"text-base text-text-secondary",children:""})]})]}),r.jsxs("div",{className:"bg-bg-base p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:"  "}),r.jsxs("div",{className:"flex items-baseline justify-center gap-x-2 mt-1",children:[r.jsx("span",{className:"text-2xl font-bold text-accent-primary",children:d}),r.jsx("span",{className:"text-base text-text-secondary",children:""}),r.jsx("span",{className:"text-lg font-semibold text-text-tertiary",children:"/"}),r.jsx("span",{className:"text-2xl font-bold text-accent-primary",children:h}),r.jsx("span",{className:"text-base text-text-secondary",children:""})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-3 mt-3",children:[r.jsx("button",{onClick:()=>t("today"),className:"wonder-button wonder-button-secondary px-4 py-2 text-sm w-full sm:w-auto",children:"  "}),r.jsx("button",{onClick:()=>t("week"),className:"wonder-button wonder-button-secondary px-4 py-2 text-sm w-full sm:w-auto",children:"  "}),r.jsxs("button",{onClick:()=>t("month"),className:"wonder-button wonder-button-primary px-4 py-2 text-sm w-full sm:w-auto flex items-center justify-center",style:{backgroundColor:"var(--accent-secondary)",borderColor:"var(--accent-secondary)"},children:[r.jsx(bb,{className:"w-4 h-4 mr-1.5"}),"  "]})]})]})},_T=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),Oh=e=>{const t=new Date(e);return t.setDate(t.getDate()+(6-t.getDay())),t.setHours(23,59,59,999),t},kh=e=>{const t=new Date(e),n=t.getDay();return t.setDate(t.getDate()-n),t.setHours(0,0,0,0),t},jT=({isOpen:e,onClose:t,userProfile:n,initialTimeframe:s})=>{const[l,o]=w.useState(s==="month"?"calendar":"report"),[a,i]=w.useState([]),[u,c]=w.useState(""),[d,h]=w.useState("date"),[f,p]=w.useState(new Date),v=w.useRef(null),S=w.useMemo(()=>[...(n.mistakeNotebook||[]).map(C=>({...C,date:C.timestamp,type:"mistake"})),...(n.completedModules||[]).map(C=>({...C,date:C.completedAt,type:"module"}))].sort((C,_)=>new Date(_.date).getTime()-new Date(C.date).getTime()),[n]),N=w.useMemo(()=>new Set(S.map(C=>new Date(C.date).toISOString().split("T")[0])),[S]),E=(C,_,L,I)=>{const j=S.filter(D=>{const M=new Date(D.date);return M>=C&&M<=_});i(j),c(L),h(I),o("report")};w.useEffect(()=>{if(e)if(s==="today"){const C=new Date,_=_T(C),L=new Date(C.getFullYear(),C.getMonth(),C.getDate(),23,59,59,999);E(_,L,"  ","subject")}else if(s==="week"){const C=new Date,_=kh(C),L=Oh(C);E(_,L,`${_.toLocaleDateString()} - ${L.toLocaleDateString()}  `,"date")}else o("calendar")},[e,s]);const g=C=>{const _=kh(C),L=Oh(C);E(_,L,`${_.toLocaleDateString()} - ${L.toLocaleDateString()}  `,"date")},y=w.useMemo(()=>a.length===0?{}:d==="date"?a.reduce((C,_)=>{const L=new Date(_.date).toLocaleDateString("ko-KR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return C[L]||(C[L]={title:L,items:[]}),C[L].items.push(_),C},{}):a.reduce((C,_)=>{const L=_.subject||"";return C[L]||(C[L]={title:L,items:[]}),C[L].items.push(_),C},{}),[a,d]),b=()=>{if(a.length===0){alert("  .");return}let C=`${u}
`;C+=`========================================

`,Object.values(y).forEach(j=>{C+=`[ ${j.title} ]
`,C+=`----------------------------------------

`,j.items.forEach((D,M)=>{D.type==="mistake"?(C+=` ${M+1}:  
`,C+=`  - : ${D.subject}
`,C+=`  - : ${D.questionText}
`,C+=`  -  : ${D.userAnswer}
`,C+=`  - : ${D.correctAnswer}
`,C+=`  - AI : ${D.aiAnalysis}
`):(C+=` ${M+1}:  
`,C+=`  -  : ${D.moduleType} (${D.subject})
`,C+=`  - : ${D.score} / ${D.maxPossibleScore}
`,D.feedbackItems.forEach(U=>{C+=`  - AI : ${U.feedback}
`})),C+=`
----------------------------------------
`}),C+=`
`});const _=new Blob([C],{type:"text/plain;charset=utf-8"}),L=URL.createObjectURL(_),I=document.createElement("a");I.href=L,I.download=`LetWeDo__${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(L)},T=()=>{const C=f.getFullYear(),_=f.getMonth(),L=new Date(C,_,1).getDay(),I=new Date(C,_+1,0).getDate(),j=Array(L).fill(null),D=Array.from({length:I},(M,U)=>U+1);return r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>p(new Date(C,_-1,1)),className:"wonder-button p-2",children:r.jsx(aT,{})}),r.jsxs("h3",{className:"text-lg font-semibold",children:[C," ",_+1,""]}),r.jsx("button",{onClick:()=>p(new Date(C,_+1,1)),className:"wonder-button p-2",children:r.jsx(iT,{})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-text-secondary mb-2",children:["","","","","","",""].map(M=>r.jsx("div",{children:M},M))}),r.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[j.map((M,U)=>r.jsx("div",{},`b-${U}`)),D.map(M=>{const U=new Date(C,_,M).toISOString().split("T")[0],$=N.has(U);return r.jsx("button",{onClick:()=>g(new Date(C,_,M)),className:`p-2 rounded-lg text-sm h-10 transition-colors ${$?"bg-accent-primary/20 hover:bg-accent-primary/40 text-text-primary font-bold":"hover:bg-bg-panel-light"}`,children:M},M)})]})]})},A=()=>r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:u}),r.jsxs("button",{onClick:b,className:"wonder-button wonder-button-secondary px-4 py-2 text-sm flex items-center",children:[r.jsx(cT,{className:"w-4 h-4 mr-2"})," TXT "]})]}),r.jsx("div",{ref:v,id:"printable-report",className:"flex-grow overflow-y-auto scrollbar-thin -mr-4 pr-4",children:Object.keys(y).length>0?Object.values(y).map((C,_)=>r.jsxs("div",{className:"report-group-container mb-6",children:[r.jsx("h4",{className:"text-md font-bold text-accent-primary border-b border-accent-primary/30 pb-1 mb-3",children:C.title}),r.jsx("div",{className:"space-y-4",children:C.items.map(L=>r.jsx("div",{className:"p-3 bg-bg-base rounded-lg border border-border-panel text-xs wonder-panel-inset",children:L.type==="mistake"?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"font-semibold mb-1 text-slate-300",children:["Q. ",L.questionText]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("p",{className:"flex-1 p-1.5 bg-color-incorrect/10 rounded",children:[r.jsx("b",{children:" :"})," ",L.userAnswer]}),r.jsxs("p",{className:"flex-1 p-1.5 bg-color-correct/10 rounded",children:[r.jsx("b",{children:":"})," ",L.correctAnswer]})]}),r.jsxs("p",{className:"mt-2 p-1.5 bg-sky-900/40 rounded",children:[r.jsx("b",{children:"AI :"})," ",L.aiAnalysis]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"font-semibold mb-1 text-slate-300",children:[": ",L.moduleType]}),r.jsxs("p",{children:[": ",r.jsxs("span",{className:"font-bold text-accent-secondary",children:[L.score," / ",L.maxPossibleScore]})]}),L.feedbackItems.map((I,j)=>r.jsxs("p",{className:"mt-2 p-1.5 bg-sky-900/40 rounded",children:[r.jsx("b",{children:"AI :"})," ",I.feedback]},j))]})},L.id))})]},C.title)):r.jsx("p",{className:"text-center text-text-secondary py-10",children:"    ."})})]});return r.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 report-modal-container",onClick:t,children:r.jsxs("div",{className:"wonder-panel w-full max-w-4xl p-6 sm:p-8 flex flex-col",onClick:C=>C.stopPropagation(),style:{height:"90vh"},children:[r.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between pb-4 border-b border-border-panel mb-4",children:[r.jsxs("h2",{className:"text-xl font-semibold text-accent-primary flex items-center",children:[r.jsx(bb,{className:"w-6 h-6 mr-3"}),"  "]}),r.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-bg-panel-light",children:r.jsx(dT,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"flex-grow overflow-hidden",children:l==="calendar"?T():A()})]})})},RT=[{id:"korean",name:"",Icon:$o,iconStrokeWidth:1.3,accentColor:"var(--accent-korean)",buttons:[{name:"",view:ce.KOREAN_LITERATURE,enabled:!0,icon:ns,description:",      "},{name:" ",view:ce.KOREAN_LITERATURE_WRITING,enabled:!0,icon:kt,description:"  ,  "},{name:"",view:ce.KOREAN_NON_FICTION,enabled:!0,icon:ns,description:",    "},{name:" ",view:ce.KOREAN_NON_FICTION_WRITING,enabled:!0,icon:kt,description:" ,  "},{name:"",view:ce.KOREAN_GRAMMAR,enabled:!0,icon:Rs,description:"   ."}]},{id:"english",name:"",Icon:Vo,iconStrokeWidth:1.3,accentColor:"var(--accent-english)",buttons:[{name:"",view:ce.ENGLISH_READING,enabled:!0,icon:ns,description:"   , "},{name:"",view:ce.ENGLISH_VOCABULARY,enabled:!0,icon:qo,description:"    "},{name:"",view:ce.ENGLISH_WRITING,enabled:!0,icon:kt,description:"   "},{name:" ",view:ce.ENGLISH_IRREGULAR_VERBS,enabled:!0,icon:qo,description:"/ "},{name:"",view:ce.ENGLISH_GRAMMAR,enabled:!0,icon:Rs,description:"   ."}]},{id:"math",name:"",Icon:zo,iconStrokeWidth:1.4,accentColor:"var(--accent-math)",buttons:[{name:"/",view:ce.MATH_ARITHMETIC,enabled:!0,icon:hb,description:"   "},{name:"/",view:ce.MATH_GRAPHS_EQUATIONS,enabled:!0,icon:ux,description:"    "},{name:"/",view:ce.MATH_GEOMETRY,enabled:!0,icon:yb,description:"     "}]},{id:"social",name:"",Icon:Qo,iconStrokeWidth:1.3,accentColor:"var(--accent-social)",buttons:[{name:"",view:ce.SOCIAL_GENERAL,enabled:!0,icon:io,description:"    ."},{name:"",view:ce.SOCIAL_HISTORY,enabled:!0,icon:Dn,description:"     ."},{name:"",view:ce.SOCIAL_GEOGRAPHY,enabled:!0,icon:xT,description:"      ."}]},{id:"science",name:"",Icon:Yo,iconStrokeWidth:1.3,accentColor:"var(--accent-science)",buttons:[{name:"",view:ce.SCIENCE_PHYSICS,enabled:!0,icon:To,description:" ,     ."},{name:"",view:ce.SCIENCE_CHEMISTRY,enabled:!0,icon:Ao,description:" , ,   ."},{name:"",view:ce.SCIENCE_LIFE_SCIENCE,enabled:!0,icon:_t,description:"     ."}]},{id:"assessment",name:"  ",Icon:dx,accentColor:"var(--accent-assessment)",cardDescription:"AI , , , ,           .",buttons:[{name:" ",view:ce.ASSESSMENT_KOREAN_LEVEL,enabled:!0,icon:$o},{name:" ",view:ce.ASSESSMENT_ENGLISH_LEVEL,enabled:!0,icon:Vo},{name:" ",view:ce.ASSESSMENT_MATH_LEVEL,enabled:!0,icon:zo},{name:" ",view:ce.ASSESSMENT_SCIENCE_LEVEL,enabled:!0,icon:Yo},{name:" ",view:ce.ASSESSMENT_SOCIAL_STUDIES_LEVEL,enabled:!0,icon:Qo},{name:" ",view:ce.ASSESSMENT_COMPREHENSIVE,enabled:!0,icon:_t}]}],IT=({subject:e,onNavigate:t})=>{const[n,s]=w.useState(!1),l={borderColor:n?e.accentColor:"var(--border-panel)",boxShadow:n?`0 0 25px -5px color-mix(in srgb, ${e.accentColor} 50%, transparent)`:"0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"};if(e.id==="assessment")return r.jsxs("div",{className:"wonder-panel p-5 flex flex-col h-full col-span-1",style:l,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx(e.Icon,{className:"w-8 h-8 mr-3.5 flex-shrink-0",style:{color:e.accentColor},strokeWidth:e.iconStrokeWidth||1.3}),r.jsx("h2",{className:"text-xl font-bold text-text-primary",children:e.name})]}),e.cardDescription&&r.jsx("p",{className:"text-sm text-text-secondary mb-4 leading-relaxed flex-grow",children:e.cardDescription}),r.jsx("div",{className:"grid grid-cols-3 gap-2 mt-auto",children:e.buttons.map(i=>{const u=i.icon;return r.jsxs("button",{onClick:()=>{i.view&&t(i.view)},className:"w-full flex flex-col items-center justify-center text-center p-3 rounded-lg transition-colors bg-bg-base hover:bg-bg-panel-light group",children:[u&&r.jsx(u,{className:"w-6 h-6 mb-1.5 flex-shrink-0 text-text-secondary group-hover:text-[--accent-color]",style:{"--accent-color":e.accentColor}}),r.jsx("span",{className:"font-semibold text-text-primary text-xs leading-tight",children:i.name})]},i.name)})})]});const a=["math","social","science"].includes(e.id)?"grid-cols-1":"grid-cols-2";return r.jsxs("div",{className:"wonder-panel p-5 flex flex-col h-full",style:l,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx(e.Icon,{className:"w-8 h-8 mr-3.5 flex-shrink-0",style:{color:e.accentColor},strokeWidth:e.iconStrokeWidth||1.3}),r.jsx("h2",{className:"text-xl font-bold text-text-primary",children:e.name})]}),e.cardDescription&&r.jsx("p",{className:"text-sm text-text-secondary mb-4 leading-relaxed flex-grow",children:e.cardDescription}),r.jsx("div",{className:`grid ${a} gap-2 mt-auto`,children:e.buttons.map(i=>{const u=i.icon,c=(e.id==="korean"||e.id==="english")&&i.name==="";return r.jsxs("button",{onClick:()=>{i.view&&t(i.view)},className:`w-full flex items-center text-left p-2.5 rounded-md transition-colors bg-bg-base hover:bg-bg-panel-light group ${c?"col-span-2":""}`,children:[u&&r.jsx(u,{className:"w-5 h-5 mr-3 flex-shrink-0 text-text-secondary group-hover:text-[--accent-color]",style:{"--accent-color":e.accentColor}}),r.jsxs("div",{className:"flex-grow",children:[r.jsx("span",{className:"font-semibold text-text-primary text-sm",children:i.name}),i.description&&r.jsx("p",{className:"text-xs text-text-secondary",children:i.description})]})]},i.name)})})]})},Lh=({onNavigate:e,userProfile:t})=>{var u;const[n,s]=w.useState(!1),[l,o]=w.useState("today"),a=c=>{o(c),s(!0)},i=((u=t==null?void 0:t.mistakeNotebook)==null?void 0:u.length)||0;return r.jsxs("div",{className:"w-full max-w-screen-xl mx-auto p-2 sm:p-4",children:[r.jsxs("header",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 md:mb-8",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary",children:[r.jsx("span",{className:"text-accent-primary",children:t.nickname}),", !"]}),r.jsx("p",{className:"text-text-secondary mt-1",children:"  ."})]}),r.jsxs("button",{onClick:()=>e(ce.PROFILE_SETTINGS),className:"wonder-button wonder-button-secondary mt-3 sm:mt-0 flex-shrink-0",children:[r.jsx(mb,{className:"w-5 h-5 mr-2"})," "]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6 md:mb-8",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsx(TT,{userProfile:t,onShowReport:a})}),r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 flex flex-col justify-center gap-4 border-2 border-accent-secondary/50",children:[r.jsx("h3",{className:"text-lg font-semibold text-accent-secondary text-center",children:" "}),r.jsx("p",{className:"text-sm text-center text-text-secondary -mt-3 mb-1",children:"AI    ."}),r.jsxs("button",{onClick:()=>e(ce.MISTAKE_NOTEBOOK),className:"wonder-button wonder-button-secondary w-full text-base py-3 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",disabled:i===0,children:[r.jsx(dx,{className:"w-5 h-5 mr-2"}),"AI  (",i,")"]}),r.jsxs("button",{onClick:()=>e(ce.REVIEW_QUIZ),disabled:i===0,className:"wonder-button wonder-button-primary w-full text-base py-3 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--accent-secondary)",borderColor:"var(--accent-secondary)"},children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"AI   "]})]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5 sm:gap-6",children:RT.map(c=>r.jsx(IT,{subject:c,onNavigate:d=>e(d)},c.id))}),n&&r.jsx(jT,{isOpen:n,onClose:()=>s(!1),userProfile:t,initialTimeframe:l})]})},Bh=({onProfileCreate:e,onProfileImport:t})=>{const[n,s]=w.useState(""),[l,o]=w.useState(""),[a,i]=w.useState(""),[u,c]=w.useState(me.MS_1_2),[d,h]=w.useState(""),f=w.useRef(null),p=()=>{if(!n.trim()){h(" .");return}if(l.length<4){h(" 4  .");return}if(l!==a){h("  .");return}h(""),e(n,l,u)},v=()=>{var N;(N=f.current)==null||N.click()},S=N=>{var y;const E=(y=N.target.files)==null?void 0:y[0];if(!E)return;const g=new FileReader;g.onload=b=>{var T;try{const A=(T=b.target)==null?void 0:T.result;if(typeof A!="string")throw new Error("   .");const C=JSON.parse(A);C&&C.id&&C.nickname&&C.password?t(C):h("    . (id, nickname, password  )")}catch(A){h("     ."),console.error(A)}},g.onerror=()=>h("  ."),g.readAsText(E),f.current&&(f.current.value="")};return r.jsxs("div",{className:"w-full max-w-lg wonder-panel p-6 sm:p-10 text-center",children:[r.jsx(xb,{className:"h-20 w-20 text-accent-primary mx-auto mb-4",strokeWidth:1}),r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary mb-2",children:"Let We Do   !"}),r.jsx("p",{className:"text-text-secondary mb-8",children:"AI   ,   ."}),r.jsxs("div",{className:"space-y-4 text-left",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"nickname",className:"flex items-center text-lg font-semibold text-text-primary mb-2",children:[r.jsx(sT,{className:"w-6 h-6 mr-2 text-accent-secondary"}),""]}),r.jsx("input",{type:"text",id:"nickname",value:n,onChange:N=>s(N.target.value),className:"wonder-input w-full p-3",placeholder:"  ",autoFocus:!0,required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"password",className:"flex items-center text-lg font-semibold text-text-primary mb-2",children:[r.jsx(Qi,{className:"w-6 h-6 mr-2 text-accent-secondary"}),""]}),r.jsx("input",{type:"password",id:"password",value:l,onChange:N=>o(N.target.value),className:"wonder-input w-full p-3",placeholder:"4   ",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"confirmPassword",className:"flex items-center text-lg font-semibold text-text-primary mb-2",children:[r.jsx(Qi,{className:"w-6 h-6 mr-2 text-accent-secondary"})," "]}),r.jsx("input",{type:"password",id:"confirmPassword",value:a,onChange:N=>i(N.target.value),className:"wonder-input w-full p-3",placeholder:"  ",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"difficulty",className:"flex items-center text-lg font-semibold text-text-primary mb-2",children:[r.jsx(Dn,{className:"w-6 h-6 mr-2 text-accent-secondary"}),"  "]}),r.jsx("select",{id:"difficulty",value:u,onChange:N=>c(N.target.value),className:"wonder-input w-full p-3 appearance-none",children:Object.values(me).map(N=>r.jsx("option",{value:N,children:N},N))})]})]}),d&&r.jsx("p",{className:"text-color-incorrect bg-color-incorrect/10 p-3 rounded-md my-6 text-sm",children:d}),r.jsxs("button",{onClick:p,className:"wonder-button wonder-button-primary w-full mt-8 py-3 text-lg",children:["     ",r.jsx(pb,{className:"w-5 h-5 ml-2"})]}),r.jsxs("div",{className:"relative flex py-5 items-center",children:[r.jsx("div",{className:"flex-grow border-t border-border-interactive"}),r.jsx("span",{className:"flex-shrink mx-4 text-text-secondary text-sm",children:""}),r.jsx("div",{className:"flex-grow border-t border-border-interactive"})]}),r.jsx("input",{type:"file",ref:f,onChange:S,className:"hidden",accept:"application/json"}),r.jsxs("button",{onClick:v,className:"wonder-button wonder-button-secondary w-full py-3 text-base",children:[r.jsx(oT,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsx("p",{className:"text-xs text-text-secondary mt-6",children:"     ."})]})},MT=({userProfile:e,onLogin:t,onDeleteProfile:n,loginError:s})=>{const[l,o]=w.useState(""),a=u=>{u.preventDefault(),t(l)},i=()=>{window.confirm(" ?     ?    .")&&n()};return r.jsxs("div",{className:"w-full max-w-md wonder-panel p-6 sm:p-10 text-center",children:[r.jsx(xb,{className:"h-20 w-20 text-accent-primary mx-auto mb-4",strokeWidth:1}),r.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"   !"}),r.jsxs("p",{className:"text-text-secondary mt-2 mb-6",children:[r.jsx("span",{className:"font-semibold text-accent-primary",children:e.nickname})," ,  ."]}),r.jsxs("form",{onSubmit:a,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"sr-only",children:""}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:r.jsx(Qi,{className:"h-5 w-5 text-text-tertiary"})}),r.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:l,onChange:u=>o(u.target.value),className:"wonder-input w-full pl-10 p-3",placeholder:"",autoFocus:!0})]})]}),s&&r.jsx("p",{className:"text-sm text-color-incorrect bg-color-incorrect/10 p-2 rounded-md",children:s}),r.jsxs("button",{type:"submit",className:"wonder-button wonder-button-primary w-full py-3 text-lg",children:[" ",r.jsx(rT,{className:"w-5 h-5 ml-2"})]})]}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:i,className:"text-xs text-text-secondary hover:text-color-incorrect hover:underline",children:" ?  "})})]})},DT=({currentUser:e,onGoHome:t,onUpdateProfileSetting:n,onDeleteAllData:s,onClearApiKey:l})=>{const[o,a]=w.useState(e.defaultStudyDifficulty),[i,u]=w.useState(""),[c,d]=w.useState(e.nickname),[h,f]=w.useState(""),[p,v]=w.useState(""),[S,N]=w.useState(""),[E,g]=w.useState(""),[y,b]=w.useState(""),[T,A]=w.useState(ub()||""),[C,_]=w.useState("");w.useEffect(()=>{a(e.defaultStudyDifficulty),d(e.nickname)},[e]);const L=()=>{u(""),n({defaultStudyDifficulty:o})?(u("    !"),setTimeout(()=>u(""),3e3)):u("  .  .")},I=()=>{if(f(""),!c.trim()){f(" .");return}n({nickname:c.trim()})?(f("  !"),setTimeout(()=>f(""),3e3)):f("  .")},j=()=>{if(b(""),!p||!S||!E){b("   .");return}if(S.length<4){b("  4  .");return}if(S!==E){b("     .");return}n({oldPassword:p,newPassword:S})?(b("  !"),v(""),N(""),g(""),setTimeout(()=>b(""),3e3)):b("   .")},D=()=>{try{const B=JSON.stringify(e,null,2),k=new Blob([B],{type:"application/json"}),H=URL.createObjectURL(k),F=document.createElement("a");F.href=H,F.download=`LWD_profile_${e.nickname}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(H)}catch(B){console.error("Error exporting data:",B),alert("    .")}},M=()=>{T.trim()?(cb(T.trim()),_("API   !"),setTimeout(()=>_(""),3e3)):_("API  .")},U=()=>{window.confirm("API  ?         .")&&(ZC(),l())},$=B=>{if(!B)return null;const k=B.includes("");return r.jsxs("p",{className:`text-xs mt-2 ${k?"text-color-correct":"text-color-incorrect"}`,children:[k&&r.jsx(En,{className:"w-4 h-4 inline mr-1"}),B]})};return r.jsx("div",{className:"w-full max-w-2xl mx-auto p-4 sm:p-6",children:r.jsxs("div",{className:"wonder-panel p-6 sm:p-8",children:[r.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-border-panel",children:[r.jsx(mb,{className:"h-10 w-10 text-accent-primary mr-4"}),r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary",children:"  "})]}),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-text-primary mb-1",children:""}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("input",{id:"nickname",value:c,onChange:B=>d(B.target.value),className:"wonder-input w-full p-2.5"}),r.jsx("button",{onClick:I,className:"wonder-button wonder-button-secondary px-4 py-2 text-sm",disabled:c===e.nickname,children:""})]}),$(h)]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"difficultySelect",className:"block text-sm font-medium text-text-primary mb-1",children:"  "}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("select",{id:"difficultySelect",value:o,onChange:B=>a(B.target.value),className:"wonder-input w-full p-2.5 appearance-none",children:Object.values(me).map(B=>r.jsx("option",{value:B,children:B},B))}),r.jsx("button",{onClick:L,className:"wonder-button wonder-button-secondary px-4 py-2 text-sm",disabled:o===e.defaultStudyDifficulty,children:""})]}),$(i)]})]}),r.jsxs("div",{className:"pt-8 border-t border-border-panel space-y-4",children:[r.jsxs("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[r.jsx(fb,{className:"w-5 h-5 mr-2"})," API  "]}),r.jsx("div",{className:"space-y-3",children:r.jsx("input",{type:"password",value:T,onChange:B=>A(B.target.value),placeholder:"Gemini API  ",className:"wonder-input w-full p-2.5 text-sm"})}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsx("button",{onClick:M,className:"wonder-button wonder-button-secondary w-full sm:w-auto px-5 py-2.5 text-sm",children:"API  "}),r.jsx("button",{onClick:U,className:"wonder-button wonder-button-destructive px-5 py-2.5 text-sm",children:"API  "})]}),$(C)]}),r.jsxs("div",{className:"pt-8 border-t border-border-panel space-y-4",children:[r.jsxs("h2",{className:"text-xl font-semibold text-text-primary flex items-center",children:[r.jsx(Qi,{className:"w-5 h-5 mr-2"}),"  "]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("input",{type:"password",value:p,onChange:B=>v(B.target.value),placeholder:" ",className:"wonder-input w-full p-2.5 text-sm"}),r.jsx("input",{type:"password",value:S,onChange:B=>N(B.target.value),placeholder:"  (4 )",className:"wonder-input w-full p-2.5 text-sm"}),r.jsx("input",{type:"password",value:E,onChange:B=>g(B.target.value),placeholder:"  ",className:"wonder-input w-full p-2.5 text-sm"})]}),r.jsx("button",{onClick:j,className:"wonder-button wonder-button-secondary w-full sm:w-auto px-5 py-2.5 text-sm",children:"  "}),$(y)]}),r.jsxs("div",{className:"pt-8 border-t border-border-panel space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:" "}),r.jsxs("div",{children:[r.jsxs("button",{onClick:D,className:"wonder-button wonder-button-secondary w-full sm:w-auto px-5 py-2.5 text-sm flex items-center justify-center",children:[r.jsx(lT,{className:"w-5 h-5 mr-2"}),"    ()"]}),r.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"   JSON  ."})]}),r.jsxs("div",{className:"p-4 border border-color-incorrect/50 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-bold text-color-incorrect",children:"  "}),r.jsx("p",{className:"text-sm text-text-secondary my-2",children:"          .     ."}),r.jsxs("button",{onClick:s,className:"wonder-button wonder-button-destructive px-5 py-2.5 text-sm",children:[r.jsx(Kd,{className:"w-5 h-5 mr-2"}),"   "]})]})]})]}),r.jsx("div",{className:"mt-10 flex items-center justify-center",children:r.jsxs("button",{onClick:t,className:"wonder-button wonder-button-secondary px-6 py-2.5 text-base",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2 inline-block"}),"  "]})})]})})},OT=({currentUser:e,onGoHome:t,onUpdateProfile:n})=>{const[s,l]=w.useState(e.mistakeNotebook||[]),o=u=>{const c=s.filter(d=>d.id!==u);n({mistakeNotebook:c})?l(c):alert("   .")},a=()=>{window.confirm(`    ${s.length} ?`)&&(n({mistakeNotebook:[]})?l([]):alert("    ."))},i=s.reduce((u,c)=>{const d=c.subject||"";return u[d]||(u[d]=[]),u[d].push(c),u},{});return r.jsx("div",{className:"w-full max-w-4xl mx-auto p-4 sm:p-6",children:r.jsxs("div",{className:"wonder-panel p-6 sm:p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-border-panel",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(dx,{className:"h-10 w-10 text-color-warning mr-4"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h2 text-color-warning",children:"AI "}),r.jsx("p",{className:"text-sm text-text-secondary",children:"AI      ."})]})]}),r.jsxs("button",{onClick:t,className:"wonder-button wonder-button-secondary px-4 py-2 text-sm",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]}),s.length>0?r.jsxs("div",{children:[r.jsx("div",{className:"text-right mb-4",children:r.jsxs("button",{onClick:a,className:"wonder-button wonder-button-destructive px-4 py-2 text-xs",children:[r.jsx(Kd,{className:"w-4 h-4 mr-1.5"}),"  "]})}),r.jsx("div",{className:"space-y-6",children:Object.entries(i).map(([u,c])=>r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 text-accent-primary mb-3 border-b-2 border-accent-primary/30 pb-1",children:[u," (",c.length,")"]}),r.jsx("ul",{className:"space-y-4",children:c.map(d=>r.jsxs("li",{className:"p-4 wonder-panel-inset relative",children:[r.jsx("p",{className:"text-xs text-text-secondary mb-2",children:new Date(d.timestamp).toLocaleString()}),r.jsx("p",{className:"text-body font-semibold text-text-primary mb-3 whitespace-pre-wrap",children:d.questionText}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"p-3 bg-color-incorrect/10 rounded-md",children:[r.jsx("p",{className:"font-semibold text-color-incorrect mb-1",children:" "}),r.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:d.userAnswer})]}),r.jsxs("div",{className:"p-3 bg-color-correct/10 rounded-md",children:[r.jsx("p",{className:"font-semibold text-color-correct mb-1",children:""}),r.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:d.correctAnswer})]})]}),r.jsxs("div",{className:"mt-4 p-3 bg-sky-500/10 dark:bg-sky-900/30 border-t border-sky-500/20 dark:border-sky-700/50 rounded-b-md",children:[r.jsx("p",{className:"font-semibold text-sky-600 dark:text-sky-300 mb-1",children:" AI   "}),r.jsx("p",{className:"text-text-primary whitespace-pre-wrap text-sm",children:d.aiAnalysis})]}),d.reviewQuizQuestion&&r.jsxs("div",{className:"mt-4 p-3 border-t-2 border-dashed border-purple-500/50 dark:border-purple-600/50 bg-purple-500/10 dark:bg-purple-900/20 rounded-md",children:[r.jsxs("h4",{className:"font-semibold text-purple-600 dark:text-purple-300 mb-2 flex items-center",children:[r.jsx(ls,{className:"w-4 h-4 mr-2"})," AI   "]}),r.jsxs("p",{className:"text-sm text-text-primary mb-2 whitespace-pre-wrap",children:[r.jsx("strong",{children:"Q: "})," ",d.reviewQuizQuestion.originalQuestionText]}),r.jsxs("div",{className:`p-2 rounded-md ${d.isReviewQuizCorrect?"bg-color-correct/10":"bg-color-incorrect/10"}`,children:[r.jsxs("p",{className:"text-xs text-text-secondary",children:[" : ",r.jsx("span",{className:"font-medium",children:d.reviewQuizQuestion.options[d.reviewQuizQuestion.userAnswerIndex??-1]||" "})]}),r.jsxs("p",{className:"text-xs text-text-secondary",children:[": ",r.jsx("span",{className:"font-medium",children:d.reviewQuizQuestion.options[d.reviewQuizQuestion.correctAnswerIndex]})]}),d.isReviewQuizCorrect?r.jsxs("p",{className:"font-semibold text-color-correct mt-1 flex items-center text-sm",children:[r.jsx(En,{className:"w-4 h-4 mr-1"}),"  !"]}):r.jsxs("p",{className:"font-semibold text-color-incorrect mt-1 flex items-center text-sm",children:[r.jsx(Oe,{className:"w-4 h-4 mr-1"}),"  "]})]})]}),r.jsx("button",{onClick:()=>o(d.id),className:"absolute top-2 right-2 p-1.5 text-text-secondary hover:text-color-incorrect hover:bg-bg-panel-light rounded-full transition-colors",title:"  ",children:r.jsx(Kd,{className:"w-4 h-4"})})]},d.id))})]},u))})]}):r.jsxs("div",{className:"text-center py-16",children:[r.jsx("p",{className:"text-h4 text-text-secondary",children:"  ."}),r.jsx("p",{className:"text-body text-text-tertiary mt-2",children:"       ."})]})]})})},Ga="var(--accent-primary)",kT=({currentUser:e,onReviewComplete:t})=>{const[n,s]=w.useState(!0),[l,o]=w.useState([]),[a,i]=w.useState(0),[u,c]=w.useState(void 0),[d,h]=w.useState(!1),[f,p]=w.useState(null),v=w.useCallback(async()=>{const y=(e.mistakeNotebook||[]).filter(b=>!b.reviewQuizQuestion);if(y.length===0){t([]);return}p(null),s(!0);try{const b=y.map(C=>eA(C).then(_=>({apiQ:_,originalMistakeId:C.id}))),A=(await Promise.allSettled(b)).filter(C=>C.status==="fulfilled"&&C.value).map(C=>{const{apiQ:_,originalMistakeId:L}=C.value;return{id:`review-${L}-${crypto.randomUUID()}`,originalQuestionText:_.question,options:_.options,correctAnswerIndex:_.answer_index,explanation:_.explanation,attemptsOnConcept:0,isConceptMastered:!1,originalMistakeId:L}});if(A.length===0)throw new Error("AI    .     ,     .");o(A)}catch(b){console.error("Error generating review quiz:",b),p(b instanceof Error?b.message:"     .     .")}finally{s(!1)}},[e.mistakeNotebook,t]);w.useEffect(()=>{v()},[v]);const S=()=>{if(u===void 0)return;const y=[...l],b=y[a];b.userAnswerIndex=u,b.isCorrectAttempt=u===b.correctAnswerIndex,o(y)},N=()=>{if(a<l.length-1)i(y=>y+1),c(void 0);else{h(!0);const y=l.map(b=>({originalMistakeId:b.originalMistakeId,reviewQuestion:b,isCorrect:!!b.isCorrectAttempt}));t(y)}};if(n)return r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-8 wonder-panel text-center",children:[r.jsx(Ne,{size:"lg",color:Ga}),r.jsx("p",{className:"text-text-secondary mt-5 text-lg animate-pulse",children:"AI      ..."})]});if(f)return r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-8 wonder-panel text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-color-incorrect mx-auto mb-4"}),r.jsx("h2",{className:"text-h2 text-color-incorrect mb-3",children:" "}),r.jsx("p",{className:"text-text-secondary mb-6",children:f}),r.jsxs("button",{onClick:()=>t([]),className:"wonder-button wonder-button-primary",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]});if(d)return r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-8 wonder-panel text-center",children:[r.jsx(nt,{className:"w-16 h-16 text-color-correct mx-auto mb-4"}),r.jsx("h2",{className:"text-h2 text-color-correct mb-3",children:" !"}),r.jsx("p",{className:"text-text-secondary mb-6",children:"  .   ."}),r.jsx(Ne,{})]});const E=l[a],g=(E==null?void 0:E.userAnswerIndex)!==void 0;return r.jsxs("div",{className:"w-full max-w-2xl mx-auto p-6 sm:p-8 wonder-panel",children:[r.jsx("h1",{className:"text-h2 text-accent-primary mb-4 text-center",children:"AI   "}),E?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Ga} 80%, var(--text-primary))`},children:[" ",a+1,"/",l.length]}),r.jsx("p",{className:"text-h4 text-text-primary mb-6 whitespace-pre-wrap py-4 border-y border-border-panel",children:E.originalQuestionText}),r.jsx("div",{className:"space-y-3 mb-6",children:E.options.map((y,b)=>{let T="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",A={};return g?b===E.correctAnswerIndex?(T+=" border-[var(--color-correct)] bg-color-correct/10",A={color:"var(--color-correct)"}):b===E.userAnswerIndex?(T+=" border-[var(--color-incorrect)] bg-color-incorrect/10",A={color:"var(--color-incorrect)"}):T+=" opacity-60":u===b&&(T+=" active",A={borderColor:Ga,backgroundColor:`color-mix(in srgb, ${Ga} 20%, transparent)`}),r.jsxs("button",{onClick:()=>!g&&c(b),disabled:g,className:T,style:A,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+b),"."]})," ",y]},b)})}),g&&r.jsxs("div",{className:`my-3 p-3 rounded-md text-sm ${E.isCorrectAttempt?"bg-color-correct/10":"bg-color-incorrect/10"}`,children:[E.isCorrectAttempt?r.jsxs("p",{className:"text-color-correct flex items-center",children:[r.jsx(En,{className:"w-5 h-5 mr-2"})," !"]}):r.jsxs("p",{className:"text-color-incorrect flex items-center",children:[r.jsx(Oe,{className:"w-5 h-5 mr-2"}),"."]}),r.jsxs("p",{className:"text-text-secondary mt-1",children:[": ",E.explanation]})]}),g?r.jsx("button",{onClick:N,className:"wonder-button wonder-button-primary w-full py-3",children:a<l.length-1?" ":"    "}):r.jsx("button",{onClick:S,disabled:u===void 0,className:"wonder-button wonder-button-primary w-full py-3",children:" "})]}):r.jsx("p",{className:"text-text-secondary text-center py-8",children:"  ..."})]})},LT=({onApiKeySet:e})=>{const[t,n]=w.useState(""),[s,l]=w.useState(""),o=()=>{if(!t.trim()){l("API  .");return}if(!t.startsWith("AIza")){l(' Google AI API     .  "AIza"  .');return}l(""),cb(t.trim()),e()};return r.jsxs("div",{className:"w-full max-w-lg wonder-panel p-6 sm:p-10 text-center",children:[r.jsx(fb,{className:"h-20 w-20 text-accent-primary mx-auto mb-4",strokeWidth:1}),r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-text-primary mb-2",children:"API  "}),r.jsx("p",{className:"text-text-secondary mb-6",children:"Let We Do Google Gemini AI    .   ,  Gemini API  ."}),r.jsx("div",{className:"space-y-4 text-left",children:r.jsxs("div",{children:[r.jsx("label",{htmlFor:"apiKeyInput",className:"block text-lg font-semibold text-text-primary mb-2",children:"Gemini API Key"}),r.jsx("input",{type:"password",id:"apiKeyInput",value:t,onChange:a=>n(a.target.value),className:"wonder-input w-full p-3",placeholder:"AIza...",autoFocus:!0}),r.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent-secondary hover:underline mt-2 inline-block",children:"API   ?"})]})}),s&&r.jsx("p",{className:"text-color-incorrect bg-color-incorrect/10 p-3 rounded-md my-6 text-sm",children:s}),r.jsxs("button",{onClick:o,className:"wonder-button wonder-button-primary w-full mt-8 py-3 text-lg",children:["  ",r.jsx(pb,{className:"w-5 h-5 ml-2"})]}),r.jsx("p",{className:"text-xs text-text-secondary mt-6",children:" API     ,   ."})]})},Ha="rgba(31, 41, 55, 0.8)",Bl=({onSolutionChange:e,accentColor:t,problemId:n})=>{const s=w.useRef(null),l=w.useRef(null),[o,a]=w.useState(null),[i,u]=w.useState(!1),[c,d]=w.useState("pen"),[h,f]=w.useState("#FFFFFF"),[p,v]=w.useState(2),[S,N]=w.useState([]),[E,g]=w.useState(null),y=w.useCallback(()=>{if(!s.current||!o)return null;const M=s.current,U=document.createElement("canvas");U.width=M.width,U.height=M.height;const $=U.getContext("2d");return $&&($.fillStyle=Ha,$.fillRect(0,0,U.width,U.height),M.toDataURL()===U.toDataURL())?null:M.toDataURL("image/png")},[o]);w.useEffect(()=>{const M=y();e(E||M)},[E,e,i]);const b=w.useCallback(()=>{if(o!=null&&o.canvas){const M=o.getImageData(0,0,o.canvas.width,o.canvas.height);N(U=>[...U,M].slice(-15))}},[o]),T=w.useCallback(()=>{o!=null&&o.canvas&&(o.fillStyle=Ha,o.fillRect(0,0,o.canvas.width,o.canvas.height),N([]),b(),g(null),l.current&&(l.current.value=""))},[o,b]);w.useEffect(()=>{if(s.current){const M=s.current.getContext("2d",{willReadFrequently:!0});M&&a(M)}},[]),w.useEffect(()=>{T()},[n,T]);const A=()=>{if(o!=null&&o.canvas&&S.length>1){const M=S.slice(0,-1);N(M),M.length>0&&o.putImageData(M[M.length-1],0,0)}},C=(M,U)=>{var Z;const $=M.getBoundingClientRect(),B=M.width/$.width,k=M.height/$.height;let H,F;if(U instanceof MouseEvent)H=U.clientX,F=U.clientY;else if(((Z=U.touches)==null?void 0:Z.length)>0)H=U.touches[0].clientX,F=U.touches[0].clientY;else return{x:0,y:0};return{x:(H-$.left)*B,y:(F-$.top)*k}},_=M=>{if(!o||!s.current)return;if(E)if(window.confirm("    ?"))g(null),l.current&&(l.current.value="");else return;b();const{x:U,y:$}=C(s.current,M.nativeEvent);o.beginPath(),o.moveTo(U,$),u(!0),M.preventDefault()},L=M=>{if(!i||!o||!s.current)return;const{x:U,y:$}=C(s.current,M.nativeEvent);o.lineCap="round",o.lineJoin="round",c==="pen"?(o.strokeStyle=h,o.lineWidth=p):(o.strokeStyle=Ha,o.lineWidth=p+10),o.lineTo(U,$),o.stroke(),M.preventDefault()},I=()=>{o&&(o.closePath(),u(!1))},j=M=>{var $;const U=($=M.target.files)==null?void 0:$[0];if(U){const B=new FileReader;B.onloadend=()=>{g(B.result),o!=null&&o.canvas&&(o.fillStyle=Ha,o.fillRect(0,0,o.canvas.width,o.canvas.height),N([]),b())},B.readAsDataURL(U)}},D=r.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 p-2 mb-2 wonder-panel border-slate-700/50",children:[r.jsx("button",{title:"",onClick:()=>d("pen"),className:`wonder-button p-2 ${c==="pen"?"active":"wonder-button-secondary"}`,style:c==="pen"?{borderColor:t,backgroundColor:`color-mix(in srgb, ${t} 25%, transparent)`,color:t}:{},children:r.jsx(Yn,{className:"w-5 h-5"})}),r.jsx("button",{title:"",onClick:()=>d("eraser"),className:`wonder-button p-2 ${c==="eraser"?"active":"wonder-button-secondary"}`,style:c==="eraser"?{borderColor:t,backgroundColor:`color-mix(in srgb, ${t} 25%, transparent)`,color:t}:{},children:r.jsx(hT,{className:"w-5 h-5"})}),r.jsx("select",{value:h,onChange:M=>f(M.target.value),className:"wonder-input p-1.5 rounded-md text-xs w-auto flex-shrink !bg-slate-700/80",children:["#FFFFFF","#63b3ed","#f6e05e","#FF5252","#69F0AE"].map(M=>r.jsx("option",{value:M,style:{backgroundColor:M,color:["#FFFFFF","#f6e05e","#63b3ed","#69F0AE"].includes(M)?"var(--bg-base)":"var(--text-light)"},children:M==="#FFFFFF"?"":M==="#63b3ed"?"":M==="#f6e05e"?"":M==="#FF5252"?"":""},M))}),r.jsxs("select",{value:p,onChange:M=>v(Number(M.target.value)),className:"wonder-input p-1.5 rounded-md text-xs w-auto flex-shrink !bg-slate-700/80",children:[r.jsx("option",{value:"2",children:""}),r.jsx("option",{value:"5",children:""}),r.jsx("option",{value:"10",children:""})]}),r.jsx("button",{title:"",onClick:A,className:"wonder-button wonder-button-secondary p-2 disabled:opacity-50",disabled:S.length<=1,children:r.jsx(pn,{className:"w-5 h-5 transform scale-x-[-1]"})}),r.jsx("button",{title:" ",onClick:T,className:"wonder-button wonder-button-destructive p-2",children:r.jsx(Oe,{className:"w-5 h-5"})})]});return r.jsxs("div",{children:[r.jsx("h3",{className:"text-md font-medium text-slate-300 text-center mb-2",children:"  (  1)"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-1 text-center",children:"1.    "}),D,r.jsx("canvas",{ref:s,width:500,height:300,onMouseDown:_,onMouseMove:L,onMouseUp:I,onMouseOut:I,onTouchStart:_,onTouchMove:L,onTouchEnd:I,"aria-label":"   ",className:"w-full h-auto bg-[rgba(31,41,59,0.8)] border-2 border-slate-600/70 rounded-md touch-none shadow-inner"})]}),r.jsx("div",{className:"text-center text-slate-400",children:""}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2 text-center",children:"2.    "}),r.jsx("input",{type:"file",id:"photoUpload",accept:"image/*",onChange:j,ref:l,className:"hidden"}),r.jsxs("label",{htmlFor:"photoUpload",className:"wonder-button wonder-button-secondary cursor-pointer inline-flex items-center justify-center w-full py-2.5",style:{color:t,borderColor:t},children:[r.jsx(mT,{className:"w-5 h-5 mr-2"}),"  "]}),E&&r.jsx("div",{className:"mt-2 text-center",children:r.jsx("img",{src:E,alt:"   ",className:"max-w-[200px] mx-auto max-h-40 rounded border border-slate-500"})})]})]})]})},Uh=2,Ph=1,vt="var(--accent-math)",Bu=["","/ ","  ","1  (x)","2  (x)"," 1  (x,y)"," 2  (x,y)"],BT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(Ht.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(Bu),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(""),[g,y]=w.useState(null),[b,T]=w.useState({answerInputTotal:0,essayTotal:0,grandTotal:0,problems:[]}),[A,C]=w.useState(null),[_,L]=w.useState(0),[I,j]=w.useState(!1),D=w.useRef(null),[M,U]=w.useState("problem"),$=f[v];w.useEffect(()=>{t&&c(t)},[t]);const B=()=>i(null),k=(W=!1)=>{o(Ht.SELECT_OPTIONS),W||(c(t||me.MS_1_2),h(Bu)),p([]),S(0),E(""),y(null),T({answerInputTotal:0,essayTotal:0,grandTotal:0,problems:[]}),L(0),j(!1),B(),C(null),U("problem")},H=()=>{k(!1),e()};w.useEffect(()=>(I?D.current=window.setInterval(()=>{L(W=>W+1)},1e3):D.current&&(clearInterval(D.current),D.current=null),()=>{D.current&&(clearInterval(D.current),D.current=null)}),[I]);const F=w.useCallback(async()=>{if(d.length===0){i({type:"validation",message:"    ."});return}o(Ht.GENERATING_QUESTIONS),C("AI    ..."),B(),p([]),S(0);try{const G=(await UA(u,d,Uh,Ph)).map((P,Q)=>({id:`math-arith-${Date.now()}-${Q}`,questionText:P.question_text,questionType:P.question_type,expectedAnswer:P.expected_answer,solutionGuide:P.solution_guide,topicCategory:P.topic_category}));if(G.length===0){i({type:"api",message:"AI   .    ."}),o(Ht.ERROR);return}p(G),S(0),E(""),y(null),o(Ht.SOLVING_PROBLEM),L(0),j(!0)}catch(W){console.error("Error generating math problems:",W),i({type:"api",message:`   : ${W instanceof Error?W.message:String(W)}`,details:String(W)}),o(Ht.ERROR)}finally{C(null)}},[u,d]),Z=async()=>{if(!$)return;j(!1);const W=_;if(!N.trim()&&!g){i({type:"validation",message:" ,        ."}),j(!0);return}let G={...$,userAnswerText:N,timeTakenSeconds:W,userSolutionImageBase64:g};o(Ht.GRADING),C(`AI '${$.topicCategory}'    ...`),B();try{let P;$.questionType==="answer_input"?P=await PA(G,u):P=await GA(G,u);const Q=30,K=P.answerScore+P.processScore+P.timeScore+(P.writingScore||0),ae={answerCorrectness:P.answerScore,solutionProcess:P.processScore,timeEfficiency:P.timeScore,descriptiveWriting:P.writingScore,total:K};G={...G,feedback:P.feedback,scoreBreakdown:ae,isGrading:!1},s&&K<Q/2&&s({id:crypto.randomUUID(),subject:"",moduleType:G.topicCategory,questionText:G.questionText,userAnswer:G.userAnswerText||"  ",correctAnswer:G.expectedAnswer||G.solutionGuide||"  ",aiAnalysis:G.feedback||"AI   .",timestamp:new Date().toISOString()});const O=f.map((se,J)=>J===v?G:se);if(p(O),v<f.length-1)S(se=>se+1),E(""),y(null),o(Ht.SOLVING_PROBLEM),L(0),j(!0);else{const se=O.reduce((J,re)=>(re.scoreBreakdown&&(re.questionType==="answer_input"?J.answerInputTotal+=re.scoreBreakdown.total:J.essayTotal+=re.scoreBreakdown.total,J.grandTotal+=re.scoreBreakdown.total),J),{answerInputTotal:0,essayTotal:0,grandTotal:0,problems:O});T(se),n&&n({id:crypto.randomUUID(),subject:"",moduleType:"/",completedAt:new Date().toISOString(),difficulty:u,score:se.grandTotal,maxPossibleScore:O.length*30,feedbackItems:O.map(J=>{var re;return{type:"math_problem_eval",subjectContext:J.questionText,feedback:J.feedback||"",score:((re=J.scoreBreakdown)==null?void 0:re.total)||0,maxScore:30}})}),o(Ht.SHOW_RESULTS)}}catch(P){console.error("Error evaluating math answer:",P),i({type:"api",message:`   : ${P instanceof Error?P.message:String(P)}`,details:String(P)}),o(Ht.SOLVING_PROBLEM),j(!0)}finally{C(null)}},z=()=>a?r.jsxs("div",{className:"my-4 p-3 bg-red-700/20 border border-red-500/60 text-red-200 rounded-md text-sm",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{children:[r.jsx("strong",{className:"font-semibold",children:":"})," ",a.message]}),r.jsx("button",{onClick:B,className:"p-1 hover:bg-red-500/30 rounded-full",children:r.jsx(Oe,{className:"w-4 h-4"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1 opacity-80",children:[" : ",a.details]})]}):null,q=W=>r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-5xl mx-auto",children:W});if(A)return q(r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:vt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:A})]}));if(l===Ht.ERROR)return q(r.jsxs("div",{className:"p-6 text-center wonder-panel",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),z(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>k(!1),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:vt},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}));const Y=W=>{h(G=>G.includes(W)?G.filter(P=>P!==W):[...G,W])},V=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(hb,{className:"h-10 w-10",style:{color:vt}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"  "})]}),r.jsx("p",{className:"mb-8 text-text-secondary",children:"AI       ,   ."}),z(),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2",style:{color:vt}})," "]}),r.jsx("div",{className:"grid grid-cols-3 lg:grid-cols-5 xl:grid-cols-9 gap-2",children:Object.values(me).map(W=>r.jsx("button",{onClick:()=>c(W),className:`wonder-button wonder-button-secondary py-2 text-xs sm:text-sm ${u===W?"active":""}`,style:u===W?{backgroundColor:`color-mix(in srgb, ${vt} 25%, transparent)`,borderColor:vt,color:"var(--text-primary)"}:{},children:W},W))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(Yn,{className:"w-5 h-5 mr-2",style:{color:vt}}),"   (  )"]}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Bu.map(W=>r.jsxs("button",{onClick:()=>Y(W),className:`wonder-button wonder-button-secondary py-3 text-sm flex items-center justify-center gap-2 ${d.includes(W)?"active":""}`,style:d.includes(W)?{backgroundColor:`color-mix(in srgb, ${vt} 25%, transparent)`,borderColor:vt,color:"var(--text-primary)"}:{},children:[d.includes(W)&&r.jsx(fT,{className:"w-4 h-4"}),W]},W))})]}),r.jsxs("p",{className:"text-sm text-slate-400 my-4",children:["AI      ",Uh,",  ",Ph," ."]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsxs("button",{onClick:F,disabled:d.length===0||l===Ht.GENERATING_QUESTIONS,className:"wonder-button wonder-button-primary px-8 py-3 text-lg flex items-center",style:{backgroundColor:vt,borderColor:vt},children:[l===Ht.GENERATING_QUESTIONS?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsx(nt,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:H,className:"text-text-secondary hover:text-text-primary flex items-center",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"})," "]})]})]}),R=()=>{if(!$)return null;const W=$.questionType==="essay",G=`lg:w-2/5 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${M==="problem"?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,P=`lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${M==="solution"?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",children:[r.jsxs("button",{onClick:()=>U("problem"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${M==="problem"?"active":""}`,style:M==="problem"?{borderColor:vt,backgroundColor:`color-mix(in srgb, ${vt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(kt,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>U("solution"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${M==="solution"?"active":""}`,style:M==="solution"?{borderColor:vt,backgroundColor:`color-mix(in srgb, ${vt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Yn,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]})]}),r.jsxs("div",{className:G,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:`color-mix(in srgb, ${vt} 80%, white)`},children:[" ",v+1,"/",f.length," (",$.questionType==="essay"?"":"",")"]}),r.jsxs("div",{className:"flex items-center text-lg font-mono wonder-button wonder-button-secondary px-3 py-1.5 shadow-sm",style:{color:vt},children:[r.jsx(xx,{className:"w-5 h-5 mr-2"})," ",String(Math.floor(_/60)).padStart(2,"0"),":",String(_%60).padStart(2,"0")]})]}),r.jsx("p",{className:"text-body text-slate-100 mb-5 whitespace-pre-wrap leading-relaxed py-3 border-y-2 border-[var(--border-panel)] my-3 text-center font-medium",style:{fontFamily:"'Noto Sans KR', sans-serif"},children:$.questionText}),$.userSolutionImageBase64&&r.jsxs("div",{className:"mt-4",children:[r.jsx("p",{className:"text-sm font-medium text-slate-300 mb-1",children:"  :"}),r.jsx("img",{src:$.userSolutionImageBase64,alt:" ",className:"max-w-xs mx-auto rounded border border-slate-500"})]}),$.feedback&&r.jsxs("div",{className:"mt-4 p-3 wonder-panel border-yellow-500/60 bg-yellow-700/20 text-sm",children:[r.jsx("p",{className:"font-semibold text-yellow-200",children:"AI :"}),r.jsx("p",{className:"text-slate-300 whitespace-pre-wrap",children:$.feedback})]})]}),r.jsxs("div",{className:P,children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"answerInput",className:"block text-md font-medium mb-2",style:{color:vt},children:W?"    :":" :"}),r.jsx("textarea",{id:"answerInput",value:N,onChange:Q=>E(Q.target.value),rows:W?4:2,placeholder:W?"    ...":" ...",className:"wonder-input w-full p-3 mb-2"})]}),r.jsx(Bl,{problemId:$.id,onSolutionChange:y,accentColor:vt})]}),r.jsx("button",{onClick:Z,disabled:l===Ht.GRADING,className:"wonder-button wonder-button-primary w-full mt-6 px-6 py-3.5 text-lg",style:{backgroundColor:"var(--accent-science)",borderColor:"var(--accent-science)"},children:l===Ht.GRADING?r.jsx(Ne,{size:"sm",color:"text-white"}):v<f.length-1?" ":"    "})]})]})},X=()=>{const W=f.reduce((Q,K)=>K.questionType==="answer_input"||K.questionType==="essay"?Q+30:Q,0),G=W>0?Math.round(b.grandTotal/W*100):0;let P="var(--color-incorrect)";return G>=80?P="var(--color-correct)":G>=50&&(P="var(--color-warning)"),r.jsxs("div",{className:"text-center wonder-panel p-6",children:[r.jsxs("div",{className:"p-5 sm:p-8 text-left",style:{borderColor:vt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Dn,{className:"h-12 w-12 sm:h-14 sm:w-14 mr-0 sm:mr-4 mb-2 sm:mb-0",style:{color:vt}}),r.jsx("h2",{className:"text-h1 font-bold text-shadow-subtle",style:{color:vt},children:"/  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(: ",u,")"]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:" "}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:vt},children:[b.grandTotal,r.jsxs("span",{className:"text-3xl text-slate-400",children:[" / ",W]})]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${G}%`,backgroundColor:P}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[G,"% "]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:"  "}),r.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto scrollbar-thin p-1",children:b.problems.map((Q,K)=>{var ae;return r.jsxs("details",{className:"p-3 wonder-panel border-slate-600/50 text-left group",children:[r.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[r.jsxs("span",{className:"text-sm font-medium text-slate-200",children:[" ",K+1,": ",Q.topicCategory," ",r.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${Q.scoreBreakdown&&Q.scoreBreakdown.total>(Q.questionType==="answer_input",30*.6)?"bg-green-600/70 text-green-200":"bg-red-600/70 text-red-200"}`,children:[((ae=Q.scoreBreakdown)==null?void 0:ae.total)||0,""]})]}),r.jsx("span",{className:"text-xs text-slate-400 group-open:rotate-180 transition-transform",children:""})]}),r.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--border-panel)] text-xs",children:[r.jsxs("p",{className:"text-slate-300 whitespace-pre-wrap",children:[": ",Q.questionText]}),r.jsxs("p",{className:"text-slate-400",children:[" : ",Q.userAnswerText||""]}),Q.userSolutionImageBase64&&r.jsx("img",{src:Q.userSolutionImageBase64,alt:" ",className:"my-1 max-w-[100px] max-h-[70px] rounded border border-slate-500 bg-slate-800/50"}),r.jsxs("p",{className:"text-sky-300 mt-1",children:["AI : ",Q.feedback||""]}),r.jsxs("p",{className:"text-gray-500 text-xxs",children:[" : ",Q.timeTakenSeconds||0,""]})]})]},Q.id)})})]}),r.jsxs("div",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>k(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center px-6 py-3.5",children:[r.jsx(ls,{className:"w-5 h-5 mr-2.5"}),"    "]}),r.jsxs("button",{onClick:H,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5",style:{backgroundColor:vt,borderColor:vt},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2.5"})," "]})]})]})};return l===Ht.SELECT_OPTIONS?q(V()):l===Ht.SOLVING_PROBLEM?q(R()):l===Ht.SHOW_RESULTS?q(X()):q(r.jsx("p",{children:"   ."}))},UT=Object.values(Co),Fa=1,mt="var(--accent-math)",PT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(tn.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(""),[g,y]=w.useState(""),[b,T]=w.useState(null),[A,C]=w.useState({totalProblemsSolved:0,totalCorrectProblems:0,cumulativeScore:0,maxPossibleCumulativeScore:0,problemHistory:[]}),[_,L]=w.useState(null),[I,j]=w.useState(0),[D,M]=w.useState(!1),U=w.useRef(null),$=w.useRef(null),[B,k]=w.useState("problem"),H=w.useRef(null),[F,Z]=w.useState(null),[z,q]=w.useState(!1),[Y,V]=w.useState("pen"),[R,X]=w.useState("#FFFFFF"),[W,G]=w.useState(2),[P,Q]=w.useState([]),K=f[v],ae=(K==null?void 0:K.interactionType)===Co.EQUATION_TO_GRAPH,O=(K==null?void 0:K.interactionType)===Co.GRAPH_TO_EQUATION,se=(K==null?void 0:K.interactionType)===Co.GRAPH_INTERPRETATION_ESSAY,J=Ee=>r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:mt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:Ee})]});w.useEffect(()=>(D?U.current=window.setInterval(()=>{j(Ee=>Ee+1)},1e3):U.current&&clearInterval(U.current),()=>{U.current&&clearInterval(U.current)}),[D]);const re=(Ee,Ie)=>{Ee!=null&&Ee.canvas&&Ie(Be=>[...Be,Ee.getImageData(0,0,Ee.canvas.width,Ee.canvas.height)].slice(-10))};w.useEffect(()=>{var Ee;if(ae&&H.current&&l===tn.SOLVING_PROBLEM){const Ie=H.current.getContext("2d",{willReadFrequently:!0});if(Ie)if(Z(Ie),P.length===0||(K==null?void 0:K.id)!==((Ee=f[v-1])==null?void 0:Ee.id))Ie.fillStyle="rgba(55, 65, 81, 0.8)",Ie.fillRect(0,0,H.current.width,H.current.height),re(Ie,Q);else{const Be=P[P.length-1];Be&&Ie.putImageData(Be,0,0)}}},[l,v,ae,K==null?void 0:K.id,f,P]);const ie=()=>{F!=null&&F.canvas&&(F.fillStyle="rgba(55, 65, 81, 0.8)",F.fillRect(0,0,F.canvas.width,F.canvas.height),Q([]),re(F,Q))},le=()=>{j(0),M(!0)},pe=()=>(M(!1),I),ee=()=>i(null),ue=(Ee=!1)=>{o(tn.SELECT_OPTIONS),Ee||(c(t||me.MS_1_2),h(null)),p([]),S(0),E(""),y(""),T(null),C({totalProblemsSolved:0,totalCorrectProblems:0,cumulativeScore:0,maxPossibleCumulativeScore:0,problemHistory:[]}),j(0),M(!1),ie(),V("pen"),X("#FFFFFF"),G(2),ee(),L(null),k("problem")},fe=()=>{ue(!1),e()},ye=w.useCallback(async()=>{if(!d){i({type:"validation",message:"  ."});return}o(tn.GENERATING_PROBLEMS),L("AI    ..."),p([]),S(0),E(""),y(""),T(null),C(Ee=>({...Ee,problemHistory:[],cumulativeScore:0,totalCorrectProblems:0,totalProblemsSolved:0})),ie(),ee();try{const Ee=Array.from({length:Fa},()=>HA(u,d)),Be=(await Promise.all(Ee)).map((at,gn)=>{var At,gt,_e,Ps;return{id:`graph-p-${Date.now()}-${crypto.randomUUID()}-${gn}`,interactionType:at.interaction_type,topic:at.topic,difficulty:u,problemTitle:`${at.problem_title} ( ${gn+1}/${Fa})`,overallSolutionGuide:at.overall_solution_guide,graphData:at.graph_data,equationString:(At=at.equation_to_graph_details)==null?void 0:At.equation_string,correctEquation:at.correct_equation,graphAxisConfig:(gt=at.equation_to_graph_details)==null?void 0:gt.axis_config,expectedPlotPoints:(_e=at.equation_to_graph_details)==null?void 0:_e.target_plot_points,solutionGraphData:(Ps=at.equation_to_graph_details)==null?void 0:Ps.solution_graph_data}});if(Be.length===0&&Fa>0)throw new Error("  :    .");p(Be),S(0),o(tn.SOLVING_PROBLEM),le()}catch(Ee){console.error("[MathGraphApp] Error generating problems:",Ee),i({type:"api",message:`   : ${Ee instanceof Error?Ee.message:String(Ee)}`,details:String(Ee)}),o(tn.ERROR)}finally{L(null)}},[u,d]),Re=()=>!ae||!H.current?null:{type:"image_base64",data:H.current.toDataURL("image/png")},ne=()=>{if(!K)return;const Ee=pe();let Ie=!1;O&&N.trim()&&(Ie=!0),se&&g.trim()&&(Ie=!0);const Be=Re();if(ae&&Be&&(Ie=!0),b&&(Ie=!0),!Ie){i({type:"validation",message:" , ,   ."}),le();return}let at={timeTakenSeconds:Ee,userSolutionImageBase64:b};O&&(at.userEquationInput=N),se&&(at.userInterpretationInput=g),ae&&(at.userDrawingData=Be),ee();const gn=f.map((At,gt)=>gt===v?{...At,...at}:At);p(gn),E(""),y(""),ie(),T(null),v<f.length-1?(S(At=>At+1),le()):(o(tn.GRADING_ALL),ge(gn))},ge=async Ee=>{L("AI    ..."),ee();let Ie=[],Be=0,at=0;const gn=20;for(let gt=0;gt<Ee.length;gt++){let _e={...Ee[gt],isGrading:!0};p(jt=>jt.map(Ln=>Ln.id===_e.id?_e:Ln));let Ps={equation:_e.userEquationInput,drawingData:_e.userDrawingData,interpretation:_e.userInterpretationInput,solutionImageBase64:_e.userSolutionImageBase64};try{const jt=await FA(_e,Ps);_e.score=jt.score,_e.feedback=jt.feedback,_e.isCorrect=jt.isCorrect,Be+=jt.score,jt.isCorrect&&at++,s&&jt.score<gn/2&&s({id:crypto.randomUUID(),subject:"",moduleType:"/",questionText:_e.problemTitle,userAnswer:_e.userEquationInput||_e.userInterpretationInput||"  ",correctAnswer:_e.correctEquation||_e.overallSolutionGuide,aiAnalysis:jt.feedback,timestamp:new Date().toISOString()})}catch(jt){console.error(`Problem ${gt} grading error:`,jt),_e.feedback=` : ${jt instanceof Error?jt.message:String(jt)}`,_e.score=0,_e.isCorrect=!1,i(Ln=>({type:"api",message:Ln!=null&&Ln.message?`${Ln.message},  ${gt+1}  .`:` ${gt+1}  .`,details:String(jt)}))}_e.isGrading=!1,Ie.push(_e),p(jt=>jt.map(Ln=>Ln.id===_e.id?_e:Ln))}const At={totalProblemsSolved:Ee.length,totalCorrectProblems:at,cumulativeScore:Be,maxPossibleCumulativeScore:Ee.length*gn,problemHistory:Ie};C(At),n&&d&&n({id:crypto.randomUUID(),subject:"",moduleType:`/ - ${d}`,completedAt:new Date().toISOString(),difficulty:u,score:At.cumulativeScore,maxPossibleScore:At.maxPossibleCumulativeScore,feedbackItems:At.problemHistory.map(gt=>({type:"math_problem_eval",subjectContext:gt.problemTitle,feedback:gt.feedback||"",score:gt.score,maxScore:gn}))}),o(tn.SHOW_OVERALL_RESULTS),L(null)},ke=(Ee,Ie)=>{var _e;const Be=Ee.getBoundingClientRect(),at=Ee.width/Be.width,gn=Ee.height/Be.height;let At,gt;if(Ie instanceof MouseEvent)At=Ie.clientX,gt=Ie.clientY;else if(((_e=Ie.touches)==null?void 0:_e.length)>0)At=Ie.touches[0].clientX,gt=Ie.touches[0].clientY;else return{x:0,y:0};return{x:(At-Be.left)*at,y:(gt-Be.top)*gn}},te=Ee=>{if(!F||!H.current)return;re(F,Q);const{x:Ie,y:Be}=ke(H.current,Ee.nativeEvent);F.beginPath(),F.moveTo(Ie,Be),q(!0),Ee.preventDefault()},xe=Ee=>{if(!z||!F||!H.current)return;const{x:Ie,y:Be}=ke(H.current,Ee.nativeEvent);F.lineCap="round",F.lineJoin="round",Y==="pen"?(F.strokeStyle=R,F.lineWidth=W):Y==="eraser"&&(F.strokeStyle="rgba(55, 65, 81, 0.8)",F.lineWidth=W+10),F.lineTo(Ie,Be),F.stroke(),Ee.preventDefault()},he=()=>{F&&(F.closePath(),q(!1))},be=()=>a?r.jsxs("div",{className:"my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:ee,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]}),l!==tn.SELECT_OPTIONS&&r.jsxs("button",{onClick:fe,className:"wonder-button wonder-button-secondary mt-4 flex items-center justify-center text-sm px-4 py-2",children:[r.jsx(pn,{className:"w-4 h-4 mr-1.5"}),"  "]})]}):null,ve=Ee=>r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:Ee}),$e=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(ux,{className:"h-10 w-10",style:{color:mt}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:" "})]}),r.jsx("p",{className:"mb-8 text-text-secondary",children:"AI         !"}),be(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:mt}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(Ee=>r.jsx("button",{onClick:()=>c(Ee),className:`wonder-button wonder-button-secondary px-3 py-3 text-xs sm:text-sm ${u===Ee?"active":""}`,style:u===Ee?{borderColor:mt,backgroundColor:`color-mix(in srgb, ${mt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:Ee},Ee))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(kt,{className:"w-6 h-6 mr-2",style:{color:mt}}),"   "]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:UT.map(Ee=>r.jsx("button",{onClick:()=>h(Ee),className:`wonder-button wonder-button-secondary p-3 text-sm ${d===Ee?"active":""}`,style:d===Ee?{borderColor:mt,backgroundColor:`color-mix(in srgb, ${mt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:Ee},Ee))})]}),r.jsxs("p",{className:"text-sm text-slate-400 my-4",children:["AI    (",Fa,")      ."]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsx("button",{onClick:ye,disabled:l===tn.GENERATING_PROBLEMS||!d,className:"wonder-button wonder-button-primary mt-6 px-8 py-3.5 text-lg",style:{backgroundColor:mt,borderColor:mt},children:l===tn.GENERATING_PROBLEMS?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"     "]})}),r.jsxs("button",{onClick:e,className:"text-text-secondary hover:text-text-primary flex items-center mt-6",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"}),""]})]})]}),ot=()=>{var Be;if(!K)return J(_||"  ...");const Ee=`lg:w-1/2 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${B==="problem"?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,Ie=`lg:w-1/2 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${B==="solution"?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",children:[r.jsxs("button",{onClick:()=>k("problem"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${B==="problem"?"active":""}`,style:B==="problem"?{borderColor:mt,backgroundColor:`color-mix(in srgb, ${mt} 25%, transparent)`,color:mt}:{},children:[r.jsx(kt,{className:"w-4 h-4 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>k("solution"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${B==="solution"?"active":""}`,style:B==="solution"?{borderColor:mt,backgroundColor:`color-mix(in srgb, ${mt} 25%, transparent)`,color:mt}:{},children:[r.jsx(Yn,{className:"w-4 h-4 inline mr-1.5"})," "]})]}),r.jsxs("div",{className:Ee,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:`color-mix(in srgb, ${mt} 80%, white)`},children:[" ",v+1,"/",f.length]}),r.jsxs("div",{className:"flex items-center text-lg font-mono wonder-button wonder-button-secondary px-3 py-1.5 shadow-sm",style:{color:mt},children:[r.jsx(xx,{className:"w-5 h-5 mr-2"})," ",String(Math.floor(I/60)).padStart(2,"0"),":",String(I%60).padStart(2,"0")]})]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-4 text-center",children:[K.topic," (",K.difficulty,")"]}),be(),r.jsx("p",{className:"text-h4 text-slate-100 mb-1 whitespace-pre-wrap leading-relaxed py-3 border-y-2 border-[var(--border-panel)] my-3 text-center font-medium",children:K.problemTitle.split("(")[0].trim()}),r.jsx("p",{className:"text-body text-slate-200 mb-4 whitespace-pre-wrap leading-relaxed",children:K.equationString||((Be=K.graphData)==null?void 0:Be.description)||"  ."}),K.graphData&&r.jsx("div",{className:"my-4 p-1 bg-slate-900/30 rounded-lg border border-[var(--border-panel)] flex justify-center items-center min-h-[200px] max-h-[300px] overflow-hidden",children:K.graphData.type==="svg_xml"?r.jsx("div",{dangerouslySetInnerHTML:{__html:K.graphData.data},className:"w-auto h-auto max-w-full max-h-full object-contain"}):r.jsx("img",{src:K.graphData.data,alt:" ",className:"max-w-full max-h-[300px] object-contain rounded"})}),K.feedback&&r.jsxs("div",{className:"mt-4 p-3 wonder-panel border-yellow-500/60 bg-yellow-700/20 text-sm",children:[r.jsx("p",{className:"font-semibold text-yellow-200",children:"AI :"}),r.jsx("p",{className:"text-slate-300 whitespace-pre-wrap",children:K.feedback})]})]}),r.jsxs("div",{className:Ie,children:[r.jsxs("div",{className:"flex-grow space-y-4",children:[O&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"userEquation",className:"block text-md font-medium mb-2",style:{color:mt},children:" :"}),r.jsx("input",{id:"userEquation",type:"text",value:N,onChange:at=>E(at.target.value),placeholder:": y = 2x^2 + 3x - 5",className:"wonder-input w-full p-3 mb-3"})]}),se&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"userInterpretation",className:"block text-md font-medium mb-2",style:{color:mt},children:"  :"}),r.jsx("textarea",{id:"userInterpretation",value:g,onChange:at=>y(at.target.value),rows:6,placeholder:" , , ,   ...",className:"wonder-input w-full p-3 mb-3"})]}),ae&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-md font-medium mb-2 text-slate-300 text-center",children:" "}),r.jsx("canvas",{ref:H,width:500,height:400,className:"bg-[rgba(55,65,81,0.8)] border-2 border-slate-600/70 rounded-md mx-auto shadow-inner w-full h-auto touch-none responsive-canvas",onMouseDown:te,onMouseMove:xe,onMouseUp:he,onMouseOut:he,onTouchStart:te,onTouchMove:xe,onTouchEnd:he,"aria-label":"  "})]}),r.jsx(Bl,{problemId:K.id,onSolutionChange:T,accentColor:mt})]}),r.jsx("div",{className:"mt-auto pt-4",children:r.jsx("button",{onClick:ne,disabled:K.isGrading,className:"wonder-button wonder-button-primary w-full px-6 py-3 text-lg",style:{backgroundColor:"var(--accent-science)",borderColor:"var(--accent-science)"},children:K.isGrading?r.jsx(Ne,{size:"sm",color:"text-white"}):v<f.length-1?" ":"  , "})})]})]})},_n=()=>{const{totalProblemsSolved:Ee,totalCorrectProblems:Ie,cumulativeScore:Be,maxPossibleCumulativeScore:at,problemHistory:gn}=A,At=at>0?Math.round(Be/at*100):0;let gt="var(--color-incorrect)";return At>=80?gt="var(--color-correct)":At>=50&&(gt="var(--color-warning)"),r.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[r.jsxs("div",{ref:$,className:"wonder-panel p-5 sm:p-8",style:{borderColor:mt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Dn,{className:"h-12 w-12 sm:h-14 sm:w-14 mr-0 sm:mr-4 mb-2 sm:mb-0",style:{color:mt}}),r.jsx("h2",{className:"text-h1 font-bold text-shadow-subtle",style:{color:mt},children:"  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(: ",d," / : ",u,")"]}),be(),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:" "}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:mt},children:[Be,r.jsxs("span",{className:"text-3xl text-slate-400",children:[" / ",at]})]}),r.jsxs("p",{className:"text-lg text-slate-200 mb-2",children:[Ie," / ",Ee,"  "]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${At}%`,backgroundColor:gt}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[At,"% "]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:"  "}),r.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto scrollbar-thin p-1",children:gn.map((_e,Ps)=>{var jt;return r.jsxs("details",{className:"p-3 wonder-panel border-slate-600/50 text-left group",children:[r.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[r.jsxs("span",{className:"text-sm font-medium text-slate-200",children:[" ",Ps+1,": ",_e.problemTitle.split("(")[0].trim(),r.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${_e.isCorrect?"bg-green-600/70 text-green-200":"bg-red-600/70 text-red-200"}`,children:[_e.score," ",_e.isCorrect?r.jsx(En,{className:"w-3 h-3 inline"}):r.jsx(Oe,{className:"w-3 h-3 inline"})]})]}),r.jsx("span",{className:"text-xs text-slate-400 group-open:rotate-180 transition-transform",children:""})]}),r.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--border-panel)] text-xs",children:[r.jsxs("p",{className:"text-slate-300 whitespace-pre-wrap",children:[": ",_e.equationString||((jt=_e.graphData)==null?void 0:jt.description)||_e.problemTitle]}),r.jsxs("p",{className:"text-slate-400",children:[" : ",_e.userEquationInput||_e.userInterpretationInput||" "]}),_e.userDrawingData&&r.jsx("img",{src:_e.userDrawingData.data,alt:" ",className:"my-1 max-w-[100px] max-h-[70px] rounded border border-slate-500 bg-slate-800/50"}),_e.userSolutionImageBase64&&r.jsx("img",{src:_e.userSolutionImageBase64,alt:"",className:"my-1 max-w-[100px] max-h-[70px] rounded border border-slate-500 bg-slate-800/50"}),r.jsxs("p",{className:"text-sky-300 mt-1",children:["AI : ",_e.feedback||""]}),r.jsxs("p",{className:"text-gray-500 text-xxs",children:[" : ",_e.timeTakenSeconds||0,""]})]})]},_e.id)})})]}),r.jsxs("div",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>{ue(!0),ye()},className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5",style:{backgroundColor:mt,borderColor:mt},children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:fe,className:"wonder-button wonder-button-secondary flex items-center justify-center px-6 py-3.5",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2.5"})," "]})]})]})};if(_&&(l===tn.GENERATING_PROBLEMS||l===tn.GRADING_ALL))return ve(J(_));if(l===tn.ERROR&&a)return ve(r.jsx("div",{className:"p-4",children:be()||r.jsx("p",{children:" .  ."})}));switch(l){case tn.SELECT_OPTIONS:return ve($e());case tn.SOLVING_PROBLEM:return ve(ot());case tn.SHOW_OVERALL_RESULTS:return ve(_n());default:return ve($e())}},GT=Object.values(Hy),Uu=1,yt="var(--accent-math)",HT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(cn.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(""),[g,y]=w.useState(null),[b,T]=w.useState({totalProblemsSolved:0,totalCorrectProblems:0,cumulativeScore:0,maxPossibleCumulativeScore:0,problemHistory:[]}),[A,C]=w.useState(null),[_,L]=w.useState(0),[I,j]=w.useState(!1),D=w.useRef(null),M=w.useRef(null),[U,$]=w.useState("problem"),B=f[v],k=K=>r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:yt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:K})]});w.useEffect(()=>{t&&c(t)},[t]),w.useEffect(()=>(I?D.current=window.setInterval(()=>{L(K=>K+1)},1e3):D.current&&clearInterval(D.current),()=>{D.current&&clearInterval(D.current)}),[I]);const H=()=>{L(0),j(!0)},F=()=>(j(!1),_),Z=()=>i(null),z=(K=!1)=>{o(cn.SELECT_OPTIONS),K||(c(t||me.MS_1_2),h(null)),p([]),S(0),E(""),y(null),T({totalProblemsSolved:0,totalCorrectProblems:0,cumulativeScore:0,maxPossibleCumulativeScore:0,problemHistory:[]}),L(0),j(!1),Z(),C(null),$("problem")},q=()=>{z(!1),e()},Y=w.useCallback(async()=>{if(!d){i({type:"validation",message:"  ."});return}o(cn.GENERATING_PROBLEMS),C("AI    ..."),p([]),S(0),E(""),y(null),T(K=>({...K,problemHistory:[],cumulativeScore:0,totalCorrectProblems:0,totalProblemsSolved:0})),Z();try{const K=Array.from({length:Uu},()=>qA(u,d)),O=(await Promise.all(K)).map((se,J)=>({id:`geom-p-${Date.now()}-${rn()}-${J}`,subCategory:se.sub_category,difficulty:u,problemTitle:`${se.problem_title} ( ${J+1}/${Uu})`,questionText:se.question_text,shapeSvgData:se.shape_svg_data,expectedAnswerText:se.expected_answer_text,expectedDescription:se.expected_description,solutionGuide:se.solution_guide}));if(O.length===0)throw new Error("  :    .");p(O),S(0),o(cn.SOLVING_PROBLEM),H()}catch(K){console.error("[MathGeometryApp] Error generating problems:",K),i({type:"api",message:`   : ${K instanceof Error?K.message:String(K)}`,details:String(K)}),o(cn.ERROR)}finally{C(null)}},[u,d]),V=()=>{if(!B)return;const K=F();if(!N.trim()&&!g){i({type:"validation",message:" ,   ."}),H();return}let ae={timeTakenSeconds:K,userInputText:N,userSolutionImageBase64:g};Z();const O=f.map((se,J)=>J===v?{...se,...ae}:se);p(O),E(""),y(null),v<f.length-1?(S(se=>se+1),H()):(o(cn.GRADING_ALL),R(O))},R=async K=>{C("AI    ..."),Z();let ae=[],O=0,se=0;const J=20;for(let ie=0;ie<K.length;ie++){let le={...K[ie],isGrading:!0};p(ee=>ee.map(ue=>ue.id===le.id?le:ue));let pe={textInput:le.userInputText,solutionImageBase64:le.userSolutionImageBase64};try{const ee=await $A(le,pe);le.score=ee.score,le.feedback=ee.feedback,le.isCorrect=ee.isCorrect,O+=ee.score,ee.isCorrect&&se++,s&&ee.score<J/2&&s({id:crypto.randomUUID(),subject:"",moduleType:`/ - ${le.subCategory}`,questionText:le.questionText,userAnswer:le.userInputText||"  ",correctAnswer:le.expectedAnswerText||le.solutionGuide,aiAnalysis:ee.feedback,timestamp:new Date().toISOString()})}catch(ee){console.error(`Problem ${ie} grading error:`,ee),le.feedback=` : ${ee instanceof Error?ee.message:String(ee)}`,le.score=0,le.isCorrect=!1,i(ue=>({type:"api",message:ue!=null&&ue.message?`${ue.message},  ${ie+1}  .`:` ${ie+1}  .`,details:String(ee)}))}le.isGrading=!1,ae.push(le),p(ee=>ee.map(ue=>ue.id===le.id?le:ue))}const re={totalProblemsSolved:K.length,totalCorrectProblems:se,cumulativeScore:O,maxPossibleCumulativeScore:K.length*J,problemHistory:ae};T(re),n&&d&&n({id:crypto.randomUUID(),subject:"",moduleType:`/ - ${d}`,completedAt:new Date().toISOString(),difficulty:u,score:re.cumulativeScore,maxPossibleScore:re.maxPossibleCumulativeScore,feedbackItems:re.problemHistory.map(ie=>({type:"math_problem_eval",subjectContext:ie.problemTitle,feedback:ie.feedback||"",score:ie.score,maxScore:J}))}),o(cn.SHOW_OVERALL_RESULTS),C(null)},X=()=>a?r.jsxs("div",{className:"my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:Z,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]}),l!==cn.SELECT_OPTIONS&&r.jsxs("button",{onClick:q,className:"wonder-button wonder-button-secondary mt-4 flex items-center justify-center text-sm px-4 py-2",children:[r.jsx(pn,{className:"w-4 h-4 mr-1.5"}),"  "]})]}):null,W=K=>r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:K}),G=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(yb,{className:"h-10 w-10",style:{color:yt}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:" "})]}),r.jsx("p",{className:"mb-8 text-text-secondary",children:"AI        !"}),X(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:yt}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(K=>r.jsx("button",{onClick:()=>c(K),className:`wonder-button wonder-button-secondary px-3 py-3 text-xs sm:text-sm ${u===K?"active":""}`,style:u===K?{borderColor:yt,backgroundColor:`color-mix(in srgb, ${yt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:K},K))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(kt,{className:"w-6 h-6 mr-2",style:{color:yt}}),"   "]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:GT.map(K=>r.jsx("button",{onClick:()=>h(K),className:`wonder-button wonder-button-secondary p-3 text-sm ${d===K?"active":""}`,style:d===K?{borderColor:yt,backgroundColor:`color-mix(in srgb, ${yt} 25%, transparent)`,color:"var(--text-primary)"}:{},children:K},K))})]}),r.jsxs("p",{className:"text-sm text-slate-400 my-4",children:["AI   (",Uu,")      ."]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsx("button",{onClick:Y,disabled:l===cn.GENERATING_PROBLEMS||!d,className:"wonder-button wonder-button-primary mt-6 px-8 py-3.5 text-lg",style:{backgroundColor:yt,borderColor:yt},children:l===cn.GENERATING_PROBLEMS?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"     "]})}),r.jsxs("button",{onClick:e,className:"text-text-secondary hover:text-text-primary flex items-center mt-6",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"}),""]})]})]}),P=()=>{if(!B)return k(A||"  ...");const K=`lg:w-1/2 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${U==="problem"?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,ae=`lg:w-1/2 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${U==="solution"?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",children:[r.jsxs("button",{onClick:()=>$("problem"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${U==="problem"?"active":""}`,style:U==="problem"?{borderColor:yt,backgroundColor:`color-mix(in srgb, ${yt} 25%, transparent)`,color:yt}:{},children:[r.jsx(kt,{className:"w-4 h-4 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>$("solution"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs shadow-xl ${U==="solution"?"active":""}`,style:U==="solution"?{borderColor:yt,backgroundColor:`color-mix(in srgb, ${yt} 25%, transparent)`,color:yt}:{},children:[r.jsx(Yn,{className:"w-4 h-4 inline mr-1.5"})," "]})]}),r.jsxs("div",{className:K,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:`color-mix(in srgb, ${yt} 80%, white)`},children:[" ",v+1,"/",f.length]}),r.jsxs("div",{className:"flex items-center text-lg font-mono wonder-button wonder-button-secondary px-3 py-1.5 shadow-sm",style:{color:yt},children:[r.jsx(xx,{className:"w-5 h-5 mr-2"})," ",String(Math.floor(_/60)).padStart(2,"0"),":",String(_%60).padStart(2,"0")]})]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-4 text-center",children:[B.subCategory," (",B.difficulty,")"]}),X(),r.jsx("p",{className:"text-h4 text-slate-100 mb-1 whitespace-pre-wrap leading-relaxed py-3 border-y-2 border-[var(--border-panel)] my-3 text-center font-medium",children:B.problemTitle.split("(")[0].trim()}),r.jsx("p",{className:"text-body text-slate-200 mb-4 whitespace-pre-wrap leading-relaxed",children:B.questionText}),B.shapeSvgData&&r.jsx("div",{className:"my-4 p-1 bg-slate-900/30 rounded-lg border border-[var(--border-panel)] flex justify-center items-center min-h-[200px] max-h-[300px] overflow-hidden",children:B.shapeSvgData.type==="svg_xml"?r.jsx("div",{dangerouslySetInnerHTML:{__html:B.shapeSvgData.data},className:"w-auto h-auto max-w-full max-h-full object-contain"}):r.jsx("img",{src:B.shapeSvgData.data,alt:" ",className:"max-w-full max-h-[300px] object-contain rounded"})}),B.feedback&&r.jsxs("div",{className:"mt-4 p-3 wonder-panel border-yellow-500/60 bg-yellow-700/20 text-sm",children:[r.jsx("p",{className:"font-semibold text-yellow-200",children:"AI :"}),r.jsx("p",{className:"text-slate-300 whitespace-pre-wrap",children:B.feedback})]})]}),r.jsxs("div",{className:ae,children:[r.jsxs("div",{className:"flex-grow space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"userInputText",className:"block text-md font-medium mb-2",style:{color:yt},children:"  ( ,  ):"}),r.jsx("textarea",{id:"userInputText",value:N,onChange:O=>E(O.target.value),rows:4,placeholder:" , ,      ...",className:"wonder-input w-full p-3 mb-3"})]}),r.jsx(Bl,{problemId:B.id,onSolutionChange:y,accentColor:yt})]}),r.jsx("div",{className:"mt-auto pt-4",children:r.jsx("button",{onClick:V,disabled:B.isGrading,className:"wonder-button wonder-button-primary w-full px-6 py-3 text-lg",style:{backgroundColor:"var(--accent-science)",borderColor:"var(--accent-science)"},children:B.isGrading?r.jsx(Ne,{size:"sm",color:"text-white"}):v<f.length-1?" ":"  , "})})]})]})},Q=()=>{const{totalProblemsSolved:K,totalCorrectProblems:ae,cumulativeScore:O,maxPossibleCumulativeScore:se,problemHistory:J}=b,re=se>0?Math.round(O/se*100):0;let ie="var(--color-incorrect)";return re>=80?ie="var(--color-correct)":re>=50&&(ie="var(--color-warning)"),r.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[r.jsxs("div",{ref:M,className:"wonder-panel p-5 sm:p-8",style:{borderColor:yt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Dn,{className:"h-12 w-12 sm:h-14 sm:w-14 mr-0 sm:mr-4 mb-2 sm:mb-0",style:{color:yt}}),r.jsx("h2",{className:"text-h1 font-bold text-shadow-subtle",style:{color:yt},children:"/  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(: ",d," / : ",u,")"]}),X(),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:" "}),r.jsxs("p",{className:"text-5xl font-extrabold mb-1",style:{color:yt},children:[O,r.jsxs("span",{className:"text-3xl text-slate-400",children:[" / ",se]})]}),r.jsxs("p",{className:"text-lg text-slate-200 mb-2",children:[ae," / ",K,"  "]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${re}%`,backgroundColor:ie}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[re,"% "]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:"  "}),r.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto scrollbar-thin p-1",children:J.map((le,pe)=>r.jsxs("details",{className:"p-3 wonder-panel border-slate-600/50 text-left group",children:[r.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[r.jsxs("span",{className:"text-sm font-medium text-slate-200",children:[" ",pe+1,": ",le.problemTitle.split("(")[0].trim(),r.jsxs("span",{className:`ml-2 px-1.5 py-0.5 text-xs rounded ${le.isCorrect?"bg-green-600/70 text-green-200":"bg-red-600/70 text-red-200"}`,children:[le.score," ",le.isCorrect?r.jsx(En,{className:"w-3 h-3 inline"}):r.jsx(Oe,{className:"w-3 h-3 inline"})]})]}),r.jsx("span",{className:"text-xs text-slate-400 group-open:rotate-180 transition-transform",children:""})]}),r.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--border-panel)] text-xs",children:[r.jsxs("p",{className:"text-slate-300 whitespace-pre-wrap",children:[": ",le.questionText]}),r.jsxs("p",{className:"text-slate-400",children:[" : ",le.userInputText||""]}),le.userSolutionImageBase64&&r.jsx("img",{src:le.userSolutionImageBase64,alt:"",className:"my-1 max-w-[100px] max-h-[70px] rounded border border-slate-500 bg-slate-800/50"}),r.jsxs("p",{className:"text-sky-300 mt-1",children:["AI : ",le.feedback||""]}),r.jsxs("p",{className:"text-gray-500 text-xxs",children:[" : ",le.timeTakenSeconds||0,""]})]})]},le.id))})]}),r.jsxs("div",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>{z(!0),Y()},className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5",style:{backgroundColor:yt,borderColor:yt},children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:q,className:"wonder-button wonder-button-secondary flex items-center justify-center px-6 py-3.5",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2.5"})," "]})]})]})};if(A&&(l===cn.GENERATING_PROBLEMS||l===cn.GRADING_ALL))return W(k(A));if(l===cn.ERROR&&a)return W(r.jsx("div",{className:"p-4",children:X()||r.jsx("p",{children:" .  ."})}));switch(l){case cn.SELECT_OPTIONS:return W(G());case cn.SOLVING_PROBLEM:return W(P());case cn.SHOW_OVERALL_RESULTS:return W(Q());default:return W(G())}},Pu=2,Gu=20,qa=10,Ve="var(--accent-social)",FT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(un.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState(Fn.AI_RECOMMENDED),[v,S]=w.useState(""),[N,E]=w.useState(null),[g,y]=w.useState([]),[b,T]=w.useState(null),[A,C]=w.useState(0),[_,L]=w.useState(void 0),[I,j]=w.useState(""),[D,M]=w.useState({mcq:0,essay:0,totalMcqPossible:Pu*qa,totalEssayPossible:Gu,total:0}),[U,$]=w.useState(null),[B,k]=w.useState(null),[H,F]=w.useState("text"),Z=w.useRef(null),z=w.useRef(null),q=()=>i(null),Y=(O=!1)=>{o(un.SELECT_OPTIONS),i(null),O||(c(t||me.MS_1_2),h(null),p(Fn.AI_RECOMMENDED),S("")),E(null),y([]),T(null),C(0),L(void 0),j(""),M({mcq:0,essay:0,totalMcqPossible:Pu*qa,totalEssayPossible:Gu,total:0}),$(null),F("text"),k(null)},V=()=>{Y(!1),e()},R=w.useCallback(async()=>{if(!d){i({type:"validation",message:"   ."}),o(un.SELECT_OPTIONS);return}o(un.FETCHING_CONTENT),k(`AI '${d}'      ...`),q(),E(null),y([]),T(null);try{const O=await tx("",d,u);E(O);const[se,J]=await Promise.all([nx(O.explanation,O.topic,Pu,u,""),sx(O.explanation,O.topic,u,"")]),re=se.map((ie,le)=>({id:`sg-mcq-${le}-${rn()}`,originalQuestionText:ie.question,options:ie.options,correctAnswerIndex:ie.answer_index,explanation:ie.explanation,attemptsOnConcept:0,isConceptMastered:!1}));y(re),J&&T({id:`sg-essay-${rn()}`,questionText:J.questionText,solutionText:J.solutionText,userAnswer:""}),o(un.DISPLAY_CONTENT_AND_INTERACTION),F("interaction")}catch(O){console.error(O),i({type:"api",message:O instanceof Error?O.message:"    ",details:String(O)}),o(un.ERROR)}finally{k(null)}},[d,u]),X=()=>{if(_===void 0||A>=g.length)return;const O=g[A],se=_===O.correctAnswerIndex,J={...O,userAnswerIndex:_,isCorrectAttempt:se,attemptsOnConcept:O.attemptsOnConcept+1,isConceptMastered:O.isConceptMastered||se};y(re=>re.map(ie=>ie.id===J.id?J:ie)),se&&J.attemptsOnConcept===1?M(re=>({...re,mcq:re.mcq+qa,total:re.total+qa})):!se&&s&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:J.originalQuestionText,userAnswer:J.options[_],correctAnswer:J.options[J.correctAnswerIndex],aiAnalysis:J.explanation,timestamp:new Date().toISOString()}),setTimeout(()=>{L(void 0),A<g.length-1?C(re=>re+1):Z.current&&(Z.current.scrollTop=0)},1500)},W=async()=>{if(!N)return;o(un.GRADING),k("AI       ..."),q();let O=0,se=b;if(b&&I.trim())try{const re=await rx(N.explanation,N.topic,b.questionText,I,u,"");O=re.score,se={...b,userAnswer:I,score:O,feedback:re.feedback},T(se),s&&O<Gu/2&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:b.questionText,userAnswer:I,correctAnswer:b.solutionText||"  ",aiAnalysis:re.feedback,timestamp:new Date().toISOString()})}catch(re){console.error("Essay grading error:",re),i({type:"api",message:"     ",details:String(re)})}const J={...D,essay:O,total:D.mcq+O};M(J);try{const re=await lx(N,g,se,"");$(re),n&&n({id:crypto.randomUUID(),subject:"",moduleType:"",completedAt:new Date().toISOString(),difficulty:u,score:J.total,maxPossibleScore:J.totalMcqPossible+J.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:re}]})}catch(re){console.error("Weak points feedback error:",re),$("     .")}o(un.SHOW_RESULTS),k(null),Z.current&&(Z.current.scrollTop=0)},G=()=>a?r.jsxs("div",{className:"w-full my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:q,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]})]}):null,P=(O,se,J=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[G(),se,J&&l!==un.SELECT_OPTIONS&&r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"    "]})]});if(B)return P("",r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Ve}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:B})]}),!1);if(l===un.ERROR)return P("",r.jsxs("div",{className:"p-6 text-center wonder-panel max-w-xl mx-auto",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),G(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>Y(!1),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:Ve},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}),!1);const Q=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(io,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:Ve},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:" "})]}),r.jsx("p",{className:"mb-4 text-body text-slate-200 leading-relaxed",children:"AI         ."}),G(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:Ve}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(O=>r.jsx("button",{onClick:()=>c(O),className:`wonder-button wonder-button-secondary px-3 py-3 text-xs sm:text-sm ${u===O?"active":""}`,style:u===O?{borderColor:Ve,backgroundColor:`color-mix(in srgb, ${Ve} 25%, transparent)`,color:"var(--text-primary)"}:{},children:O},O))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(io,{className:"w-6 h-6 mr-2",style:{color:Ve}}),"   "]}),r.jsx("div",{className:"flex justify-center space-x-3 mb-4",children:Object.values(Fn).map(O=>r.jsx("button",{onClick:()=>p(O),className:`wonder-button text-xs px-3 py-1.5 sm:px-4 sm:py-2 ${f===O?"wonder-button-primary":"wonder-button-secondary"}`,style:f===O?{backgroundColor:`color-mix(in srgb, ${Ve} 70%, transparent)`,borderColor:Ve,color:"var(--text-primary)"}:{},children:O},O))}),f===Fn.AI_RECOMMENDED?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:SE.map(O=>r.jsx("button",{onClick:()=>h(O),className:`wonder-button wonder-button-secondary p-3 text-sm ${d===O?"active":""}`,style:d===O?{borderColor:Ve,backgroundColor:`color-mix(in srgb, ${Ve} 25%, transparent)`,color:"var(--text-primary)"}:{},children:O},O))}):r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"text",value:v,onChange:O=>S(O.target.value),placeholder:"  (: )",className:"wonder-input flex-grow p-3"}),r.jsx("button",{onClick:()=>h(v),disabled:!v.trim(),className:"wonder-button wonder-button-primary p-3",children:r.jsx(Lr,{className:"w-5 h-5"})})]}),d&&r.jsxs("p",{className:"text-sm text-slate-300 mt-3 text-center",children:[" : ",r.jsx("span",{style:{color:Ve,fontWeight:"bold"},children:d})]})]}),r.jsx("button",{onClick:R,disabled:!d||l===un.FETCHING_CONTENT,className:"wonder-button wonder-button-primary mt-8 px-8 py-3.5 text-lg",style:{backgroundColor:Ve,borderColor:Ve},children:l===un.FETCHING_CONTENT?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})}),r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),K=()=>{if(!N)return null;const O=A<g.length,se=!O&&b,J=!O&&(!b||b&&I.trim()!==""),re=`lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${H==="text"||l===un.SHOW_RESULTS?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,ie=`lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${H==="interaction"||l===un.SHOW_RESULTS?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",id:"mobile-view-toggle-social-general",children:[r.jsxs("button",{onClick:()=>F("text"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="text"?"active":""}`,style:H==="text"?{borderColor:Ve,backgroundColor:`color-mix(in srgb, ${Ve} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Bs,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>F("interaction"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="interaction"?"active":""}`,style:H==="interaction"?{borderColor:Ve,backgroundColor:`color-mix(in srgb, ${Ve} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Yn,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]})]}),r.jsxs("div",{id:"report-text-panel-social-general",className:re,ref:z,children:[r.jsx("div",{className:"flex justify-between items-center mb-3",children:r.jsxs("h2",{className:"text-h2 font-semibold flex items-center",style:{color:Ve},children:[r.jsx(io,{className:"w-7 h-7 mr-2.5 flex-shrink-0"})," ",N.topic]})}),r.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[r.jsxs("p",{className:"text-caption text-slate-400",children:[" (",N.difficulty,")"]}),N.sourceUrl&&r.jsx("a",{href:N.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-small hover:underline",style:{color:Ve},children:" "})]}),r.jsx("div",{className:"prose-wonder max-w-none text-slate-200 whitespace-pre-wrap text-body leading-relaxed",children:N.explanation})]}),r.jsxs("div",{id:"report-interaction-panel-social-general",ref:Z,className:ie,children:[G(),O&&g[A]&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Ve} 80%, white)`},children:["  ",A+1,"/",g.length]}),r.jsx("p",{className:"text-body text-slate-100 mb-4 whitespace-pre-wrap",children:g[A].originalQuestionText}),r.jsx("div",{className:"space-y-3",children:g[A].options.map((le,pe)=>{const ee=_===pe,ue=g[A];let fe="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",ye={};return ue.userAnswerIndex!==void 0?pe===ue.correctAnswerIndex?(fe+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.2)]",ye={color:"var(--color-correct)",fontWeight:"600"}):pe===ue.userAnswerIndex?(fe+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.2)]",ye={color:"var(--color-incorrect)"}):fe+=" opacity-60 border-[var(--border-panel)]":ee?(fe+=` active border-[${Ve}]`,ye={borderColor:Ve,backgroundColor:`color-mix(in srgb, ${Ve} 20%, transparent)`,color:"var(--text-primary)"}):fe+=` border-[var(--border-panel)] hover:border-[${Ve}]`,r.jsxs("button",{onClick:()=>ue.userAnswerIndex===void 0&&L(pe),disabled:ue.userAnswerIndex!==void 0,className:fe,style:ye,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+pe),"."]})," ",le]},pe)})}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!1&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-red-700/20 border-red-500/60 text-sm",children:[r.jsx("p",{className:"font-semibold text-red-200",children:"."}),r.jsxs("p",{className:"text-slate-300",children:[": ",g[A].options[g[A].correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-400",children:[": ",g[A].explanation]})]}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!0&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-green-700/30 border-green-500/60 text-green-200 font-semibold flex items-center text-sm",children:[r.jsx(En,{className:"w-5 h-5 mr-2 text-green-300"})," !"]}),g[A].userAnswerIndex===void 0&&r.jsx("button",{onClick:X,disabled:_===void 0,className:"wonder-button wonder-button-primary w-full mt-4 py-3 text-lg",style:{backgroundColor:Ve,borderColor:Ve},children:" "})]}),se&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Ve} 80%, white)`},children:" "}),r.jsx("p",{className:"text-body text-slate-100 mb-3 whitespace-pre-wrap",children:b.questionText}),r.jsx("textarea",{value:I,onChange:le=>j(le.target.value),placeholder:"  ...",rows:6,className:"wonder-input w-full p-3"})]}),J&&r.jsx("button",{onClick:W,className:"wonder-button wonder-button-primary w-full mt-6 py-3.5 text-lg",style:{backgroundColor:"var(--accent-english)",borderColor:"var(--accent-english)"},children:"     "})]})]})},ae=()=>{const{mcq:O,essay:se,totalMcqPossible:J,totalEssayPossible:re,total:ie}=D,le=J+re,pe=le>0?Math.round(ie/le*100):0;let ee="var(--color-incorrect)";return pe>=80?ee="var(--color-correct)":pe>=50&&(ee="var(--color-warning)"),r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 text-left mb-6",style:{borderColor:Ve},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-4 text-center sm:text-left",children:[r.jsx(io,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Ve}}),r.jsx("h2",{className:"text-h2 font-bold text-shadow-subtle",style:{color:Ve},children:"  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(",u,")"]}),N&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsx("p",{className:"text-body text-slate-200",children:N.topic})]}),r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:Ve},children:[O," / ",J]})]}),r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:`color-mix(in srgb, ${Ve} 80%, white)`},children:[se," / ",re]})]}),r.jsxs("div",{className:"wonder-panel p-3 border-green-600/50 bg-green-800/30",children:[r.jsx("p",{className:"text-xs text-slate-300",children:""}),r.jsxs("p",{className:"text-lg font-bold text-green-300",children:[ie," / ",le]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${pe}%`,backgroundColor:ee}})}),r.jsxs("p",{className:"text-right text-xs text-slate-400 mt-1",children:[pe,"% "]})]})]}),U&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-1 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-400"}),"AI  "]}),r.jsx("p",{className:"text-slate-200 whitespace-pre-wrap text-sm",children:U})]}),(b==null?void 0:b.feedback)&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-semibold",style:{color:`color-mix(in srgb, ${Ve} 80%, white)`},children:"  AI :"}),r.jsx("p",{className:"text-xs text-slate-200 whitespace-pre-wrap mt-1",children:b.feedback})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:()=>Y(!0),className:"wonder-button wonder-button-primary flex items-center justify-center",style:{backgroundColor:Ve,borderColor:Ve},children:[r.jsx(nt,{className:"w-5 h-5 mr-2"}),"   "]})})]})};return l===un.SELECT_OPTIONS?P("",Q(),!1):P("",l===un.SHOW_RESULTS?ae():K(),!0)},Hu=2,Fu=20,$a=10,ze="var(--accent-social)",qT=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(dn.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState(Fn.AI_RECOMMENDED),[v,S]=w.useState(""),[N,E]=w.useState(null),[g,y]=w.useState([]),[b,T]=w.useState(null),[A,C]=w.useState(0),[_,L]=w.useState(void 0),[I,j]=w.useState(""),[D,M]=w.useState({mcq:0,essay:0,totalMcqPossible:Hu*$a,totalEssayPossible:Fu,total:0}),[U,$]=w.useState(null),[B,k]=w.useState(null),[H,F]=w.useState("text"),Z=w.useRef(null),z=w.useRef(null),q=()=>i(null),Y=(O=!1)=>{o(dn.SELECT_OPTIONS),i(null),O||(c(t||me.MS_1_2),h(null),p(Fn.AI_RECOMMENDED),S("")),E(null),y([]),T(null),C(0),L(void 0),j(""),M({mcq:0,essay:0,totalMcqPossible:Hu*$a,totalEssayPossible:Fu,total:0}),$(null),F("text"),k(null)},V=()=>{Y(!1),e()},R=w.useCallback(async()=>{if(!d){i({type:"validation",message:"     ."}),o(dn.SELECT_OPTIONS);return}o(dn.FETCHING_CONTENT),k(`AI '${d}'      ...`),q(),E(null),y([]),T(null);try{const O=await tx("",d,u);E(O);const[se,J]=await Promise.all([nx(O.explanation,O.topic,Hu,u,""),sx(O.explanation,O.topic,u,"")]),re=se.map((ie,le)=>({id:`sh-mcq-${le}-${rn()}`,originalQuestionText:ie.question,options:ie.options,correctAnswerIndex:ie.answer_index,explanation:ie.explanation,attemptsOnConcept:0,isConceptMastered:!1}));y(re),J&&T({id:`sh-essay-${rn()}`,questionText:J.questionText,solutionText:J.solutionText,userAnswer:""}),o(dn.DISPLAY_CONTENT_AND_INTERACTION),F("interaction")}catch(O){console.error(O),i({type:"api",message:O instanceof Error?O.message:"    ",details:String(O)}),o(dn.ERROR)}finally{k(null)}},[d,u]),X=()=>{if(_===void 0||A>=g.length)return;const O=g[A],se=_===O.correctAnswerIndex,J={...O,userAnswerIndex:_,isCorrectAttempt:se,attemptsOnConcept:O.attemptsOnConcept+1,isConceptMastered:O.isConceptMastered||se};y(re=>re.map(ie=>ie.id===J.id?J:ie)),se&&J.attemptsOnConcept===1?M(re=>({...re,mcq:re.mcq+$a,total:re.total+$a})):!se&&s&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:J.originalQuestionText,userAnswer:J.options[_],correctAnswer:J.options[J.correctAnswerIndex],aiAnalysis:J.explanation,timestamp:new Date().toISOString()}),setTimeout(()=>{L(void 0),A<g.length-1?C(re=>re+1):Z.current&&(Z.current.scrollTop=0)},1500)},W=async()=>{if(!N)return;o(dn.GRADING),k("AI       ..."),q();let O=0,se=b;if(b&&I.trim())try{const re=await rx(N.explanation,N.topic,b.questionText,I,u,"");O=re.score,se={...b,userAnswer:I,score:O,feedback:re.feedback},T(se),s&&O<Fu/2&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:b.questionText,userAnswer:I,correctAnswer:b.solutionText||"  ",aiAnalysis:re.feedback,timestamp:new Date().toISOString()})}catch(re){console.error("Essay grading error:",re),i({type:"api",message:"     ",details:String(re)})}const J={...D,essay:O,total:D.mcq+O};M(J);try{const re=await lx(N,g,se,"");$(re),n&&n({id:crypto.randomUUID(),subject:"",moduleType:"",completedAt:new Date().toISOString(),difficulty:u,score:J.total,maxPossibleScore:J.totalMcqPossible+J.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:re}]})}catch(re){console.error("Weak points feedback error:",re),$("     .")}o(dn.SHOW_RESULTS),k(null),Z.current&&(Z.current.scrollTop=0)},G=()=>a?r.jsxs("div",{className:"w-full my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:q,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]})]}):null,P=(O,se,J=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[G(),se,J&&l!==dn.SELECT_OPTIONS&&r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"    "]})]});if(B)return P("",r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:ze}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:B})]}),!1);if(l===dn.ERROR)return P("",r.jsxs("div",{className:"p-6 text-center wonder-panel max-w-xl mx-auto",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),G(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>Y(!1),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:ze},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}),!1);const Q=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(Dn,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:ze},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:" "})]}),r.jsx("p",{className:"mb-4 text-body text-slate-200 leading-relaxed",children:"AI          ."}),G(),r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:ze}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(O=>r.jsx("button",{onClick:()=>c(O),className:`wonder-button wonder-button-secondary px-3 py-3 text-xs sm:text-sm ${u===O?"active":""}`,style:u===O?{borderColor:ze,backgroundColor:`color-mix(in srgb, ${ze} 25%, transparent)`,color:"var(--text-primary)"}:{},children:O},O))})]}),r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(Dn,{className:"w-6 h-6 mr-2",style:{color:ze}}),"     "]}),r.jsx("div",{className:"flex justify-center space-x-3 mb-4",children:Object.values(Fn).map(O=>r.jsx("button",{onClick:()=>p(O),className:`wonder-button text-xs px-3 py-1.5 sm:px-4 sm:py-2 ${f===O?"wonder-button-primary":"wonder-button-secondary"}`,style:f===O?{backgroundColor:`color-mix(in srgb, ${ze} 70%, transparent)`,borderColor:ze,color:"var(--text-primary)"}:{},children:O},O))}),f===Fn.AI_RECOMMENDED?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:wE.map(O=>r.jsx("button",{onClick:()=>h(O),className:`wonder-button wonder-button-secondary p-3 text-sm ${d===O?"active":""}`,style:d===O?{borderColor:ze,backgroundColor:`color-mix(in srgb, ${ze} 25%, transparent)`,color:"var(--text-primary)"}:{},children:O},O))}):r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"text",value:v,onChange:O=>S(O.target.value),placeholder:"  (:  )",className:"wonder-input flex-grow p-3"}),r.jsx("button",{onClick:()=>h(v),disabled:!v.trim(),className:"wonder-button wonder-button-primary p-3",children:r.jsx(Lr,{className:"w-5 h-5"})})]}),d&&r.jsxs("p",{className:"text-sm text-slate-300 mt-3 text-center",children:[" : ",r.jsx("span",{style:{color:ze,fontWeight:"bold"},children:d})]})]}),r.jsx("button",{onClick:R,disabled:!d||l===dn.FETCHING_CONTENT,className:"wonder-button wonder-button-primary mt-8 px-8 py-3.5 text-lg",style:{backgroundColor:ze,borderColor:ze},children:l===dn.FETCHING_CONTENT?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})}),r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),K=()=>{if(!N)return null;const O=A<g.length,se=!O&&b,J=!O&&(!b||b&&I.trim()!==""),re=`lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${H==="text"||l===dn.SHOW_RESULTS?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,ie=`lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${H==="interaction"||l===dn.SHOW_RESULTS?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",id:"mobile-view-toggle-social-history",children:[r.jsxs("button",{onClick:()=>F("text"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="text"?"active":""}`,style:H==="text"?{borderColor:ze,backgroundColor:`color-mix(in srgb, ${ze} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Bs,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>F("interaction"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="interaction"?"active":""}`,style:H==="interaction"?{borderColor:ze,backgroundColor:`color-mix(in srgb, ${ze} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Yn,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]})]}),r.jsxs("div",{id:"report-text-panel-social-history",className:re,ref:z,children:[r.jsx("div",{className:"flex justify-between items-center mb-3",children:r.jsxs("h2",{className:"text-h2 font-semibold flex items-center",style:{color:ze},children:[r.jsx(Dn,{className:"w-7 h-7 mr-2.5 flex-shrink-0"})," ",N.topic]})}),r.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[r.jsxs("p",{className:"text-caption text-slate-400",children:[" (",N.difficulty,")"]}),N.sourceUrl&&r.jsx("a",{href:N.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-small hover:underline",style:{color:ze},children:" "})]}),r.jsx("div",{className:"prose-wonder max-w-none text-slate-200 whitespace-pre-wrap text-body leading-relaxed",children:N.explanation})]}),r.jsxs("div",{id:"report-interaction-panel-social-history",ref:Z,className:ie,children:[G(),O&&g[A]&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${ze} 80%, white)`},children:["  ",A+1,"/",g.length]}),r.jsx("p",{className:"text-body text-slate-100 mb-4 whitespace-pre-wrap",children:g[A].originalQuestionText}),r.jsx("div",{className:"space-y-3",children:g[A].options.map((le,pe)=>{const ee=_===pe,ue=g[A];let fe="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",ye={};return ue.userAnswerIndex!==void 0?pe===ue.correctAnswerIndex?(fe+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.2)]",ye={color:"var(--color-correct)",fontWeight:"600"}):pe===ue.userAnswerIndex?(fe+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.2)]",ye={color:"var(--color-incorrect)"}):fe+=" opacity-60 border-[var(--border-panel)]":ee?(fe+=` active border-[${ze}]`,ye={borderColor:ze,backgroundColor:`color-mix(in srgb, ${ze} 20%, transparent)`,color:"var(--text-primary)"}):fe+=` border-[var(--border-panel)] hover:border-[${ze}]`,r.jsxs("button",{onClick:()=>ue.userAnswerIndex===void 0&&L(pe),disabled:ue.userAnswerIndex!==void 0,className:fe,style:ye,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+pe),"."]})," ",le]},pe)})}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!1&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-red-700/20 border-red-500/60 text-sm",children:[r.jsx("p",{className:"font-semibold text-red-200",children:"."}),r.jsxs("p",{className:"text-slate-300",children:[": ",g[A].options[g[A].correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-400",children:[": ",g[A].explanation]})]}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!0&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-green-700/30 border-green-500/60 text-green-200 font-semibold flex items-center text-sm",children:[r.jsx(En,{className:"w-5 h-5 mr-2 text-green-300"})," !"]}),g[A].userAnswerIndex===void 0&&r.jsx("button",{onClick:X,disabled:_===void 0,className:"wonder-button wonder-button-primary w-full mt-4 py-3 text-lg",style:{backgroundColor:ze,borderColor:ze},children:" "})]}),se&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${ze} 80%, white)`},children:" "}),r.jsx("p",{className:"text-body text-slate-100 mb-3 whitespace-pre-wrap",children:b.questionText}),r.jsx("textarea",{value:I,onChange:le=>j(le.target.value),placeholder:"  ...",rows:6,className:"wonder-input w-full p-3"})]}),J&&r.jsx("button",{onClick:W,className:"wonder-button wonder-button-primary w-full mt-6 py-3.5 text-lg",style:{backgroundColor:"var(--accent-english)",borderColor:"var(--accent-english)"},children:"     "})]})]})},ae=()=>{const{mcq:O,essay:se,totalMcqPossible:J,totalEssayPossible:re,total:ie}=D,le=J+re,pe=le>0?Math.round(ie/le*100):0;let ee="var(--color-incorrect)";return pe>=80?ee="var(--color-correct)":pe>=50&&(ee="var(--color-warning)"),r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 text-left mb-6",style:{borderColor:ze},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-4 text-center sm:text-left",children:[r.jsx(Dn,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:ze}}),r.jsx("h2",{className:"text-h2 font-bold text-shadow-subtle",style:{color:ze},children:"  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(",u,")"]}),N&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsx("p",{className:"text-body text-slate-200",children:N.topic})]}),r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:ze},children:[O," / ",J]})]}),r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:`color-mix(in srgb, ${ze} 80%, white)`},children:[se," / ",re]})]}),r.jsxs("div",{className:"wonder-panel p-3 border-green-600/50 bg-green-800/30",children:[r.jsx("p",{className:"text-xs text-slate-300",children:""}),r.jsxs("p",{className:"text-lg font-bold text-green-300",children:[ie," / ",le]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${pe}%`,backgroundColor:ee}})}),r.jsxs("p",{className:"text-right text-xs text-slate-400 mt-1",children:[pe,"% "]})]})]}),U&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-1 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-400"}),"AI  "]}),r.jsx("p",{className:"text-slate-200 whitespace-pre-wrap text-sm",children:U})]}),(b==null?void 0:b.feedback)&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-semibold",style:{color:`color-mix(in srgb, ${ze} 80%, white)`},children:"  AI :"}),r.jsx("p",{className:"text-xs text-slate-200 whitespace-pre-wrap mt-1",children:b.feedback})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:()=>Y(!0),className:"wonder-button wonder-button-primary flex items-center justify-center",style:{backgroundColor:ze,borderColor:ze},children:[r.jsx(nt,{className:"w-5 h-5 mr-2"}),"   "]})})]})};return l===dn.SELECT_OPTIONS?P("",Q(),!1):P("",l===dn.SHOW_RESULTS?ae():K(),!0)},qu=2,$u=20,Va=10,Qe="var(--accent-social)",$T=({onGoHome:e,initialDifficulty:t,onModuleComplete:n,onMistakeMade:s})=>{const[l,o]=w.useState(xn.SELECT_OPTIONS),[a,i]=w.useState(null),[u,c]=w.useState(t||me.MS_1_2),[d,h]=w.useState(null),[f,p]=w.useState(Fn.AI_RECOMMENDED),[v,S]=w.useState(""),[N,E]=w.useState(null),[g,y]=w.useState([]),[b,T]=w.useState(null),[A,C]=w.useState(0),[_,L]=w.useState(void 0),[I,j]=w.useState(""),[D,M]=w.useState({mcq:0,essay:0,totalMcqPossible:qu*Va,totalEssayPossible:$u,total:0}),[U,$]=w.useState(null),[B,k]=w.useState(null),[H,F]=w.useState("text"),Z=w.useRef(null),z=w.useRef(null),q=()=>i(null),Y=(J=!1)=>{o(xn.SELECT_OPTIONS),i(null),J||(c(t||me.MS_1_2),h(null),p(Fn.AI_RECOMMENDED),S("")),E(null),y([]),T(null),C(0),L(void 0),j(""),M({mcq:0,essay:0,totalMcqPossible:qu*Va,totalEssayPossible:$u,total:0}),$(null),F("text"),k(null)},V=()=>{Y(!1),e()},R=w.useCallback(async()=>{if(!d){i({type:"validation",message:"    ."}),o(xn.SELECT_OPTIONS);return}o(xn.FETCHING_CONTENT),k(`AI '${d}'      ...`),q(),E(null),y([]),T(null);try{const J=await tx("",d,u);E(J);const[re,ie]=await Promise.all([nx(J.explanation,J.topic,qu,u,""),sx(J.explanation,J.topic,u,"")]),le=re.map((pe,ee)=>({id:`sgp-mcq-${ee}-${rn()}`,originalQuestionText:pe.question,options:pe.options,correctAnswerIndex:pe.answer_index,explanation:pe.explanation,attemptsOnConcept:0,isConceptMastered:!1}));y(le),ie&&T({id:`sgp-essay-${rn()}`,questionText:ie.questionText,solutionText:ie.solutionText,userAnswer:""}),o(xn.DISPLAY_CONTENT_AND_INTERACTION),F("interaction")}catch(J){console.error(J),i({type:"api",message:J instanceof Error?J.message:"    ",details:String(J)}),o(xn.ERROR)}finally{k(null)}},[d,u]),X=()=>{if(_===void 0||A>=g.length)return;const J=g[A],re=_===J.correctAnswerIndex,ie={...J,userAnswerIndex:_,isCorrectAttempt:re,attemptsOnConcept:J.attemptsOnConcept+1,isConceptMastered:J.isConceptMastered||re};y(le=>le.map(pe=>pe.id===ie.id?ie:pe)),re&&ie.attemptsOnConcept===1?M(le=>({...le,mcq:le.mcq+Va,total:le.total+Va})):!re&&s&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:ie.originalQuestionText,userAnswer:ie.options[_],correctAnswer:ie.options[ie.correctAnswerIndex],aiAnalysis:ie.explanation,timestamp:new Date().toISOString()}),setTimeout(()=>{L(void 0),A<g.length-1?C(le=>le+1):Z.current&&(Z.current.scrollTop=0)},1200)},W=async()=>{if(!N)return;o(xn.GRADING),k("AI       ..."),q();let J=0,re=b;if(b&&I.trim())try{const le=await rx(N.explanation,N.topic,b.questionText,I,u,"");J=le.score,re={...b,userAnswer:I,score:J,feedback:le.feedback},T(re),s&&J<=$u/2&&s({id:crypto.randomUUID(),subject:"",moduleType:"",questionText:b.questionText,userAnswer:I,correctAnswer:b.solutionText||"  ",aiAnalysis:le.feedback,timestamp:new Date().toISOString()})}catch(le){console.error("Essay grading error:",le),i({type:"api",message:"     ",details:String(le)})}const ie={...D,essay:J,total:D.mcq+J};M(ie);try{const le=await lx(N,g,re,"");$(le),n&&n({id:crypto.randomUUID(),subject:"",moduleType:"",completedAt:new Date().toISOString(),difficulty:u,score:ie.total,maxPossibleScore:ie.totalMcqPossible+ie.totalEssayPossible,feedbackItems:[{type:"weak_points",feedback:le}]})}catch(le){console.error("Weak points feedback error:",le),$("     .")}o(xn.SHOW_RESULTS),k(null),Z.current&&(Z.current.scrollTop=0)},G=()=>a?r.jsxs("div",{className:"w-full my-4 bg-red-700/30 border border-red-500/70 text-red-200 px-4 py-3 rounded-lg shadow-md",role:"alert",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("strong",{className:"font-semibold block mb-1 text-red-100",children:" "}),r.jsx("span",{className:"block sm:inline text-sm",children:a.message})]}),r.jsx("button",{onClick:q,className:"wonder-button p-1.5 text-red-300 hover:text-white rounded-full hover:bg-red-600/50 transition-colors",children:r.jsx(Oe,{className:"w-5 h-5"})})]}),a.details&&r.jsxs("p",{className:"text-xs mt-1.5 opacity-75",children:[" : ",a.details.substring(0,200),"..."]})]}):null,P=(J,re,ie=!0)=>r.jsxs("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:[G(),re,ie&&l!==xn.SELECT_OPTIONS&&r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"    "]})]});if(B)return P("",r.jsxs("div",{className:"w-full h-96 flex items-center justify-center",children:[" ",r.jsx(Ne,{size:"lg",color:Qe}),r.jsx("p",{className:"text-slate-300 mt-4 text-lg animate-pulse",children:B})," "]}),!1);if(l===xn.ERROR)return P("",r.jsxs("div",{className:"p-6 text-center wonder-panel max-w-xl mx-auto",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),G(),r.jsxs("div",{className:"mt-6 space-x-3",children:[r.jsxs("button",{onClick:()=>Y(!1),className:"wonder-button wonder-button-secondary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-primary",style:{backgroundColor:Qe},children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]}),!1);const Q=()=>r.jsxs("div",{className:"my-6",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-3 text-slate-100 flex items-center justify-center",children:[r.jsx(pt,{className:"w-6 h-6 mr-2",style:{color:Qe}}),"   "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:Object.values(me).map(J=>r.jsx("button",{onClick:()=>c(J),className:`wonder-button wonder-button-secondary px-3 py-3 text-xs sm:text-sm ${u===J?"active":""}`,style:u===J?{borderColor:Qe,backgroundColor:`color-mix(in srgb, ${Qe} 25%, transparent)`,color:"var(--text-primary)"}:{},children:J},J))})]}),K=()=>r.jsxs("div",{className:"my-8",children:[r.jsxs("h3",{className:"text-h4 font-semibold mb-4 text-slate-100 flex items-center justify-center",children:[r.jsx(Ia,{className:"w-6 h-6 mr-2",style:{color:Qe}}),"     "]}),r.jsx("div",{className:"flex justify-center space-x-3 mb-4",children:Object.values(Fn).map(J=>r.jsx("button",{onClick:()=>p(J),className:`wonder-button text-xs px-3 py-1.5 sm:px-4 sm:py-2 ${f===J?"wonder-button-primary":"wonder-button-secondary"}`,style:f===J?{backgroundColor:`color-mix(in srgb, ${Qe} 70%, transparent)`,borderColor:Qe,color:"var(--text-primary)"}:{},children:J},J))}),f===Fn.AI_RECOMMENDED?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:CE.map(J=>r.jsx("button",{onClick:()=>h(J),className:`wonder-button wonder-button-secondary p-3 text-sm ${d===J?"active":""}`,style:d===J?{borderColor:Qe,backgroundColor:`color-mix(in srgb, ${Qe} 25%, transparent)`,color:"var(--text-primary)"}:{},children:J},J))}):r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"text",value:v,onChange:J=>S(J.target.value),placeholder:"  (:  )",className:"wonder-input flex-grow p-3"}),r.jsx("button",{onClick:()=>h(v),disabled:!v.trim(),className:"wonder-button wonder-button-primary p-3",children:r.jsx(Lr,{className:"w-5 h-5"})})]}),d&&r.jsxs("p",{className:"text-sm text-slate-300 mt-3 text-center",children:[" : ",r.jsx("span",{style:{color:Qe,fontWeight:"bold"},children:d})]})]}),ae=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-6 sm:mb-8",children:[r.jsx(Ia,{className:"h-10 w-10 sm:h-12 sm:w-12",style:{color:Qe},strokeWidth:1.2}),r.jsx("h1",{className:"text-h1 text-heading text-shadow-subtle",children:" "})]}),r.jsx("p",{className:"mb-4 text-body text-slate-200 leading-relaxed",children:"AI         ,   ."}),G(),Q(),K(),r.jsx("button",{onClick:R,disabled:!d||l===xn.FETCHING_CONTENT,className:"wonder-button wonder-button-primary mt-8 px-8 py-3.5 text-lg",style:{backgroundColor:Qe,borderColor:Qe},children:l===xn.FETCHING_CONTENT?r.jsx(Ne,{size:"sm",color:"text-white"}):r.jsxs(r.Fragment,{children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})}),r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary mt-12 flex items-center justify-center px-6 py-3 text-sm mx-auto",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"}),"  "]})]}),O=()=>{if(!N)return null;const J=A<g.length,re=!J&&b,ie=!J&&(!b||b&&I.trim()!==""),le=`lg:w-2/5 wonder-panel p-4 sm:p-6 lg:sticky lg:top-4 self-start max-h-[85vh] overflow-y-auto scrollbar-thin ${H==="text"||l===xn.SHOW_RESULTS?"block w-full mb-4 lg:mb-0":"hidden lg:block"}`,pe=`lg:w-3/5 wonder-panel p-4 sm:p-6 self-start min-h-[60vh] lg:min-h-0 scrollbar-thin ${H==="interaction"||l===xn.SHOW_RESULTS?"block w-full":"hidden lg:block"}`;return r.jsxs("div",{className:"w-full max-w-7xl lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:hidden fixed bottom-4 right-4 z-50 flex flex-col space-y-2",id:"mobile-view-toggle-social-geography",children:[r.jsxs("button",{onClick:()=>F("text"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="text"?"active":""}`,style:H==="text"?{borderColor:Qe,backgroundColor:`color-mix(in srgb, ${Qe} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Bs,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]}),r.jsxs("button",{onClick:()=>F("interaction"),className:`wonder-button wonder-button-secondary px-3 py-2 text-xs sm:text-sm shadow-xl ${H==="interaction"?"active":""}`,style:H==="interaction"?{borderColor:Qe,backgroundColor:`color-mix(in srgb, ${Qe} 25%, transparent)`,color:"var(--text-primary)"}:{},children:[r.jsx(Yn,{className:"w-4 h-4 sm:w-5 sm:h-5 inline mr-1.5"})," "]})]}),r.jsxs("div",{id:"report-text-panel-social-geography",className:le,ref:z,children:[r.jsx("div",{className:"flex justify-between items-center mb-3",children:r.jsxs("h2",{className:"text-h2 font-semibold flex items-center",style:{color:Qe},children:[r.jsx(Ia,{className:"w-7 h-7 mr-2.5 flex-shrink-0"})," ",N.topic]})}),r.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[r.jsxs("p",{className:"text-caption text-slate-400",children:[" (",N.difficulty,")"]}),N.sourceUrl&&r.jsx("a",{href:N.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-small hover:underline",style:{color:Qe},children:" "})]}),r.jsx("div",{className:"prose-wonder max-w-none text-slate-200 whitespace-pre-wrap text-body leading-relaxed",children:N.explanation})]}),r.jsxs("div",{id:"report-interaction-panel-social-geography",ref:Z,className:pe,children:[G(),J&&g[A]&&r.jsxs("div",{children:[r.jsxs("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Qe} 80%, white)`},children:["  ",A+1,"/",g.length]}),r.jsx("p",{className:"text-body text-slate-100 mb-4 whitespace-pre-wrap",children:g[A].originalQuestionText}),r.jsx("div",{className:"space-y-3",children:g[A].options.map((ee,ue)=>{const fe=_===ue,ye=g[A];let Re="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2",ne={};return ye.userAnswerIndex!==void 0?ue===ye.correctAnswerIndex?(Re+=" border-[var(--color-correct)] bg-[rgba(16,185,129,0.2)]",ne={color:"var(--color-correct)",fontWeight:"600"}):ue===ye.userAnswerIndex?(Re+=" border-[var(--color-incorrect)] bg-[rgba(244,63,94,0.2)]",ne={color:"var(--color-incorrect)"}):Re+=" opacity-60 border-[var(--border-panel)]":fe?(Re+=` active border-[${Qe}]`,ne={borderColor:Qe,backgroundColor:`color-mix(in srgb, ${Qe} 20%, transparent)`,color:"var(--text-primary)"}):Re+=` border-[var(--border-panel)] hover:border-[${Qe}]`,r.jsxs("button",{onClick:()=>ye.userAnswerIndex===void 0&&L(ue),disabled:ye.userAnswerIndex!==void 0,className:Re,style:ne,children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+ue),"."]})," ",ee]},ue)})}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!1&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-red-700/20 border-red-500/60 text-sm",children:[r.jsx("p",{className:"font-semibold text-red-200",children:"."}),r.jsxs("p",{className:"text-slate-300",children:[": ",g[A].options[g[A].correctAnswerIndex]]}),r.jsxs("p",{className:"text-slate-400",children:[": ",g[A].explanation]})]}),g[A].userAnswerIndex!==void 0&&g[A].isCorrectAttempt===!0&&r.jsxs("div",{className:"my-3 p-3 wonder-panel bg-green-700/30 border-green-500/60 text-green-200 font-semibold flex items-center text-sm",children:[r.jsx(En,{className:"w-5 h-5 mr-2 text-green-300"})," !"]}),g[A].userAnswerIndex===void 0&&r.jsx("button",{onClick:X,disabled:_===void 0,className:"wonder-button wonder-button-primary w-full mt-4 py-3 text-lg",style:{backgroundColor:Qe,borderColor:Qe},children:" "})]}),re&&r.jsxs("div",{children:[r.jsx("h3",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Qe} 80%, white)`},children:" "}),r.jsx("p",{className:"text-body text-slate-100 mb-3 whitespace-pre-wrap",children:b.questionText}),r.jsx("textarea",{value:I,onChange:ee=>j(ee.target.value),placeholder:"  ...",rows:6,className:"wonder-input w-full p-3"})]}),ie&&r.jsx("button",{onClick:W,className:"wonder-button wonder-button-primary w-full mt-6 py-3.5 text-lg",style:{backgroundColor:"var(--accent-english)",borderColor:"var(--accent-english)"},children:"     "})]})]})},se=()=>{const{mcq:J,essay:re,totalMcqPossible:ie,totalEssayPossible:le,total:pe}=D,ee=ie+le,ue=ee>0?Math.round(pe/ee*100):0;let fe="var(--color-incorrect)";return ue>=80?fe="var(--color-correct)":ue>=50&&(fe="var(--color-warning)"),r.jsxs("div",{className:"text-center w-full",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 text-left mb-6",style:{borderColor:Qe},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-4 text-center sm:text-left",children:[r.jsx(Ia,{className:"w-10 h-10 sm:w-12 sm:w-12 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Qe}}),r.jsx("h2",{className:"text-h2 font-bold text-shadow-subtle",style:{color:Qe},children:"  "})]}),r.jsxs("p",{className:"text-xs text-center text-slate-400 mb-4",children:["(",u,")"]}),N&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsx("p",{className:"text-body text-slate-200",children:N.topic})]}),r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-1",children:" "}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:Qe},children:[J," / ",ie]})]}),r.jsxs("div",{className:"wonder-panel p-3 border border-slate-700/30",children:[r.jsx("p",{className:"text-xs text-slate-400",children:""}),r.jsxs("p",{className:"text-lg font-bold",style:{color:`color-mix(in srgb, ${Qe} 80%, white)`},children:[re," / ",le]})]}),r.jsxs("div",{className:"wonder-panel p-3 border-green-600/50 bg-green-800/30",children:[r.jsx("p",{className:"text-xs text-slate-300",children:""}),r.jsxs("p",{className:"text-lg font-bold text-green-300",children:[pe," / ",ee]})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:r.jsx("div",{className:"h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${ue}%`,backgroundColor:fe}})}),r.jsxs("p",{className:"text-right text-xs text-slate-400 mt-1",children:[ue,"% "]})]})]}),U&&r.jsxs("div",{className:"mb-4 pb-4 border-b border-[var(--border-panel)]",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-1 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-400"}),"AI  "]}),r.jsx("p",{className:"text-slate-200 whitespace-pre-wrap text-sm",children:U})]}),(b==null?void 0:b.feedback)&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-semibold",style:{color:`color-mix(in srgb, ${Qe} 80%, white)`},children:"  AI :"}),r.jsx("p",{className:"text-xs text-slate-200 whitespace-pre-wrap mt-1",children:b.feedback})]}),r.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>Y(!0),className:"wonder-button wonder-button-primary flex items-center justify-center",style:{backgroundColor:Qe,borderColor:Qe},children:[r.jsx(nt,{className:"w-5 h-5 mr-2"}),"   "]}),r.jsxs("button",{onClick:V,className:"wonder-button wonder-button-secondary px-4 py-2 text-sm",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]})};return l===xn.SELECT_OPTIONS?P("",ae(),!1):P("",l===xn.SHOW_RESULTS?se():O(),!1)},Nn="var(--accent-science)",Wl=2,Vu=1,za=10,qs=25,VT=({onGoHome:e,subject:t,subjectSpecificSubCategories:n,initialDifficulty:s,onModuleComplete:l,onMistakeMade:o})=>{const[a,i]=w.useState(De.SELECT_OPTIONS),[u,c]=w.useState(null),[d,h]=w.useState(s||me.MS_1_2),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(void 0),[g,y]=w.useState(""),[b,T]=w.useState(null),[A,C]=w.useState({mcqCorrect:0,mcqTotalQuestions:Wl,essayScores:[],essayTotalPossiblePerQuestion:qs,overallScore:0,maxPossibleScore:Wl*za+Vu*qs}),[_,L]=w.useState(null),[I,j]=w.useState(null),[D,M]=w.useState(null);w.useEffect(()=>{s&&h(s)},[s]);const U=()=>j(null),$=(R=!1)=>{i(De.SELECT_OPTIONS),R||(c(null),h(s||me.MS_1_2)),p([]),S(0),y(""),E(void 0),T(null),C({mcqCorrect:0,mcqTotalQuestions:Wl,essayScores:[],essayTotalPossiblePerQuestion:qs,overallScore:0,maxPossibleScore:Wl*za+Vu*qs}),L(null),U(),M(null)},B=()=>{$(!1),e()},k=w.useCallback(async()=>{if(!u){j({type:"validation",message:"   ."});return}i(De.GENERATING_QUESTIONS),M(`AI ${t} (${u})   ...`),$(!0),U();try{const[R,X]=await Promise.all([ox(t,u,d,Wl),ax(t,u,d,Vu)]),W=R.map((Q,K)=>({id:`mcq-phy-${K}-${rn()}`,originalQuestionText:Q.question,options:Q.options,correctAnswerIndex:Q.answer_index,explanation:Q.explanation,attemptsOnConcept:0,isConceptMastered:!1})),G=X.map((Q,K)=>({id:`essay-phy-${K}-${rn()}`,questionText:Q.questionText,solutionText:Q.solutionText,userAnswer:""})),P=[...W,...G];p(P),S(0),i(P.length>0&&"options"in P[0]?De.MCQ_SOLVE:De.ESSAY_SOLVE)}catch(R){console.error(R),j({type:"api",message:`   : ${R instanceof Error?R.message:String(R)}`,details:String(R)}),i(De.ERROR)}finally{M(null)}},[t,u,d]),H=w.useCallback(async R=>{i(De.ESSAY_GRADING),M("AI      ...");const X=await Promise.all(R.map(async O=>{if(!("options"in O)&&O.userAnswer.trim()!=="")try{const se=await ix(O.questionText,O.userAnswer,O.solutionText||"",t,u,d,O.userNotepadImageBase64);return o&&u&&se.score<=qs/2&&o({id:rn(),subject:t,moduleType:u,questionText:O.questionText,userAnswer:O.userAnswer,correctAnswer:O.solutionText||"  ",aiAnalysis:se.feedback,timestamp:new Date().toISOString()}),{...O,score:se.score,feedback:se.feedback}}catch(se){return console.error(`Essay grading error for problem ${O.id}:`,se),{...O,score:0,feedback:"   ."}}return O}));p(X);const W=X.filter(O=>"options"in O),G=X.filter(O=>!("options"in O)),P=W.filter(O=>O.isCorrectAttempt).length,Q=G.map(O=>O.score||0),K=P*za+Q.reduce((O,se)=>O+se,0),ae={mcqCorrect:P,mcqTotalQuestions:W.length,essayScores:Q,essayTotalPossiblePerQuestion:qs,overallScore:K,maxPossibleScore:W.length*za+G.length*qs};C(ae);try{const O=await cx(t,u,d,W,G);L(O),l&&u&&l({id:rn(),subject:t,moduleType:u,completedAt:new Date().toISOString(),difficulty:d,score:K,maxPossibleScore:ae.maxPossibleScore,feedbackItems:[{type:"weak_points",feedback:O}]})}catch(O){console.error("Feedback generation error:",O),L("     .")}i(De.SHOW_RESULTS),M(null)},[t,u,d,l,o]),F=()=>{if(N===void 0)return;const R=f[v],X=N===R.correctAnswerIndex;!X&&o&&u&&o({id:rn(),subject:t,moduleType:u,questionText:R.originalQuestionText,userAnswer:R.options[N],correctAnswer:R.options[R.correctAnswerIndex],aiAnalysis:R.explanation,timestamp:new Date().toISOString()}),p(W=>W.map((G,P)=>P===v?{...G,userAnswerIndex:N,isCorrectAttempt:X}:G))},Z=()=>{const R=!("options"in f[v]);let X=f;if(R){const W=f.map((G,P)=>P===v?{...G,userAnswer:g,userNotepadImageBase64:b}:G);p(W),X=W}if(v<f.length-1){S(G=>G+1),E(void 0),y(""),T(null);const W=X[v+1];i("options"in W?De.MCQ_SOLVE:De.ESSAY_SOLVE)}else H(X)},z=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(To,{className:"h-10 w-10",style:{color:Nn}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:t})]}),r.jsxs("p",{className:"mb-8 text-text-secondary",children:[t,"      ."]}),I&&r.jsx("div",{className:"text-red-400 my-2",children:I.message}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2",style:{color:Nn}})," "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(me).map(R=>r.jsx("button",{onClick:()=>h(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${d===R?"active":""}`,style:d===R?{backgroundColor:`color-mix(in srgb, ${Nn} 25%, transparent)`,borderColor:Nn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(kt,{className:"w-5 h-5 mr-2",style:{color:Nn}}),"  "]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map(R=>r.jsx("button",{onClick:()=>c(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${u===R?"active":""}`,style:u===R?{backgroundColor:`color-mix(in srgb, ${Nn} 25%, transparent)`,borderColor:Nn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsxs("button",{onClick:k,disabled:!u||D!==null,className:"wonder-button wonder-button-primary px-8 py-3 text-lg flex items-center",children:[D?r.jsx(Ne,{size:"sm"}):r.jsx(nt,{className:"w-5 h-5 mr-2"}),"  "]}),r.jsxs("button",{onClick:B,className:"text-text-secondary hover:text-text-primary flex items-center",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"}),"  "]})]})]}),q=()=>{const R=f[v];if(!R)return r.jsx("p",{children:"  ..."});const X="options"in R,W=X&&R.userAnswerIndex!==void 0;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:w-2/5 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin mb-4 lg:mb-0",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:Nn},children:[" ",v+1,"/",f.length]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-3",children:[X?"":""," - ",u]}),r.jsx("div",{className:"text-body text-text-primary whitespace-pre-wrap py-4 border-y border-slate-700",children:X?R.originalQuestionText:R.questionText})]}),r.jsxs("div",{className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start",children:[r.jsx("h3",{className:"text-h4 font-semibold mb-3",style:{color:`color-mix(in srgb, ${Nn} 80%, white)`},children:"   "}),X?r.jsx("div",{className:"space-y-3",children:R.options.map((G,P)=>{let Q="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2";return W?P===R.correctAnswerIndex?Q+=" border-color-correct bg-color-correct/10":P===N?Q+=" border-color-incorrect bg-color-incorrect/10":Q+=" opacity-50":N===P&&(Q+=" active"),r.jsxs("button",{onClick:()=>!W&&E(P),disabled:W,className:Q,children:[String.fromCharCode(65+P),". ",G]},P)})}):r.jsxs("div",{children:[r.jsx("textarea",{value:g,onChange:G=>y(G.target.value),className:"wonder-input w-full",rows:4,placeholder:"  ..."}),r.jsx("div",{className:"mt-4",children:r.jsx(Bl,{problemId:R.id,onSolutionChange:T,accentColor:Nn})})]}),W&&r.jsxs("div",{className:`mt-4 p-3 rounded-md text-sm ${R.isCorrectAttempt?"bg-color-correct/10 text-color-correct":"bg-color-incorrect/10 text-color-incorrect"}`,children:[R.isCorrectAttempt?r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(En,{className:"w-5 h-5 mr-2"})," !"]}):r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(Oe,{className:"w-5 h-5 mr-2"})," ."]}),r.jsxs("p",{className:"mt-1 text-slate-300",children:[": ",R.explanation]})]}),!W&&X?r.jsx("button",{onClick:F,disabled:N===void 0,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:" "}):r.jsx("button",{onClick:Z,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:""})]})]})},Y=()=>{const{mcqCorrect:R,mcqTotalQuestions:X,essayScores:W,overallScore:G,maxPossibleScore:P}=A,Q=P>0?Math.round(G/P*100):0;let K="var(--color-incorrect)";return Q>=80?K="var(--color-correct)":Q>=50&&(K="var(--color-warning)"),r.jsxs("div",{className:"text-center wonder-panel p-6 max-w-3xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[r.jsx(Dn,{className:"h-12 w-12 mr-4",style:{color:Nn}}),r.jsxs("h2",{className:"text-h2 font-bold",style:{color:Nn},children:[t,"  "]})]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:[u," (",d,")"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 my-6",children:[r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:Nn},children:[R," / ",X]})]}),r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:Nn},children:[W.reduce((ae,O)=>ae+O,0)," / ",W.length*qs]})]})]}),r.jsxs("div",{className:"my-6",children:[r.jsxs("p",{className:"text-lg font-semibold text-center text-green-300",children:[": ",G," / ",P]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5 mt-1",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${Q}%`,backgroundColor:K}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[Q,"% "]})]}),_&&r.jsxs("div",{className:"my-6 text-left",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-300"}),"AI  "]}),r.jsx("div",{className:"p-4 wonder-panel-inset text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",children:_})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>$(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center",children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:B,className:"wonder-button wonder-button-primary flex items-center justify-center",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]})};let V;return D?V=r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center",children:[r.jsx(Ne,{size:"lg",color:Nn}),r.jsx("p",{className:"mt-4 text-text-secondary",children:D})]}):a===De.SELECT_OPTIONS?V=z():a===De.MCQ_SOLVE||a===De.ESSAY_SOLVE?V=q():a===De.SHOW_RESULTS?V=Y():V=r.jsx("div",{children:I?I.message:"   ."}),r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:V})},Sn="var(--accent-science)",Xl=2,zu=1,Qa=10,$s=25,zT=({onGoHome:e,subject:t,subjectSpecificSubCategories:n,initialDifficulty:s,onModuleComplete:l,onMistakeMade:o})=>{const[a,i]=w.useState(De.SELECT_OPTIONS),[u,c]=w.useState(null),[d,h]=w.useState(s||me.MS_1_2),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(void 0),[g,y]=w.useState(""),[b,T]=w.useState(null),[A,C]=w.useState({mcqCorrect:0,mcqTotalQuestions:Xl,essayScores:[],essayTotalPossiblePerQuestion:$s,overallScore:0,maxPossibleScore:Xl*Qa+zu*$s}),[_,L]=w.useState(null),[I,j]=w.useState(null),[D,M]=w.useState(null);w.useEffect(()=>{s&&h(s)},[s]);const U=()=>j(null),$=(R=!1)=>{i(De.SELECT_OPTIONS),R||(c(null),h(s||me.MS_1_2)),p([]),S(0),y(""),E(void 0),T(null),C({mcqCorrect:0,mcqTotalQuestions:Xl,essayScores:[],essayTotalPossiblePerQuestion:$s,overallScore:0,maxPossibleScore:Xl*Qa+zu*$s}),L(null),U(),M(null)},B=()=>{$(!1),e()},k=w.useCallback(async()=>{if(!u){j({type:"validation",message:"   ."});return}i(De.GENERATING_QUESTIONS),M(`AI ${t} (${u})   ...`),$(!0),U();try{const[R,X]=await Promise.all([ox(t,u,d,Xl),ax(t,u,d,zu)]),W=R.map((Q,K)=>({id:`mcq-chem-${K}-${rn()}`,originalQuestionText:Q.question,options:Q.options,correctAnswerIndex:Q.answer_index,explanation:Q.explanation,attemptsOnConcept:0,isConceptMastered:!1})),G=X.map((Q,K)=>({id:`essay-chem-${K}-${rn()}`,questionText:Q.questionText,solutionText:Q.solutionText,userAnswer:""})),P=[...W,...G];p(P),S(0),i(P.length>0&&"options"in P[0]?De.MCQ_SOLVE:De.ESSAY_SOLVE)}catch(R){console.error(R),j({type:"api",message:`   : ${R instanceof Error?R.message:String(R)}`,details:String(R)}),i(De.ERROR)}finally{M(null)}},[t,u,d]),H=w.useCallback(async R=>{i(De.ESSAY_GRADING),M("AI      ...");const X=await Promise.all(R.map(async O=>{if(!("options"in O)&&O.userAnswer.trim()!=="")try{const se=await ix(O.questionText,O.userAnswer,O.solutionText||"",t,u,d,O.userNotepadImageBase64);return o&&u&&se.score<=$s/2&&o({id:crypto.randomUUID(),subject:t,moduleType:u,questionText:O.questionText,userAnswer:O.userAnswer,correctAnswer:O.solutionText||"  ",aiAnalysis:se.feedback,timestamp:new Date().toISOString()}),{...O,score:se.score,feedback:se.feedback}}catch(se){return console.error(`Essay grading error for problem ${O.id}:`,se),{...O,score:0,feedback:"   ."}}return O}));p(X);const W=X.filter(O=>"options"in O),G=X.filter(O=>!("options"in O)),P=W.filter(O=>O.isCorrectAttempt).length,Q=G.map(O=>O.score||0),K=P*Qa+Q.reduce((O,se)=>O+se,0),ae={mcqCorrect:P,mcqTotalQuestions:W.length,essayScores:Q,essayTotalPossiblePerQuestion:$s,overallScore:K,maxPossibleScore:W.length*Qa+G.length*$s};C(ae);try{const O=await cx(t,u,d,W,G);L(O),l&&u&&l({id:crypto.randomUUID(),subject:t,moduleType:u,completedAt:new Date().toISOString(),difficulty:d,score:K,maxPossibleScore:ae.maxPossibleScore,feedbackItems:[{type:"weak_points",feedback:O}]})}catch(O){console.error("Feedback generation error:",O),L("     .")}i(De.SHOW_RESULTS),M(null)},[t,u,d,l,o]),F=()=>{if(N===void 0)return;const R=f[v],X=N===R.correctAnswerIndex;!X&&o&&u&&o({id:crypto.randomUUID(),subject:t,moduleType:u,questionText:R.originalQuestionText,userAnswer:R.options[N],correctAnswer:R.options[R.correctAnswerIndex],aiAnalysis:R.explanation,timestamp:new Date().toISOString()}),p(W=>W.map((G,P)=>P===v?{...G,userAnswerIndex:N,isCorrectAttempt:X}:G))},Z=()=>{const R=!("options"in f[v]);let X=f;if(R){const W=f.map((G,P)=>P===v?{...G,userAnswer:g,userNotepadImageBase64:b}:G);p(W),X=W}if(v<f.length-1){S(G=>G+1),E(void 0),y(""),T(null);const W=X[v+1];i("options"in W?De.MCQ_SOLVE:De.ESSAY_SOLVE)}else H(X)},z=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(Ao,{className:"h-10 w-10",style:{color:Sn}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:t})]}),r.jsxs("p",{className:"mb-8 text-text-secondary",children:[t,"      ."]}),I&&r.jsx("div",{className:"text-red-400 my-2",children:I.message}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2",style:{color:Sn}})," "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(me).map(R=>r.jsx("button",{onClick:()=>h(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${d===R?"active":""}`,style:d===R?{backgroundColor:`color-mix(in srgb, ${Sn} 25%, transparent)`,borderColor:Sn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(kt,{className:"w-5 h-5 mr-2",style:{color:Sn}}),"  "]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map(R=>r.jsx("button",{onClick:()=>c(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${u===R?"active":""}`,style:u===R?{backgroundColor:`color-mix(in srgb, ${Sn} 25%, transparent)`,borderColor:Sn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsxs("button",{onClick:k,disabled:!u||D!==null,className:"wonder-button wonder-button-primary px-8 py-3 text-lg flex items-center",children:[D?r.jsx(Ne,{size:"sm"}):r.jsx(nt,{className:"w-5 h-5 mr-2"}),"  "]}),r.jsxs("button",{onClick:B,className:"text-text-secondary hover:text-text-primary flex items-center",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"}),"  "]})]})]}),q=()=>{const R=f[v];if(!R)return r.jsx("p",{children:"  ..."});const X="options"in R,W=X&&R.userAnswerIndex!==void 0;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:w-2/5 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin mb-4 lg:mb-0",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:Sn},children:[" ",v+1,"/",f.length]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-3",children:[X?"":""," - ",u]}),r.jsx("div",{className:"text-body text-text-primary whitespace-pre-wrap py-4 border-y border-slate-700",children:X?R.originalQuestionText:R.questionText})]}),r.jsxs("div",{className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start",children:[r.jsx("h3",{className:"text-h4 font-semibold mb-3",style:{color:`color-mix(in srgb, ${Sn} 80%, white)`},children:"   "}),X?r.jsx("div",{className:"space-y-3",children:R.options.map((G,P)=>{let Q="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2";return W?P===R.correctAnswerIndex?Q+=" border-color-correct bg-color-correct/10":P===N?Q+=" border-color-incorrect bg-color-incorrect/10":Q+=" opacity-50":N===P&&(Q+=" active"),r.jsxs("button",{onClick:()=>!W&&E(P),disabled:W,className:Q,children:[String.fromCharCode(65+P),". ",G]},P)})}):r.jsxs("div",{children:[r.jsx("textarea",{value:g,onChange:G=>y(G.target.value),className:"wonder-input w-full",rows:4,placeholder:"  ..."}),r.jsx("div",{className:"mt-4",children:r.jsx(Bl,{problemId:R.id,onSolutionChange:T,accentColor:Sn})})]}),W&&r.jsxs("div",{className:`mt-4 p-3 rounded-md text-sm ${R.isCorrectAttempt?"bg-color-correct/10 text-color-correct":"bg-color-incorrect/10 text-color-incorrect"}`,children:[R.isCorrectAttempt?r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(En,{className:"w-5 h-5 mr-2"})," !"]}):r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(Oe,{className:"w-5 h-5 mr-2"})," ."]}),r.jsxs("p",{className:"mt-1 text-slate-300",children:[": ",R.explanation]})]}),!W&&X?r.jsx("button",{onClick:F,disabled:N===void 0,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:" "}):r.jsx("button",{onClick:Z,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:""})]})]})},Y=()=>{const{mcqCorrect:R,mcqTotalQuestions:X,essayScores:W,overallScore:G,maxPossibleScore:P}=A,Q=P>0?Math.round(G/P*100):0;let K="var(--color-incorrect)";return Q>=80?K="var(--color-correct)":Q>=50&&(K="var(--color-warning)"),r.jsxs("div",{className:"text-center wonder-panel p-6 max-w-3xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[r.jsx(Dn,{className:"h-12 w-12 mr-4",style:{color:Sn}}),r.jsxs("h2",{className:"text-h2 font-bold",style:{color:Sn},children:[t,"  "]})]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:[u," (",d,")"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 my-6",children:[r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:Sn},children:[R," / ",X]})]}),r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:Sn},children:[W.reduce((ae,O)=>ae+O,0)," / ",W.length*$s]})]})]}),r.jsxs("div",{className:"my-6",children:[r.jsxs("p",{className:"text-lg font-semibold text-center text-green-300",children:[": ",G," / ",P]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5 mt-1",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${Q}%`,backgroundColor:K}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[Q,"% "]})]}),_&&r.jsxs("div",{className:"my-6 text-left",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-300"}),"AI  "]}),r.jsx("div",{className:"p-4 wonder-panel-inset text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",children:_})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>$(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center",children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:B,className:"wonder-button wonder-button-primary flex items-center justify-center",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]})};let V;return D?V=r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center",children:[r.jsx(Ne,{size:"lg",color:Sn}),r.jsx("p",{className:"mt-4 text-text-secondary",children:D})]}):a===De.SELECT_OPTIONS?V=z():a===De.MCQ_SOLVE||a===De.ESSAY_SOLVE?V=q():a===De.SHOW_RESULTS?V=Y():V=r.jsx("div",{children:I?I.message:"   ."}),r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:V})},wn="var(--accent-science)",Kl=2,Qu=1,Ya=10,Vs=25,QT=({onGoHome:e,subject:t,subjectSpecificSubCategories:n,initialDifficulty:s,onModuleComplete:l,onMistakeMade:o})=>{const[a,i]=w.useState(De.SELECT_OPTIONS),[u,c]=w.useState(null),[d,h]=w.useState(s||me.MS_1_2),[f,p]=w.useState([]),[v,S]=w.useState(0),[N,E]=w.useState(void 0),[g,y]=w.useState(""),[b,T]=w.useState(null),[A,C]=w.useState({mcqCorrect:0,mcqTotalQuestions:Kl,essayScores:[],essayTotalPossiblePerQuestion:Vs,overallScore:0,maxPossibleScore:Kl*Ya+Qu*Vs}),[_,L]=w.useState(null),[I,j]=w.useState(null),[D,M]=w.useState(null);w.useEffect(()=>{s&&h(s)},[s]);const U=()=>j(null),$=(R=!1)=>{i(De.SELECT_OPTIONS),R||(c(null),h(s||me.MS_1_2)),p([]),S(0),y(""),E(void 0),T(null),C({mcqCorrect:0,mcqTotalQuestions:Kl,essayScores:[],essayTotalPossiblePerQuestion:Vs,overallScore:0,maxPossibleScore:Kl*Ya+Qu*Vs}),L(null),U(),M(null)},B=()=>{$(!1),e()},k=w.useCallback(async()=>{if(!u){j({type:"validation",message:"   ."});return}i(De.GENERATING_QUESTIONS),M(`AI ${t} (${u})   ...`),$(!0),U();try{const[R,X]=await Promise.all([ox(t,u,d,Kl),ax(t,u,d,Qu)]),W=R.map((Q,K)=>({id:`mcq-ls-${K}-${rn()}`,originalQuestionText:Q.question,options:Q.options,correctAnswerIndex:Q.answer_index,explanation:Q.explanation,attemptsOnConcept:0,isConceptMastered:!1})),G=X.map((Q,K)=>({id:`essay-ls-${K}-${rn()}`,questionText:Q.questionText,solutionText:Q.solutionText,userAnswer:""})),P=[...W,...G];p(P),S(0),i(P.length>0&&"options"in P[0]?De.MCQ_SOLVE:De.ESSAY_SOLVE)}catch(R){console.error(R),j({type:"api",message:`   : ${R instanceof Error?R.message:String(R)}`,details:String(R)}),i(De.ERROR)}finally{M(null)}},[t,u,d]),H=w.useCallback(async R=>{i(De.ESSAY_GRADING),M("AI      ...");const X=await Promise.all(R.map(async O=>{if(!("options"in O)&&O.userAnswer.trim()!=="")try{const se=await ix(O.questionText,O.userAnswer,O.solutionText||"",t,u,d,O.userNotepadImageBase64);return o&&u&&se.score<=Vs/2&&o({id:crypto.randomUUID(),subject:t,moduleType:u,questionText:O.questionText,userAnswer:O.userAnswer,correctAnswer:O.solutionText||"  ",aiAnalysis:se.feedback,timestamp:new Date().toISOString()}),{...O,score:se.score,feedback:se.feedback}}catch(se){return console.error(`Essay grading error for problem ${O.id}:`,se),{...O,score:0,feedback:"   ."}}return O}));p(X);const W=X.filter(O=>"options"in O),G=X.filter(O=>!("options"in O)),P=W.filter(O=>O.isCorrectAttempt).length,Q=G.map(O=>O.score||0),K=P*Ya+Q.reduce((O,se)=>O+se,0),ae={mcqCorrect:P,mcqTotalQuestions:W.length,essayScores:Q,essayTotalPossiblePerQuestion:Vs,overallScore:K,maxPossibleScore:W.length*Ya+G.length*Vs};C(ae);try{const O=await cx(t,u,d,W,G);L(O),l&&u&&l({id:crypto.randomUUID(),subject:t,moduleType:u,completedAt:new Date().toISOString(),difficulty:d,score:K,maxPossibleScore:ae.maxPossibleScore,feedbackItems:[{type:"weak_points",feedback:O}]})}catch(O){console.error("Feedback generation error:",O),L("     .")}i(De.SHOW_RESULTS),M(null)},[t,u,d,l,o]),F=()=>{if(N===void 0)return;const R=f[v],X=N===R.correctAnswerIndex;!X&&o&&u&&o({id:crypto.randomUUID(),subject:t,moduleType:u,questionText:R.originalQuestionText,userAnswer:R.options[N],correctAnswer:R.options[R.correctAnswerIndex],aiAnalysis:R.explanation,timestamp:new Date().toISOString()}),p(W=>W.map((G,P)=>P===v?{...G,userAnswerIndex:N,isCorrectAttempt:X}:G))},Z=()=>{const R=!("options"in f[v]);let X=f;if(R){const W=f.map((G,P)=>P===v?{...G,userAnswer:g,userNotepadImageBase64:b}:G);p(W),X=W}if(v<f.length-1){S(G=>G+1),E(void 0),y(""),T(null);const W=X[v+1];i("options"in W?De.MCQ_SOLVE:De.ESSAY_SOLVE)}else H(X)},z=()=>r.jsxs("div",{className:"w-full max-w-3xl text-center p-4 md:p-6 wonder-panel mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[r.jsx(_t,{className:"h-10 w-10",style:{color:wn}}),r.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:t})]}),r.jsxs("p",{className:"mb-8 text-text-secondary",children:[t,"      ."]}),I&&r.jsx("div",{className:"text-red-400 my-2",children:I.message}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(pt,{className:"w-5 h-5 mr-2",style:{color:wn}})," "]}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(me).map(R=>r.jsx("button",{onClick:()=>h(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${d===R?"active":""}`,style:d===R?{backgroundColor:`color-mix(in srgb, ${wn} 25%, transparent)`,borderColor:wn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center justify-center text-text-primary",children:[r.jsx(kt,{className:"w-5 h-5 mr-2",style:{color:wn}}),"  "]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.map(R=>r.jsx("button",{onClick:()=>c(R),className:`wonder-button wonder-button-secondary py-3 text-sm ${u===R?"active":""}`,style:u===R?{backgroundColor:`color-mix(in srgb, ${wn} 25%, transparent)`,borderColor:wn,color:"var(--text-primary)"}:{},children:R},R))})]}),r.jsxs("div",{className:"flex items-center justify-center space-x-4 mt-10",children:[r.jsxs("button",{onClick:k,disabled:!u||D!==null,className:"wonder-button wonder-button-primary px-8 py-3 text-lg flex items-center",children:[D?r.jsx(Ne,{size:"sm"}):r.jsx(nt,{className:"w-5 h-5 mr-2"}),"  "]}),r.jsxs("button",{onClick:B,className:"text-text-secondary hover:text-text-primary flex items-center",children:[r.jsx(pn,{className:"w-5 h-5 mr-1"}),"  "]})]})]}),q=()=>{const R=f[v];if(!R)return r.jsx("p",{children:"  ..."});const X="options"in R,W=X&&R.userAnswerIndex!==void 0;return r.jsxs("div",{className:"w-full lg:flex lg:space-x-4 relative",children:[r.jsxs("div",{className:"lg:w-2/5 wonder-panel p-4 sm:p-6 self-start max-h-[85vh] overflow-y-auto scrollbar-thin mb-4 lg:mb-0",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:wn},children:[" ",v+1,"/",f.length]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-3",children:[X?"":""," - ",u]}),r.jsx("div",{className:"text-body text-text-primary whitespace-pre-wrap py-4 border-y border-slate-700",children:X?R.originalQuestionText:R.questionText})]}),r.jsxs("div",{className:"lg:w-3/5 wonder-panel p-4 sm:p-6 self-start",children:[r.jsx("h3",{className:"text-h4 font-semibold mb-3",style:{color:`color-mix(in srgb, ${wn} 80%, white)`},children:"   "}),X?r.jsx("div",{className:"space-y-3",children:R.options.map((G,P)=>{let Q="wonder-button wonder-button-secondary w-full text-left p-3.5 border-2";return W?P===R.correctAnswerIndex?Q+=" border-color-correct bg-color-correct/10":P===N?Q+=" border-color-incorrect bg-color-incorrect/10":Q+=" opacity-50":N===P&&(Q+=" active"),r.jsxs("button",{onClick:()=>!W&&E(P),disabled:W,className:Q,children:[String.fromCharCode(65+P),". ",G]},P)})}):r.jsxs("div",{children:[r.jsx("textarea",{value:g,onChange:G=>y(G.target.value),className:"wonder-input w-full",rows:4,placeholder:"  ..."}),r.jsx("div",{className:"mt-4",children:r.jsx(Bl,{problemId:R.id,onSolutionChange:T,accentColor:wn})})]}),W&&r.jsxs("div",{className:`mt-4 p-3 rounded-md text-sm ${R.isCorrectAttempt?"bg-color-correct/10 text-color-correct":"bg-color-incorrect/10 text-color-incorrect"}`,children:[R.isCorrectAttempt?r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(En,{className:"w-5 h-5 mr-2"})," !"]}):r.jsxs("p",{className:"font-semibold flex items-center",children:[r.jsx(Oe,{className:"w-5 h-5 mr-2"})," ."]}),r.jsxs("p",{className:"mt-1 text-slate-300",children:[": ",R.explanation]})]}),!W&&X?r.jsx("button",{onClick:F,disabled:N===void 0,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:" "}):r.jsx("button",{onClick:Z,className:"wonder-button wonder-button-primary w-full py-3 text-lg mt-4",children:""})]})]})},Y=()=>{const{mcqCorrect:R,mcqTotalQuestions:X,essayScores:W,overallScore:G,maxPossibleScore:P}=A,Q=P>0?Math.round(G/P*100):0;let K="var(--color-incorrect)";return Q>=80?K="var(--color-correct)":Q>=50&&(K="var(--color-warning)"),r.jsxs("div",{className:"text-center wonder-panel p-6 max-w-3xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[r.jsx(Dn,{className:"h-12 w-12 mr-4",style:{color:wn}}),r.jsxs("h2",{className:"text-h2 font-bold",style:{color:wn},children:[t,"  "]})]}),r.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:[u," (",d,")"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 my-6",children:[r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:wn},children:[R," / ",X]})]}),r.jsxs("div",{className:"wonder-panel-inset p-4",children:[r.jsx("p",{className:"text-sm text-text-secondary",children:""}),r.jsxs("p",{className:"text-2xl font-bold",style:{color:wn},children:[W.reduce((ae,O)=>ae+O,0)," / ",W.length*Vs]})]})]}),r.jsxs("div",{className:"my-6",children:[r.jsxs("p",{className:"text-lg font-semibold text-center text-green-300",children:[": ",G," / ",P]}),r.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2.5 mt-1",children:r.jsx("div",{className:"h-2.5 rounded-full",style:{width:`${Q}%`,backgroundColor:K}})}),r.jsxs("p",{className:"text-right text-caption text-slate-400 mt-1",children:[Q,"% "]})]}),_&&r.jsxs("div",{className:"my-6 text-left",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-5 h-5 mr-2 text-yellow-300"}),"AI  "]}),r.jsx("div",{className:"p-4 wonder-panel-inset text-slate-200 whitespace-pre-wrap prose-wonder max-w-none text-sm leading-relaxed",children:_})]}),r.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[r.jsxs("button",{onClick:()=>$(!0),className:"wonder-button wonder-button-secondary flex items-center justify-center",children:[r.jsx(ls,{className:"w-5 h-5 mr-2"}),"    "]}),r.jsxs("button",{onClick:B,className:"wonder-button wonder-button-primary flex items-center justify-center",children:[r.jsx(Ce,{className:"w-5 h-5 mr-2"})," "]})]})]})};let V;return D?V=r.jsxs("div",{className:"h-96 flex flex-col items-center justify-center",children:[r.jsx(Ne,{size:"lg",color:wn}),r.jsx("p",{className:"mt-4 text-text-secondary",children:D})]}):a===De.SELECT_OPTIONS?V=z():a===De.MCQ_SOLVE||a===De.ESSAY_SOLVE?V=q():a===De.SHOW_RESULTS?V=Y():V=r.jsx("div",{children:I?I.message:"   ."}),r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-7xl mx-auto",children:V})},Qt="var(--accent-assessment)",Zl=5,YT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI     ..."),l(null);try{const M=await VA(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"    ."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<Zl)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI     ...");try{const k=await zA(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"    ."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["AI      . ",r.jsx("br",{})," ",Zl,"   ,      . ",r.jsx("br",{}),"     !"]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Qt,borderColor:Qt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})]}),_=()=>o?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Qt} 80%, white)`},children:[" ",c,"/",Zl]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI  : ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((j,D)=>r.jsxs("button",{onClick:()=>f(D),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===D?"active":""}`,style:h===D?{borderColor:Qt,backgroundColor:`color-mix(in srgb, ${Qt} 20%, transparent)`,color:Qt}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+D),"."]})," ",j]},D))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Qt,borderColor:Qt},children:c<Zl?" ":" "})]}):r.jsx("p",{children:"   ..."}),L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Qt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx($o,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Qt}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Qt},children:"    "})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI  "}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Qt} 90%, white)`},children:p.assessedLevel})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"})," AI  "]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Qt} 50%, transparent)`},children:p.feedback})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Qt,borderColor:Qt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"}),"  "]})})]}):r.jsx("p",{children:"   ..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Qt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," "]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"   ."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx($o,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Qt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Qt},children:"  "}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${Zl}`:" ",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]})})},Yt="var(--accent-assessment)",Jl=5,WT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI is generating the next assessment question..."),l(null);try{const M=await QA(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"Error generating question."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<Jl)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI is determining your English proficiency level...");try{const k=await YA(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"Error determining level."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["Begin your AI-powered English level assessment. ",r.jsx("br",{}),"You will be asked approximately ",Jl," multiple-choice questions. The difficulty will adapt based on your answers. ",r.jsx("br",{}),"Try your best to answer accurately!"]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Yt,borderColor:Yt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"})," Start Assessment"]})]}),_=()=>o?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Yt} 80%, white)`},children:["Question ",c,"/",Jl]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI Target Difficulty: ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((j,D)=>r.jsxs("button",{onClick:()=>f(D),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===D?"active":""}`,style:h===D?{borderColor:Yt,backgroundColor:`color-mix(in srgb, ${Yt} 20%, transparent)`,color:Yt}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+D),"."]})," ",j]},D))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Yt,borderColor:Yt},children:c<Jl?"Next Question":"Show Results"})]}):r.jsx("p",{children:"Error loading question..."}),L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Yt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Vo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Yt}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Yt},children:"English Level Assessment Results"})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI Assessed Level"}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Yt} 90%, white)`},children:p.assessedLevel})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"})," AI Feedback (Korean)"]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Yt} 50%, transparent)`},children:p.feedback})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Yt,borderColor:Yt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"})," Retake Assessment"]})})]}):r.jsx("p",{children:"Error analyzing results..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Yt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:"Error"}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," Try Again"]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"Unknown state."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Vo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Yt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Yt},children:"English Level Assessment"}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${Jl}`:"Preparing...",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"})," Go Back Home"]})]})})},Wt="var(--accent-assessment)",eo=5,XT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI     ..."),l(null);try{const M=await WA(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"    ."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<eo)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI     ...");try{const k=await XA(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"    ."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["AI      . ",r.jsx("br",{})," ",eo,"   ,      . ",r.jsx("br",{}),"     !"]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Wt,borderColor:Wt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})]}),_=()=>o?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Wt} 80%, white)`},children:[" ",c,"/",eo]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI  : ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((j,D)=>r.jsxs("button",{onClick:()=>f(D),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===D?"active":""}`,style:h===D?{borderColor:Wt,backgroundColor:`color-mix(in srgb, ${Wt} 20%, transparent)`,color:Wt}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+D),"."]})," ",j]},D))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Wt,borderColor:Wt},children:c<eo?" ":" "})]}):r.jsx("p",{children:"   ..."}),L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Wt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(zo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Wt}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Wt},children:"    "})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI  "}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Wt} 90%, white)`},children:p.assessedLevel})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"})," AI  "]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Wt} 50%, transparent)`},children:p.feedback})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Wt,borderColor:Wt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"}),"  "]})})]}):r.jsx("p",{children:"   ..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Wt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," "]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"   ."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(zo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Wt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Wt},children:"  "}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${eo}`:" ",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]})})},Xt="var(--accent-assessment)",to=5,KT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI      ..."),l(null);try{const M=await KA(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"    ."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<to)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI      ...");try{const k=await ZA(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"    ."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["AI      . ",r.jsx("br",{})," ",to,"   ,      . ",r.jsx("br",{}),"     !"]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Xt,borderColor:Xt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})]}),_=()=>o?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Xt} 80%, white)`},children:[" ",c,"/",to]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI  : ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((j,D)=>r.jsxs("button",{onClick:()=>f(D),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===D?"active":""}`,style:h===D?{borderColor:Xt,backgroundColor:`color-mix(in srgb, ${Xt} 20%, transparent)`,color:Xt}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+D),"."]})," ",j]},D))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Xt,borderColor:Xt},children:c<to?" ":" "})]}):r.jsx("p",{children:"   ..."}),L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Xt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Yo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Xt}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Xt},children:"    "})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI  "}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Xt} 90%, white)`},children:p.assessedLevel})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"})," AI  "]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Xt} 50%, transparent)`},children:p.feedback})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Xt,borderColor:Xt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"}),"  "]})})]}):r.jsx("p",{children:"   ..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Xt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," "]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"   ."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Yo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Xt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Xt},children:"  "}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${to}`:" ",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]})})},Kt="var(--accent-assessment)",no=5,ZT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI      ..."),l(null);try{const M=await JA(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"    ."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<no)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI      ...");try{const k=await eT(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"    ."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["AI      . ",r.jsx("br",{})," ",no,"   ,      . ",r.jsx("br",{}),"     !"]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Kt,borderColor:Kt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"  "]})]}),_=()=>o?r.jsxs("div",{children:[r.jsxs("h2",{className:"text-h3 font-semibold mb-2",style:{color:`color-mix(in srgb, ${Kt} 80%, white)`},children:[" ",c,"/",no]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI  : ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((j,D)=>r.jsxs("button",{onClick:()=>f(D),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===D?"active":""}`,style:h===D?{borderColor:Kt,backgroundColor:`color-mix(in srgb, ${Kt} 20%, transparent)`,color:Kt}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+D),"."]})," ",j]},D))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Kt,borderColor:Kt},children:c<no?" ":" "})]}):r.jsx("p",{children:"   ..."}),L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Kt},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Qo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Kt}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Kt},children:"    "})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI  "}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Kt} 90%, white)`},children:p.assessedLevel})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 flex items-center",children:[r.jsx(_t,{className:"w-6 h-6 mr-2.5 text-yellow-400"})," AI  "]}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Kt} 50%, transparent)`},children:p.feedback})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Kt,borderColor:Kt},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"}),"  "]})})]}):r.jsx("p",{children:"   ..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Kt}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," "]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"   ."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-3xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(Qo,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Kt},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Kt},children:"  "}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${no}`:" ",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]})})},Ft="var(--accent-primary)",so=20,Gh=e=>{switch(e==null?void 0:e.toLowerCase()){case"":return{Icon:$o,color:"var(--accent-korean)"};case"":return{Icon:Vo,color:"var(--accent-english)"};case"":return{Icon:zo,color:"var(--accent-math)"};case"":return{Icon:Yo,color:"var(--accent-science)"};case"":return{Icon:Qo,color:"var(--accent-social)"};default:return{Icon:_t,color:Ft}}},JT=({onGoHome:e})=>{const[t,n]=w.useState(de.WELCOME),[s,l]=w.useState(null),[o,a]=w.useState(null),[i,u]=w.useState([]),[c,d]=w.useState(0),[h,f]=w.useState(void 0),[p,v]=w.useState(null),[S,N]=w.useState(null),[E,g]=w.useState(me.MS_1_2),y=()=>{n(de.WELCOME),l(null),a(null),u([]),d(0),f(void 0),v(null),N(null),g(me.MS_1_2)},b=w.useCallback(async(j,D)=>{N("AI      ..."),l(null);try{const M=await tT(D,j);a(M),d(U=>U+1),n(de.SHOWING_QUESTION)}catch(M){console.error(M),l(M instanceof Error?M.message:"    ."),n(de.ERROR)}finally{N(null)}},[]),T=()=>{y(),n(de.GENERATING_QUESTION),b(E,[])},A=async()=>{if(h===void 0||!o)return;const j=h===o.answer_index,D={questionId:o.id,questionText:o.question,options:o.options,correctAnswerIndex:o.answer_index,userAnswerIndex:h,isCorrect:j,difficultyPresented:o.difficultyUsedToGenerate,subject:o.subject||""},M=[...i,D];u(M),f(void 0);let U=E;const $=Object.values(me),B=$.indexOf(E);if(j?B<$.length-1&&(U=$[B+1]):B>0&&(U=$[B-1]),g(U),c<so)n(de.GENERATING_QUESTION),b(U,M);else{n(de.DETERMINING_LEVEL),N("AI      ...");try{const k=await nT(M);v(k),n(de.SHOWING_RESULTS)}catch(k){console.error(k),l(k instanceof Error?k.message:"    ."),n(de.ERROR)}finally{N(null)}}},C=()=>r.jsxs("div",{className:"text-center",children:[r.jsxs("p",{className:"text-body text-slate-200 mb-8 leading-relaxed",children:["AI      . ",r.jsx("br",{}),", , , ,      ",so,"  . ",r.jsx("br",{}),"     ,        ."]}),r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary px-8 py-3.5 text-lg",style:{backgroundColor:Ft,borderColor:Ft},children:[r.jsx(nt,{className:"w-5 h-5 mr-2 inline"}),"   "]})]}),_=()=>{if(!o)return r.jsx("p",{children:"   ..."});const{Icon:j,color:D}=Gh(o.subject);return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h2",{className:"text-h3 font-semibold",style:{color:`color-mix(in srgb, ${Ft} 80%, var(--text-primary))`},children:[" ",c,"/",so]}),r.jsxs("div",{className:"flex items-center px-2 py-1 rounded-md text-xs font-medium",style:{backgroundColor:`color-mix(in srgb, ${D} 20%, transparent)`,color:D,border:`1px solid ${D}`},children:[r.jsx(j,{className:"w-3.5 h-3.5 mr-1.5",style:{color:D}}),o.subject||""]})]}),r.jsxs("p",{className:"text-caption text-slate-400 mb-1",children:["AI  : ",o.difficultyUsedToGenerate]}),r.jsx("p",{className:"text-h4 text-slate-100 mb-6 whitespace-pre-wrap py-4 border-y border-slate-700",children:o.question}),r.jsx("div",{className:"space-y-3 mb-6",children:o.options.map((M,U)=>r.jsxs("button",{onClick:()=>f(U),className:`wonder-button wonder-button-secondary w-full text-left p-3.5 border-2 ${h===U?"active":""}`,style:h===U?{borderColor:Ft,backgroundColor:`color-mix(in srgb, ${Ft} 20%, transparent)`,color:Ft}:{},children:[r.jsxs("span",{className:"font-mono mr-2",children:[String.fromCharCode(65+U),"."]})," ",M]},U))}),r.jsx("button",{onClick:A,disabled:h===void 0,className:"wonder-button wonder-button-primary w-full mt-3 px-6 py-3.5 text-lg",style:{backgroundColor:Ft,borderColor:Ft},children:c<so?" ":" "})]})},L=()=>p?r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"wonder-panel p-5 sm:p-8 text-left mb-6",style:{borderColor:Ft},children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(_t,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Ft}}),r.jsx("div",{children:r.jsx("h2",{className:"text-h2 sm:text-h1 font-bold text-shadow-subtle",style:{color:Ft},children:"    "})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2 text-center",children:"AI   "}),r.jsx("p",{className:"text-5xl font-extrabold text-center mb-3",style:{color:`color-mix(in srgb, ${Ft} 90%, white)`},children:p.assessedLevel})]}),p.subjectBreakdown&&Object.keys(p.subjectBreakdown).length>0&&r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-3",children:"  "}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-sm",children:Object.entries(p.subjectBreakdown).map(([j,D])=>{const{Icon:M,color:U}=Gh(j);return r.jsxs("div",{className:"p-3 wonder-panel border rounded-md",style:{borderColor:`color-mix(in srgb, ${U} 50%, transparent)`},children:[r.jsxs("div",{className:"flex items-center justify-center mb-1",children:[r.jsx(M,{className:"w-4 h-4 mr-1.5",style:{color:U}}),r.jsx("span",{className:"font-medium",style:{color:U},children:j})]}),r.jsx("p",{className:"text-md font-semibold text-slate-200 text-center",children:D})]},j)})})]}),r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-slate-100 mb-2",children:"AI  "}),r.jsx("div",{className:"p-4 wonder-panel text-slate-200 whitespace-pre-wrap prose-wonder max-w-none leading-relaxed text-sm",style:{borderColor:`color-mix(in srgb, ${Ft} 50%, transparent)`},children:p.feedback})]}),p.strengths&&p.strengths.length>0&&r.jsxs("div",{className:"mb-6 pb-6 border-b border-[var(--border-panel)]",children:[r.jsx("h3",{className:"text-h3 font-semibold text-green-400 mb-2",children:"  "}),r.jsx("ul",{className:"list-disc list-inside text-slate-200 pl-2 space-y-1 prose-wonder max-w-none text-sm",children:p.strengths.map((j,D)=>r.jsx("li",{children:j},`str-${D}`))})]}),p.areasForImprovement&&p.areasForImprovement.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-h3 font-semibold text-yellow-400 mb-2",children:" "}),r.jsx("ul",{className:"list-disc list-inside text-slate-200 pl-2 space-y-1 prose-wonder max-w-none text-sm",children:p.areasForImprovement.map((j,D)=>r.jsx("li",{children:j},`imp-${D}`))})]}),r.jsxs("p",{className:"mt-6 text-xs text-center text-slate-500",children:["Let We Do (",new Date().toLocaleDateString(),")"]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:r.jsxs("button",{onClick:T,className:"wonder-button wonder-button-primary flex items-center justify-center px-6 py-3.5 text-sm",style:{backgroundColor:Ft,borderColor:Ft},children:[r.jsx(nt,{className:"w-5 h-5 mr-2.5"}),"  "]})})]}):r.jsx("p",{children:"   ..."}),I=()=>{if(S)return r.jsxs("div",{className:"h-60 flex flex-col items-center justify-center p-8 text-center",children:[r.jsx(Ne,{size:"lg",color:Ft}),r.jsx("p",{className:"text-slate-300 mt-5 text-lg animate-pulse",children:S})]});if(s)return r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(Oe,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-3",children:" "}),r.jsx("p",{className:"text-slate-300 mb-4",children:s}),r.jsxs("button",{onClick:y,className:"wonder-button wonder-button-secondary",children:[r.jsx(pn,{className:"w-5 h-5 mr-2"})," "]})]});switch(t){case de.WELCOME:return C();case de.SHOWING_QUESTION:return _();case de.SHOWING_RESULTS:return L();default:return r.jsx("p",{children:"   ."})}};return r.jsx("div",{className:"p-1 sm:p-2 w-full max-w-4xl mx-auto",children:r.jsxs("div",{className:"wonder-panel p-5 sm:p-6 md:p-8",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center mb-6 text-center sm:text-left",children:[r.jsx(_t,{className:"w-12 h-12 sm:w-14 sm:w-14 mr-0 sm:mr-3 mb-2 sm:mb-0",style:{color:Ft},strokeWidth:1.2}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-h1 font-bold text-shadow-subtle",style:{color:Ft},children:"  "}),t!==de.WELCOME&&t!==de.ERROR&&r.jsxs("p",{className:"text-caption text-slate-400",children:["(",c>0?`${c} / ${so}`:" ",")"]})]})]}),I(),t!==de.WELCOME&&r.jsxs("button",{onClick:e,className:"wonder-button wonder-button-secondary mt-8 block mx-auto px-6 py-2 text-xs",children:[r.jsx(Ce,{className:"w-4 h-4 mr-1.5 inline-block"}),"  "]})]})})},Wa="lwdUserProfile";function Hh(){const e=navigator.userAgent;return/Windows NT/i.test(e)?"Windows":/Macintosh|Mac OS X/i.test(e)?"Mac":/Linux/i.test(e)?"Linux":/CrOS/i.test(e)?"ChromeOS":/Android/i.test(e)?"Android":/iPhone|iPad|iPod/i.test(e)?"iOS":" "}function e_(){const e=navigator.userAgent;return/Mobi|Android|iPhone|iPad|iPod|Mobile|Tablet/i.test(e)?{type:"mobile"}:/CrOS/i.test(e)?{type:"chromeos"}:/Windows NT/i.test(e)?{type:"dt-win",os:Hh()}:{type:"dt-other",os:Hh()}}const t_=()=>{const[e,t]=w.useState(!ex()),[n,s]=w.useState(null),[l,o]=w.useState(ce.HOME),[a,i]=w.useState(!0),[u,c]=w.useState(null),[d,h]=w.useState(!1),[f,p]=w.useState(navigator.onLine),v=e_();w.useEffect(()=>{try{const j=localStorage.getItem(Wa);if(j){const D=JSON.parse(j);s(D),o(ce.LOGIN)}else o(ce.ONBOARDING_FLOW)}catch(j){console.error("Error loading profile from localStorage:",j),localStorage.removeItem(Wa),o(ce.ONBOARDING_FLOW)}finally{i(!1)}},[]),w.useEffect(()=>{const j=()=>{if(v.type==="mobile"||v.type==="chromeos"){const U=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;h(U)}else h(!1)};j(),window.addEventListener("resize",j),window.addEventListener("DOMContentLoaded",j);const D=()=>p(!0),M=()=>p(!1);return window.addEventListener("online",D),window.addEventListener("offline",M),()=>{window.removeEventListener("resize",j),window.removeEventListener("DOMContentLoaded",j),window.removeEventListener("online",D),window.removeEventListener("offline",M)}},[v.type]);const S=j=>{j?localStorage.setItem(Wa,JSON.stringify(j)):localStorage.removeItem(Wa)},N=()=>{t(!0)},E=(j,D,M)=>{const U=Xd(D),$={id:`user-${Date.now()}`,nickname:j,password:U,defaultStudyDifficulty:M,completedModules:[],mistakeNotebook:[]};s($),S($),o(ce.HOME)},g=j=>{S(j),s(j),o(ce.LOGIN)},y=j=>{n&&n.password?Ch(j,n.password)?(c(null),o(ce.HOME)):c("  ."):c("       .")},b=()=>{window.confirm("      ?     .")&&(s(null),S(null),o(ce.ONBOARDING_FLOW))},T=j=>{if(n){let D={...n,...j};if(j.oldPassword&&j.newPassword&&n.password)if(Ch(j.oldPassword,n.password))D.password=Xd(j.newPassword);else return!1;return delete D.oldPassword,delete D.newPassword,s(D),S(D),!0}return!1},A=w.useCallback(j=>{if(n){const D={...n,completedModules:[...n.completedModules||[],j]};s(D),S(D)}},[n]),C=w.useCallback(j=>{if(n){const D={...n,mistakeNotebook:[...n.mistakeNotebook||[],j]};s(D),S(D)}},[n]),_=w.useCallback(j=>{if(n){const D=n.mistakeNotebook.map(U=>{const $=j.find(B=>B.originalMistakeId===U.id);return $?{...U,reviewQuizQuestion:$.reviewQuestion,isReviewQuizCorrect:$.isCorrect}:U}),M={...n,mistakeNotebook:D};s(M),S(M)}o(ce.HOME)},[n]),L=()=>{t(!1)};if(!d)return r.jsxs("div",{className:"w-full h-screen flex flex-col items-center justify-center bg-slate-900 text-white text-center p-8",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4",children:"  "}),v.type==="mobile"&&r.jsx(r.Fragment,{children:r.jsxs("p",{className:"mb-2",children:["  , ",r.jsx("b",{children:"LWD"})," !"]})}),v.type==="chromeos"&&r.jsx(r.Fragment,{children:r.jsxs("p",{className:"mb-2",children:["  ",r.jsx("b",{children:'" "'})," , ",r.jsx("b",{children:"LWD"})," !"]})}),v.type==="dt-win"&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"mb-2",children:[v.os," PWA  ."]}),r.jsxs("p",{className:"mb-2",children:[" ",r.jsx("b",{children:"Electron"}),"  ."]}),r.jsxs("p",{className:"mb-2",children:["  ",r.jsx("a",{href:"https://LetWD.github.io",target:"_blank",rel:"noopener noreferrer",className:"underline text-accent-secondary",children:""})," !"]})]}),v.type==="dt-other"&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"mb-2",children:["LWD ",v.os,"  ."]}),r.jsx("p",{className:"mb-2",children:"       ."}),r.jsxs("p",{className:"mb-2",children:["  ",r.jsx("a",{href:"https://LetWD.github.io",target:"_blank",rel:"noopener noreferrer",className:"underline text-accent-secondary",children:""})," !"]})]})]});if(!f)return r.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",fontSize:20},children:r.jsxs("p",{children:["    .",r.jsx("br",{}),"  ."]})});if(!e)return r.jsxs("main",{className:"min-h-screen bg-bg-base text-text-primary font-sans flex flex-col",children:[r.jsx("div",{className:"flex-grow p-2 sm:p-4 flex items-center justify-center",children:r.jsx(LT,{onApiKeySet:N})}),r.jsx("footer",{className:"flex-shrink-0 py-3 px-4 text-center text-xs text-text-tertiary/70 border-t border-border-panel/50",children:" 2025 LetWD | Developed by Jiwho | Powered by Gemini"})]});if(a)return r.jsx("div",{className:"w-full h-screen flex flex-col items-center justify-center bg-bg-base text-center",children:r.jsx(Ne,{size:"lg"})});const I=()=>{if(!n)return r.jsx(Bh,{onProfileCreate:E,onProfileImport:g});switch(l){case ce.LOGIN:return r.jsx(MT,{userProfile:n,onLogin:y,onDeleteProfile:b,loginError:u});case ce.HOME:return r.jsx(Lh,{userProfile:n,onNavigate:j=>o(j)});case ce.ONBOARDING_FLOW:return r.jsx(Bh,{onProfileCreate:E,onProfileImport:g});case ce.PROFILE_SETTINGS:return r.jsx(DT,{currentUser:n,onGoHome:()=>o(ce.HOME),onUpdateProfileSetting:T,onDeleteAllData:b,onClearApiKey:L});case ce.MISTAKE_NOTEBOOK:return r.jsx(OT,{currentUser:n,onGoHome:()=>o(ce.HOME),onUpdateProfile:T});case ce.REVIEW_QUIZ:return r.jsx(kT,{currentUser:n,onReviewComplete:_});case ce.KOREAN_LITERATURE:return r.jsx(pT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.KOREAN_NON_FICTION:return r.jsx(gT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.KOREAN_GRAMMAR:return r.jsx(yT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.KOREAN_LITERATURE_WRITING:return r.jsx(bT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.KOREAN_NON_FICTION_WRITING:return r.jsx(vT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ENGLISH_READING:return r.jsx(ET,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ENGLISH_WRITING:return r.jsx(NT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ENGLISH_GRAMMAR:return r.jsx(ST,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ENGLISH_VOCABULARY:return r.jsx(wT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ENGLISH_IRREGULAR_VERBS:return r.jsx(AT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.MATH_ARITHMETIC:return r.jsx(BT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.MATH_GRAPHS_EQUATIONS:return r.jsx(PT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.MATH_GEOMETRY:return r.jsx(HT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SOCIAL_GENERAL:return r.jsx(FT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SOCIAL_HISTORY:return r.jsx(qT,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SOCIAL_GEOGRAPHY:return r.jsx($T,{onGoHome:()=>o(ce.HOME),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SCIENCE_PHYSICS:return r.jsx(VT,{onGoHome:()=>o(ce.HOME),subject:di.PHYSICS,subjectSpecificSubCategories:Object.values(Fy),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SCIENCE_CHEMISTRY:return r.jsx(zT,{onGoHome:()=>o(ce.HOME),subject:di.CHEMISTRY,subjectSpecificSubCategories:Object.values(qy),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.SCIENCE_LIFE_SCIENCE:return r.jsx(QT,{onGoHome:()=>o(ce.HOME),subject:di.LIFE_SCIENCE,subjectSpecificSubCategories:Object.values($y),initialDifficulty:n==null?void 0:n.defaultStudyDifficulty,onModuleComplete:A,onMistakeMade:C});case ce.ASSESSMENT_KOREAN_LEVEL:return r.jsx(YT,{onGoHome:()=>o(ce.HOME)});case ce.ASSESSMENT_ENGLISH_LEVEL:return r.jsx(WT,{onGoHome:()=>o(ce.HOME)});case ce.ASSESSMENT_MATH_LEVEL:return r.jsx(XT,{onGoHome:()=>o(ce.HOME)});case ce.ASSESSMENT_SCIENCE_LEVEL:return r.jsx(KT,{onGoHome:()=>o(ce.HOME)});case ce.ASSESSMENT_SOCIAL_STUDIES_LEVEL:return r.jsx(ZT,{onGoHome:()=>o(ce.HOME)});case ce.ASSESSMENT_COMPREHENSIVE:return r.jsx(JT,{onGoHome:()=>o(ce.HOME)});default:return r.jsx(Lh,{userProfile:n,onNavigate:j=>o(j)})}};return r.jsxs("main",{className:"min-h-screen bg-bg-base text-text-primary font-sans flex flex-col",children:[r.jsx("div",{className:"flex-grow p-2 sm:p-4 flex items-center justify-center",children:I()}),r.jsx("footer",{className:"flex-shrink-0 py-3 px-4 text-center text-xs text-text-tertiary/70 border-t border-border-panel/50",children:" 2025 LetWD | Developed by Jiwho | Powered by Gemini"})]})},vb=document.getElementById("root");if(!vb)throw new Error("Could not find root element to mount to");const n_=NE.createRoot(vb);n_.render(r.jsx(qb.StrictMode,{children:r.jsx(t_,{})}));
